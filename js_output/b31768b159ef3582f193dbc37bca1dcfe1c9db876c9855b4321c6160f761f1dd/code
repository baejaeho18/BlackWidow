(this.webpackChunkpc_home=this.webpackChunkpc_home||[]).push([[877],{"../../node_modules/.pnpm/@tencent+qn-logger@1.0.0/node_modules/@tencent/qn-logger/es/dcl-upload/call.js":
/*!****************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@tencent+qn-logger@1.0.0/node_modules/@tencent/qn-logger/es/dcl-upload/call.js + 19 modules ***!
  \****************************************************************************************************************************/function(g,I,C){"use strict";C.d(I,{xH:function(){return Xg},kc:function(){return Vg},Ev:function(){return Wg},ML:function(){return Jg}});var t="0123456789abcdefghijklmnopqrstuvwxyz";function A(g){return t.charAt(g)}function e(g,I){return g&I}function i(g,I){return g|I}function n(g,I){return g^I}function o(g,I){return g&~I}function r(g){if(0==g)return-1;var I=0;return 0==(65535&g)&&(g>>=16,I+=16),0==(255&g)&&(g>>=8,I+=8),0==(15&g)&&(g>>=4,I+=4),0==(3&g)&&(g>>=2,I+=2),0==(1&g)&&++I,I}function s(g){for(var I=0;0!=g;)g&=g-1,++I;return I}var a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="=";function u(g){var I,C,t="";for(I=0;I+3<=g.length;I+=3)C=parseInt(g.substring(I,I+3),16),t+=c.charAt(C>>6)+c.charAt(63&C);for(I+1==g.length?(C=parseInt(g.substring(I,I+1),16),t+=c.charAt(C<<2)):I+2==g.length&&(C=parseInt(g.substring(I,I+2),16),t+=c.charAt(C>>2)+c.charAt((3&C)<<4));(3&t.length)>0;)t+=l;return t}function d(g){var I,C="",t=0,e=0;for(I=0;I<g.length&&g.charAt(I)!=l;++I){var i=c.indexOf(g.charAt(I));i<0||(0==t?(C+=A(i>>2),e=3&i,t=1):1==t?(C+=A(e<<2|i>>4),e=15&i,t=2):2==t?(C+=A(e),C+=A(i>>2),e=3&i,t=3):(C+=A(e<<2|i>>4),C+=A(15&i),t=0))}return 1==t&&(C+=A(e<<2)),C}var h,m=function(g){var I;if(void 0===a){var C="0123456789ABCDEF",t=" \f\n\r\t \u2028\u2029";for(a={},I=0;I<16;++I)a[C.charAt(I)]=I;for(C=C.toLowerCase(),I=10;I<16;++I)a[C.charAt(I)]=I;for(I=0;I<8;++I)a[t.charAt(I)]=-1}var A=[],e=0,i=0;for(I=0;I<g.length;++I){var n=g.charAt(I);if("="==n)break;if(-1!=(n=a[n])){if(void 0===n)throw new Error("Illegal character at offset "+I);e|=n,++i>=2?(A[A.length]=e,e=0,i=0):e<<=4}}if(i)throw new Error("Hex encoding incomplete: 4 bits missing");return A},S={decode:function(g){var I;if(void 0===h){var C="= \f\n\r\t \u2028\u2029";for(h=Object.create(null),I=0;I<64;++I)h["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(I)]=I;for(h["-"]=62,h._=63,I=0;I<9;++I)h[C.charAt(I)]=-1}var t=[],A=0,e=0;for(I=0;I<g.length;++I){var i=g.charAt(I);if("="==i)break;if(-1!=(i=h[i])){if(void 0===i)throw new Error("Illegal character at offset "+I);A|=i,++e>=4?(t[t.length]=A>>16,t[t.length]=A>>8&255,t[t.length]=255&A,A=0,e=0):A<<=6}}switch(e){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:t[t.length]=A>>10;break;case 3:t[t.length]=A>>16,t[t.length]=A>>8&255}return t},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(g){var I=S.re.exec(g);if(I)if(I[1])g=I[1];else{if(!I[2])throw new Error("RegExp out of sync");g=I[2]}return S.decode(g)}},y=1e13,b=function(){function g(g){this.buf=[+g||0]}return g.prototype.mulAdd=function(g,I){var C,t,A=this.buf,e=A.length;for(C=0;C<e;++C)(t=A[C]*g+I)<y?I=0:t-=(I=0|t/y)*y,A[C]=t;I>0&&(A[C]=I)},g.prototype.sub=function(g){var I,C,t=this.buf,A=t.length;for(I=0;I<A;++I)(C=t[I]-g)<0?(C+=y,g=1):g=0,t[I]=C;for(;0===t[t.length-1];)t.pop()},g.prototype.toString=function(g){if(10!=(g||10))throw new Error("only base 10 is supported");for(var I=this.buf,C=I[I.length-1].toString(),t=I.length-2;t>=0;--t)C+=(y+I[t]).toString().substring(1);return C},g.prototype.valueOf=function(){for(var g=this.buf,I=0,C=g.length-1;C>=0;--C)I=I*y+g[C];return I},g.prototype.simplify=function(){var g=this.buf;return 1==g.length?g[0]:this},g}(),Z=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,B=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function G(g,I){return g.length>I&&(g=g.substring(0,I)+"…"),g}var p,w=function(){function g(I,C){this.hexDigits="0123456789ABCDEF",I instanceof g?(this.enc=I.enc,this.pos=I.pos):(this.enc=I,this.pos=C)}return g.prototype.get=function(g){if(void 0===g&&(g=this.pos++),g>=this.enc.length)throw new Error("Requesting byte offset ".concat(g," on a stream of length ").concat(this.enc.length));return"string"==typeof this.enc?this.enc.charCodeAt(g):this.enc[g]},g.prototype.hexByte=function(g){return this.hexDigits.charAt(g>>4&15)+this.hexDigits.charAt(15&g)},g.prototype.hexDump=function(g,I,C){for(var t="",A=g;A<I;++A)if(t+=this.hexByte(this.get(A)),!0!==C)switch(15&A){case 7:t+="  ";break;case 15:t+="\n";break;default:t+=" "}return t},g.prototype.isASCII=function(g,I){for(var C=g;C<I;++C){var t=this.get(C);if(t<32||t>176)return!1}return!0},g.prototype.parseStringISO=function(g,I){for(var C="",t=g;t<I;++t)C+=String.fromCharCode(this.get(t));return C},g.prototype.parseStringUTF=function(g,I){for(var C="",t=g;t<I;){var A=this.get(t++);C+=A<128?String.fromCharCode(A):A>191&&A<224?String.fromCharCode((31&A)<<6|63&this.get(t++)):String.fromCharCode((15&A)<<12|(63&this.get(t++))<<6|63&this.get(t++))}return C},g.prototype.parseStringBMP=function(g,I){for(var C,t,A="",e=g;e<I;)C=this.get(e++),t=this.get(e++),A+=String.fromCharCode(C<<8|t);return A},g.prototype.parseTime=function(g,I,C){var t=this.parseStringISO(g,I),A=(C?Z:B).exec(t);return A?(C&&(A[1]=+A[1],A[1]+=+A[1]<70?2e3:1900),t=A[1]+"-"+A[2]+"-"+A[3]+" "+A[4],A[5]&&(t+=":"+A[5],A[6]&&(t+=":"+A[6],A[7]&&(t+="."+A[7]))),A[8]&&(t+=" UTC","Z"!=A[8]&&(t+=A[8],A[9]&&(t+=":"+A[9]))),t):"Unrecognized time: "+t},g.prototype.parseInteger=function(g,I){for(var C,t=this.get(g),A=t>127,e=A?255:0,i="";t==e&&++g<I;)t=this.get(g);if(0===(C=I-g))return A?-1:0;if(C>4){for(i=t,C<<=3;0==(128&(+i^e));)i=+i<<1,--C;i="("+C+" bit)\n"}A&&(t-=256);for(var n=new b(t),o=g+1;o<I;++o)n.mulAdd(256,this.get(o));return i+n.toString()},g.prototype.parseBitString=function(g,I,C){for(var t=this.get(g),A="("+((I-g-1<<3)-t)+" bit)\n",e="",i=g+1;i<I;++i){for(var n=this.get(i),o=i==I-1?t:0,r=7;r>=o;--r)e+=n>>r&1?"1":"0";if(e.length>C)return A+G(e,C)}return A+e},g.prototype.parseOctetString=function(g,I,C){if(this.isASCII(g,I))return G(this.parseStringISO(g,I),C);var t=I-g,A="("+t+" byte)\n";t>(C/=2)&&(I=g+C);for(var e=g;e<I;++e)A+=this.hexByte(this.get(e));return t>C&&(A+="…"),A},g.prototype.parseOID=function(g,I,C){for(var t="",A=new b,e=0,i=g;i<I;++i){var n=this.get(i);if(A.mulAdd(128,127&n),e+=7,!(128&n)){if(""===t)if((A=A.simplify())instanceof b)A.sub(80),t="2."+A.toString();else{var o=A<80?A<40?0:1:2;t=o+"."+(A-40*o)}else t+="."+A.toString();if(t.length>C)return G(t,C);A=new b,e=0}}return e>0&&(t+=".incomplete"),t},g}(),f=function(){function g(g,I,C,t,A){if(!(t instanceof k))throw new Error("Invalid tag value.");this.stream=g,this.header=I,this.length=C,this.tag=t,this.sub=A}return g.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},g.prototype.content=function(g){if(void 0===this.tag)return null;void 0===g&&(g=1/0);var I=this.posContent(),C=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(I,I+C,g);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(I)?"false":"true";case 2:return this.stream.parseInteger(I,I+C);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(I,I+C,g);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(I,I+C,g);case 6:return this.stream.parseOID(I,I+C,g);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return G(this.stream.parseStringUTF(I,I+C),g);case 18:case 19:case 20:case 21:case 22:case 26:return G(this.stream.parseStringISO(I,I+C),g);case 30:return G(this.stream.parseStringBMP(I,I+C),g);case 23:case 24:return this.stream.parseTime(I,I+C,23==this.tag.tagNumber)}return null},g.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},g.prototype.toPrettyString=function(g){void 0===g&&(g="");var I=g+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(I+="+"),I+=this.length,this.tag.tagConstructed?I+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(I+=" (encapsulates)"),I+="\n",null!==this.sub){g+="  ";for(var C=0,t=this.sub.length;C<t;++C)I+=this.sub[C].toPrettyString(g)}return I},g.prototype.posStart=function(){return this.stream.pos},g.prototype.posContent=function(){return this.stream.pos+this.header},g.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},g.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},g.decodeLength=function(g){var I=g.get(),C=127&I;if(C==I)return C;if(C>6)throw new Error("Length over 48 bits not supported at position "+(g.pos-1));if(0===C)return null;I=0;for(var t=0;t<C;++t)I=256*I+g.get();return I},g.prototype.getHexStringValue=function(){var g=this.toHexString(),I=2*this.header,C=2*this.length;return g.substr(I,C)},g.decode=function(I){var C;C=I instanceof w?I:new w(I,0);var t=new w(C),A=new k(C),e=g.decodeLength(C),i=C.pos,n=i-t.pos,o=null,r=function(){var I=[];if(null!==e){for(var t=i+e;C.pos<t;)I[I.length]=g.decode(C);if(C.pos!=t)throw new Error("Content size is not correct for container starting at offset "+i)}else try{for(;;){var A=g.decode(C);if(A.tag.isEOC())break;I[I.length]=A}e=i-C.pos}catch(g){throw new Error("Exception while decoding undefined length content: "+g)}return I};if(A.tagConstructed)o=r();else if(A.isUniversal()&&(3==A.tagNumber||4==A.tagNumber))try{if(3==A.tagNumber&&0!=C.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");o=r();for(var s=0;s<o.length;++s)if(o[s].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(g){o=null}if(null===o){if(null===e)throw new Error("We can't skip over an invalid tag with undefined length at offset "+i);C.pos=i+Math.abs(e)}return new g(t,n,e,A,o)},g}(),k=function(){function g(g){var I=g.get();if(this.tagClass=I>>6,this.tagConstructed=0!=(32&I),this.tagNumber=31&I,31==this.tagNumber){var C=new b;do{I=g.get(),C.mulAdd(128,127&I)}while(128&I);this.tagNumber=C.simplify()}}return g.prototype.isUniversal=function(){return 0===this.tagClass},g.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},g}(),H=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],J=(1<<26)/H[H.length-1],K=function(){function g(g,I,C){null!=g&&("number"==typeof g?this.fromNumber(g,I,C):null==I&&"string"!=typeof g?this.fromString(g,256):this.fromString(g,I))}return g.prototype.toString=function(g){if(this.s<0)return"-"+this.negate().toString(g);var I;if(16==g)I=4;else if(8==g)I=3;else if(2==g)I=1;else if(32==g)I=5;else{if(4!=g)return this.toRadix(g);I=2}var C,t=(1<<I)-1,e=!1,i="",n=this.t,o=this.DB-n*this.DB%I;if(n-- >0)for(o<this.DB&&(C=this[n]>>o)>0&&(e=!0,i=A(C));n>=0;)o<I?(C=(this[n]&(1<<o)-1)<<I-o,C|=this[--n]>>(o+=this.DB-I)):(C=this[n]>>(o-=I)&t,o<=0&&(o+=this.DB,--n)),C>0&&(e=!0),e&&(i+=A(C));return e?i:"0"},g.prototype.negate=function(){var I=Y();return g.ZERO.subTo(this,I),I},g.prototype.abs=function(){return this.s<0?this.negate():this},g.prototype.compareTo=function(g){var I=this.s-g.s;if(0!=I)return I;var C=this.t;if(0!=(I=C-g.t))return this.s<0?-I:I;for(;--C>=0;)if(0!=(I=this[C]-g[C]))return I;return 0},g.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+z(this[this.t-1]^this.s&this.DM)},g.prototype.mod=function(I){var C=Y();return this.abs().divRemTo(I,null,C),this.s<0&&C.compareTo(g.ZERO)>0&&I.subTo(C,C),C},g.prototype.modPowInt=function(g,I){var C;return C=g<256||I.isEven()?new V(I):new X(I),this.exp(g,C)},g.prototype.clone=function(){var g=Y();return this.copyTo(g),g},g.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},g.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},g.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},g.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},g.prototype.toByteArray=function(){var g=this.t,I=[];I[0]=this.s;var C,t=this.DB-g*this.DB%8,A=0;if(g-- >0)for(t<this.DB&&(C=this[g]>>t)!=(this.s&this.DM)>>t&&(I[A++]=C|this.s<<this.DB-t);g>=0;)t<8?(C=(this[g]&(1<<t)-1)<<8-t,C|=this[--g]>>(t+=this.DB-8)):(C=this[g]>>(t-=8)&255,t<=0&&(t+=this.DB,--g)),0!=(128&C)&&(C|=-256),0==A&&(128&this.s)!=(128&C)&&++A,(A>0||C!=this.s)&&(I[A++]=C);return I},g.prototype.equals=function(g){return 0==this.compareTo(g)},g.prototype.min=function(g){return this.compareTo(g)<0?this:g},g.prototype.max=function(g){return this.compareTo(g)>0?this:g},g.prototype.and=function(g){var I=Y();return this.bitwiseTo(g,e,I),I},g.prototype.or=function(g){var I=Y();return this.bitwiseTo(g,i,I),I},g.prototype.xor=function(g){var I=Y();return this.bitwiseTo(g,n,I),I},g.prototype.andNot=function(g){var I=Y();return this.bitwiseTo(g,o,I),I},g.prototype.not=function(){for(var g=Y(),I=0;I<this.t;++I)g[I]=this.DM&~this[I];return g.t=this.t,g.s=~this.s,g},g.prototype.shiftLeft=function(g){var I=Y();return g<0?this.rShiftTo(-g,I):this.lShiftTo(g,I),I},g.prototype.shiftRight=function(g){var I=Y();return g<0?this.lShiftTo(-g,I):this.rShiftTo(g,I),I},g.prototype.getLowestSetBit=function(){for(var g=0;g<this.t;++g)if(0!=this[g])return g*this.DB+r(this[g]);return this.s<0?this.t*this.DB:-1},g.prototype.bitCount=function(){for(var g=0,I=this.s&this.DM,C=0;C<this.t;++C)g+=s(this[C]^I);return g},g.prototype.testBit=function(g){var I=Math.floor(g/this.DB);return I>=this.t?0!=this.s:0!=(this[I]&1<<g%this.DB)},g.prototype.setBit=function(g){return this.changeBit(g,i)},g.prototype.clearBit=function(g){return this.changeBit(g,o)},g.prototype.flipBit=function(g){return this.changeBit(g,n)},g.prototype.add=function(g){var I=Y();return this.addTo(g,I),I},g.prototype.subtract=function(g){var I=Y();return this.subTo(g,I),I},g.prototype.multiply=function(g){var I=Y();return this.multiplyTo(g,I),I},g.prototype.divide=function(g){var I=Y();return this.divRemTo(g,I,null),I},g.prototype.remainder=function(g){var I=Y();return this.divRemTo(g,null,I),I},g.prototype.divideAndRemainder=function(g){var I=Y(),C=Y();return this.divRemTo(g,I,C),[I,C]},g.prototype.modPow=function(g,I){var C,t,A=g.bitLength(),e=P(1);if(A<=0)return e;C=A<18?1:A<48?3:A<144?4:A<768?5:6,t=A<8?new V(I):I.isEven()?new L(I):new X(I);var i=[],n=3,o=C-1,r=(1<<C)-1;if(i[1]=t.convert(this),C>1){var s=Y();for(t.sqrTo(i[1],s);n<=r;)i[n]=Y(),t.mulTo(s,i[n-2],i[n]),n+=2}var a,c,l=g.t-1,u=!0,d=Y();for(A=z(g[l])-1;l>=0;){for(A>=o?a=g[l]>>A-o&r:(a=(g[l]&(1<<A+1)-1)<<o-A,l>0&&(a|=g[l-1]>>this.DB+A-o)),n=C;0==(1&a);)a>>=1,--n;if((A-=n)<0&&(A+=this.DB,--l),u)i[a].copyTo(e),u=!1;else{for(;n>1;)t.sqrTo(e,d),t.sqrTo(d,e),n-=2;n>0?t.sqrTo(e,d):(c=e,e=d,d=c),t.mulTo(d,i[a],e)}for(;l>=0&&0==(g[l]&1<<A);)t.sqrTo(e,d),c=e,e=d,d=c,--A<0&&(A=this.DB-1,--l)}return t.revert(e)},g.prototype.modInverse=function(I){var C=I.isEven();if(this.isEven()&&C||0==I.signum())return g.ZERO;for(var t=I.clone(),A=this.clone(),e=P(1),i=P(0),n=P(0),o=P(1);0!=t.signum();){for(;t.isEven();)t.rShiftTo(1,t),C?(e.isEven()&&i.isEven()||(e.addTo(this,e),i.subTo(I,i)),e.rShiftTo(1,e)):i.isEven()||i.subTo(I,i),i.rShiftTo(1,i);for(;A.isEven();)A.rShiftTo(1,A),C?(n.isEven()&&o.isEven()||(n.addTo(this,n),o.subTo(I,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(I,o),o.rShiftTo(1,o);t.compareTo(A)>=0?(t.subTo(A,t),C&&e.subTo(n,e),i.subTo(o,i)):(A.subTo(t,A),C&&n.subTo(e,n),o.subTo(i,o))}return 0!=A.compareTo(g.ONE)?g.ZERO:o.compareTo(I)>=0?o.subtract(I):o.signum()<0?(o.addTo(I,o),o.signum()<0?o.add(I):o):o},g.prototype.pow=function(g){return this.exp(g,new W)},g.prototype.gcd=function(g){var I=this.s<0?this.negate():this.clone(),C=g.s<0?g.negate():g.clone();if(I.compareTo(C)<0){var t=I;I=C,C=t}var A=I.getLowestSetBit(),e=C.getLowestSetBit();if(e<0)return I;for(A<e&&(e=A),e>0&&(I.rShiftTo(e,I),C.rShiftTo(e,C));I.signum()>0;)(A=I.getLowestSetBit())>0&&I.rShiftTo(A,I),(A=C.getLowestSetBit())>0&&C.rShiftTo(A,C),I.compareTo(C)>=0?(I.subTo(C,I),I.rShiftTo(1,I)):(C.subTo(I,C),C.rShiftTo(1,C));return e>0&&C.lShiftTo(e,C),C},g.prototype.isProbablePrime=function(g){var I,C=this.abs();if(1==C.t&&C[0]<=H[H.length-1]){for(I=0;I<H.length;++I)if(C[0]==H[I])return!0;return!1}if(C.isEven())return!1;for(I=1;I<H.length;){for(var t=H[I],A=I+1;A<H.length&&t<J;)t*=H[A++];for(t=C.modInt(t);I<A;)if(t%H[I++]==0)return!1}return C.millerRabin(g)},g.prototype.copyTo=function(g){for(var I=this.t-1;I>=0;--I)g[I]=this[I];g.t=this.t,g.s=this.s},g.prototype.fromInt=function(g){this.t=1,this.s=g<0?-1:0,g>0?this[0]=g:g<-1?this[0]=g+this.DV:this.t=0},g.prototype.fromString=function(I,C){var t;if(16==C)t=4;else if(8==C)t=3;else if(256==C)t=8;else if(2==C)t=1;else if(32==C)t=5;else{if(4!=C)return void this.fromRadix(I,C);t=2}this.t=0,this.s=0;for(var A=I.length,e=!1,i=0;--A>=0;){var n=8==t?255&+I[A]:M(I,A);n<0?"-"==I.charAt(A)&&(e=!0):(e=!1,0==i?this[this.t++]=n:i+t>this.DB?(this[this.t-1]|=(n&(1<<this.DB-i)-1)<<i,this[this.t++]=n>>this.DB-i):this[this.t-1]|=n<<i,(i+=t)>=this.DB&&(i-=this.DB))}8==t&&0!=(128&+I[0])&&(this.s=-1,i>0&&(this[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),e&&g.ZERO.subTo(this,this)},g.prototype.clamp=function(){for(var g=this.s&this.DM;this.t>0&&this[this.t-1]==g;)--this.t},g.prototype.dlShiftTo=function(g,I){var C;for(C=this.t-1;C>=0;--C)I[C+g]=this[C];for(C=g-1;C>=0;--C)I[C]=0;I.t=this.t+g,I.s=this.s},g.prototype.drShiftTo=function(g,I){for(var C=g;C<this.t;++C)I[C-g]=this[C];I.t=Math.max(this.t-g,0),I.s=this.s},g.prototype.lShiftTo=function(g,I){for(var C=g%this.DB,t=this.DB-C,A=(1<<t)-1,e=Math.floor(g/this.DB),i=this.s<<C&this.DM,n=this.t-1;n>=0;--n)I[n+e+1]=this[n]>>t|i,i=(this[n]&A)<<C;for(n=e-1;n>=0;--n)I[n]=0;I[e]=i,I.t=this.t+e+1,I.s=this.s,I.clamp()},g.prototype.rShiftTo=function(g,I){I.s=this.s;var C=Math.floor(g/this.DB);if(C>=this.t)I.t=0;else{var t=g%this.DB,A=this.DB-t,e=(1<<t)-1;I[0]=this[C]>>t;for(var i=C+1;i<this.t;++i)I[i-C-1]|=(this[i]&e)<<A,I[i-C]=this[i]>>t;t>0&&(I[this.t-C-1]|=(this.s&e)<<A),I.t=this.t-C,I.clamp()}},g.prototype.subTo=function(g,I){for(var C=0,t=0,A=Math.min(g.t,this.t);C<A;)t+=this[C]-g[C],I[C++]=t&this.DM,t>>=this.DB;if(g.t<this.t){for(t-=g.s;C<this.t;)t+=this[C],I[C++]=t&this.DM,t>>=this.DB;t+=this.s}else{for(t+=this.s;C<g.t;)t-=g[C],I[C++]=t&this.DM,t>>=this.DB;t-=g.s}I.s=t<0?-1:0,t<-1?I[C++]=this.DV+t:t>0&&(I[C++]=t),I.t=C,I.clamp()},g.prototype.multiplyTo=function(I,C){var t=this.abs(),A=I.abs(),e=t.t;for(C.t=e+A.t;--e>=0;)C[e]=0;for(e=0;e<A.t;++e)C[e+t.t]=t.am(0,A[e],C,e,0,t.t);C.s=0,C.clamp(),this.s!=I.s&&g.ZERO.subTo(C,C)},g.prototype.squareTo=function(g){for(var I=this.abs(),C=g.t=2*I.t;--C>=0;)g[C]=0;for(C=0;C<I.t-1;++C){var t=I.am(C,I[C],g,2*C,0,1);(g[C+I.t]+=I.am(C+1,2*I[C],g,2*C+1,t,I.t-C-1))>=I.DV&&(g[C+I.t]-=I.DV,g[C+I.t+1]=1)}g.t>0&&(g[g.t-1]+=I.am(C,I[C],g,2*C,0,1)),g.s=0,g.clamp()},g.prototype.divRemTo=function(I,C,t){var A=I.abs();if(!(A.t<=0)){var e=this.abs();if(e.t<A.t)return null!=C&&C.fromInt(0),void(null!=t&&this.copyTo(t));null==t&&(t=Y());var i=Y(),n=this.s,o=I.s,r=this.DB-z(A[A.t-1]);r>0?(A.lShiftTo(r,i),e.lShiftTo(r,t)):(A.copyTo(i),e.copyTo(t));var s=i.t,a=i[s-1];if(0!=a){var c=a*(1<<this.F1)+(s>1?i[s-2]>>this.F2:0),l=this.FV/c,u=(1<<this.F1)/c,d=1<<this.F2,h=t.t,m=h-s,S=null==C?Y():C;for(i.dlShiftTo(m,S),t.compareTo(S)>=0&&(t[t.t++]=1,t.subTo(S,t)),g.ONE.dlShiftTo(s,S),S.subTo(i,i);i.t<s;)i[i.t++]=0;for(;--m>=0;){var y=t[--h]==a?this.DM:Math.floor(t[h]*l+(t[h-1]+d)*u);if((t[h]+=i.am(0,y,t,m,0,s))<y)for(i.dlShiftTo(m,S),t.subTo(S,t);t[h]<--y;)t.subTo(S,t)}null!=C&&(t.drShiftTo(s,C),n!=o&&g.ZERO.subTo(C,C)),t.t=s,t.clamp(),r>0&&t.rShiftTo(r,t),n<0&&g.ZERO.subTo(t,t)}}},g.prototype.invDigit=function(){if(this.t<1)return 0;var g=this[0];if(0==(1&g))return 0;var I=3&g;return(I=(I=(I=(I=I*(2-(15&g)*I)&15)*(2-(255&g)*I)&255)*(2-((65535&g)*I&65535))&65535)*(2-g*I%this.DV)%this.DV)>0?this.DV-I:-I},g.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},g.prototype.exp=function(I,C){if(I>4294967295||I<1)return g.ONE;var t=Y(),A=Y(),e=C.convert(this),i=z(I)-1;for(e.copyTo(t);--i>=0;)if(C.sqrTo(t,A),(I&1<<i)>0)C.mulTo(A,e,t);else{var n=t;t=A,A=n}return C.revert(t)},g.prototype.chunkSize=function(g){return Math.floor(Math.LN2*this.DB/Math.log(g))},g.prototype.toRadix=function(g){if(null==g&&(g=10),0==this.signum()||g<2||g>36)return"0";var I=this.chunkSize(g),C=Math.pow(g,I),t=P(C),A=Y(),e=Y(),i="";for(this.divRemTo(t,A,e);A.signum()>0;)i=(C+e.intValue()).toString(g).substr(1)+i,A.divRemTo(t,A,e);return e.intValue().toString(g)+i},g.prototype.fromRadix=function(I,C){this.fromInt(0),null==C&&(C=10);for(var t=this.chunkSize(C),A=Math.pow(C,t),e=!1,i=0,n=0,o=0;o<I.length;++o){var r=M(I,o);r<0?"-"==I.charAt(o)&&0==this.signum()&&(e=!0):(n=C*n+r,++i>=t&&(this.dMultiply(A),this.dAddOffset(n,0),i=0,n=0))}i>0&&(this.dMultiply(Math.pow(C,i)),this.dAddOffset(n,0)),e&&g.ZERO.subTo(this,this)},g.prototype.fromNumber=function(I,C,t){if("number"==typeof C)if(I<2)this.fromInt(1);else for(this.fromNumber(I,t),this.testBit(I-1)||this.bitwiseTo(g.ONE.shiftLeft(I-1),i,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(C);)this.dAddOffset(2,0),this.bitLength()>I&&this.subTo(g.ONE.shiftLeft(I-1),this);else{var A=[],e=7&I;A.length=1+(I>>3),C.nextBytes(A),e>0?A[0]&=(1<<e)-1:A[0]=0,this.fromString(A,256)}},g.prototype.bitwiseTo=function(g,I,C){var t,A,e=Math.min(g.t,this.t);for(t=0;t<e;++t)C[t]=I(this[t],g[t]);if(g.t<this.t){for(A=g.s&this.DM,t=e;t<this.t;++t)C[t]=I(this[t],A);C.t=this.t}else{for(A=this.s&this.DM,t=e;t<g.t;++t)C[t]=I(A,g[t]);C.t=g.t}C.s=I(this.s,g.s),C.clamp()},g.prototype.changeBit=function(I,C){var t=g.ONE.shiftLeft(I);return this.bitwiseTo(t,C,t),t},g.prototype.addTo=function(g,I){for(var C=0,t=0,A=Math.min(g.t,this.t);C<A;)t+=this[C]+g[C],I[C++]=t&this.DM,t>>=this.DB;if(g.t<this.t){for(t+=g.s;C<this.t;)t+=this[C],I[C++]=t&this.DM,t>>=this.DB;t+=this.s}else{for(t+=this.s;C<g.t;)t+=g[C],I[C++]=t&this.DM,t>>=this.DB;t+=g.s}I.s=t<0?-1:0,t>0?I[C++]=t:t<-1&&(I[C++]=this.DV+t),I.t=C,I.clamp()},g.prototype.dMultiply=function(g){this[this.t]=this.am(0,g-1,this,0,0,this.t),++this.t,this.clamp()},g.prototype.dAddOffset=function(g,I){if(0!=g){for(;this.t<=I;)this[this.t++]=0;for(this[I]+=g;this[I]>=this.DV;)this[I]-=this.DV,++I>=this.t&&(this[this.t++]=0),++this[I]}},g.prototype.multiplyLowerTo=function(g,I,C){var t=Math.min(this.t+g.t,I);for(C.s=0,C.t=t;t>0;)C[--t]=0;for(var A=C.t-this.t;t<A;++t)C[t+this.t]=this.am(0,g[t],C,t,0,this.t);for(A=Math.min(g.t,I);t<A;++t)this.am(0,g[t],C,t,0,I-t);C.clamp()},g.prototype.multiplyUpperTo=function(g,I,C){--I;var t=C.t=this.t+g.t-I;for(C.s=0;--t>=0;)C[t]=0;for(t=Math.max(I-this.t,0);t<g.t;++t)C[this.t+t-I]=this.am(I-t,g[t],C,0,0,this.t+t-I);C.clamp(),C.drShiftTo(1,C)},g.prototype.modInt=function(g){if(g<=0)return 0;var I=this.DV%g,C=this.s<0?g-1:0;if(this.t>0)if(0==I)C=this[0]%g;else for(var t=this.t-1;t>=0;--t)C=(I*C+this[t])%g;return C},g.prototype.millerRabin=function(I){var C=this.subtract(g.ONE),t=C.getLowestSetBit();if(t<=0)return!1;var A=C.shiftRight(t);(I=I+1>>1)>H.length&&(I=H.length);for(var e=Y(),i=0;i<I;++i){e.fromInt(H[Math.floor(Math.random()*H.length)]);var n=e.modPow(A,this);if(0!=n.compareTo(g.ONE)&&0!=n.compareTo(C)){for(var o=1;o++<t&&0!=n.compareTo(C);)if(0==(n=n.modPowInt(2,this)).compareTo(g.ONE))return!1;if(0!=n.compareTo(C))return!1}}return!0},g.prototype.square=function(){var g=Y();return this.squareTo(g),g},g.prototype.gcda=function(g,I){var C=this.s<0?this.negate():this.clone(),t=g.s<0?g.negate():g.clone();if(C.compareTo(t)<0){var A=C;C=t,t=A}var e=C.getLowestSetBit(),i=t.getLowestSetBit();if(i<0)I(C);else{e<i&&(i=e),i>0&&(C.rShiftTo(i,C),t.rShiftTo(i,t));setTimeout((function g(){(e=C.getLowestSetBit())>0&&C.rShiftTo(e,C),(e=t.getLowestSetBit())>0&&t.rShiftTo(e,t),C.compareTo(t)>=0?(C.subTo(t,C),C.rShiftTo(1,C)):(t.subTo(C,t),t.rShiftTo(1,t)),C.signum()>0?setTimeout(g,0):(i>0&&t.lShiftTo(i,t),setTimeout((function(){I(t)}),0))}),10)}},g.prototype.fromNumberAsync=function(I,C,t,A){if("number"==typeof C)if(I<2)this.fromInt(1);else{this.fromNumber(I,t),this.testBit(I-1)||this.bitwiseTo(g.ONE.shiftLeft(I-1),i,this),this.isEven()&&this.dAddOffset(1,0);var e=this;setTimeout((function t(){e.dAddOffset(2,0),e.bitLength()>I&&e.subTo(g.ONE.shiftLeft(I-1),e),e.isProbablePrime(C)?setTimeout((function(){A()}),0):setTimeout(t,0)}),0)}else{var n=[],o=7&I;n.length=1+(I>>3),C.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}},g}(),W=function(){function g(){}return g.prototype.convert=function(g){return g},g.prototype.revert=function(g){return g},g.prototype.mulTo=function(g,I,C){g.multiplyTo(I,C)},g.prototype.sqrTo=function(g,I){g.squareTo(I)},g}(),V=function(){function g(g){this.m=g}return g.prototype.convert=function(g){return g.s<0||g.compareTo(this.m)>=0?g.mod(this.m):g},g.prototype.revert=function(g){return g},g.prototype.reduce=function(g){g.divRemTo(this.m,null,g)},g.prototype.mulTo=function(g,I,C){g.multiplyTo(I,C),this.reduce(C)},g.prototype.sqrTo=function(g,I){g.squareTo(I),this.reduce(I)},g}(),X=function(){function g(g){this.m=g,this.mp=g.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<g.DB-15)-1,this.mt2=2*g.t}return g.prototype.convert=function(g){var I=Y();return g.abs().dlShiftTo(this.m.t,I),I.divRemTo(this.m,null,I),g.s<0&&I.compareTo(K.ZERO)>0&&this.m.subTo(I,I),I},g.prototype.revert=function(g){var I=Y();return g.copyTo(I),this.reduce(I),I},g.prototype.reduce=function(g){for(;g.t<=this.mt2;)g[g.t++]=0;for(var I=0;I<this.m.t;++I){var C=32767&g[I],t=C*this.mpl+((C*this.mph+(g[I]>>15)*this.mpl&this.um)<<15)&g.DM;for(g[C=I+this.m.t]+=this.m.am(0,t,g,I,0,this.m.t);g[C]>=g.DV;)g[C]-=g.DV,g[++C]++}g.clamp(),g.drShiftTo(this.m.t,g),g.compareTo(this.m)>=0&&g.subTo(this.m,g)},g.prototype.mulTo=function(g,I,C){g.multiplyTo(I,C),this.reduce(C)},g.prototype.sqrTo=function(g,I){g.squareTo(I),this.reduce(I)},g}(),L=function(){function g(g){this.m=g,this.r2=Y(),this.q3=Y(),K.ONE.dlShiftTo(2*g.t,this.r2),this.mu=this.r2.divide(g)}return g.prototype.convert=function(g){if(g.s<0||g.t>2*this.m.t)return g.mod(this.m);if(g.compareTo(this.m)<0)return g;var I=Y();return g.copyTo(I),this.reduce(I),I},g.prototype.revert=function(g){return g},g.prototype.reduce=function(g){for(g.drShiftTo(this.m.t-1,this.r2),g.t>this.m.t+1&&(g.t=this.m.t+1,g.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);g.compareTo(this.r2)<0;)g.dAddOffset(1,this.m.t+1);for(g.subTo(this.r2,g);g.compareTo(this.m)>=0;)g.subTo(this.m,g)},g.prototype.mulTo=function(g,I,C){g.multiplyTo(I,C),this.reduce(C)},g.prototype.sqrTo=function(g,I){g.squareTo(I),this.reduce(I)},g}();function Y(){return new K(null)}function v(g,I){return new K(g,I)}var R="undefined"!=typeof navigator;R&&"Microsoft Internet Explorer"==navigator.appName?(K.prototype.am=function(g,I,C,t,A,e){for(var i=32767&I,n=I>>15;--e>=0;){var o=32767&this[g],r=this[g++]>>15,s=n*o+r*i;A=((o=i*o+((32767&s)<<15)+C[t]+(1073741823&A))>>>30)+(s>>>15)+n*r+(A>>>30),C[t++]=1073741823&o}return A},p=30):R&&"Netscape"!=navigator.appName?(K.prototype.am=function(g,I,C,t,A,e){for(;--e>=0;){var i=I*this[g++]+C[t]+A;A=Math.floor(i/67108864),C[t++]=67108863&i}return A},p=26):(K.prototype.am=function(g,I,C,t,A,e){for(var i=16383&I,n=I>>14;--e>=0;){var o=16383&this[g],r=this[g++]>>14,s=n*o+r*i;A=((o=i*o+((16383&s)<<14)+C[t]+A)>>28)+(s>>14)+n*r,C[t++]=268435455&o}return A},p=28),K.prototype.DB=p,K.prototype.DM=(1<<p)-1,K.prototype.DV=1<<p;K.prototype.FV=Math.pow(2,52),K.prototype.F1=52-p,K.prototype.F2=2*p-52;var D,N,F=[];for(D="0".charCodeAt(0),N=0;N<=9;++N)F[D++]=N;for(D="a".charCodeAt(0),N=10;N<36;++N)F[D++]=N;for(D="A".charCodeAt(0),N=10;N<36;++N)F[D++]=N;function M(g,I){var C=F[g.charCodeAt(I)];return null==C?-1:C}function P(g){var I=Y();return I.fromInt(g),I}function z(g){var I,C=1;return 0!=(I=g>>>16)&&(g=I,C+=16),0!=(I=g>>8)&&(g=I,C+=8),0!=(I=g>>4)&&(g=I,C+=4),0!=(I=g>>2)&&(g=I,C+=2),0!=(I=g>>1)&&(g=I,C+=1),C}K.ZERO=P(0),K.ONE=P(1);var U=function(){function g(){this.i=0,this.j=0,this.S=[]}return g.prototype.init=function(g){var I,C,t;for(I=0;I<256;++I)this.S[I]=I;for(C=0,I=0;I<256;++I)C=C+this.S[I]+g[I%g.length]&255,t=this.S[I],this.S[I]=this.S[C],this.S[C]=t;this.i=0,this.j=0},g.prototype.next=function(){var g;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,g=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=g,this.S[g+this.S[this.i]&255]},g}();var T,x,E=null;if(null==E){E=[],x=0;var O=void 0;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var j=new Uint32Array(256);for(window.crypto.getRandomValues(j),O=0;O<j.length;++O)E[x++]=255&j[O]}var Q=0,_=function g(I){if((Q=Q||0)>=256||x>=256)window.removeEventListener?window.removeEventListener("mousemove",g,!1):window.detachEvent&&window.detachEvent("onmousemove",g);else try{var C=I.x+I.y;E[x++]=255&C,Q+=1}catch(g){}};"undefined"!=typeof window&&(window.addEventListener?window.addEventListener("mousemove",_,!1):window.attachEvent&&window.attachEvent("onmousemove",_))}function q(){if(null==T){for(T=new U;x<256;){var g=Math.floor(65536*Math.random());E[x++]=255&g}for(T.init(E),x=0;x<E.length;++x)E[x]=0;x=0}return T.next()}var $=function(){function g(){}return g.prototype.nextBytes=function(g){for(var I=0;I<g.length;++I)g[I]=q()},g}();var gg=function(){function g(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return g.prototype.doPublic=function(g){return g.modPowInt(this.e,this.n)},g.prototype.doPrivate=function(g){if(null==this.p||null==this.q)return g.modPow(this.d,this.n);for(var I=g.mod(this.p).modPow(this.dmp1,this.p),C=g.mod(this.q).modPow(this.dmq1,this.q);I.compareTo(C)<0;)I=I.add(this.p);return I.subtract(C).multiply(this.coeff).mod(this.p).multiply(this.q).add(C)},g.prototype.setPublic=function(g,I){null!=g&&null!=I&&g.length>0&&I.length>0?(this.n=v(g,16),this.e=parseInt(I,16)):console.error("Invalid RSA public key")},g.prototype.encrypt=function(g){var I=this.n.bitLength()+7>>3,C=function(g,I){if(I<g.length+11)return console.error("Message too long for RSA"),null;for(var C=[],t=g.length-1;t>=0&&I>0;){var A=g.charCodeAt(t--);A<128?C[--I]=A:A>127&&A<2048?(C[--I]=63&A|128,C[--I]=A>>6|192):(C[--I]=63&A|128,C[--I]=A>>6&63|128,C[--I]=A>>12|224)}C[--I]=0;for(var e=new $,i=[];I>2;){for(i[0]=0;0==i[0];)e.nextBytes(i);C[--I]=i[0]}return C[--I]=2,C[--I]=0,new K(C)}(g,I);if(null==C)return null;var t=this.doPublic(C);if(null==t)return null;for(var A=t.toString(16),e=A.length,i=0;i<2*I-e;i++)A="0"+A;return A},g.prototype.setPrivate=function(g,I,C){null!=g&&null!=I&&g.length>0&&I.length>0?(this.n=v(g,16),this.e=parseInt(I,16),this.d=v(C,16)):console.error("Invalid RSA private key")},g.prototype.setPrivateEx=function(g,I,C,t,A,e,i,n){null!=g&&null!=I&&g.length>0&&I.length>0?(this.n=v(g,16),this.e=parseInt(I,16),this.d=v(C,16),this.p=v(t,16),this.q=v(A,16),this.dmp1=v(e,16),this.dmq1=v(i,16),this.coeff=v(n,16)):console.error("Invalid RSA private key")},g.prototype.generate=function(g,I){var C=new $,t=g>>1;this.e=parseInt(I,16);for(var A=new K(I,16);;){for(;this.p=new K(g-t,1,C),0!=this.p.subtract(K.ONE).gcd(A).compareTo(K.ONE)||!this.p.isProbablePrime(10););for(;this.q=new K(t,1,C),0!=this.q.subtract(K.ONE).gcd(A).compareTo(K.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var e=this.p;this.p=this.q,this.q=e}var i=this.p.subtract(K.ONE),n=this.q.subtract(K.ONE),o=i.multiply(n);if(0==o.gcd(A).compareTo(K.ONE)){this.n=this.p.multiply(this.q),this.d=A.modInverse(o),this.dmp1=this.d.mod(i),this.dmq1=this.d.mod(n),this.coeff=this.q.modInverse(this.p);break}}},g.prototype.decrypt=function(g){var I=v(g,16),C=this.doPrivate(I);return null==C?null:function(g,I){var C=g.toByteArray(),t=0;for(;t<C.length&&0==C[t];)++t;if(C.length-t!=I-1||2!=C[t])return null;++t;for(;0!=C[t];)if(++t>=C.length)return null;var A="";for(;++t<C.length;){var e=255&C[t];e<128?A+=String.fromCharCode(e):e>191&&e<224?(A+=String.fromCharCode((31&e)<<6|63&C[t+1]),++t):(A+=String.fromCharCode((15&e)<<12|(63&C[t+1])<<6|63&C[t+2]),t+=2)}return A}(C,this.n.bitLength()+7>>3)},g.prototype.generateAsync=function(g,I,C){var t=new $,A=g>>1;this.e=parseInt(I,16);var e=new K(I,16),i=this;setTimeout((function I(){var n=function(){if(i.p.compareTo(i.q)<=0){var g=i.p;i.p=i.q,i.q=g}var t=i.p.subtract(K.ONE),A=i.q.subtract(K.ONE),n=t.multiply(A);0==n.gcd(e).compareTo(K.ONE)?(i.n=i.p.multiply(i.q),i.d=e.modInverse(n),i.dmp1=i.d.mod(t),i.dmq1=i.d.mod(A),i.coeff=i.q.modInverse(i.p),setTimeout((function(){C()}),0)):setTimeout(I,0)},o=function g(){i.q=Y(),i.q.fromNumberAsync(A,1,t,(function(){i.q.subtract(K.ONE).gcda(e,(function(I){0==I.compareTo(K.ONE)&&i.q.isProbablePrime(10)?setTimeout(n,0):setTimeout(g,0)}))}))};setTimeout((function I(){i.p=Y(),i.p.fromNumberAsync(g-A,1,t,(function(){i.p.subtract(K.ONE).gcda(e,(function(g){0==g.compareTo(K.ONE)&&i.p.isProbablePrime(10)?setTimeout(o,0):setTimeout(I,0)}))}))}),0)}),0)},g.prototype.sign=function(g,I,C){var t=function(g,I){if(I<g.length+22)return console.error("Message too long for RSA"),null;for(var C=I-g.length-6,t="",A=0;A<C;A+=2)t+="ff";return v("0001"+t+"00"+g,16)}((Ig[C]||"")+I(g).toString(),this.n.bitLength()/4);if(null==t)return null;var A=this.doPrivate(t);if(null==A)return null;var e=A.toString(16);return 0==(1&e.length)?e:"0"+e},g.prototype.verify=function(g,I,C){var t=v(I,16),A=this.doPublic(t);return null==A?null:function(g){for(var I in Ig)if(Ig.hasOwnProperty(I)){var C=Ig[I],t=C.length;if(g.substr(0,t)==C)return g.substr(t)}return g}(A.toString(16).replace(/^1f+00/,""))==C(g).toString()},g}();var Ig={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};
/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/
var Cg={};Cg.lang={extend:function(g,I,C){if(!I||!g)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var t=function(){};if(t.prototype=I.prototype,g.prototype=new t,g.prototype.constructor=g,g.superclass=I.prototype,I.prototype.constructor==Object.prototype.constructor&&(I.prototype.constructor=I),C){var A;for(A in C)g.prototype[A]=C[A];var e=function(){},i=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(e=function(g,I){for(A=0;A<i.length;A+=1){var C=i[A],t=I[C];"function"==typeof t&&t!=Object.prototype[C]&&(g[C]=t)}})}catch(g){}e(g.prototype,C)}}};
/**
 * @fileOverview
 * @name asn1-1.0.js
 * @author Kenji Urushima kenji.urushima@gmail.com
 * @version asn1 1.0.13 (2017-Jun-02)
 * @since jsrsasign 2.1
 * @license <a href="https://kjur.github.io/jsrsasign/license/">MIT License</a>
 */
var tg={};void 0!==tg.asn1&&tg.asn1||(tg.asn1={}),tg.asn1.ASN1Util=new function(){this.integerToByteHex=function(g){var I=g.toString(16);return I.length%2==1&&(I="0"+I),I},this.bigIntToMinTwosComplementsHex=function(g){var I=g.toString(16);if("-"!=I.substr(0,1))I.length%2==1?I="0"+I:I.match(/^[0-7]/)||(I="00"+I);else{var C=I.substr(1).length;C%2==1?C+=1:I.match(/^[0-7]/)||(C+=2);for(var t="",A=0;A<C;A++)t+="f";I=new K(t,16).xor(g).add(K.ONE).toString(16).replace(/^-/,"")}return I},this.getPEMStringFromHex=function(g,I){return hextopem(g,I)},this.newObject=function(g){var I=tg.asn1,C=I.DERBoolean,t=I.DERInteger,A=I.DERBitString,e=I.DEROctetString,i=I.DERNull,n=I.DERObjectIdentifier,o=I.DEREnumerated,r=I.DERUTF8String,s=I.DERNumericString,a=I.DERPrintableString,c=I.DERTeletexString,l=I.DERIA5String,u=I.DERUTCTime,d=I.DERGeneralizedTime,h=I.DERSequence,m=I.DERSet,S=I.DERTaggedObject,y=I.ASN1Util.newObject,b=Object.keys(g);if(1!=b.length)throw"key of param shall be only one.";var Z=b[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+Z+":"))throw"undefined key: "+Z;if("bool"==Z)return new C(g[Z]);if("int"==Z)return new t(g[Z]);if("bitstr"==Z)return new A(g[Z]);if("octstr"==Z)return new e(g[Z]);if("null"==Z)return new i(g[Z]);if("oid"==Z)return new n(g[Z]);if("enum"==Z)return new o(g[Z]);if("utf8str"==Z)return new r(g[Z]);if("numstr"==Z)return new s(g[Z]);if("prnstr"==Z)return new a(g[Z]);if("telstr"==Z)return new c(g[Z]);if("ia5str"==Z)return new l(g[Z]);if("utctime"==Z)return new u(g[Z]);if("gentime"==Z)return new d(g[Z]);if("seq"==Z){for(var B=g[Z],G=[],p=0;p<B.length;p++){var w=y(B[p]);G.push(w)}return new h({array:G})}if("set"==Z){for(B=g[Z],G=[],p=0;p<B.length;p++){w=y(B[p]);G.push(w)}return new m({array:G})}if("tag"==Z){var f=g[Z];if("[object Array]"===Object.prototype.toString.call(f)&&3==f.length){var k=y(f[2]);return new S({tag:f[0],explicit:f[1],obj:k})}var H={};if(void 0!==f.explicit&&(H.explicit=f.explicit),void 0!==f.tag&&(H.tag=f.tag),void 0===f.obj)throw"obj shall be specified for 'tag'.";return H.obj=y(f.obj),new S(H)}},this.jsonToASN1HEX=function(g){return this.newObject(g).getEncodedHex()}},tg.asn1.ASN1Util.oidHexToInt=function(g){for(var I="",C=parseInt(g.substr(0,2),16),t=(I=Math.floor(C/40)+"."+C%40,""),A=2;A<g.length;A+=2){var e=("00000000"+parseInt(g.substr(A,2),16).toString(2)).slice(-8);if(t+=e.substr(1,7),"0"==e.substr(0,1))I=I+"."+new K(t,2).toString(10),t=""}return I},tg.asn1.ASN1Util.oidIntToHex=function(g){var I=function(g){var I=g.toString(16);return 1==I.length&&(I="0"+I),I},C=function(g){var C="",t=new K(g,10).toString(2),A=7-t.length%7;7==A&&(A=0);for(var e="",i=0;i<A;i++)e+="0";t=e+t;for(i=0;i<t.length-1;i+=7){var n=t.substr(i,7);i!=t.length-7&&(n="1"+n),C+=I(parseInt(n,2))}return C};if(!g.match(/^[0-9.]+$/))throw"malformed oid string: "+g;var t="",A=g.split("."),e=40*parseInt(A[0])+parseInt(A[1]);t+=I(e),A.splice(0,2);for(var i=0;i<A.length;i++)t+=C(A[i]);return t},tg.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n=0,v="+this.hV;var g=this.hV.length/2,I=g.toString(16);if(I.length%2==1&&(I="0"+I),g<128)return I;var C=I.length/2;if(C>15)throw"ASN.1 length too long to represent by 8x: n = "+g.toString(16);return(128+C).toString(16)+I},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},tg.asn1.DERAbstractString=function(g){tg.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(g){this.hTLV=null,this.isModified=!0,this.s=g,this.hV=stohex(this.s)},this.setStringHex=function(g){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=g},this.getFreshValueHex=function(){return this.hV},void 0!==g&&("string"==typeof g?this.setString(g):void 0!==g.str?this.setString(g.str):void 0!==g.hex&&this.setStringHex(g.hex))},Cg.lang.extend(tg.asn1.DERAbstractString,tg.asn1.ASN1Object),tg.asn1.DERAbstractTime=function(g){tg.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(g){return utc=g.getTime()+6e4*g.getTimezoneOffset(),new Date(utc)},this.formatDate=function(g,I,C){var t=this.zeroPadding,A=this.localDateToUTC(g),e=String(A.getFullYear());"utc"==I&&(e=e.substr(2,2));var i=e+t(String(A.getMonth()+1),2)+t(String(A.getDate()),2)+t(String(A.getHours()),2)+t(String(A.getMinutes()),2)+t(String(A.getSeconds()),2);if(!0===C){var n=A.getMilliseconds();if(0!=n){var o=t(String(n),3);i=i+"."+(o=o.replace(/[0]+$/,""))}}return i+"Z"},this.zeroPadding=function(g,I){return g.length>=I?g:new Array(I-g.length+1).join("0")+g},this.getString=function(){return this.s},this.setString=function(g){this.hTLV=null,this.isModified=!0,this.s=g,this.hV=stohex(g)},this.setByDateValue=function(g,I,C,t,A,e){var i=new Date(Date.UTC(g,I-1,C,t,A,e,0));this.setByDate(i)},this.getFreshValueHex=function(){return this.hV}},Cg.lang.extend(tg.asn1.DERAbstractTime,tg.asn1.ASN1Object),tg.asn1.DERAbstractStructured=function(g){tg.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(g){this.hTLV=null,this.isModified=!0,this.asn1Array=g},this.appendASN1Object=function(g){this.hTLV=null,this.isModified=!0,this.asn1Array.push(g)},this.asn1Array=new Array,void 0!==g&&void 0!==g.array&&(this.asn1Array=g.array)},Cg.lang.extend(tg.asn1.DERAbstractStructured,tg.asn1.ASN1Object),tg.asn1.DERBoolean=function(){tg.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},Cg.lang.extend(tg.asn1.DERBoolean,tg.asn1.ASN1Object),tg.asn1.DERInteger=function(g){tg.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(g){this.hTLV=null,this.isModified=!0,this.hV=tg.asn1.ASN1Util.bigIntToMinTwosComplementsHex(g)},this.setByInteger=function(g){var I=new K(String(g),10);this.setByBigInteger(I)},this.setValueHex=function(g){this.hV=g},this.getFreshValueHex=function(){return this.hV},void 0!==g&&(void 0!==g.bigint?this.setByBigInteger(g.bigint):void 0!==g.int?this.setByInteger(g.int):"number"==typeof g?this.setByInteger(g):void 0!==g.hex&&this.setValueHex(g.hex))},Cg.lang.extend(tg.asn1.DERInteger,tg.asn1.ASN1Object),tg.asn1.DERBitString=function(g){if(void 0!==g&&void 0!==g.obj){var I=tg.asn1.ASN1Util.newObject(g.obj);g.hex="00"+I.getEncodedHex()}tg.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(g){this.hTLV=null,this.isModified=!0,this.hV=g},this.setUnusedBitsAndHexValue=function(g,I){if(g<0||7<g)throw"unused bits shall be from 0 to 7: u = "+g;var C="0"+g;this.hTLV=null,this.isModified=!0,this.hV=C+I},this.setByBinaryString=function(g){var I=8-(g=g.replace(/0+$/,"")).length%8;8==I&&(I=0);for(var C=0;C<=I;C++)g+="0";var t="";for(C=0;C<g.length-1;C+=8){var A=g.substr(C,8),e=parseInt(A,2).toString(16);1==e.length&&(e="0"+e),t+=e}this.hTLV=null,this.isModified=!0,this.hV="0"+I+t},this.setByBooleanArray=function(g){for(var I="",C=0;C<g.length;C++)1==g[C]?I+="1":I+="0";this.setByBinaryString(I)},this.newFalseArray=function(g){for(var I=new Array(g),C=0;C<g;C++)I[C]=!1;return I},this.getFreshValueHex=function(){return this.hV},void 0!==g&&("string"==typeof g&&g.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(g):void 0!==g.hex?this.setHexValueIncludingUnusedBits(g.hex):void 0!==g.bin?this.setByBinaryString(g.bin):void 0!==g.array&&this.setByBooleanArray(g.array))},Cg.lang.extend(tg.asn1.DERBitString,tg.asn1.ASN1Object),tg.asn1.DEROctetString=function(g){if(void 0!==g&&void 0!==g.obj){var I=tg.asn1.ASN1Util.newObject(g.obj);g.hex=I.getEncodedHex()}tg.asn1.DEROctetString.superclass.constructor.call(this,g),this.hT="04"},Cg.lang.extend(tg.asn1.DEROctetString,tg.asn1.DERAbstractString),tg.asn1.DERNull=function(){tg.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Cg.lang.extend(tg.asn1.DERNull,tg.asn1.ASN1Object),tg.asn1.DERObjectIdentifier=function(g){var I=function(g){var I=g.toString(16);return 1==I.length&&(I="0"+I),I},C=function(g){var C="",t=new K(g,10).toString(2),A=7-t.length%7;7==A&&(A=0);for(var e="",i=0;i<A;i++)e+="0";t=e+t;for(i=0;i<t.length-1;i+=7){var n=t.substr(i,7);i!=t.length-7&&(n="1"+n),C+=I(parseInt(n,2))}return C};tg.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(g){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=g},this.setValueOidString=function(g){if(!g.match(/^[0-9.]+$/))throw"malformed oid string: "+g;var t="",A=g.split("."),e=40*parseInt(A[0])+parseInt(A[1]);t+=I(e),A.splice(0,2);for(var i=0;i<A.length;i++)t+=C(A[i]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(g){var I=tg.asn1.x509.OID.name2oid(g);if(""===I)throw"DERObjectIdentifier oidName undefined: "+g;this.setValueOidString(I)},this.getFreshValueHex=function(){return this.hV},void 0!==g&&("string"==typeof g?g.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(g):this.setValueName(g):void 0!==g.oid?this.setValueOidString(g.oid):void 0!==g.hex?this.setValueHex(g.hex):void 0!==g.name&&this.setValueName(g.name))},Cg.lang.extend(tg.asn1.DERObjectIdentifier,tg.asn1.ASN1Object),tg.asn1.DEREnumerated=function(g){tg.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(g){this.hTLV=null,this.isModified=!0,this.hV=tg.asn1.ASN1Util.bigIntToMinTwosComplementsHex(g)},this.setByInteger=function(g){var I=new K(String(g),10);this.setByBigInteger(I)},this.setValueHex=function(g){this.hV=g},this.getFreshValueHex=function(){return this.hV},void 0!==g&&(void 0!==g.int?this.setByInteger(g.int):"number"==typeof g?this.setByInteger(g):void 0!==g.hex&&this.setValueHex(g.hex))},Cg.lang.extend(tg.asn1.DEREnumerated,tg.asn1.ASN1Object),tg.asn1.DERUTF8String=function(g){tg.asn1.DERUTF8String.superclass.constructor.call(this,g),this.hT="0c"},Cg.lang.extend(tg.asn1.DERUTF8String,tg.asn1.DERAbstractString),tg.asn1.DERNumericString=function(g){tg.asn1.DERNumericString.superclass.constructor.call(this,g),this.hT="12"},Cg.lang.extend(tg.asn1.DERNumericString,tg.asn1.DERAbstractString),tg.asn1.DERPrintableString=function(g){tg.asn1.DERPrintableString.superclass.constructor.call(this,g),this.hT="13"},Cg.lang.extend(tg.asn1.DERPrintableString,tg.asn1.DERAbstractString),tg.asn1.DERTeletexString=function(g){tg.asn1.DERTeletexString.superclass.constructor.call(this,g),this.hT="14"},Cg.lang.extend(tg.asn1.DERTeletexString,tg.asn1.DERAbstractString),tg.asn1.DERIA5String=function(g){tg.asn1.DERIA5String.superclass.constructor.call(this,g),this.hT="16"},Cg.lang.extend(tg.asn1.DERIA5String,tg.asn1.DERAbstractString),tg.asn1.DERUTCTime=function(g){tg.asn1.DERUTCTime.superclass.constructor.call(this,g),this.hT="17",this.setByDate=function(g){this.hTLV=null,this.isModified=!0,this.date=g,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==g&&(void 0!==g.str?this.setString(g.str):"string"==typeof g&&g.match(/^[0-9]{12}Z$/)?this.setString(g):void 0!==g.hex?this.setStringHex(g.hex):void 0!==g.date&&this.setByDate(g.date))},Cg.lang.extend(tg.asn1.DERUTCTime,tg.asn1.DERAbstractTime),tg.asn1.DERGeneralizedTime=function(g){tg.asn1.DERGeneralizedTime.superclass.constructor.call(this,g),this.hT="18",this.withMillis=!1,this.setByDate=function(g){this.hTLV=null,this.isModified=!0,this.date=g,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==g&&(void 0!==g.str?this.setString(g.str):"string"==typeof g&&g.match(/^[0-9]{14}Z$/)?this.setString(g):void 0!==g.hex?this.setStringHex(g.hex):void 0!==g.date&&this.setByDate(g.date),!0===g.millis&&(this.withMillis=!0))},Cg.lang.extend(tg.asn1.DERGeneralizedTime,tg.asn1.DERAbstractTime),tg.asn1.DERSequence=function(g){tg.asn1.DERSequence.superclass.constructor.call(this,g),this.hT="30",this.getFreshValueHex=function(){for(var g="",I=0;I<this.asn1Array.length;I++){g+=this.asn1Array[I].getEncodedHex()}return this.hV=g,this.hV}},Cg.lang.extend(tg.asn1.DERSequence,tg.asn1.DERAbstractStructured),tg.asn1.DERSet=function(g){tg.asn1.DERSet.superclass.constructor.call(this,g),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var g=new Array,I=0;I<this.asn1Array.length;I++){var C=this.asn1Array[I];g.push(C.getEncodedHex())}return 1==this.sortFlag&&g.sort(),this.hV=g.join(""),this.hV},void 0!==g&&void 0!==g.sortflag&&0==g.sortflag&&(this.sortFlag=!1)},Cg.lang.extend(tg.asn1.DERSet,tg.asn1.DERAbstractStructured),tg.asn1.DERTaggedObject=function(g){tg.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(g,I,C){this.hT=I,this.isExplicit=g,this.asn1Object=C,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=C.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,I),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==g&&(void 0!==g.tag&&(this.hT=g.tag),void 0!==g.explicit&&(this.isExplicit=g.explicit),void 0!==g.obj&&(this.asn1Object=g.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},Cg.lang.extend(tg.asn1.DERTaggedObject,tg.asn1.ASN1Object);var Ag,eg,ig=(Ag=function(g,I){return Ag=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,I){g.__proto__=I}||function(g,I){for(var C in I)Object.prototype.hasOwnProperty.call(I,C)&&(g[C]=I[C])},Ag(g,I)},function(g,I){if("function"!=typeof I&&null!==I)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function C(){this.constructor=g}Ag(g,I),g.prototype=null===I?Object.create(I):(C.prototype=I.prototype,new C)}),ng=function(g){function I(C){var t=g.call(this)||this;return C&&("string"==typeof C?t.parseKey(C):(I.hasPrivateKeyProperty(C)||I.hasPublicKeyProperty(C))&&t.parsePropertiesFrom(C)),t}return ig(I,g),I.prototype.parseKey=function(g){try{var I=0,C=0,t=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(g)?m(g):S.unarmor(g),A=f.decode(t);if(3===A.sub.length&&(A=A.sub[2].sub[0]),9===A.sub.length){I=A.sub[1].getHexStringValue(),this.n=v(I,16),C=A.sub[2].getHexStringValue(),this.e=parseInt(C,16);var e=A.sub[3].getHexStringValue();this.d=v(e,16);var i=A.sub[4].getHexStringValue();this.p=v(i,16);var n=A.sub[5].getHexStringValue();this.q=v(n,16);var o=A.sub[6].getHexStringValue();this.dmp1=v(o,16);var r=A.sub[7].getHexStringValue();this.dmq1=v(r,16);var s=A.sub[8].getHexStringValue();this.coeff=v(s,16)}else{if(2!==A.sub.length)return!1;if(A.sub[0].sub){var a=A.sub[1].sub[0];I=a.sub[0].getHexStringValue(),this.n=v(I,16),C=a.sub[1].getHexStringValue(),this.e=parseInt(C,16)}else I=A.sub[0].getHexStringValue(),this.n=v(I,16),C=A.sub[1].getHexStringValue(),this.e=parseInt(C,16)}return!0}catch(g){return!1}},I.prototype.getPrivateBaseKey=function(){var g={array:[new tg.asn1.DERInteger({int:0}),new tg.asn1.DERInteger({bigint:this.n}),new tg.asn1.DERInteger({int:this.e}),new tg.asn1.DERInteger({bigint:this.d}),new tg.asn1.DERInteger({bigint:this.p}),new tg.asn1.DERInteger({bigint:this.q}),new tg.asn1.DERInteger({bigint:this.dmp1}),new tg.asn1.DERInteger({bigint:this.dmq1}),new tg.asn1.DERInteger({bigint:this.coeff})]};return new tg.asn1.DERSequence(g).getEncodedHex()},I.prototype.getPrivateBaseKeyB64=function(){return u(this.getPrivateBaseKey())},I.prototype.getPublicBaseKey=function(){var g=new tg.asn1.DERSequence({array:[new tg.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new tg.asn1.DERNull]}),I=new tg.asn1.DERSequence({array:[new tg.asn1.DERInteger({bigint:this.n}),new tg.asn1.DERInteger({int:this.e})]}),C=new tg.asn1.DERBitString({hex:"00"+I.getEncodedHex()});return new tg.asn1.DERSequence({array:[g,C]}).getEncodedHex()},I.prototype.getPublicBaseKeyB64=function(){return u(this.getPublicBaseKey())},I.wordwrap=function(g,I){if(!g)return g;var C="(.{1,"+(I=I||64)+"})( +|$\n?)|(.{1,"+I+"})";return g.match(RegExp(C,"g")).join("\n")},I.prototype.getPrivateKey=function(){var g="-----BEGIN RSA PRIVATE KEY-----\n";return g+=I.wordwrap(this.getPrivateBaseKeyB64())+"\n",g+="-----END RSA PRIVATE KEY-----"},I.prototype.getPublicKey=function(){var g="-----BEGIN PUBLIC KEY-----\n";return g+=I.wordwrap(this.getPublicBaseKeyB64())+"\n",g+="-----END PUBLIC KEY-----"},I.hasPublicKeyProperty=function(g){return(g=g||{}).hasOwnProperty("n")&&g.hasOwnProperty("e")},I.hasPrivateKeyProperty=function(g){return(g=g||{}).hasOwnProperty("n")&&g.hasOwnProperty("e")&&g.hasOwnProperty("d")&&g.hasOwnProperty("p")&&g.hasOwnProperty("q")&&g.hasOwnProperty("dmp1")&&g.hasOwnProperty("dmq1")&&g.hasOwnProperty("coeff")},I.prototype.parsePropertiesFrom=function(g){this.n=g.n,this.e=g.e,g.hasOwnProperty("d")&&(this.d=g.d,this.p=g.p,this.q=g.q,this.dmp1=g.dmp1,this.dmq1=g.dmq1,this.coeff=g.coeff)},I}(gg),og="undefined"!=typeof process?null===(eg={NODE_ENV:"production",PUBLIC_URL:"https://mat1.gtimg.com/qqcdn/qqindex2021/common-static/pc-home/20241226122229"})||void 0===eg?void 0:eg.npm_package_version:void 0,rg=function(){function g(g){void 0===g&&(g={}),g=g||{},this.default_key_size=g.default_key_size?parseInt(g.default_key_size,10):1024,this.default_public_exponent=g.default_public_exponent||"010001",this.log=g.log||!1,this.key=null}return g.prototype.setKey=function(g){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new ng(g)},g.prototype.setPrivateKey=function(g){this.setKey(g)},g.prototype.setPublicKey=function(g){this.setKey(g)},g.prototype.decrypt=function(g){try{return this.getKey().decrypt(d(g))}catch(g){return!1}},g.prototype.encrypt=function(g){try{return u(this.getKey().encrypt(g))}catch(g){return!1}},g.prototype.sign=function(g,I,C){try{return u(this.getKey().sign(g,I,C))}catch(g){return!1}},g.prototype.verify=function(g,I,C){try{return this.getKey().verify(g,d(I),C)}catch(g){return!1}},g.prototype.getKey=function(g){if(!this.key){if(this.key=new ng,g&&"[object Function]"==={}.toString.call(g))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,g);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},g.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},g.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},g.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},g.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},g.version=og,g}(),sg=["O","K","K","D","K","l","C","P","D","i","m","s","j","m","k","I",";","y","2","D","C","S","G","H","C","C","Q","E","C","S",":","C","O","K","K","D","E","i","M","E","C","S","G","C","5","p","H","[","E","D","3","h",":","M","\\",";","x","o","6","Q","n","5","g","|","e","N","S","P","R","v","3","C","y","r","O","r","J","k","\\","Z","f","[","2","8","u","|",";","h","M","r","i","c","T","[","{","G","I","D","R","W","{","E","6","p","o","Z","o","T","X","g","-","5","O","I","[","T","[","4","v","T","L","5","7","S","V",":","g","R","2","c","X","D","w","y","F","P","d","Y","R","t","d","D","P","R","K","z","p","e","6","1","m","m","t","\\","v","x","7","c","I","|",";","m","y","4","H","V","l","\\","W","V","5","L","l","1","9","R","U","I","T","t","O","G","v","O",":","k","W","s","U","O","y","c","7","v","U","K","M","8","G","u","m","G","v","z","Q","i","r","S","V","s","P","V","w","V","U","[","W","r","S","p","g","w","1","7","F","K","j","-","c","p","h","H","9","J","Q","L",":","N","E","v","n","N","2","g","h","P","r","E","P","I","j",":","9","r","{","\\","j","z","|","7","n","2","v","o","m","6","x","d","t","X","R","\\","g","3",":","5","j","5","{","H","P","u","d","3",";","Y","r","-","V","o","V","5","U","e","6","8","X","r","\\",";","L","F","N","i","S","O","O","r","8","V","v",":","r","C","2","T","2","Z","w","h","s","G","j","u","v","W","z","7","d",";","5","z","i","m","n","T","f","i","{","s","F","C","k","Y","E","N","v","N","z","\\","L","x","Z","D","H","G","K","4","G","O","3","9","z","Y","n","o","I","q","T","U","V","[","L","4","M","T","1","X","L","x","[","w","x","y","k","S","K","F","C","S","C","D"],ag=["333","uy","zvr","56"];function cg(g){return function(g){if(Array.isArray(g))return lg(g)}(g)||function(g){if("undefined"!=typeof Symbol&&null!=g[Symbol.iterator]||null!=g["@@iterator"])return Array.from(g)}(g)||function(g,I){if(!g)return;if("string"==typeof g)return lg(g,I);var C=Object.prototype.toString.call(g).slice(8,-1);"Object"===C&&g.constructor&&(C=g.constructor.name);if("Map"===C||"Set"===C)return Array.from(g);if("Arguments"===C||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return lg(g,I)}(g)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lg(g,I){(null==I||I>g.length)&&(I=g.length);for(var C=0,t=new Array(I);C<I;C++)t[C]=g[C];return t}var ug=function(g){if(!(g>=0&&Number.isFinite(g)))throw new TypeError("Expected a `length` to be a non-negative finite number");var I,C=function(g){for(var I=new Uint8Array(g),C=0;C<g;C+=65536)I.set(crypto.getRandomValues(new Uint8Array(Math.min(65536,g-C))),C);return I}(Math.ceil(.5*g));return(I=C,cg(I).map((function(g){return g.toString(16).padStart(2,"0")})).join("")).slice(0,g)};function dg(g,I){return function(g){if(Array.isArray(g))return g}(g)||function(g,I){var C=null==g?null:"undefined"!=typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=C){var t,A,e,i,n=[],o=!0,r=!1;try{if(e=(C=C.call(g)).next,0===I){if(Object(C)!==C)return;o=!1}else for(;!(o=(t=e.call(C)).done)&&(n.push(t.value),n.length!==I);o=!0);}catch(g){r=!0,A=g}finally{try{if(!o&&null!=C.return&&(i=C.return(),Object(i)!==i))return}finally{if(r)throw A}}return n}}(g,I)||function(g,I){if(!g)return;if("string"==typeof g)return hg(g,I);var C=Object.prototype.toString.call(g).slice(8,-1);"Object"===C&&g.constructor&&(C=g.constructor.name);if("Map"===C||"Set"===C)return Array.from(g);if("Arguments"===C||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return hg(g,I)}(g,I)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hg(g,I){(null==I||I>g.length)&&(I=g.length);for(var C=0,t=new Array(I);C<I;C++)t[C]=g[C];return t}function mg(g,I){switch(I){case"IE":var C=/\brv[ :]+(\d+)/g.exec(g)||[];return Number(C[1])||null;case"Edge":var t=g.match(/\b(Edge)\/(\d+)/);return Number(null==t?void 0:t[2])||null}var A=function(g){var I;switch(g){case"Opera":I="OPR";break;case"UC Browser":I="UCBrowser";break;case"Samsung Internet":I="SamsungBrowser"}return I}(I);if(A)return function(g,I){var C,t="".concat(g,"/"),A=I.indexOf(t),e=I.substring(A+t.length),i=e.indexOf(" ");i>0&&(e=e.substring(0,i)),C=e.indexOf(".",2)>0?e.indexOf(".",2):e.indexOf(".",1);var n=e.substring(0,C);return Number(n)}(A,g);var e=g.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];e=e[2]?[e[1],e[2]]:[e[1],"Unknown","-?"];var i=g.match(/version\/(\d+)/i);if(null!=i&&i[1]){var n=dg(i,2)[1];e.splice(1,1,n)}return Number(e[1])}var Sg=function(g){var I=function(g){return function(g){return g.includes("Chrome")&&!g.includes("Chromium")&&!g.includes("OPR")&&!g.includes("Edge")&&!g.includes("SamsungBrowser")}(g)?"Chrome":function(g){return g.includes("Safari")&&!g.includes("Chrome")&&!g.includes("Chromium")&&!g.includes("Android")}(g)?"Safari":function(g){return g.includes("UCBrowser")}(g)?"UC Browser":function(g){return g.includes("Firefox")&&!g.includes("Seamonkey")}(g)?"Firefox":function(g){return/trident/i.test(g)}(g)?"IE":function(g){return g.includes("OPR")}(g)?"Opera":function(g){return g.includes("SamsungBrowser")}(g)?"Samsung Internet":function(g){return g.includes("Android")&&!g.includes("Chrome")&&g.includes("AppleWebKit")}(g)?"Android Browser":function(g){return g.includes("Edge")&&g.includes("Chrome")}(g)?"Edge":"Unknown"}(g);return{name:I,version:mg(g,I)}};function yg(g){return yg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},yg(g)}function bg(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */bg=function(){return I};var g,I={},C=Object.prototype,t=C.hasOwnProperty,A=Object.defineProperty||function(g,I,C){g[I]=C.value},e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function r(g,I,C){return Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}),g[I]}try{r({},"")}catch(g){r=function(g,I,C){return g[I]=C}}function s(g,I,C,t){var e=I&&I.prototype instanceof m?I:m,i=Object.create(e.prototype),n=new K(t||[]);return A(i,"_invoke",{value:f(g,C,n)}),i}function a(g,I,C){try{return{type:"normal",arg:g.call(I,C)}}catch(g){return{type:"throw",arg:g}}}I.wrap=s;var c="suspendedStart",l="suspendedYield",u="executing",d="completed",h={};function m(){}function S(){}function y(){}var b={};r(b,i,(function(){return this}));var Z=Object.getPrototypeOf,B=Z&&Z(Z(W([])));B&&B!==C&&t.call(B,i)&&(b=B);var G=y.prototype=m.prototype=Object.create(b);function p(g){["next","throw","return"].forEach((function(I){r(g,I,(function(g){return this._invoke(I,g)}))}))}function w(g,I){function C(A,e,i,n){var o=a(g[A],g,e);if("throw"!==o.type){var r=o.arg,s=r.value;return s&&"object"==yg(s)&&t.call(s,"__await")?I.resolve(s.__await).then((function(g){C("next",g,i,n)}),(function(g){C("throw",g,i,n)})):I.resolve(s).then((function(g){r.value=g,i(r)}),(function(g){return C("throw",g,i,n)}))}n(o.arg)}var e;A(this,"_invoke",{value:function(g,t){function A(){return new I((function(I,A){C(g,t,I,A)}))}return e=e?e.then(A,A):A()}})}function f(I,C,t){var A=c;return function(e,i){if(A===u)throw new Error("Generator is already running");if(A===d){if("throw"===e)throw i;return{value:g,done:!0}}for(t.method=e,t.arg=i;;){var n=t.delegate;if(n){var o=k(n,t);if(o){if(o===h)continue;return o}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(A===c)throw A=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);A=u;var r=a(I,C,t);if("normal"===r.type){if(A=t.done?d:l,r.arg===h)continue;return{value:r.arg,done:t.done}}"throw"===r.type&&(A=d,t.method="throw",t.arg=r.arg)}}}function k(I,C){var t=C.method,A=I.iterator[t];if(A===g)return C.delegate=null,"throw"===t&&I.iterator.return&&(C.method="return",C.arg=g,k(I,C),"throw"===C.method)||"return"!==t&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+t+"' method")),h;var e=a(A,I.iterator,C.arg);if("throw"===e.type)return C.method="throw",C.arg=e.arg,C.delegate=null,h;var i=e.arg;return i?i.done?(C[I.resultName]=i.value,C.next=I.nextLoc,"return"!==C.method&&(C.method="next",C.arg=g),C.delegate=null,h):i:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,h)}function H(g){var I={tryLoc:g[0]};1 in g&&(I.catchLoc=g[1]),2 in g&&(I.finallyLoc=g[2],I.afterLoc=g[3]),this.tryEntries.push(I)}function J(g){var I=g.completion||{};I.type="normal",delete I.arg,g.completion=I}function K(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(H,this),this.reset(!0)}function W(I){if(I||""===I){var C=I[i];if(C)return C.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var A=-1,e=function C(){for(;++A<I.length;)if(t.call(I,A))return C.value=I[A],C.done=!1,C;return C.value=g,C.done=!0,C};return e.next=e}}throw new TypeError(yg(I)+" is not iterable")}return S.prototype=y,A(G,"constructor",{value:y,configurable:!0}),A(y,"constructor",{value:S,configurable:!0}),S.displayName=r(y,o,"GeneratorFunction"),I.isGeneratorFunction=function(g){var I="function"==typeof g&&g.constructor;return!!I&&(I===S||"GeneratorFunction"===(I.displayName||I.name))},I.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,r(g,o,"GeneratorFunction")),g.prototype=Object.create(G),g},I.awrap=function(g){return{__await:g}},p(w.prototype),r(w.prototype,n,(function(){return this})),I.AsyncIterator=w,I.async=function(g,C,t,A,e){void 0===e&&(e=Promise);var i=new w(s(g,C,t,A),e);return I.isGeneratorFunction(C)?i:i.next().then((function(g){return g.done?g.value:i.next()}))},p(G),r(G,o,"Generator"),r(G,i,(function(){return this})),r(G,"toString",(function(){return"[object Generator]"})),I.keys=function(g){var I=Object(g),C=[];for(var t in I)C.push(t);return C.reverse(),function g(){for(;C.length;){var t=C.pop();if(t in I)return g.value=t,g.done=!1,g}return g.done=!0,g}},I.values=W,K.prototype={constructor:K,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(J),!I)for(var C in this)"t"===C.charAt(0)&&t.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=g)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var C=this;function A(t,A){return n.type="throw",n.arg=I,C.next=t,A&&(C.method="next",C.arg=g),!!A}for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],n=i.completion;if("root"===i.tryLoc)return A("end");if(i.tryLoc<=this.prev){var o=t.call(i,"catchLoc"),r=t.call(i,"finallyLoc");if(o&&r){if(this.prev<i.catchLoc)return A(i.catchLoc,!0);if(this.prev<i.finallyLoc)return A(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return A(i.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return A(i.finallyLoc)}}}},abrupt:function(g,I){for(var C=this.tryEntries.length-1;C>=0;--C){var A=this.tryEntries[C];if(A.tryLoc<=this.prev&&t.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var e=A;break}}e&&("break"===g||"continue"===g)&&e.tryLoc<=I&&I<=e.finallyLoc&&(e=null);var i=e?e.completion:{};return i.type=g,i.arg=I,e?(this.method="next",this.next=e.finallyLoc,h):this.complete(i)},complete:function(g,I){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&I&&(this.next=I),h},finish:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.finallyLoc===g)return this.complete(C.completion,C.afterLoc),J(C),h}},catch:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.tryLoc===g){var t=C.completion;if("throw"===t.type){var A=t.arg;J(C)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(I,C,t){return this.delegate={iterator:W(I),resultName:C,nextLoc:t},"next"===this.method&&(this.arg=g),h}},I}function Zg(g,I){var C=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);I&&(t=t.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),C.push.apply(C,t)}return C}function Bg(g){for(var I=1;I<arguments.length;I++){var C=null!=arguments[I]?arguments[I]:{};I%2?Zg(Object(C),!0).forEach((function(I){Gg(g,I,C[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(C)):Zg(Object(C)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(C,I))}))}return g}function Gg(g,I,C){return(I=function(g){var I=function(g,I){if("object"!==yg(g)||null===g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var t=C.call(g,I||"default");if("object"!==yg(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"===yg(I)?I:String(I)}(I))in g?Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):g[I]=C,g}function pg(g,I,C,t,A,e,i){try{var n=g[e](i),o=n.value}catch(g){return void C(g)}n.done?I(o):Promise.resolve(o).then(t,A)}function wg(g){return function(){var I=this,C=arguments;return new Promise((function(t,A){var e=g.apply(I,C);function i(g){pg(e,t,A,i,n,"next",g)}function n(g){pg(e,t,A,i,n,"throw",g)}i(void 0)}))}}var fg=function(){return"".concat(ug(22),"_").concat(Date.parse((new Date).toString())/1e3)},kg=function(g,I){var C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",t=arguments.length>3?arguments[3]:void 0,A=arguments.length>4?arguments[4]:void 0;return new Promise((function(e,i){var n=new XMLHttpRequest;n.open(g,I),"dcl"===t&&(n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("X-Tone-RequestId",fg()),n.setRequestHeader("Source","api")),"cos"===t&&(n.setRequestHeader("x-cos-acl",A.acl),n.setRequestHeader("x-cos-storage-class",A.storageClass),n.setRequestHeader("x-cos-traffic-limit",A.trafficLimit),n.setRequestHeader("Content-MD5",A.contentMd5),n.setRequestHeader("Content-Type",C.type)),n.onload=function(){if(this.status>=200&&this.status<300)try{e("cos"===t?this.status:JSON.parse(n.response))}catch(g){i("xhr解析异常-".concat(I,"-").concat(g))}else i("xhr请求异常-".concat(n.statusText))},n.onerror=function(){i("xhr请求异常-".concat(n.statusText))},n.send(C)}))},Hg=function(){var g=wg(bg().mark((function g(I){var C,t,A,e,i,n,o,r,s=arguments;return bg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(t=s.length>3?s[3]:void 0,A=s.length>4?s[4]:void 0,e="",i=s.length>1&&void 0!==s[1]?s[1]:"",n={method:C=s.length>2&&void 0!==s[2]?s[2]:"POST",headers:{"Content-Type":"application/json"}},"dcl"===I&&(n.headers={"X-Tone-RequestId":fg(),Source:"api","Content-Type":"application/json"}),t&&(e=JSON.stringify(t),n=Bg(Bg({},n),{},{body:e})),"GET"===C&&A&&(o=new URLSearchParams(A),i="".concat(i,"&").concat(o)),!window.fetch){g.next=21;break}return g.prev=11,g.next=14,fetch(i,n);case 14:return r=g.sent,g.abrupt("return",r.json());case 18:throw g.prev=18,g.t0=g.catch(11),new TypeError("fetch请求异常-".concat(i,"-").concat(g.t0));case 21:return g.abrupt("return",kg(C,i,e,I));case 22:case"end":return g.stop()}}),g,null,[[11,18]])})));return function(I){return g.apply(this,arguments)}}(),Jg=function(){var g=wg(bg().mark((function g(I){var C,t,A;return bg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return"https://v.qq.com/cache/wuji/object?appid=news_h5&schemaid=test_logger_whitelist&schemakey=636de98414b44a73b82564acc5bb3da4",g.prev=1,g.next=4,Hg("wuji","https://v.qq.com/cache/wuji/object?appid=news_h5&schemaid=test_logger_whitelist&schemakey=636de98414b44a73b82564acc5bb3da4","GET");case 4:if(C=g.sent,!(t=null==C?void 0:C.data).length){g.next=9;break}return A=t.find((function(g){return g.user===I})),g.abrupt("return",!!A);case 9:return g.abrupt("return",!1);case 12:return g.prev=12,g.t0=g.catch(1),g.abrupt("return",!1);case 15:case"end":return g.stop()}}),g,null,[[1,12]])})));return function(I){return g.apply(this,arguments)}}(),Kg=function(g,I){if("string"!=typeof g||!g)return"";for(var C="",t=0;t<g.length;t++)C+=String.fromCharCode(g.charCodeAt(t)+2*I);return C},Wg=function(g){var I=g.user,C=g.fid,t=g.customField,A=g.dclConfig,e=void 0===A?{}:A,i=e.appId,n=e.serviceId,o=e.publicKey,r={showTitle:Kg(ag.join(""),-1),enTitle:Kg(sg.join(""),-1)},s=r.showTitle,a=r.enTitle,c=Date.now(),l=new rg,u="";i&&o?(l.setPublicKey(o),u=i):(l.setPublicKey(a),u=s);var d,h,m,S,y,b="userid=".concat(I,"&t=").concat(c,"&net=").concat((y=(null===(h=navigator)||void 0===h?void 0:h.connection)||(null===(m=navigator)||void 0===m?void 0:m.mozConnection)||(null===(S=navigator)||void 0===S?void 0:S.webkitConnection),(null==y?void 0:y.type)||(null==y?void 0:y.effectiveType)||""),"&os=").concat(function(){var g,I=null===(g=navigator)||void 0===g?void 0:g.userAgent;try{var C=Sg(I);return"".concat(C.name,":").concat(C.version)}catch(g){return""}}(),"&hardware=").concat((null===(d=navigator)||void 0===d||null===(d=d.userAgentData)||void 0===d?void 0:d.platform)||"");C&&(b="".concat(b,"&fid=").concat(C));var Z=l.encrypt(b),B="appId=".concat(u,"&serviceId=").concat(n,"&data=").concat(Z);return t&&(B="".concat(B,"&customField=").concat(t)),B},Vg=function(){var g=wg(bg().mark((function g(I){var C,t,A,e,i,n,o,r,s;return bg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C=I.apiName,t=I.fid,A=I.user,e=I.method,i=I.data,n=I.params,o=I.dclConfig,"https://api.dcl.qq.com/",r=Wg({user:A,fid:t,dclConfig:o}),s="".concat("https://api.dcl.qq.com/").concat(C,"?").concat(r),g.abrupt("return",Hg("dcl",s,e,i,n));case 5:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),Xg=function(){var g=wg(bg().mark((function g(I,C){var t,A,e;return bg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(t=C.url,A={method:"PUT",headers:{"x-cos-acl":C.acl,"x-cos-storage-class":C.storageClass,"x-cos-traffic-limit":C.trafficLimit,"Content-MD5":C.contentMd5,"Content-Type":I.type},body:I},!window.fetch){g.next=13;break}return g.prev=3,g.next=6,fetch(t,A);case 6:return e=g.sent,g.abrupt("return",(null==e?void 0:e.status)||0);case 10:throw g.prev=10,g.t0=g.catch(3),new TypeError("fetch上传Cos失败-".concat(g.t0));case 13:return g.abrupt("return",kg("PUT",t,I,"cos",C));case 14:case"end":return g.stop()}}),g,null,[[3,10]])})));return function(I,C){return g.apply(this,arguments)}}()},"../../node_modules/.pnpm/@tencent+qn-logger@1.0.0/node_modules/@tencent/qn-logger/es/log/index.js":
/*!**********************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@tencent+qn-logger@1.0.0/node_modules/@tencent/qn-logger/es/log/index.js + 12 modules ***!
  \**********************************************************************************************************************/function(g,I,C){"use strict";function t(g){return"[object Function]"==={}.toString.call(g)}function A(g,I){var C="undefined"!=typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(!C){if(Array.isArray(g)||(C=function(g,I){if(!g)return;if("string"==typeof g)return e(g,I);var C=Object.prototype.toString.call(g).slice(8,-1);"Object"===C&&g.constructor&&(C=g.constructor.name);if("Map"===C||"Set"===C)return Array.from(g);if("Arguments"===C||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return e(g,I)}(g))||I&&g&&"number"==typeof g.length){C&&(g=C);var t=0,A=function(){};return{s:A,n:function(){return t>=g.length?{done:!0}:{done:!1,value:g[t++]}},e:function(g){throw g},f:A}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n=!0,o=!1;return{s:function(){C=C.call(g)},n:function(){var g=C.next();return n=g.done,g},e:function(g){o=!0,i=g},f:function(){try{n||null==C.return||C.return()}finally{if(o)throw i}}}}function e(g,I){(null==I||I>g.length)&&(I=g.length);for(var C=0,t=new Array(I);C<I;C++)t[C]=g[C];return t}function i(g){var I,C={},t=A(g.split("&"));try{for(t.s();!(I=t.n()).done;){var e=I.value,i=e.indexOf("=");C[e.slice(0,i)]=decodeURIComponent(e.slice(i+1))}}catch(g){t.e(g)}finally{t.f()}return C}function n(g,I){var C,t=i(null===(C=(I||window.location.search).replace(/^\?/,""))||void 0===C?void 0:C.split("#")[0]);return t[g]?Array.isArray(t[g])?t[g][t[g].length-1]:t[g]:""}C.d(I,{Z:function(){return Kg}});var o,r,s="fe.log",a=function(g,I){return I.some((function(I){return g instanceof I}))};var c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap;var m={get:function(g,I,C){if(g instanceof IDBTransaction){if("done"===I)return l.get(g);if("objectStoreNames"===I)return g.objectStoreNames||u.get(g);if("store"===I)return C.objectStoreNames[1]?void 0:C.objectStore(C.objectStoreNames[0])}return b(g[I])},set:function(g,I,C){return g[I]=C,!0},has:function(g,I){return g instanceof IDBTransaction&&("done"===I||"store"===I)||I in g}};function S(g){return g!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(g)?function(){for(var I=arguments.length,C=new Array(I),t=0;t<I;t++)C[t]=arguments[t];return g.apply(Z(this),C),b(c.get(this))}:function(){for(var I=arguments.length,C=new Array(I),t=0;t<I;t++)C[t]=arguments[t];return b(g.apply(Z(this),C))}:function(I){for(var C=arguments.length,t=new Array(C>1?C-1:0),A=1;A<C;A++)t[A-1]=arguments[A];var e=g.call.apply(g,[Z(this),I].concat(t));return u.set(e,I.sort?I.sort():[I]),b(e)}}function y(g){return"function"==typeof g?S(g):(g instanceof IDBTransaction&&function(g){if(!l.has(g)){var I=new Promise((function(I,C){var t=function(){g.removeEventListener("complete",A),g.removeEventListener("error",e),g.removeEventListener("abort",e)},A=function(){I(),t()},e=function(){C(g.error||new DOMException("AbortError","AbortError")),t()};g.addEventListener("complete",A),g.addEventListener("error",e),g.addEventListener("abort",e)}));l.set(g,I)}}(g),a(g,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(g,m):g)}function b(g){if(g instanceof IDBRequest)return I=g,(C=new Promise((function(g,C){var t=function(){I.removeEventListener("success",A),I.removeEventListener("error",e)},A=function(){g(b(I.result)),t()},e=function(){C(I.error),t()};I.addEventListener("success",A),I.addEventListener("error",e)}))).then((function(g){g instanceof IDBCursor&&c.set(g,I)})).catch((function(){})),h.set(C,I),C;var I,C;if(d.has(g))return d.get(g);var t=y(g);return t!==g&&(d.set(g,t),h.set(t,g)),t}var Z=function(g){return h.get(g)};function B(g){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},B(g)}function G(g,I){var C=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);I&&(t=t.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),C.push.apply(C,t)}return C}function p(g){for(var I=1;I<arguments.length;I++){var C=null!=arguments[I]?arguments[I]:{};I%2?G(Object(C),!0).forEach((function(I){w(g,I,C[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(C)):G(Object(C)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(C,I))}))}return g}function w(g,I,C){return(I=function(g){var I=function(g,I){if("object"!==B(g)||null===g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var t=C.call(g,I||"default");if("object"!==B(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"===B(I)?I:String(I)}(I))in g?Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):g[I]=C,g}function f(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */f=function(){return I};var g,I={},C=Object.prototype,t=C.hasOwnProperty,A=Object.defineProperty||function(g,I,C){g[I]=C.value},e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function r(g,I,C){return Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}),g[I]}try{r({},"")}catch(g){r=function(g,I,C){return g[I]=C}}function s(g,I,C,t){var e=I&&I.prototype instanceof m?I:m,i=Object.create(e.prototype),n=new V(t||[]);return A(i,"_invoke",{value:H(g,C,n)}),i}function a(g,I,C){try{return{type:"normal",arg:g.call(I,C)}}catch(g){return{type:"throw",arg:g}}}I.wrap=s;var c="suspendedStart",l="suspendedYield",u="executing",d="completed",h={};function m(){}function S(){}function y(){}var b={};r(b,i,(function(){return this}));var Z=Object.getPrototypeOf,G=Z&&Z(Z(X([])));G&&G!==C&&t.call(G,i)&&(b=G);var p=y.prototype=m.prototype=Object.create(b);function w(g){["next","throw","return"].forEach((function(I){r(g,I,(function(g){return this._invoke(I,g)}))}))}function k(g,I){function C(A,e,i,n){var o=a(g[A],g,e);if("throw"!==o.type){var r=o.arg,s=r.value;return s&&"object"==B(s)&&t.call(s,"__await")?I.resolve(s.__await).then((function(g){C("next",g,i,n)}),(function(g){C("throw",g,i,n)})):I.resolve(s).then((function(g){r.value=g,i(r)}),(function(g){return C("throw",g,i,n)}))}n(o.arg)}var e;A(this,"_invoke",{value:function(g,t){function A(){return new I((function(I,A){C(g,t,I,A)}))}return e=e?e.then(A,A):A()}})}function H(I,C,t){var A=c;return function(e,i){if(A===u)throw new Error("Generator is already running");if(A===d){if("throw"===e)throw i;return{value:g,done:!0}}for(t.method=e,t.arg=i;;){var n=t.delegate;if(n){var o=J(n,t);if(o){if(o===h)continue;return o}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(A===c)throw A=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);A=u;var r=a(I,C,t);if("normal"===r.type){if(A=t.done?d:l,r.arg===h)continue;return{value:r.arg,done:t.done}}"throw"===r.type&&(A=d,t.method="throw",t.arg=r.arg)}}}function J(I,C){var t=C.method,A=I.iterator[t];if(A===g)return C.delegate=null,"throw"===t&&I.iterator.return&&(C.method="return",C.arg=g,J(I,C),"throw"===C.method)||"return"!==t&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+t+"' method")),h;var e=a(A,I.iterator,C.arg);if("throw"===e.type)return C.method="throw",C.arg=e.arg,C.delegate=null,h;var i=e.arg;return i?i.done?(C[I.resultName]=i.value,C.next=I.nextLoc,"return"!==C.method&&(C.method="next",C.arg=g),C.delegate=null,h):i:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,h)}function K(g){var I={tryLoc:g[0]};1 in g&&(I.catchLoc=g[1]),2 in g&&(I.finallyLoc=g[2],I.afterLoc=g[3]),this.tryEntries.push(I)}function W(g){var I=g.completion||{};I.type="normal",delete I.arg,g.completion=I}function V(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(K,this),this.reset(!0)}function X(I){if(I||""===I){var C=I[i];if(C)return C.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var A=-1,e=function C(){for(;++A<I.length;)if(t.call(I,A))return C.value=I[A],C.done=!1,C;return C.value=g,C.done=!0,C};return e.next=e}}throw new TypeError(B(I)+" is not iterable")}return S.prototype=y,A(p,"constructor",{value:y,configurable:!0}),A(y,"constructor",{value:S,configurable:!0}),S.displayName=r(y,o,"GeneratorFunction"),I.isGeneratorFunction=function(g){var I="function"==typeof g&&g.constructor;return!!I&&(I===S||"GeneratorFunction"===(I.displayName||I.name))},I.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,r(g,o,"GeneratorFunction")),g.prototype=Object.create(p),g},I.awrap=function(g){return{__await:g}},w(k.prototype),r(k.prototype,n,(function(){return this})),I.AsyncIterator=k,I.async=function(g,C,t,A,e){void 0===e&&(e=Promise);var i=new k(s(g,C,t,A),e);return I.isGeneratorFunction(C)?i:i.next().then((function(g){return g.done?g.value:i.next()}))},w(p),r(p,o,"Generator"),r(p,i,(function(){return this})),r(p,"toString",(function(){return"[object Generator]"})),I.keys=function(g){var I=Object(g),C=[];for(var t in I)C.push(t);return C.reverse(),function g(){for(;C.length;){var t=C.pop();if(t in I)return g.value=t,g.done=!1,g}return g.done=!0,g}},I.values=X,V.prototype={constructor:V,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(W),!I)for(var C in this)"t"===C.charAt(0)&&t.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=g)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var C=this;function A(t,A){return n.type="throw",n.arg=I,C.next=t,A&&(C.method="next",C.arg=g),!!A}for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],n=i.completion;if("root"===i.tryLoc)return A("end");if(i.tryLoc<=this.prev){var o=t.call(i,"catchLoc"),r=t.call(i,"finallyLoc");if(o&&r){if(this.prev<i.catchLoc)return A(i.catchLoc,!0);if(this.prev<i.finallyLoc)return A(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return A(i.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return A(i.finallyLoc)}}}},abrupt:function(g,I){for(var C=this.tryEntries.length-1;C>=0;--C){var A=this.tryEntries[C];if(A.tryLoc<=this.prev&&t.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var e=A;break}}e&&("break"===g||"continue"===g)&&e.tryLoc<=I&&I<=e.finallyLoc&&(e=null);var i=e?e.completion:{};return i.type=g,i.arg=I,e?(this.method="next",this.next=e.finallyLoc,h):this.complete(i)},complete:function(g,I){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&I&&(this.next=I),h},finish:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.finallyLoc===g)return this.complete(C.completion,C.afterLoc),W(C),h}},catch:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.tryLoc===g){var t=C.completion;if("throw"===t.type){var A=t.arg;W(C)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(I,C,t){return this.delegate={iterator:X(I),resultName:C,nextLoc:t},"next"===this.method&&(this.arg=g),h}},I}function k(g,I,C,t,A,e,i){try{var n=g[e](i),o=n.value}catch(g){return void C(g)}n.done?I(o):Promise.resolve(o).then(t,A)}function H(g,I){var C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=C.blocked,A=C.upgrade,e=C.blocking,i=C.terminated,n=indexedDB.open(g,I),o=b(n);return A&&n.addEventListener("upgradeneeded",(function(g){A(b(n.result),g.oldVersion,g.newVersion,b(n.transaction),g)})),t&&n.addEventListener("blocked",(function(g){return t(g.oldVersion,g.newVersion,g)})),o.then((function(g){i&&g.addEventListener("close",(function(){return i()})),e&&g.addEventListener("versionchange",(function(g){return e(g.oldVersion,g.newVersion,g)}))})).catch((function(){})),o}function J(g){var I=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).blocked,C=indexedDB.deleteDatabase(g);return I&&C.addEventListener("blocked",(function(g){return I(g.oldVersion,g)})),b(C).then((function(){}))}var K=["get","getKey","getAll","getAllKeys","count"],W=["put","add","delete","clear"],V=new Map;function X(g,I){if(g instanceof IDBDatabase&&!(I in g)&&"string"==typeof I){if(V.get(I))return V.get(I);var C=I.replace(/FromIndex$/,""),t=I!==C,A=W.includes(C);if(C in(t?IDBIndex:IDBObjectStore).prototype&&(A||K.includes(C))){var e=function(){var g,I=(g=f().mark((function g(I){var e,i,n,o,r,s,a=arguments;return f().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:for(i=this.transaction(I,A?"readwrite":"readonly"),n=i.store,o=a.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=a[s];return t&&(n=n.index(r.shift())),g.next=6,Promise.all([(e=n)[C].apply(e,r),A&&i.done]);case 6:return g.abrupt("return",g.sent[0]);case 7:case"end":return g.stop()}}),g,this)})),function(){var I=this,C=arguments;return new Promise((function(t,A){var e=g.apply(I,C);function i(g){k(e,t,A,i,n,"next",g)}function n(g){k(e,t,A,i,n,"throw",g)}i(void 0)}))});return function(g){return I.apply(this,arguments)}}();return V.set(I,e),e}}}m=function(g){return p(p({},g),{},{get:function(I,C,t){return X(I,C)||g.get(I,C,t)},has:function(I,C){return!!X(I,C)||g.has(I,C)}})}(m);var L="log-info",Y="qnc-offline-log-".concat(1);function v(g){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},v(g)}function R(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */R=function(){return I};var g,I={},C=Object.prototype,t=C.hasOwnProperty,A=Object.defineProperty||function(g,I,C){g[I]=C.value},e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function r(g,I,C){return Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}),g[I]}try{r({},"")}catch(g){r=function(g,I,C){return g[I]=C}}function s(g,I,C,t){var e=I&&I.prototype instanceof m?I:m,i=Object.create(e.prototype),n=new K(t||[]);return A(i,"_invoke",{value:f(g,C,n)}),i}function a(g,I,C){try{return{type:"normal",arg:g.call(I,C)}}catch(g){return{type:"throw",arg:g}}}I.wrap=s;var c="suspendedStart",l="suspendedYield",u="executing",d="completed",h={};function m(){}function S(){}function y(){}var b={};r(b,i,(function(){return this}));var Z=Object.getPrototypeOf,B=Z&&Z(Z(W([])));B&&B!==C&&t.call(B,i)&&(b=B);var G=y.prototype=m.prototype=Object.create(b);function p(g){["next","throw","return"].forEach((function(I){r(g,I,(function(g){return this._invoke(I,g)}))}))}function w(g,I){function C(A,e,i,n){var o=a(g[A],g,e);if("throw"!==o.type){var r=o.arg,s=r.value;return s&&"object"==v(s)&&t.call(s,"__await")?I.resolve(s.__await).then((function(g){C("next",g,i,n)}),(function(g){C("throw",g,i,n)})):I.resolve(s).then((function(g){r.value=g,i(r)}),(function(g){return C("throw",g,i,n)}))}n(o.arg)}var e;A(this,"_invoke",{value:function(g,t){function A(){return new I((function(I,A){C(g,t,I,A)}))}return e=e?e.then(A,A):A()}})}function f(I,C,t){var A=c;return function(e,i){if(A===u)throw new Error("Generator is already running");if(A===d){if("throw"===e)throw i;return{value:g,done:!0}}for(t.method=e,t.arg=i;;){var n=t.delegate;if(n){var o=k(n,t);if(o){if(o===h)continue;return o}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(A===c)throw A=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);A=u;var r=a(I,C,t);if("normal"===r.type){if(A=t.done?d:l,r.arg===h)continue;return{value:r.arg,done:t.done}}"throw"===r.type&&(A=d,t.method="throw",t.arg=r.arg)}}}function k(I,C){var t=C.method,A=I.iterator[t];if(A===g)return C.delegate=null,"throw"===t&&I.iterator.return&&(C.method="return",C.arg=g,k(I,C),"throw"===C.method)||"return"!==t&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+t+"' method")),h;var e=a(A,I.iterator,C.arg);if("throw"===e.type)return C.method="throw",C.arg=e.arg,C.delegate=null,h;var i=e.arg;return i?i.done?(C[I.resultName]=i.value,C.next=I.nextLoc,"return"!==C.method&&(C.method="next",C.arg=g),C.delegate=null,h):i:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,h)}function H(g){var I={tryLoc:g[0]};1 in g&&(I.catchLoc=g[1]),2 in g&&(I.finallyLoc=g[2],I.afterLoc=g[3]),this.tryEntries.push(I)}function J(g){var I=g.completion||{};I.type="normal",delete I.arg,g.completion=I}function K(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(H,this),this.reset(!0)}function W(I){if(I||""===I){var C=I[i];if(C)return C.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var A=-1,e=function C(){for(;++A<I.length;)if(t.call(I,A))return C.value=I[A],C.done=!1,C;return C.value=g,C.done=!0,C};return e.next=e}}throw new TypeError(v(I)+" is not iterable")}return S.prototype=y,A(G,"constructor",{value:y,configurable:!0}),A(y,"constructor",{value:S,configurable:!0}),S.displayName=r(y,o,"GeneratorFunction"),I.isGeneratorFunction=function(g){var I="function"==typeof g&&g.constructor;return!!I&&(I===S||"GeneratorFunction"===(I.displayName||I.name))},I.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,r(g,o,"GeneratorFunction")),g.prototype=Object.create(G),g},I.awrap=function(g){return{__await:g}},p(w.prototype),r(w.prototype,n,(function(){return this})),I.AsyncIterator=w,I.async=function(g,C,t,A,e){void 0===e&&(e=Promise);var i=new w(s(g,C,t,A),e);return I.isGeneratorFunction(C)?i:i.next().then((function(g){return g.done?g.value:i.next()}))},p(G),r(G,o,"Generator"),r(G,i,(function(){return this})),r(G,"toString",(function(){return"[object Generator]"})),I.keys=function(g){var I=Object(g),C=[];for(var t in I)C.push(t);return C.reverse(),function g(){for(;C.length;){var t=C.pop();if(t in I)return g.value=t,g.done=!1,g}return g.done=!0,g}},I.values=W,K.prototype={constructor:K,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(J),!I)for(var C in this)"t"===C.charAt(0)&&t.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=g)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var C=this;function A(t,A){return n.type="throw",n.arg=I,C.next=t,A&&(C.method="next",C.arg=g),!!A}for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],n=i.completion;if("root"===i.tryLoc)return A("end");if(i.tryLoc<=this.prev){var o=t.call(i,"catchLoc"),r=t.call(i,"finallyLoc");if(o&&r){if(this.prev<i.catchLoc)return A(i.catchLoc,!0);if(this.prev<i.finallyLoc)return A(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return A(i.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return A(i.finallyLoc)}}}},abrupt:function(g,I){for(var C=this.tryEntries.length-1;C>=0;--C){var A=this.tryEntries[C];if(A.tryLoc<=this.prev&&t.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var e=A;break}}e&&("break"===g||"continue"===g)&&e.tryLoc<=I&&I<=e.finallyLoc&&(e=null);var i=e?e.completion:{};return i.type=g,i.arg=I,e?(this.method="next",this.next=e.finallyLoc,h):this.complete(i)},complete:function(g,I){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&I&&(this.next=I),h},finish:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.finallyLoc===g)return this.complete(C.completion,C.afterLoc),J(C),h}},catch:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.tryLoc===g){var t=C.completion;if("throw"===t.type){var A=t.arg;J(C)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(I,C,t){return this.delegate={iterator:W(I),resultName:C,nextLoc:t},"next"===this.method&&(this.arg=g),h}},I}function D(g,I,C,t,A,e,i){try{var n=g[e](i),o=n.value}catch(g){return void C(g)}n.done?I(o):Promise.resolve(o).then(t,A)}function N(g){return function(){var I=this,C=arguments;return new Promise((function(t,A){var e=g.apply(I,C);function i(g){D(e,t,A,i,n,"next",g)}function n(g){D(e,t,A,i,n,"throw",g)}i(void 0)}))}}function F(g,I){for(var C=0;C<I.length;C++){var t=I[C];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,(A=t.key,e=void 0,e=function(g,I){if("object"!==v(g)||null===g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var t=C.call(g,I||"default");if("object"!==v(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(A,"string"),"symbol"===v(e)?e:String(e)),t)}var A,e}var M=function(){function g(){!function(g,I){if(!(g instanceof I))throw new TypeError("Cannot call a class as a function")}(this,g)}var I,C,t,A,e,i,n,o;return I=g,C=[{key:"isSupported",value:function(){var g;return!(null===(g=window)||void 0===g||!g.indexedDB)}},{key:"initDB",value:(o=N(R().mark((function g(I,C){return R().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,H(I,C,{upgrade:function(g){g.createObjectStore(L,{keyPath:"time"}).createIndex("time","time")}});case 2:this.db=g.sent;case 3:case"end":return g.stop()}}),g,this)}))),function(g,I){return o.apply(this,arguments)})},{key:"getAllLogs",value:(n=N(R().mark((function g(){return R().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",this.db.getAllFromIndex(L,"time"));case 1:case"end":return g.stop()}}),g,this)}))),function(){return n.apply(this,arguments)})},{key:"storeLog",value:(i=N(R().mark((function g(I){return R().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this.db.put(L,I);case 3:g.next=9;break;case 5:return g.prev=5,g.t0=g.catch(0),g.next=9,J(Y);case 9:case"end":return g.stop()}}),g,this,[[0,5]])}))),function(g){return i.apply(this,arguments)})},{key:"removeExpiredLog",value:(e=N(R().mark((function g(){var I,C,t;return R().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.db.transaction(L,"readwrite").store.openCursor();case 2:I=g.sent;case 3:if(!I){g.next=14;break}if(C=Date.now(),t=I.value.time,!(C-t>6048e5)){g.next=9;break}return g.next=9,I.delete();case 9:return g.next=11,I.continue();case 11:I=g.sent,g.next=3;break;case 14:case"end":return g.stop()}}),g,this)}))),function(){return e.apply(this,arguments)})},{key:"clearDBWhenOverflow",value:(A=N(R().mark((function g(){var I,C,t,A,e,i;return R().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(null!==(I=navigator)&&void 0!==I&&null!==(I=I.storage)&&void 0!==I&&I.estimate){g.next=2;break}return g.abrupt("return");case 2:return g.prev=2,C=10485760,t=20971520,g.next=7,navigator.storage.estimate();case 7:if(A=g.sent,e=A.quota-A.usage,i=A.usage,!(e<=t||i>=C)){g.next=15;break}return g.next=13,this.db.transaction(L,"readwrite").store;case 13:g.sent.clear();case 15:g.next=21;break;case 17:return g.prev=17,g.t0=g.catch(2),g.next=21,J(Y);case 21:case"end":return g.stop()}}),g,this,[[2,17]])}))),function(){return A.apply(this,arguments)})}],C&&F(I.prototype,C),t&&F(I,t),Object.defineProperty(I,"prototype",{writable:!1}),g}();function P(g){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},P(g)}function z(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */z=function(){return I};var g,I={},C=Object.prototype,t=C.hasOwnProperty,A=Object.defineProperty||function(g,I,C){g[I]=C.value},e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function r(g,I,C){return Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}),g[I]}try{r({},"")}catch(g){r=function(g,I,C){return g[I]=C}}function s(g,I,C,t){var e=I&&I.prototype instanceof m?I:m,i=Object.create(e.prototype),n=new K(t||[]);return A(i,"_invoke",{value:f(g,C,n)}),i}function a(g,I,C){try{return{type:"normal",arg:g.call(I,C)}}catch(g){return{type:"throw",arg:g}}}I.wrap=s;var c="suspendedStart",l="suspendedYield",u="executing",d="completed",h={};function m(){}function S(){}function y(){}var b={};r(b,i,(function(){return this}));var Z=Object.getPrototypeOf,B=Z&&Z(Z(W([])));B&&B!==C&&t.call(B,i)&&(b=B);var G=y.prototype=m.prototype=Object.create(b);function p(g){["next","throw","return"].forEach((function(I){r(g,I,(function(g){return this._invoke(I,g)}))}))}function w(g,I){function C(A,e,i,n){var o=a(g[A],g,e);if("throw"!==o.type){var r=o.arg,s=r.value;return s&&"object"==P(s)&&t.call(s,"__await")?I.resolve(s.__await).then((function(g){C("next",g,i,n)}),(function(g){C("throw",g,i,n)})):I.resolve(s).then((function(g){r.value=g,i(r)}),(function(g){return C("throw",g,i,n)}))}n(o.arg)}var e;A(this,"_invoke",{value:function(g,t){function A(){return new I((function(I,A){C(g,t,I,A)}))}return e=e?e.then(A,A):A()}})}function f(I,C,t){var A=c;return function(e,i){if(A===u)throw new Error("Generator is already running");if(A===d){if("throw"===e)throw i;return{value:g,done:!0}}for(t.method=e,t.arg=i;;){var n=t.delegate;if(n){var o=k(n,t);if(o){if(o===h)continue;return o}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(A===c)throw A=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);A=u;var r=a(I,C,t);if("normal"===r.type){if(A=t.done?d:l,r.arg===h)continue;return{value:r.arg,done:t.done}}"throw"===r.type&&(A=d,t.method="throw",t.arg=r.arg)}}}function k(I,C){var t=C.method,A=I.iterator[t];if(A===g)return C.delegate=null,"throw"===t&&I.iterator.return&&(C.method="return",C.arg=g,k(I,C),"throw"===C.method)||"return"!==t&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+t+"' method")),h;var e=a(A,I.iterator,C.arg);if("throw"===e.type)return C.method="throw",C.arg=e.arg,C.delegate=null,h;var i=e.arg;return i?i.done?(C[I.resultName]=i.value,C.next=I.nextLoc,"return"!==C.method&&(C.method="next",C.arg=g),C.delegate=null,h):i:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,h)}function H(g){var I={tryLoc:g[0]};1 in g&&(I.catchLoc=g[1]),2 in g&&(I.finallyLoc=g[2],I.afterLoc=g[3]),this.tryEntries.push(I)}function J(g){var I=g.completion||{};I.type="normal",delete I.arg,g.completion=I}function K(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(H,this),this.reset(!0)}function W(I){if(I||""===I){var C=I[i];if(C)return C.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var A=-1,e=function C(){for(;++A<I.length;)if(t.call(I,A))return C.value=I[A],C.done=!1,C;return C.value=g,C.done=!0,C};return e.next=e}}throw new TypeError(P(I)+" is not iterable")}return S.prototype=y,A(G,"constructor",{value:y,configurable:!0}),A(y,"constructor",{value:S,configurable:!0}),S.displayName=r(y,o,"GeneratorFunction"),I.isGeneratorFunction=function(g){var I="function"==typeof g&&g.constructor;return!!I&&(I===S||"GeneratorFunction"===(I.displayName||I.name))},I.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,r(g,o,"GeneratorFunction")),g.prototype=Object.create(G),g},I.awrap=function(g){return{__await:g}},p(w.prototype),r(w.prototype,n,(function(){return this})),I.AsyncIterator=w,I.async=function(g,C,t,A,e){void 0===e&&(e=Promise);var i=new w(s(g,C,t,A),e);return I.isGeneratorFunction(C)?i:i.next().then((function(g){return g.done?g.value:i.next()}))},p(G),r(G,o,"Generator"),r(G,i,(function(){return this})),r(G,"toString",(function(){return"[object Generator]"})),I.keys=function(g){var I=Object(g),C=[];for(var t in I)C.push(t);return C.reverse(),function g(){for(;C.length;){var t=C.pop();if(t in I)return g.value=t,g.done=!1,g}return g.done=!0,g}},I.values=W,K.prototype={constructor:K,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(J),!I)for(var C in this)"t"===C.charAt(0)&&t.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=g)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var C=this;function A(t,A){return n.type="throw",n.arg=I,C.next=t,A&&(C.method="next",C.arg=g),!!A}for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],n=i.completion;if("root"===i.tryLoc)return A("end");if(i.tryLoc<=this.prev){var o=t.call(i,"catchLoc"),r=t.call(i,"finallyLoc");if(o&&r){if(this.prev<i.catchLoc)return A(i.catchLoc,!0);if(this.prev<i.finallyLoc)return A(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return A(i.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return A(i.finallyLoc)}}}},abrupt:function(g,I){for(var C=this.tryEntries.length-1;C>=0;--C){var A=this.tryEntries[C];if(A.tryLoc<=this.prev&&t.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var e=A;break}}e&&("break"===g||"continue"===g)&&e.tryLoc<=I&&I<=e.finallyLoc&&(e=null);var i=e?e.completion:{};return i.type=g,i.arg=I,e?(this.method="next",this.next=e.finallyLoc,h):this.complete(i)},complete:function(g,I){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&I&&(this.next=I),h},finish:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.finallyLoc===g)return this.complete(C.completion,C.afterLoc),J(C),h}},catch:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.tryLoc===g){var t=C.completion;if("throw"===t.type){var A=t.arg;J(C)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(I,C,t){return this.delegate={iterator:W(I),resultName:C,nextLoc:t},"next"===this.method&&(this.arg=g),h}},I}function U(g,I,C,t,A,e,i){try{var n=g[e](i),o=n.value}catch(g){return void C(g)}n.done?I(o):Promise.resolve(o).then(t,A)}function T(g){return function(){var I=this,C=arguments;return new Promise((function(t,A){var e=g.apply(I,C);function i(g){U(e,t,A,i,n,"next",g)}function n(g){U(e,t,A,i,n,"throw",g)}i(void 0)}))}}function x(g,I){for(var C=0;C<I.length;C++){var t=I[C];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,(A=t.key,e=void 0,e=function(g,I){if("object"!==P(g)||null===g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var t=C.call(g,I||"default");if("object"!==P(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(A,"string"),"symbol"===P(e)?e:String(e)),t)}var A,e}var E=function(){function g(){!function(g,I){if(!(g instanceof I))throw new TypeError("Cannot call a class as a function")}(this,g),this.catch=g.createCache(),this.promiseInitDB=this.initDB()}var I,C,t,A,e,i;return I=g,C=[{key:"storeOfflineLog",value:(i=T(z().mark((function I(C){return z().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return this.catch&&this.catch.logs.length>=1e3&&(this.catch=g.createCache()),I.next=3,this.promiseInitDB;case 3:I.prev=3,this.catch.logs.push(C),this.db.storeLog(this.catch),I.next=11;break;case 8:throw I.prev=8,I.t0=I.catch(3),new Error("indexedDB store log failed");case 11:case"end":return I.stop()}}),I,this,[[3,8]])}))),function(g){return i.apply(this,arguments)})},{key:"getAllLogs",value:(e=T(z().mark((function g(){return z().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this.db.getAllLogs();case 3:return g.abrupt("return",g.sent);case 6:return g.prev=6,g.t0=g.catch(0),g.abrupt("return","");case 9:case"end":return g.stop()}}),g,this,[[0,6]])}))),function(){return e.apply(this,arguments)})},{key:"initDB",value:(A=T(z().mark((function g(){return z().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(this.db=new M,this.db.isSupported()){g.next=3;break}throw new Error("IndexedDB is not supported");case 3:return g.prev=3,g.next=6,this.db.initDB(Y,1);case 6:return g.next=8,this.db.clearDBWhenOverflow();case 8:return g.next=10,this.db.removeExpiredLog();case 10:g.next=15;break;case 12:throw g.prev=12,g.t0=g.catch(3),new Error("indexedDB initialization failed");case 15:case"end":return g.stop()}}),g,this,[[3,12]])}))),function(){return A.apply(this,arguments)})}],t=[{key:"createCache",value:function(){return{time:Date.now(),logs:[]}}}],C&&x(I.prototype,C),t&&x(I,t),Object.defineProperty(I,"prototype",{writable:!1}),g}(),O=C("../../node_modules/.pnpm/jszip@3.10.1/node_modules/jszip/dist/jszip.min.js"),j=C.n(O);function Q(g,I,C){var t=void 0===I?null:I,A=function(g,I){var C=atob(g);if(I){for(var t=new Uint8Array(C.length),A=0,e=C.length;A<e;++A)t[A]=C.charCodeAt(A);return String.fromCharCode.apply(null,new Uint16Array(t.buffer))}return C}(g,void 0!==C&&C),e=A.indexOf("\n",10)+1,i=A.substring(e)+(t?"//# sourceMappingURL="+t:""),n=new Blob([i],{type:"application/javascript"});return URL.createObjectURL(n)}var _,q,$,gg,Ig=(_="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGNvbW1vbmpzUmVxdWlyZSAocGF0aCkgewoJCXRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGR5bmFtaWNhbGx5IHJlcXVpcmUgIicgKyBwYXRoICsgJyIuIFBsZWFzZSBjb25maWd1cmUgdGhlIGR5bmFtaWNSZXF1aXJlVGFyZ2V0cyBvci9hbmQgaWdub3JlRHluYW1pY1JlcXVpcmVzIG9wdGlvbiBvZiBAcm9sbHVwL3BsdWdpbi1jb21tb25qcyBhcHByb3ByaWF0ZWx5IGZvciB0aGlzIHJlcXVpcmUgY2FsbCB0byB3b3JrLicpOwoJfQoKCXZhciBqc3ppcF9taW4gPSB7ZXhwb3J0czoge319OwoKCShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7CglmdW5jdGlvbiBfdHlwZW9mKG8pIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvKSB7IHJldHVybiB0eXBlb2YgbzsgfSA6IGZ1bmN0aW9uIChvKSB7IHJldHVybiBvICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiBvLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgbyAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG87IH0sIF90eXBlb2Yobyk7IH0KCS8qIQoKCUpTWmlwIHYzLjEwLjEgLSBBIEphdmFTY3JpcHQgY2xhc3MgZm9yIGdlbmVyYXRpbmcgYW5kIHJlYWRpbmcgemlwIGZpbGVzCgk8aHR0cDovL3N0dWFydGsuY29tL2pzemlwPgoKCShjKSAyMDA5LTIwMTYgU3R1YXJ0IEtuaWdodGxleSA8c3R1YXJ0IFthdF0gc3R1YXJ0ay5jb20+CglEdWFsIGxpY2VuY2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBvciBHUEx2My4gU2VlIGh0dHBzOi8vcmF3LmdpdGh1Yi5jb20vU3R1ay9qc3ppcC9tYWluL0xJQ0VOU0UubWFya2Rvd24uCgoJSlNaaXAgdXNlcyB0aGUgbGlicmFyeSBwYWtvIHJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSA6CglodHRwczovL2dpdGh1Yi5jb20vbm9kZWNhL3Bha28vYmxvYi9tYWluL0xJQ0VOU0UKCSovCgoJIWZ1bmN0aW9uIChlKSB7CgkgIGlmICgib2JqZWN0IiA9PSAoX3R5cGVvZihleHBvcnRzKSkgJiYgInVuZGVmaW5lZCIgIT0gJ29iamVjdCcpIG1vZHVsZS5leHBvcnRzID0gZSgpO2Vsc2UgewoJICAgICgidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIGNvbW1vbmpzR2xvYmFsID8gY29tbW9uanNHbG9iYWwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygc2VsZiA/IHNlbGYgOiB0aGlzKS5KU1ppcCA9IGUoKTsKCSAgfQoJfShmdW5jdGlvbiAoKSB7CgkgIHJldHVybiBmdW5jdGlvbiBzKGEsIG8sIGgpIHsKCSAgICBmdW5jdGlvbiB1KHIsIGUpIHsKCSAgICAgIGlmICghb1tyXSkgewoJICAgICAgICBpZiAoIWFbcl0pIHsKCSAgICAgICAgICB2YXIgdCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGNvbW1vbmpzUmVxdWlyZSAmJiBjb21tb25qc1JlcXVpcmU7CgkgICAgICAgICAgaWYgKCFlICYmIHQpIHJldHVybiB0KHIsICEwKTsKCSAgICAgICAgICBpZiAobCkgcmV0dXJuIGwociwgITApOwoJICAgICAgICAgIHZhciBuID0gbmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIgKyByICsgIiciKTsKCSAgICAgICAgICB0aHJvdyBuLmNvZGUgPSAiTU9EVUxFX05PVF9GT1VORCIsIG47CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGkgPSBvW3JdID0gewoJICAgICAgICAgIGV4cG9ydHM6IHt9CgkgICAgICAgIH07CgkgICAgICAgIGFbcl1bMF0uY2FsbChpLmV4cG9ydHMsIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdmFyIHQgPSBhW3JdWzFdW2VdOwoJICAgICAgICAgIHJldHVybiB1KHQgfHwgZSk7CgkgICAgICAgIH0sIGksIGkuZXhwb3J0cywgcywgYSwgbywgaCk7CgkgICAgICB9CgkgICAgICByZXR1cm4gb1tyXS5leHBvcnRzOwoJICAgIH0KCSAgICBmb3IgKHZhciBsID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgY29tbW9uanNSZXF1aXJlICYmIGNvbW1vbmpzUmVxdWlyZSwgZSA9IDA7IGUgPCBoLmxlbmd0aDsgZSsrKSB1KGhbZV0pOwoJICAgIHJldHVybiB1OwoJICB9KHsKCSAgICAxOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgZCA9IGUoIi4vdXRpbHMiKSwKCSAgICAgICAgYyA9IGUoIi4vc3VwcG9ydCIpLAoJICAgICAgICBwID0gIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89IjsKCSAgICAgIHIuZW5jb2RlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgZm9yICh2YXIgdCwgciwgbiwgaSwgcywgYSwgbywgaCA9IFtdLCB1ID0gMCwgbCA9IGUubGVuZ3RoLCBmID0gbCwgYyA9ICJzdHJpbmciICE9PSBkLmdldFR5cGVPZihlKTsgdSA8IGUubGVuZ3RoOykgZiA9IGwgLSB1LCBuID0gYyA/ICh0ID0gZVt1KytdLCByID0gdSA8IGwgPyBlW3UrK10gOiAwLCB1IDwgbCA/IGVbdSsrXSA6IDApIDogKHQgPSBlLmNoYXJDb2RlQXQodSsrKSwgciA9IHUgPCBsID8gZS5jaGFyQ29kZUF0KHUrKykgOiAwLCB1IDwgbCA/IGUuY2hhckNvZGVBdCh1KyspIDogMCksIGkgPSB0ID4+IDIsIHMgPSAoMyAmIHQpIDw8IDQgfCByID4+IDQsIGEgPSAxIDwgZiA/ICgxNSAmIHIpIDw8IDIgfCBuID4+IDYgOiA2NCwgbyA9IDIgPCBmID8gNjMgJiBuIDogNjQsIGgucHVzaChwLmNoYXJBdChpKSArIHAuY2hhckF0KHMpICsgcC5jaGFyQXQoYSkgKyBwLmNoYXJBdChvKSk7CgkgICAgICAgIHJldHVybiBoLmpvaW4oIiIpOwoJICAgICAgfSwgci5kZWNvZGUgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICB2YXIgdCwKCSAgICAgICAgICByLAoJICAgICAgICAgIG4sCgkgICAgICAgICAgaSwKCSAgICAgICAgICBzLAoJICAgICAgICAgIGEsCgkgICAgICAgICAgbyA9IDAsCgkgICAgICAgICAgaCA9IDAsCgkgICAgICAgICAgdSA9ICJkYXRhOiI7CgkgICAgICAgIGlmIChlLnN1YnN0cigwLCB1Lmxlbmd0aCkgPT09IHUpIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBiYXNlNjQgaW5wdXQsIGl0IGxvb2tzIGxpa2UgYSBkYXRhIHVybC4iKTsKCSAgICAgICAgdmFyIGwsCgkgICAgICAgICAgZiA9IDMgKiAoZSA9IGUucmVwbGFjZSgvW15BLVphLXowLTkrLz1dL2csICIiKSkubGVuZ3RoIC8gNDsKCSAgICAgICAgaWYgKGUuY2hhckF0KGUubGVuZ3RoIC0gMSkgPT09IHAuY2hhckF0KDY0KSAmJiBmLS0sIGUuY2hhckF0KGUubGVuZ3RoIC0gMikgPT09IHAuY2hhckF0KDY0KSAmJiBmLS0sIGYgJSAxICE9IDApIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBiYXNlNjQgaW5wdXQsIGJhZCBjb250ZW50IGxlbmd0aC4iKTsKCSAgICAgICAgZm9yIChsID0gYy51aW50OGFycmF5ID8gbmV3IFVpbnQ4QXJyYXkoMCB8IGYpIDogbmV3IEFycmF5KDAgfCBmKTsgbyA8IGUubGVuZ3RoOykgdCA9IHAuaW5kZXhPZihlLmNoYXJBdChvKyspKSA8PCAyIHwgKGkgPSBwLmluZGV4T2YoZS5jaGFyQXQobysrKSkpID4+IDQsIHIgPSAoMTUgJiBpKSA8PCA0IHwgKHMgPSBwLmluZGV4T2YoZS5jaGFyQXQobysrKSkpID4+IDIsIG4gPSAoMyAmIHMpIDw8IDYgfCAoYSA9IHAuaW5kZXhPZihlLmNoYXJBdChvKyspKSksIGxbaCsrXSA9IHQsIDY0ICE9PSBzICYmIChsW2grK10gPSByKSwgNjQgIT09IGEgJiYgKGxbaCsrXSA9IG4pOwoJICAgICAgICByZXR1cm4gbDsKCSAgICAgIH07CgkgICAgfSwgewoJICAgICAgIi4vc3VwcG9ydCI6IDMwLAoJICAgICAgIi4vdXRpbHMiOiAzMgoJICAgIH1dLAoJICAgIDI6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBuID0gZSgiLi9leHRlcm5hbCIpLAoJICAgICAgICBpID0gZSgiLi9zdHJlYW0vRGF0YVdvcmtlciIpLAoJICAgICAgICBzID0gZSgiLi9zdHJlYW0vQ3JjMzJQcm9iZSIpLAoJICAgICAgICBhID0gZSgiLi9zdHJlYW0vRGF0YUxlbmd0aFByb2JlIik7CgkgICAgICBmdW5jdGlvbiBvKGUsIHQsIHIsIG4sIGkpIHsKCSAgICAgICAgdGhpcy5jb21wcmVzc2VkU2l6ZSA9IGUsIHRoaXMudW5jb21wcmVzc2VkU2l6ZSA9IHQsIHRoaXMuY3JjMzIgPSByLCB0aGlzLmNvbXByZXNzaW9uID0gbiwgdGhpcy5jb21wcmVzc2VkQ29udGVudCA9IGk7CgkgICAgICB9CgkgICAgICBvLnByb3RvdHlwZSA9IHsKCSAgICAgICAgZ2V0Q29udGVudFdvcmtlcjogZnVuY3Rpb24gZ2V0Q29udGVudFdvcmtlcigpIHsKCSAgICAgICAgICB2YXIgZSA9IG5ldyBpKG4uUHJvbWlzZS5yZXNvbHZlKHRoaXMuY29tcHJlc3NlZENvbnRlbnQpKS5waXBlKHRoaXMuY29tcHJlc3Npb24udW5jb21wcmVzc1dvcmtlcigpKS5waXBlKG5ldyBhKCJkYXRhX2xlbmd0aCIpKSwKCSAgICAgICAgICAgIHQgPSB0aGlzOwoJICAgICAgICAgIHJldHVybiBlLm9uKCJlbmQiLCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAodGhpcy5zdHJlYW1JbmZvLmRhdGFfbGVuZ3RoICE9PSB0LnVuY29tcHJlc3NlZFNpemUpIHRocm93IG5ldyBFcnJvcigiQnVnIDogdW5jb21wcmVzc2VkIGRhdGEgc2l6ZSBtaXNtYXRjaCIpOwoJICAgICAgICAgIH0pLCBlOwoJICAgICAgICB9LAoJICAgICAgICBnZXRDb21wcmVzc2VkV29ya2VyOiBmdW5jdGlvbiBnZXRDb21wcmVzc2VkV29ya2VyKCkgewoJICAgICAgICAgIHJldHVybiBuZXcgaShuLlByb21pc2UucmVzb2x2ZSh0aGlzLmNvbXByZXNzZWRDb250ZW50KSkud2l0aFN0cmVhbUluZm8oImNvbXByZXNzZWRTaXplIiwgdGhpcy5jb21wcmVzc2VkU2l6ZSkud2l0aFN0cmVhbUluZm8oInVuY29tcHJlc3NlZFNpemUiLCB0aGlzLnVuY29tcHJlc3NlZFNpemUpLndpdGhTdHJlYW1JbmZvKCJjcmMzMiIsIHRoaXMuY3JjMzIpLndpdGhTdHJlYW1JbmZvKCJjb21wcmVzc2lvbiIsIHRoaXMuY29tcHJlc3Npb24pOwoJICAgICAgICB9CgkgICAgICB9LCBvLmNyZWF0ZVdvcmtlckZyb20gPSBmdW5jdGlvbiAoZSwgdCwgcikgewoJICAgICAgICByZXR1cm4gZS5waXBlKG5ldyBzKCkpLnBpcGUobmV3IGEoInVuY29tcHJlc3NlZFNpemUiKSkucGlwZSh0LmNvbXByZXNzV29ya2VyKHIpKS5waXBlKG5ldyBhKCJjb21wcmVzc2VkU2l6ZSIpKS53aXRoU3RyZWFtSW5mbygiY29tcHJlc3Npb24iLCB0KTsKCSAgICAgIH0sIHQuZXhwb3J0cyA9IG87CgkgICAgfSwgewoJICAgICAgIi4vZXh0ZXJuYWwiOiA2LAoJICAgICAgIi4vc3RyZWFtL0NyYzMyUHJvYmUiOiAyNSwKCSAgICAgICIuL3N0cmVhbS9EYXRhTGVuZ3RoUHJvYmUiOiAyNiwKCSAgICAgICIuL3N0cmVhbS9EYXRhV29ya2VyIjogMjcKCSAgICB9XSwKCSAgICAzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgbiA9IGUoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKTsKCSAgICAgIHIuU1RPUkUgPSB7CgkgICAgICAgIG1hZ2ljOiAiXDBcMCIsCgkgICAgICAgIGNvbXByZXNzV29ya2VyOiBmdW5jdGlvbiBjb21wcmVzc1dvcmtlcigpIHsKCSAgICAgICAgICByZXR1cm4gbmV3IG4oIlNUT1JFIGNvbXByZXNzaW9uIik7CgkgICAgICAgIH0sCgkgICAgICAgIHVuY29tcHJlc3NXb3JrZXI6IGZ1bmN0aW9uIHVuY29tcHJlc3NXb3JrZXIoKSB7CgkgICAgICAgICAgcmV0dXJuIG5ldyBuKCJTVE9SRSBkZWNvbXByZXNzaW9uIik7CgkgICAgICAgIH0KCSAgICAgIH0sIHIuREVGTEFURSA9IGUoIi4vZmxhdGUiKTsKCSAgICB9LCB7CgkgICAgICAiLi9mbGF0ZSI6IDcsCgkgICAgICAiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6IDI4CgkgICAgfV0sCgkgICAgNDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG4gPSBlKCIuL3V0aWxzIik7CgkgICAgICB2YXIgbyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgZm9yICh2YXIgZSwgdCA9IFtdLCByID0gMDsgciA8IDI1NjsgcisrKSB7CgkgICAgICAgICAgZSA9IHI7CgkgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCA4OyBuKyspIGUgPSAxICYgZSA/IDM5ODgyOTIzODQgXiBlID4+PiAxIDogZSA+Pj4gMTsKCSAgICAgICAgICB0W3JdID0gZTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdDsKCSAgICAgIH0oKTsKCSAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgJiYgZS5sZW5ndGggPyAic3RyaW5nIiAhPT0gbi5nZXRUeXBlT2YoZSkgPyBmdW5jdGlvbiAoZSwgdCwgciwgbikgewoJICAgICAgICAgIHZhciBpID0gbywKCSAgICAgICAgICAgIHMgPSBuICsgcjsKCSAgICAgICAgICBlIF49IC0xOwoJICAgICAgICAgIGZvciAodmFyIGEgPSBuOyBhIDwgczsgYSsrKSBlID0gZSA+Pj4gOCBeIGlbMjU1ICYgKGUgXiB0W2FdKV07CgkgICAgICAgICAgcmV0dXJuIC0xIF4gZTsKCSAgICAgICAgfSgwIHwgdCwgZSwgZS5sZW5ndGgsIDApIDogZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKCSAgICAgICAgICB2YXIgaSA9IG8sCgkgICAgICAgICAgICBzID0gbiArIHI7CgkgICAgICAgICAgZSBePSAtMTsKCSAgICAgICAgICBmb3IgKHZhciBhID0gbjsgYSA8IHM7IGErKykgZSA9IGUgPj4+IDggXiBpWzI1NSAmIChlIF4gdC5jaGFyQ29kZUF0KGEpKV07CgkgICAgICAgICAgcmV0dXJuIC0xIF4gZTsKCSAgICAgICAgfSgwIHwgdCwgZSwgZS5sZW5ndGgsIDApIDogMDsKCSAgICAgIH07CgkgICAgfSwgewoJICAgICAgIi4vdXRpbHMiOiAzMgoJICAgIH1dLAoJICAgIDU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHIuYmFzZTY0ID0gITEsIHIuYmluYXJ5ID0gITEsIHIuZGlyID0gITEsIHIuY3JlYXRlRm9sZGVycyA9ICEwLCByLmRhdGUgPSBudWxsLCByLmNvbXByZXNzaW9uID0gbnVsbCwgci5jb21wcmVzc2lvbk9wdGlvbnMgPSBudWxsLCByLmNvbW1lbnQgPSBudWxsLCByLnVuaXhQZXJtaXNzaW9ucyA9IG51bGwsIHIuZG9zUGVybWlzc2lvbnMgPSBudWxsOwoJICAgIH0sIHt9XSwKCSAgICA2OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgbiA9IG51bGw7CgkgICAgICBuID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIFByb21pc2UgPyBQcm9taXNlIDogZSgibGllIiksIHQuZXhwb3J0cyA9IHsKCSAgICAgICAgUHJvbWlzZTogbgoJICAgICAgfTsKCSAgICB9LCB7CgkgICAgICBsaWU6IDM3CgkgICAgfV0sCgkgICAgNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG4gPSAidW5kZWZpbmVkIiAhPSB0eXBlb2YgVWludDhBcnJheSAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgVWludDE2QXJyYXkgJiYgInVuZGVmaW5lZCIgIT0gdHlwZW9mIFVpbnQzMkFycmF5LAoJICAgICAgICBpID0gZSgicGFrbyIpLAoJICAgICAgICBzID0gZSgiLi91dGlscyIpLAoJICAgICAgICBhID0gZSgiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciIpLAoJICAgICAgICBvID0gbiA/ICJ1aW50OGFycmF5IiA6ICJhcnJheSI7CgkgICAgICBmdW5jdGlvbiBoKGUsIHQpIHsKCSAgICAgICAgYS5jYWxsKHRoaXMsICJGbGF0ZVdvcmtlci8iICsgZSksIHRoaXMuX3Bha28gPSBudWxsLCB0aGlzLl9wYWtvQWN0aW9uID0gZSwgdGhpcy5fcGFrb09wdGlvbnMgPSB0LCB0aGlzLm1ldGEgPSB7fTsKCSAgICAgIH0KCSAgICAgIHIubWFnaWMgPSAiXGJcMCIsIHMuaW5oZXJpdHMoaCwgYSksIGgucHJvdG90eXBlLnByb2Nlc3NDaHVuayA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHRoaXMubWV0YSA9IGUubWV0YSwgbnVsbCA9PT0gdGhpcy5fcGFrbyAmJiB0aGlzLl9jcmVhdGVQYWtvKCksIHRoaXMuX3Bha28ucHVzaChzLnRyYW5zZm9ybVRvKG8sIGUuZGF0YSksICExKTsKCSAgICAgIH0sIGgucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkgewoJICAgICAgICBhLnByb3RvdHlwZS5mbHVzaC5jYWxsKHRoaXMpLCBudWxsID09PSB0aGlzLl9wYWtvICYmIHRoaXMuX2NyZWF0ZVBha28oKSwgdGhpcy5fcGFrby5wdXNoKFtdLCAhMCk7CgkgICAgICB9LCBoLnByb3RvdHlwZS5jbGVhblVwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICBhLnByb3RvdHlwZS5jbGVhblVwLmNhbGwodGhpcyksIHRoaXMuX3Bha28gPSBudWxsOwoJICAgICAgfSwgaC5wcm90b3R5cGUuX2NyZWF0ZVBha28gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMuX3Bha28gPSBuZXcgaVt0aGlzLl9wYWtvQWN0aW9uXSh7CgkgICAgICAgICAgcmF3OiAhMCwKCSAgICAgICAgICBsZXZlbDogdGhpcy5fcGFrb09wdGlvbnMubGV2ZWwgfHwgLTEKCSAgICAgICAgfSk7CgkgICAgICAgIHZhciB0ID0gdGhpczsKCSAgICAgICAgdGhpcy5fcGFrby5vbkRhdGEgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgIHQucHVzaCh7CgkgICAgICAgICAgICBkYXRhOiBlLAoJICAgICAgICAgICAgbWV0YTogdC5tZXRhCgkgICAgICAgICAgfSk7CgkgICAgICAgIH07CgkgICAgICB9LCByLmNvbXByZXNzV29ya2VyID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgcmV0dXJuIG5ldyBoKCJEZWZsYXRlIiwgZSk7CgkgICAgICB9LCByLnVuY29tcHJlc3NXb3JrZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgaCgiSW5mbGF0ZSIsIHt9KTsKCSAgICAgIH07CgkgICAgfSwgewoJICAgICAgIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiOiAyOCwKCSAgICAgICIuL3V0aWxzIjogMzIsCgkgICAgICBwYWtvOiAzOAoJICAgIH1dLAoJICAgIDg6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIGZ1bmN0aW9uIEEoZSwgdCkgewoJICAgICAgICB2YXIgciwKCSAgICAgICAgICBuID0gIiI7CgkgICAgICAgIGZvciAociA9IDA7IHIgPCB0OyByKyspIG4gKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgyNTUgJiBlKSwgZSA+Pj49IDg7CgkgICAgICAgIHJldHVybiBuOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gbihlLCB0LCByLCBuLCBpLCBzKSB7CgkgICAgICAgIHZhciBhLAoJICAgICAgICAgIG8sCgkgICAgICAgICAgaCA9IGUuZmlsZSwKCSAgICAgICAgICB1ID0gZS5jb21wcmVzc2lvbiwKCSAgICAgICAgICBsID0gcyAhPT0gTy51dGY4ZW5jb2RlLAoJICAgICAgICAgIGYgPSBJLnRyYW5zZm9ybVRvKCJzdHJpbmciLCBzKGgubmFtZSkpLAoJICAgICAgICAgIGMgPSBJLnRyYW5zZm9ybVRvKCJzdHJpbmciLCBPLnV0ZjhlbmNvZGUoaC5uYW1lKSksCgkgICAgICAgICAgZCA9IGguY29tbWVudCwKCSAgICAgICAgICBwID0gSS50cmFuc2Zvcm1Ubygic3RyaW5nIiwgcyhkKSksCgkgICAgICAgICAgbSA9IEkudHJhbnNmb3JtVG8oInN0cmluZyIsIE8udXRmOGVuY29kZShkKSksCgkgICAgICAgICAgXyA9IGMubGVuZ3RoICE9PSBoLm5hbWUubGVuZ3RoLAoJICAgICAgICAgIGcgPSBtLmxlbmd0aCAhPT0gZC5sZW5ndGgsCgkgICAgICAgICAgYiA9ICIiLAoJICAgICAgICAgIHYgPSAiIiwKCSAgICAgICAgICB5ID0gIiIsCgkgICAgICAgICAgdyA9IGguZGlyLAoJICAgICAgICAgIGsgPSBoLmRhdGUsCgkgICAgICAgICAgeCA9IHsKCSAgICAgICAgICAgIGNyYzMyOiAwLAoJICAgICAgICAgICAgY29tcHJlc3NlZFNpemU6IDAsCgkgICAgICAgICAgICB1bmNvbXByZXNzZWRTaXplOiAwCgkgICAgICAgICAgfTsKCSAgICAgICAgdCAmJiAhciB8fCAoeC5jcmMzMiA9IGUuY3JjMzIsIHguY29tcHJlc3NlZFNpemUgPSBlLmNvbXByZXNzZWRTaXplLCB4LnVuY29tcHJlc3NlZFNpemUgPSBlLnVuY29tcHJlc3NlZFNpemUpOwoJICAgICAgICB2YXIgUyA9IDA7CgkgICAgICAgIHQgJiYgKFMgfD0gOCksIGwgfHwgIV8gJiYgIWcgfHwgKFMgfD0gMjA0OCk7CgkgICAgICAgIHZhciB6ID0gMCwKCSAgICAgICAgICBDID0gMDsKCSAgICAgICAgdyAmJiAoeiB8PSAxNiksICJVTklYIiA9PT0gaSA/IChDID0gNzk4LCB6IHw9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgICAgdmFyIHIgPSBlOwoJICAgICAgICAgIHJldHVybiBlIHx8IChyID0gdCA/IDE2ODkzIDogMzMyMDQpLCAoNjU1MzUgJiByKSA8PCAxNjsKCSAgICAgICAgfShoLnVuaXhQZXJtaXNzaW9ucywgdykpIDogKEMgPSAyMCwgeiB8PSBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgIHJldHVybiA2MyAmIChlIHx8IDApOwoJICAgICAgICB9KGguZG9zUGVybWlzc2lvbnMpKSwgYSA9IGsuZ2V0VVRDSG91cnMoKSwgYSA8PD0gNiwgYSB8PSBrLmdldFVUQ01pbnV0ZXMoKSwgYSA8PD0gNSwgYSB8PSBrLmdldFVUQ1NlY29uZHMoKSAvIDIsIG8gPSBrLmdldFVUQ0Z1bGxZZWFyKCkgLSAxOTgwLCBvIDw8PSA0LCBvIHw9IGsuZ2V0VVRDTW9udGgoKSArIDEsIG8gPDw9IDUsIG8gfD0gay5nZXRVVENEYXRlKCksIF8gJiYgKHYgPSBBKDEsIDEpICsgQShCKGYpLCA0KSArIGMsIGIgKz0gInVwIiArIEEodi5sZW5ndGgsIDIpICsgdiksIGcgJiYgKHkgPSBBKDEsIDEpICsgQShCKHApLCA0KSArIG0sIGIgKz0gInVjIiArIEEoeS5sZW5ndGgsIDIpICsgeSk7CgkgICAgICAgIHZhciBFID0gIiI7CgkgICAgICAgIHJldHVybiBFICs9ICJcblwwIiwgRSArPSBBKFMsIDIpLCBFICs9IHUubWFnaWMsIEUgKz0gQShhLCAyKSwgRSArPSBBKG8sIDIpLCBFICs9IEEoeC5jcmMzMiwgNCksIEUgKz0gQSh4LmNvbXByZXNzZWRTaXplLCA0KSwgRSArPSBBKHgudW5jb21wcmVzc2VkU2l6ZSwgNCksIEUgKz0gQShmLmxlbmd0aCwgMiksIEUgKz0gQShiLmxlbmd0aCwgMiksIHsKCSAgICAgICAgICBmaWxlUmVjb3JkOiBSLkxPQ0FMX0ZJTEVfSEVBREVSICsgRSArIGYgKyBiLAoJICAgICAgICAgIGRpclJlY29yZDogUi5DRU5UUkFMX0ZJTEVfSEVBREVSICsgQShDLCAyKSArIEUgKyBBKHAubGVuZ3RoLCAyKSArICJcMFwwXDBcMCIgKyBBKHosIDQpICsgQShuLCA0KSArIGYgKyBiICsgcAoJICAgICAgICB9OwoJICAgICAgfQoJICAgICAgdmFyIEkgPSBlKCIuLi91dGlscyIpLAoJICAgICAgICBpID0gZSgiLi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKSwKCSAgICAgICAgTyA9IGUoIi4uL3V0ZjgiKSwKCSAgICAgICAgQiA9IGUoIi4uL2NyYzMyIiksCgkgICAgICAgIFIgPSBlKCIuLi9zaWduYXR1cmUiKTsKCSAgICAgIGZ1bmN0aW9uIHMoZSwgdCwgciwgbikgewoJICAgICAgICBpLmNhbGwodGhpcywgIlppcEZpbGVXb3JrZXIiKSwgdGhpcy5ieXRlc1dyaXR0ZW4gPSAwLCB0aGlzLnppcENvbW1lbnQgPSB0LCB0aGlzLnppcFBsYXRmb3JtID0gciwgdGhpcy5lbmNvZGVGaWxlTmFtZSA9IG4sIHRoaXMuc3RyZWFtRmlsZXMgPSBlLCB0aGlzLmFjY3VtdWxhdGUgPSAhMSwgdGhpcy5jb250ZW50QnVmZmVyID0gW10sIHRoaXMuZGlyUmVjb3JkcyA9IFtdLCB0aGlzLmN1cnJlbnRTb3VyY2VPZmZzZXQgPSAwLCB0aGlzLmVudHJpZXNDb3VudCA9IDAsIHRoaXMuY3VycmVudEZpbGUgPSBudWxsLCB0aGlzLl9zb3VyY2VzID0gW107CgkgICAgICB9CgkgICAgICBJLmluaGVyaXRzKHMsIGkpLCBzLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdmFyIHQgPSBlLm1ldGEucGVyY2VudCB8fCAwLAoJICAgICAgICAgIHIgPSB0aGlzLmVudHJpZXNDb3VudCwKCSAgICAgICAgICBuID0gdGhpcy5fc291cmNlcy5sZW5ndGg7CgkgICAgICAgIHRoaXMuYWNjdW11bGF0ZSA/IHRoaXMuY29udGVudEJ1ZmZlci5wdXNoKGUpIDogKHRoaXMuYnl0ZXNXcml0dGVuICs9IGUuZGF0YS5sZW5ndGgsIGkucHJvdG90eXBlLnB1c2guY2FsbCh0aGlzLCB7CgkgICAgICAgICAgZGF0YTogZS5kYXRhLAoJICAgICAgICAgIG1ldGE6IHsKCSAgICAgICAgICAgIGN1cnJlbnRGaWxlOiB0aGlzLmN1cnJlbnRGaWxlLAoJICAgICAgICAgICAgcGVyY2VudDogciA/ICh0ICsgMTAwICogKHIgLSBuIC0gMSkpIC8gciA6IDEwMAoJICAgICAgICAgIH0KCSAgICAgICAgfSkpOwoJICAgICAgfSwgcy5wcm90b3R5cGUub3BlbmVkU291cmNlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdGhpcy5jdXJyZW50U291cmNlT2Zmc2V0ID0gdGhpcy5ieXRlc1dyaXR0ZW4sIHRoaXMuY3VycmVudEZpbGUgPSBlLmZpbGUubmFtZTsKCSAgICAgICAgdmFyIHQgPSB0aGlzLnN0cmVhbUZpbGVzICYmICFlLmZpbGUuZGlyOwoJICAgICAgICBpZiAodCkgewoJICAgICAgICAgIHZhciByID0gbihlLCB0LCAhMSwgdGhpcy5jdXJyZW50U291cmNlT2Zmc2V0LCB0aGlzLnppcFBsYXRmb3JtLCB0aGlzLmVuY29kZUZpbGVOYW1lKTsKCSAgICAgICAgICB0aGlzLnB1c2goewoJICAgICAgICAgICAgZGF0YTogci5maWxlUmVjb3JkLAoJICAgICAgICAgICAgbWV0YTogewoJICAgICAgICAgICAgICBwZXJjZW50OiAwCgkgICAgICAgICAgICB9CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0gZWxzZSB0aGlzLmFjY3VtdWxhdGUgPSAhMDsKCSAgICAgIH0sIHMucHJvdG90eXBlLmNsb3NlZFNvdXJjZSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHRoaXMuYWNjdW11bGF0ZSA9ICExOwoJICAgICAgICB2YXIgdCA9IHRoaXMuc3RyZWFtRmlsZXMgJiYgIWUuZmlsZS5kaXIsCgkgICAgICAgICAgciA9IG4oZSwgdCwgITAsIHRoaXMuY3VycmVudFNvdXJjZU9mZnNldCwgdGhpcy56aXBQbGF0Zm9ybSwgdGhpcy5lbmNvZGVGaWxlTmFtZSk7CgkgICAgICAgIGlmICh0aGlzLmRpclJlY29yZHMucHVzaChyLmRpclJlY29yZCksIHQpIHRoaXMucHVzaCh7CgkgICAgICAgICAgZGF0YTogZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgIHJldHVybiBSLkRBVEFfREVTQ1JJUFRPUiArIEEoZS5jcmMzMiwgNCkgKyBBKGUuY29tcHJlc3NlZFNpemUsIDQpICsgQShlLnVuY29tcHJlc3NlZFNpemUsIDQpOwoJICAgICAgICAgIH0oZSksCgkgICAgICAgICAgbWV0YTogewoJICAgICAgICAgICAgcGVyY2VudDogMTAwCgkgICAgICAgICAgfQoJICAgICAgICB9KTtlbHNlIGZvciAodGhpcy5wdXNoKHsKCSAgICAgICAgICBkYXRhOiByLmZpbGVSZWNvcmQsCgkgICAgICAgICAgbWV0YTogewoJICAgICAgICAgICAgcGVyY2VudDogMAoJICAgICAgICAgIH0KCSAgICAgICAgfSk7IHRoaXMuY29udGVudEJ1ZmZlci5sZW5ndGg7KSB0aGlzLnB1c2godGhpcy5jb250ZW50QnVmZmVyLnNoaWZ0KCkpOwoJICAgICAgICB0aGlzLmN1cnJlbnRGaWxlID0gbnVsbDsKCSAgICAgIH0sIHMucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKCkgewoJICAgICAgICBmb3IgKHZhciBlID0gdGhpcy5ieXRlc1dyaXR0ZW4sIHQgPSAwOyB0IDwgdGhpcy5kaXJSZWNvcmRzLmxlbmd0aDsgdCsrKSB0aGlzLnB1c2goewoJICAgICAgICAgIGRhdGE6IHRoaXMuZGlyUmVjb3Jkc1t0XSwKCSAgICAgICAgICBtZXRhOiB7CgkgICAgICAgICAgICBwZXJjZW50OiAxMDAKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgICB2YXIgciA9IHRoaXMuYnl0ZXNXcml0dGVuIC0gZSwKCSAgICAgICAgICBuID0gZnVuY3Rpb24gKGUsIHQsIHIsIG4sIGkpIHsKCSAgICAgICAgICAgIHZhciBzID0gSS50cmFuc2Zvcm1Ubygic3RyaW5nIiwgaShuKSk7CgkgICAgICAgICAgICByZXR1cm4gUi5DRU5UUkFMX0RJUkVDVE9SWV9FTkQgKyAiXDBcMFwwXDAiICsgQShlLCAyKSArIEEoZSwgMikgKyBBKHQsIDQpICsgQShyLCA0KSArIEEocy5sZW5ndGgsIDIpICsgczsKCSAgICAgICAgICB9KHRoaXMuZGlyUmVjb3Jkcy5sZW5ndGgsIHIsIGUsIHRoaXMuemlwQ29tbWVudCwgdGhpcy5lbmNvZGVGaWxlTmFtZSk7CgkgICAgICAgIHRoaXMucHVzaCh7CgkgICAgICAgICAgZGF0YTogbiwKCSAgICAgICAgICBtZXRhOiB7CgkgICAgICAgICAgICBwZXJjZW50OiAxMDAKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSwgcy5wcm90b3R5cGUucHJlcGFyZU5leHRTb3VyY2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMucHJldmlvdXMgPSB0aGlzLl9zb3VyY2VzLnNoaWZ0KCksIHRoaXMub3BlbmVkU291cmNlKHRoaXMucHJldmlvdXMuc3RyZWFtSW5mbyksIHRoaXMuaXNQYXVzZWQgPyB0aGlzLnByZXZpb3VzLnBhdXNlKCkgOiB0aGlzLnByZXZpb3VzLnJlc3VtZSgpOwoJICAgICAgfSwgcy5wcm90b3R5cGUucmVnaXN0ZXJQcmV2aW91cyA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHRoaXMuX3NvdXJjZXMucHVzaChlKTsKCSAgICAgICAgdmFyIHQgPSB0aGlzOwoJICAgICAgICByZXR1cm4gZS5vbigiZGF0YSIsIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdC5wcm9jZXNzQ2h1bmsoZSk7CgkgICAgICAgIH0pLCBlLm9uKCJlbmQiLCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgdC5jbG9zZWRTb3VyY2UodC5wcmV2aW91cy5zdHJlYW1JbmZvKSwgdC5fc291cmNlcy5sZW5ndGggPyB0LnByZXBhcmVOZXh0U291cmNlKCkgOiB0LmVuZCgpOwoJICAgICAgICB9KSwgZS5vbigiZXJyb3IiLCBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgIHQuZXJyb3IoZSk7CgkgICAgICAgIH0pLCB0aGlzOwoJICAgICAgfSwgcy5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gISFpLnByb3RvdHlwZS5yZXN1bWUuY2FsbCh0aGlzKSAmJiAoIXRoaXMucHJldmlvdXMgJiYgdGhpcy5fc291cmNlcy5sZW5ndGggPyAodGhpcy5wcmVwYXJlTmV4dFNvdXJjZSgpLCAhMCkgOiB0aGlzLnByZXZpb3VzIHx8IHRoaXMuX3NvdXJjZXMubGVuZ3RoIHx8IHRoaXMuZ2VuZXJhdGVkRXJyb3IgPyB2b2lkIDAgOiAodGhpcy5lbmQoKSwgITApKTsKCSAgICAgIH0sIHMucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdmFyIHQgPSB0aGlzLl9zb3VyY2VzOwoJICAgICAgICBpZiAoIWkucHJvdG90eXBlLmVycm9yLmNhbGwodGhpcywgZSkpIHJldHVybiAhMTsKCSAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB0cnkgewoJICAgICAgICAgIHRbcl0uZXJyb3IoZSk7CgkgICAgICAgIH0gY2F0Y2ggKGUpIHt9CgkgICAgICAgIHJldHVybiAhMDsKCSAgICAgIH0sIHMucHJvdG90eXBlLmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGkucHJvdG90eXBlLmxvY2suY2FsbCh0aGlzKTsKCSAgICAgICAgZm9yICh2YXIgZSA9IHRoaXMuX3NvdXJjZXMsIHQgPSAwOyB0IDwgZS5sZW5ndGg7IHQrKykgZVt0XS5sb2NrKCk7CgkgICAgICB9LCB0LmV4cG9ydHMgPSBzOwoJICAgIH0sIHsKCSAgICAgICIuLi9jcmMzMiI6IDQsCgkgICAgICAiLi4vc2lnbmF0dXJlIjogMjMsCgkgICAgICAiLi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiOiAyOCwKCSAgICAgICIuLi91dGY4IjogMzEsCgkgICAgICAiLi4vdXRpbHMiOiAzMgoJICAgIH1dLAoJICAgIDk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciB1ID0gZSgiLi4vY29tcHJlc3Npb25zIiksCgkgICAgICAgIG4gPSBlKCIuL1ppcEZpbGVXb3JrZXIiKTsKCSAgICAgIHIuZ2VuZXJhdGVXb3JrZXIgPSBmdW5jdGlvbiAoZSwgYSwgdCkgewoJICAgICAgICB2YXIgbyA9IG5ldyBuKGEuc3RyZWFtRmlsZXMsIHQsIGEucGxhdGZvcm0sIGEuZW5jb2RlRmlsZU5hbWUpLAoJICAgICAgICAgIGggPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgIGUuZm9yRWFjaChmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICAgICAgaCsrOwoJICAgICAgICAgICAgdmFyIHIgPSBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICAgICAgICAgIHZhciByID0gZSB8fCB0LAoJICAgICAgICAgICAgICAgICAgbiA9IHVbcl07CgkgICAgICAgICAgICAgICAgaWYgKCFuKSB0aHJvdyBuZXcgRXJyb3IociArICIgaXMgbm90IGEgdmFsaWQgY29tcHJlc3Npb24gbWV0aG9kICEiKTsKCSAgICAgICAgICAgICAgICByZXR1cm4gbjsKCSAgICAgICAgICAgICAgfSh0Lm9wdGlvbnMuY29tcHJlc3Npb24sIGEuY29tcHJlc3Npb24pLAoJICAgICAgICAgICAgICBuID0gdC5vcHRpb25zLmNvbXByZXNzaW9uT3B0aW9ucyB8fCBhLmNvbXByZXNzaW9uT3B0aW9ucyB8fCB7fSwKCSAgICAgICAgICAgICAgaSA9IHQuZGlyLAoJICAgICAgICAgICAgICBzID0gdC5kYXRlOwoJICAgICAgICAgICAgdC5fY29tcHJlc3NXb3JrZXIociwgbikud2l0aFN0cmVhbUluZm8oImZpbGUiLCB7CgkgICAgICAgICAgICAgIG5hbWU6IGUsCgkgICAgICAgICAgICAgIGRpcjogaSwKCSAgICAgICAgICAgICAgZGF0ZTogcywKCSAgICAgICAgICAgICAgY29tbWVudDogdC5jb21tZW50IHx8ICIiLAoJICAgICAgICAgICAgICB1bml4UGVybWlzc2lvbnM6IHQudW5peFBlcm1pc3Npb25zLAoJICAgICAgICAgICAgICBkb3NQZXJtaXNzaW9uczogdC5kb3NQZXJtaXNzaW9ucwoJICAgICAgICAgICAgfSkucGlwZShvKTsKCSAgICAgICAgICB9KSwgby5lbnRyaWVzQ291bnQgPSBoOwoJICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgby5lcnJvcihlKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbzsKCSAgICAgIH07CgkgICAgfSwgewoJICAgICAgIi4uL2NvbXByZXNzaW9ucyI6IDMsCgkgICAgICAiLi9aaXBGaWxlV29ya2VyIjogOAoJICAgIH1dLAoJICAgIDEwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICBmdW5jdGlvbiBuKCkgewoJICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgbikpIHJldHVybiBuZXcgbigpOwoJICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKCJUaGUgY29uc3RydWN0b3Igd2l0aCBwYXJhbWV0ZXJzIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuIik7CgkgICAgICAgIHRoaXMuZmlsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpLCB0aGlzLmNvbW1lbnQgPSBudWxsLCB0aGlzLnJvb3QgPSAiIiwgdGhpcy5jbG9uZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICB2YXIgZSA9IG5ldyBuKCk7CgkgICAgICAgICAgZm9yICh2YXIgdCBpbiB0aGlzKSAiZnVuY3Rpb24iICE9IHR5cGVvZiB0aGlzW3RdICYmIChlW3RdID0gdGhpc1t0XSk7CgkgICAgICAgICAgcmV0dXJuIGU7CgkgICAgICAgIH07CgkgICAgICB9CgkgICAgICAobi5wcm90b3R5cGUgPSBlKCIuL29iamVjdCIpKS5sb2FkQXN5bmMgPSBlKCIuL2xvYWQiKSwgbi5zdXBwb3J0ID0gZSgiLi9zdXBwb3J0IiksIG4uZGVmYXVsdHMgPSBlKCIuL2RlZmF1bHRzIiksIG4udmVyc2lvbiA9ICIzLjEwLjEiLCBuLmxvYWRBc3luYyA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHJldHVybiBuZXcgbigpLmxvYWRBc3luYyhlLCB0KTsKCSAgICAgIH0sIG4uZXh0ZXJuYWwgPSBlKCIuL2V4dGVybmFsIiksIHQuZXhwb3J0cyA9IG47CgkgICAgfSwgewoJICAgICAgIi4vZGVmYXVsdHMiOiA1LAoJICAgICAgIi4vZXh0ZXJuYWwiOiA2LAoJICAgICAgIi4vbG9hZCI6IDExLAoJICAgICAgIi4vb2JqZWN0IjogMTUsCgkgICAgICAiLi9zdXBwb3J0IjogMzAKCSAgICB9XSwKCSAgICAxMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIHUgPSBlKCIuL3V0aWxzIiksCgkgICAgICAgIGkgPSBlKCIuL2V4dGVybmFsIiksCgkgICAgICAgIG4gPSBlKCIuL3V0ZjgiKSwKCSAgICAgICAgcyA9IGUoIi4vemlwRW50cmllcyIpLAoJICAgICAgICBhID0gZSgiLi9zdHJlYW0vQ3JjMzJQcm9iZSIpLAoJICAgICAgICBsID0gZSgiLi9ub2RlanNVdGlscyIpOwoJICAgICAgZnVuY3Rpb24gZihuKSB7CgkgICAgICAgIHJldHVybiBuZXcgaS5Qcm9taXNlKGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgICAgdmFyIHIgPSBuLmRlY29tcHJlc3NlZC5nZXRDb250ZW50V29ya2VyKCkucGlwZShuZXcgYSgpKTsKCSAgICAgICAgICByLm9uKCJlcnJvciIsIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICB0KGUpOwoJICAgICAgICAgIH0pLm9uKCJlbmQiLCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICByLnN0cmVhbUluZm8uY3JjMzIgIT09IG4uZGVjb21wcmVzc2VkLmNyYzMyID8gdChuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXAgOiBDUkMzMiBtaXNtYXRjaCIpKSA6IGUoKTsKCSAgICAgICAgICB9KS5yZXN1bWUoKTsKCSAgICAgICAgfSk7CgkgICAgICB9CgkgICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgbykgewoJICAgICAgICB2YXIgaCA9IHRoaXM7CgkgICAgICAgIHJldHVybiBvID0gdS5leHRlbmQobyB8fCB7fSwgewoJICAgICAgICAgIGJhc2U2NDogITEsCgkgICAgICAgICAgY2hlY2tDUkMzMjogITEsCgkgICAgICAgICAgb3B0aW1pemVkQmluYXJ5U3RyaW5nOiAhMSwKCSAgICAgICAgICBjcmVhdGVGb2xkZXJzOiAhMSwKCSAgICAgICAgICBkZWNvZGVGaWxlTmFtZTogbi51dGY4ZGVjb2RlCgkgICAgICAgIH0pLCBsLmlzTm9kZSAmJiBsLmlzU3RyZWFtKGUpID8gaS5Qcm9taXNlLnJlamVjdChuZXcgRXJyb3IoIkpTWmlwIGNhbid0IGFjY2VwdCBhIHN0cmVhbSB3aGVuIGxvYWRpbmcgYSB6aXAgZmlsZS4iKSkgOiB1LnByZXBhcmVDb250ZW50KCJ0aGUgbG9hZGVkIHppcCBmaWxlIiwgZSwgITAsIG8ub3B0aW1pemVkQmluYXJ5U3RyaW5nLCBvLmJhc2U2NCkudGhlbihmdW5jdGlvbiAoZSkgewoJICAgICAgICAgIHZhciB0ID0gbmV3IHMobyk7CgkgICAgICAgICAgcmV0dXJuIHQubG9hZChlKSwgdDsKCSAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZSkgewoJICAgICAgICAgIHZhciB0ID0gW2kuUHJvbWlzZS5yZXNvbHZlKGUpXSwKCSAgICAgICAgICAgIHIgPSBlLmZpbGVzOwoJICAgICAgICAgIGlmIChvLmNoZWNrQ1JDMzIpIGZvciAodmFyIG4gPSAwOyBuIDwgci5sZW5ndGg7IG4rKykgdC5wdXNoKGYocltuXSkpOwoJICAgICAgICAgIHJldHVybiBpLlByb21pc2UuYWxsKHQpOwoJICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgZm9yICh2YXIgdCA9IGUuc2hpZnQoKSwgciA9IHQuZmlsZXMsIG4gPSAwOyBuIDwgci5sZW5ndGg7IG4rKykgewoJICAgICAgICAgICAgdmFyIGkgPSByW25dLAoJICAgICAgICAgICAgICBzID0gaS5maWxlTmFtZVN0ciwKCSAgICAgICAgICAgICAgYSA9IHUucmVzb2x2ZShpLmZpbGVOYW1lU3RyKTsKCSAgICAgICAgICAgIGguZmlsZShhLCBpLmRlY29tcHJlc3NlZCwgewoJICAgICAgICAgICAgICBiaW5hcnk6ICEwLAoJICAgICAgICAgICAgICBvcHRpbWl6ZWRCaW5hcnlTdHJpbmc6ICEwLAoJICAgICAgICAgICAgICBkYXRlOiBpLmRhdGUsCgkgICAgICAgICAgICAgIGRpcjogaS5kaXIsCgkgICAgICAgICAgICAgIGNvbW1lbnQ6IGkuZmlsZUNvbW1lbnRTdHIubGVuZ3RoID8gaS5maWxlQ29tbWVudFN0ciA6IG51bGwsCgkgICAgICAgICAgICAgIHVuaXhQZXJtaXNzaW9uczogaS51bml4UGVybWlzc2lvbnMsCgkgICAgICAgICAgICAgIGRvc1Blcm1pc3Npb25zOiBpLmRvc1Blcm1pc3Npb25zLAoJICAgICAgICAgICAgICBjcmVhdGVGb2xkZXJzOiBvLmNyZWF0ZUZvbGRlcnMKCSAgICAgICAgICAgIH0pLCBpLmRpciB8fCAoaC5maWxlKGEpLnVuc2FmZU9yaWdpbmFsTmFtZSA9IHMpOwoJICAgICAgICAgIH0KCSAgICAgICAgICByZXR1cm4gdC56aXBDb21tZW50Lmxlbmd0aCAmJiAoaC5jb21tZW50ID0gdC56aXBDb21tZW50KSwgaDsKCSAgICAgICAgfSk7CgkgICAgICB9OwoJICAgIH0sIHsKCSAgICAgICIuL2V4dGVybmFsIjogNiwKCSAgICAgICIuL25vZGVqc1V0aWxzIjogMTQsCgkgICAgICAiLi9zdHJlYW0vQ3JjMzJQcm9iZSI6IDI1LAoJICAgICAgIi4vdXRmOCI6IDMxLAoJICAgICAgIi4vdXRpbHMiOiAzMiwKCSAgICAgICIuL3ppcEVudHJpZXMiOiAzMwoJICAgIH1dLAoJICAgIDEyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgbiA9IGUoIi4uL3V0aWxzIiksCgkgICAgICAgIGkgPSBlKCIuLi9zdHJlYW0vR2VuZXJpY1dvcmtlciIpOwoJICAgICAgZnVuY3Rpb24gcyhlLCB0KSB7CgkgICAgICAgIGkuY2FsbCh0aGlzLCAiTm9kZWpzIHN0cmVhbSBpbnB1dCBhZGFwdGVyIGZvciAiICsgZSksIHRoaXMuX3Vwc3RyZWFtRW5kZWQgPSAhMSwgdGhpcy5fYmluZFN0cmVhbSh0KTsKCSAgICAgIH0KCSAgICAgIG4uaW5oZXJpdHMocywgaSksIHMucHJvdG90eXBlLl9iaW5kU3RyZWFtID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdmFyIHQgPSB0aGlzOwoJICAgICAgICAodGhpcy5fc3RyZWFtID0gZSkucGF1c2UoKSwgZS5vbigiZGF0YSIsIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdC5wdXNoKHsKCSAgICAgICAgICAgIGRhdGE6IGUsCgkgICAgICAgICAgICBtZXRhOiB7CgkgICAgICAgICAgICAgIHBlcmNlbnQ6IDAKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9KTsKCSAgICAgICAgfSkub24oImVycm9yIiwgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICB0LmlzUGF1c2VkID8gdGhpcy5nZW5lcmF0ZWRFcnJvciA9IGUgOiB0LmVycm9yKGUpOwoJICAgICAgICB9KS5vbigiZW5kIiwgZnVuY3Rpb24gKCkgewoJICAgICAgICAgIHQuaXNQYXVzZWQgPyB0Ll91cHN0cmVhbUVuZGVkID0gITAgOiB0LmVuZCgpOwoJICAgICAgICB9KTsKCSAgICAgIH0sIHMucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gISFpLnByb3RvdHlwZS5wYXVzZS5jYWxsKHRoaXMpICYmICh0aGlzLl9zdHJlYW0ucGF1c2UoKSwgITApOwoJICAgICAgfSwgcy5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gISFpLnByb3RvdHlwZS5yZXN1bWUuY2FsbCh0aGlzKSAmJiAodGhpcy5fdXBzdHJlYW1FbmRlZCA/IHRoaXMuZW5kKCkgOiB0aGlzLl9zdHJlYW0ucmVzdW1lKCksICEwKTsKCSAgICAgIH0sIHQuZXhwb3J0cyA9IHM7CgkgICAgfSwgewoJICAgICAgIi4uL3N0cmVhbS9HZW5lcmljV29ya2VyIjogMjgsCgkgICAgICAiLi4vdXRpbHMiOiAzMgoJICAgIH1dLAoJICAgIDEzOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgaSA9IGUoInJlYWRhYmxlLXN0cmVhbSIpLlJlYWRhYmxlOwoJICAgICAgZnVuY3Rpb24gbihlLCB0LCByKSB7CgkgICAgICAgIGkuY2FsbCh0aGlzLCB0KSwgdGhpcy5faGVscGVyID0gZTsKCSAgICAgICAgdmFyIG4gPSB0aGlzOwoJICAgICAgICBlLm9uKCJkYXRhIiwgZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgICBuLnB1c2goZSkgfHwgbi5faGVscGVyLnBhdXNlKCksIHIgJiYgcih0KTsKCSAgICAgICAgfSkub24oImVycm9yIiwgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICBuLmVtaXQoImVycm9yIiwgZSk7CgkgICAgICAgIH0pLm9uKCJlbmQiLCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgbi5wdXNoKG51bGwpOwoJICAgICAgICB9KTsKCSAgICAgIH0KCSAgICAgIGUoIi4uL3V0aWxzIikuaW5oZXJpdHMobiwgaSksIG4ucHJvdG90eXBlLl9yZWFkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aGlzLl9oZWxwZXIucmVzdW1lKCk7CgkgICAgICB9LCB0LmV4cG9ydHMgPSBuOwoJICAgIH0sIHsKCSAgICAgICIuLi91dGlscyI6IDMyLAoJICAgICAgInJlYWRhYmxlLXN0cmVhbSI6IDE2CgkgICAgfV0sCgkgICAgMTQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHQuZXhwb3J0cyA9IHsKCSAgICAgICAgaXNOb2RlOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgQnVmZmVyLAoJICAgICAgICBuZXdCdWZmZXJGcm9tOiBmdW5jdGlvbiBuZXdCdWZmZXJGcm9tKGUsIHQpIHsKCSAgICAgICAgICBpZiAoQnVmZmVyLmZyb20gJiYgQnVmZmVyLmZyb20gIT09IFVpbnQ4QXJyYXkuZnJvbSkgcmV0dXJuIEJ1ZmZlci5mcm9tKGUsIHQpOwoJICAgICAgICAgIGlmICgibnVtYmVyIiA9PSB0eXBlb2YgZSkgdGhyb3cgbmV3IEVycm9yKCdUaGUgImRhdGEiIGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyJyk7CgkgICAgICAgICAgcmV0dXJuIG5ldyBCdWZmZXIoZSwgdCk7CgkgICAgICAgIH0sCgkgICAgICAgIGFsbG9jQnVmZmVyOiBmdW5jdGlvbiBhbGxvY0J1ZmZlcihlKSB7CgkgICAgICAgICAgaWYgKEJ1ZmZlci5hbGxvYykgcmV0dXJuIEJ1ZmZlci5hbGxvYyhlKTsKCSAgICAgICAgICB2YXIgdCA9IG5ldyBCdWZmZXIoZSk7CgkgICAgICAgICAgcmV0dXJuIHQuZmlsbCgwKSwgdDsKCSAgICAgICAgfSwKCSAgICAgICAgaXNCdWZmZXI6IGZ1bmN0aW9uIGlzQnVmZmVyKGUpIHsKCSAgICAgICAgICByZXR1cm4gQnVmZmVyLmlzQnVmZmVyKGUpOwoJICAgICAgICB9LAoJICAgICAgICBpc1N0cmVhbTogZnVuY3Rpb24gaXNTdHJlYW0oZSkgewoJICAgICAgICAgIHJldHVybiBlICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUub24gJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgZS5wYXVzZSAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBlLnJlc3VtZTsKCSAgICAgICAgfQoJICAgICAgfTsKCSAgICB9LCB7fV0sCgkgICAgMTU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIGZ1bmN0aW9uIHMoZSwgdCwgcikgewoJICAgICAgICB2YXIgbiwKCSAgICAgICAgICBpID0gdS5nZXRUeXBlT2YodCksCgkgICAgICAgICAgcyA9IHUuZXh0ZW5kKHIgfHwge30sIGYpOwoJICAgICAgICBzLmRhdGUgPSBzLmRhdGUgfHwgbmV3IERhdGUoKSwgbnVsbCAhPT0gcy5jb21wcmVzc2lvbiAmJiAocy5jb21wcmVzc2lvbiA9IHMuY29tcHJlc3Npb24udG9VcHBlckNhc2UoKSksICJzdHJpbmciID09IHR5cGVvZiBzLnVuaXhQZXJtaXNzaW9ucyAmJiAocy51bml4UGVybWlzc2lvbnMgPSBwYXJzZUludChzLnVuaXhQZXJtaXNzaW9ucywgOCkpLCBzLnVuaXhQZXJtaXNzaW9ucyAmJiAxNjM4NCAmIHMudW5peFBlcm1pc3Npb25zICYmIChzLmRpciA9ICEwKSwgcy5kb3NQZXJtaXNzaW9ucyAmJiAxNiAmIHMuZG9zUGVybWlzc2lvbnMgJiYgKHMuZGlyID0gITApLCBzLmRpciAmJiAoZSA9IGcoZSkpLCBzLmNyZWF0ZUZvbGRlcnMgJiYgKG4gPSBfKGUpKSAmJiBiLmNhbGwodGhpcywgbiwgITApOwoJICAgICAgICB2YXIgYSA9ICJzdHJpbmciID09PSBpICYmICExID09PSBzLmJpbmFyeSAmJiAhMSA9PT0gcy5iYXNlNjQ7CgkgICAgICAgIHIgJiYgdm9pZCAwICE9PSByLmJpbmFyeSB8fCAocy5iaW5hcnkgPSAhYSksICh0IGluc3RhbmNlb2YgYyAmJiAwID09PSB0LnVuY29tcHJlc3NlZFNpemUgfHwgcy5kaXIgfHwgIXQgfHwgMCA9PT0gdC5sZW5ndGgpICYmIChzLmJhc2U2NCA9ICExLCBzLmJpbmFyeSA9ICEwLCB0ID0gIiIsIHMuY29tcHJlc3Npb24gPSAiU1RPUkUiLCBpID0gInN0cmluZyIpOwoJICAgICAgICB2YXIgbyA9IG51bGw7CgkgICAgICAgIG8gPSB0IGluc3RhbmNlb2YgYyB8fCB0IGluc3RhbmNlb2YgbCA/IHQgOiBwLmlzTm9kZSAmJiBwLmlzU3RyZWFtKHQpID8gbmV3IG0oZSwgdCkgOiB1LnByZXBhcmVDb250ZW50KGUsIHQsIHMuYmluYXJ5LCBzLm9wdGltaXplZEJpbmFyeVN0cmluZywgcy5iYXNlNjQpOwoJICAgICAgICB2YXIgaCA9IG5ldyBkKGUsIG8sIHMpOwoJICAgICAgICB0aGlzLmZpbGVzW2VdID0gaDsKCSAgICAgIH0KCSAgICAgIHZhciBpID0gZSgiLi91dGY4IiksCgkgICAgICAgIHUgPSBlKCIuL3V0aWxzIiksCgkgICAgICAgIGwgPSBlKCIuL3N0cmVhbS9HZW5lcmljV29ya2VyIiksCgkgICAgICAgIGEgPSBlKCIuL3N0cmVhbS9TdHJlYW1IZWxwZXIiKSwKCSAgICAgICAgZiA9IGUoIi4vZGVmYXVsdHMiKSwKCSAgICAgICAgYyA9IGUoIi4vY29tcHJlc3NlZE9iamVjdCIpLAoJICAgICAgICBkID0gZSgiLi96aXBPYmplY3QiKSwKCSAgICAgICAgbyA9IGUoIi4vZ2VuZXJhdGUiKSwKCSAgICAgICAgcCA9IGUoIi4vbm9kZWpzVXRpbHMiKSwKCSAgICAgICAgbSA9IGUoIi4vbm9kZWpzL05vZGVqc1N0cmVhbUlucHV0QWRhcHRlciIpLAoJICAgICAgICBfID0gZnVuY3Rpb24gXyhlKSB7CgkgICAgICAgICAgIi8iID09PSBlLnNsaWNlKC0xKSAmJiAoZSA9IGUuc3Vic3RyaW5nKDAsIGUubGVuZ3RoIC0gMSkpOwoJICAgICAgICAgIHZhciB0ID0gZS5sYXN0SW5kZXhPZigiLyIpOwoJICAgICAgICAgIHJldHVybiAwIDwgdCA/IGUuc3Vic3RyaW5nKDAsIHQpIDogIiI7CgkgICAgICAgIH0sCgkgICAgICAgIGcgPSBmdW5jdGlvbiBnKGUpIHsKCSAgICAgICAgICByZXR1cm4gIi8iICE9PSBlLnNsaWNlKC0xKSAmJiAoZSArPSAiLyIpLCBlOwoJICAgICAgICB9LAoJICAgICAgICBiID0gZnVuY3Rpb24gYihlLCB0KSB7CgkgICAgICAgICAgcmV0dXJuIHQgPSB2b2lkIDAgIT09IHQgPyB0IDogZi5jcmVhdGVGb2xkZXJzLCBlID0gZyhlKSwgdGhpcy5maWxlc1tlXSB8fCBzLmNhbGwodGhpcywgZSwgbnVsbCwgewoJICAgICAgICAgICAgZGlyOiAhMCwKCSAgICAgICAgICAgIGNyZWF0ZUZvbGRlcnM6IHQKCSAgICAgICAgICB9KSwgdGhpcy5maWxlc1tlXTsKCSAgICAgICAgfTsKCSAgICAgIGZ1bmN0aW9uIGgoZSkgewoJICAgICAgICByZXR1cm4gIltvYmplY3QgUmVnRXhwXSIgPT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKTsKCSAgICAgIH0KCSAgICAgIHZhciBuID0gewoJICAgICAgICBsb2FkOiBmdW5jdGlvbiBsb2FkKCkgewoJICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVGhpcyBtZXRob2QgaGFzIGJlZW4gcmVtb3ZlZCBpbiBKU1ppcCAzLjAsIHBsZWFzZSBjaGVjayB0aGUgdXBncmFkZSBndWlkZS4iKTsKCSAgICAgICAgfSwKCSAgICAgICAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChlKSB7CgkgICAgICAgICAgdmFyIHQsIHIsIG47CgkgICAgICAgICAgZm9yICh0IGluIHRoaXMuZmlsZXMpIG4gPSB0aGlzLmZpbGVzW3RdLCAociA9IHQuc2xpY2UodGhpcy5yb290Lmxlbmd0aCwgdC5sZW5ndGgpKSAmJiB0LnNsaWNlKDAsIHRoaXMucm9vdC5sZW5ndGgpID09PSB0aGlzLnJvb3QgJiYgZShyLCBuKTsKCSAgICAgICAgfSwKCSAgICAgICAgZmlsdGVyOiBmdW5jdGlvbiBmaWx0ZXIocikgewoJICAgICAgICAgIHZhciBuID0gW107CgkgICAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICAgICAgcihlLCB0KSAmJiBuLnB1c2godCk7CgkgICAgICAgICAgfSksIG47CgkgICAgICAgIH0sCgkgICAgICAgIGZpbGU6IGZ1bmN0aW9uIGZpbGUoZSwgdCwgcikgewoJICAgICAgICAgIGlmICgxICE9PSBhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gZSA9IHRoaXMucm9vdCArIGUsIHMuY2FsbCh0aGlzLCBlLCB0LCByKSwgdGhpczsKCSAgICAgICAgICBpZiAoaChlKSkgewoJICAgICAgICAgICAgdmFyIG4gPSBlOwoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgICAgICAgIHJldHVybiAhdC5kaXIgJiYgbi50ZXN0KGUpOwoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgfQoJICAgICAgICAgIHZhciBpID0gdGhpcy5maWxlc1t0aGlzLnJvb3QgKyBlXTsKCSAgICAgICAgICByZXR1cm4gaSAmJiAhaS5kaXIgPyBpIDogbnVsbDsKCSAgICAgICAgfSwKCSAgICAgICAgZm9sZGVyOiBmdW5jdGlvbiBmb2xkZXIocikgewoJICAgICAgICAgIGlmICghcikgcmV0dXJuIHRoaXM7CgkgICAgICAgICAgaWYgKGgocikpIHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICAgICAgcmV0dXJuIHQuZGlyICYmIHIudGVzdChlKTsKCSAgICAgICAgICB9KTsKCSAgICAgICAgICB2YXIgZSA9IHRoaXMucm9vdCArIHIsCgkgICAgICAgICAgICB0ID0gYi5jYWxsKHRoaXMsIGUpLAoJICAgICAgICAgICAgbiA9IHRoaXMuY2xvbmUoKTsKCSAgICAgICAgICByZXR1cm4gbi5yb290ID0gdC5uYW1lLCBuOwoJICAgICAgICB9LAoJICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShyKSB7CgkgICAgICAgICAgciA9IHRoaXMucm9vdCArIHI7CgkgICAgICAgICAgdmFyIGUgPSB0aGlzLmZpbGVzW3JdOwoJICAgICAgICAgIGlmIChlIHx8ICgiLyIgIT09IHIuc2xpY2UoLTEpICYmIChyICs9ICIvIiksIGUgPSB0aGlzLmZpbGVzW3JdKSwgZSAmJiAhZS5kaXIpIGRlbGV0ZSB0aGlzLmZpbGVzW3JdO2Vsc2UgZm9yICh2YXIgdCA9IHRoaXMuZmlsdGVyKGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgICAgICAgIHJldHVybiB0Lm5hbWUuc2xpY2UoMCwgci5sZW5ndGgpID09PSByOwoJICAgICAgICAgICAgfSksIG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgZGVsZXRlIHRoaXMuZmlsZXNbdFtuXS5uYW1lXTsKCSAgICAgICAgICByZXR1cm4gdGhpczsKCSAgICAgICAgfSwKCSAgICAgICAgZ2VuZXJhdGU6IGZ1bmN0aW9uIGdlbmVyYXRlKCkgewoJICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiVGhpcyBtZXRob2QgaGFzIGJlZW4gcmVtb3ZlZCBpbiBKU1ppcCAzLjAsIHBsZWFzZSBjaGVjayB0aGUgdXBncmFkZSBndWlkZS4iKTsKCSAgICAgICAgfSwKCSAgICAgICAgZ2VuZXJhdGVJbnRlcm5hbFN0cmVhbTogZnVuY3Rpb24gZ2VuZXJhdGVJbnRlcm5hbFN0cmVhbShlKSB7CgkgICAgICAgICAgdmFyIHQsCgkgICAgICAgICAgICByID0ge307CgkgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGlmICgociA9IHUuZXh0ZW5kKGUgfHwge30sIHsKCSAgICAgICAgICAgICAgc3RyZWFtRmlsZXM6ICExLAoJICAgICAgICAgICAgICBjb21wcmVzc2lvbjogIlNUT1JFIiwKCSAgICAgICAgICAgICAgY29tcHJlc3Npb25PcHRpb25zOiBudWxsLAoJICAgICAgICAgICAgICB0eXBlOiAiIiwKCSAgICAgICAgICAgICAgcGxhdGZvcm06ICJET1MiLAoJICAgICAgICAgICAgICBjb21tZW50OiBudWxsLAoJICAgICAgICAgICAgICBtaW1lVHlwZTogImFwcGxpY2F0aW9uL3ppcCIsCgkgICAgICAgICAgICAgIGVuY29kZUZpbGVOYW1lOiBpLnV0ZjhlbmNvZGUKCSAgICAgICAgICAgIH0pKS50eXBlID0gci50eXBlLnRvTG93ZXJDYXNlKCksIHIuY29tcHJlc3Npb24gPSByLmNvbXByZXNzaW9uLnRvVXBwZXJDYXNlKCksICJiaW5hcnlzdHJpbmciID09PSByLnR5cGUgJiYgKHIudHlwZSA9ICJzdHJpbmciKSwgIXIudHlwZSkgdGhyb3cgbmV3IEVycm9yKCJObyBvdXRwdXQgdHlwZSBzcGVjaWZpZWQuIik7CgkgICAgICAgICAgICB1LmNoZWNrU3VwcG9ydChyLnR5cGUpLCAiZGFyd2luIiAhPT0gci5wbGF0Zm9ybSAmJiAiZnJlZWJzZCIgIT09IHIucGxhdGZvcm0gJiYgImxpbnV4IiAhPT0gci5wbGF0Zm9ybSAmJiAic3Vub3MiICE9PSByLnBsYXRmb3JtIHx8IChyLnBsYXRmb3JtID0gIlVOSVgiKSwgIndpbjMyIiA9PT0gci5wbGF0Zm9ybSAmJiAoci5wbGF0Zm9ybSA9ICJET1MiKTsKCSAgICAgICAgICAgIHZhciBuID0gci5jb21tZW50IHx8IHRoaXMuY29tbWVudCB8fCAiIjsKCSAgICAgICAgICAgIHQgPSBvLmdlbmVyYXRlV29ya2VyKHRoaXMsIHIsIG4pOwoJICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgICAgICh0ID0gbmV3IGwoImVycm9yIikpLmVycm9yKGUpOwoJICAgICAgICAgIH0KCSAgICAgICAgICByZXR1cm4gbmV3IGEodCwgci50eXBlIHx8ICJzdHJpbmciLCByLm1pbWVUeXBlKTsKCSAgICAgICAgfSwKCSAgICAgICAgZ2VuZXJhdGVBc3luYzogZnVuY3Rpb24gZ2VuZXJhdGVBc3luYyhlLCB0KSB7CgkgICAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVJbnRlcm5hbFN0cmVhbShlKS5hY2N1bXVsYXRlKHQpOwoJICAgICAgICB9LAoJICAgICAgICBnZW5lcmF0ZU5vZGVTdHJlYW06IGZ1bmN0aW9uIGdlbmVyYXRlTm9kZVN0cmVhbShlLCB0KSB7CgkgICAgICAgICAgcmV0dXJuIChlID0gZSB8fCB7fSkudHlwZSB8fCAoZS50eXBlID0gIm5vZGVidWZmZXIiKSwgdGhpcy5nZW5lcmF0ZUludGVybmFsU3RyZWFtKGUpLnRvTm9kZWpzU3RyZWFtKHQpOwoJICAgICAgICB9CgkgICAgICB9OwoJICAgICAgdC5leHBvcnRzID0gbjsKCSAgICB9LCB7CgkgICAgICAiLi9jb21wcmVzc2VkT2JqZWN0IjogMiwKCSAgICAgICIuL2RlZmF1bHRzIjogNSwKCSAgICAgICIuL2dlbmVyYXRlIjogOSwKCSAgICAgICIuL25vZGVqcy9Ob2RlanNTdHJlYW1JbnB1dEFkYXB0ZXIiOiAxMiwKCSAgICAgICIuL25vZGVqc1V0aWxzIjogMTQsCgkgICAgICAiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6IDI4LAoJICAgICAgIi4vc3RyZWFtL1N0cmVhbUhlbHBlciI6IDI5LAoJICAgICAgIi4vdXRmOCI6IDMxLAoJICAgICAgIi4vdXRpbHMiOiAzMiwKCSAgICAgICIuL3ppcE9iamVjdCI6IDM1CgkgICAgfV0sCgkgICAgMTY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHQuZXhwb3J0cyA9IGUoInN0cmVhbSIpOwoJICAgIH0sIHsKCSAgICAgIHN0cmVhbTogdm9pZCAwCgkgICAgfV0sCgkgICAgMTc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBuID0gZSgiLi9EYXRhUmVhZGVyIik7CgkgICAgICBmdW5jdGlvbiBpKGUpIHsKCSAgICAgICAgbi5jYWxsKHRoaXMsIGUpOwoJICAgICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IHRoaXMuZGF0YS5sZW5ndGg7IHQrKykgZVt0XSA9IDI1NSAmIGVbdF07CgkgICAgICB9CgkgICAgICBlKCIuLi91dGlscyIpLmluaGVyaXRzKGksIG4pLCBpLnByb3RvdHlwZS5ieXRlQXQgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICByZXR1cm4gdGhpcy5kYXRhW3RoaXMuemVybyArIGVdOwoJICAgICAgfSwgaS5wcm90b3R5cGUubGFzdEluZGV4T2ZTaWduYXR1cmUgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICBmb3IgKHZhciB0ID0gZS5jaGFyQ29kZUF0KDApLCByID0gZS5jaGFyQ29kZUF0KDEpLCBuID0gZS5jaGFyQ29kZUF0KDIpLCBpID0gZS5jaGFyQ29kZUF0KDMpLCBzID0gdGhpcy5sZW5ndGggLSA0OyAwIDw9IHM7IC0tcykgaWYgKHRoaXMuZGF0YVtzXSA9PT0gdCAmJiB0aGlzLmRhdGFbcyArIDFdID09PSByICYmIHRoaXMuZGF0YVtzICsgMl0gPT09IG4gJiYgdGhpcy5kYXRhW3MgKyAzXSA9PT0gaSkgcmV0dXJuIHMgLSB0aGlzLnplcm87CgkgICAgICAgIHJldHVybiAtMTsKCSAgICAgIH0sIGkucHJvdG90eXBlLnJlYWRBbmRDaGVja1NpZ25hdHVyZSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHZhciB0ID0gZS5jaGFyQ29kZUF0KDApLAoJICAgICAgICAgIHIgPSBlLmNoYXJDb2RlQXQoMSksCgkgICAgICAgICAgbiA9IGUuY2hhckNvZGVBdCgyKSwKCSAgICAgICAgICBpID0gZS5jaGFyQ29kZUF0KDMpLAoJICAgICAgICAgIHMgPSB0aGlzLnJlYWREYXRhKDQpOwoJICAgICAgICByZXR1cm4gdCA9PT0gc1swXSAmJiByID09PSBzWzFdICYmIG4gPT09IHNbMl0gJiYgaSA9PT0gc1szXTsKCSAgICAgIH0sIGkucHJvdG90eXBlLnJlYWREYXRhID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgaWYgKHRoaXMuY2hlY2tPZmZzZXQoZSksIDAgPT09IGUpIHJldHVybiBbXTsKCSAgICAgICAgdmFyIHQgPSB0aGlzLmRhdGEuc2xpY2UodGhpcy56ZXJvICsgdGhpcy5pbmRleCwgdGhpcy56ZXJvICsgdGhpcy5pbmRleCArIGUpOwoJICAgICAgICByZXR1cm4gdGhpcy5pbmRleCArPSBlLCB0OwoJICAgICAgfSwgdC5leHBvcnRzID0gaTsKCSAgICB9LCB7CgkgICAgICAiLi4vdXRpbHMiOiAzMiwKCSAgICAgICIuL0RhdGFSZWFkZXIiOiAxOAoJICAgIH1dLAoJICAgIDE4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgbiA9IGUoIi4uL3V0aWxzIik7CgkgICAgICBmdW5jdGlvbiBpKGUpIHsKCSAgICAgICAgdGhpcy5kYXRhID0gZSwgdGhpcy5sZW5ndGggPSBlLmxlbmd0aCwgdGhpcy5pbmRleCA9IDAsIHRoaXMuemVybyA9IDA7CgkgICAgICB9CgkgICAgICBpLnByb3RvdHlwZSA9IHsKCSAgICAgICAgY2hlY2tPZmZzZXQ6IGZ1bmN0aW9uIGNoZWNrT2Zmc2V0KGUpIHsKCSAgICAgICAgICB0aGlzLmNoZWNrSW5kZXgodGhpcy5pbmRleCArIGUpOwoJICAgICAgICB9LAoJICAgICAgICBjaGVja0luZGV4OiBmdW5jdGlvbiBjaGVja0luZGV4KGUpIHsKCSAgICAgICAgICBpZiAodGhpcy5sZW5ndGggPCB0aGlzLnplcm8gKyBlIHx8IGUgPCAwKSB0aHJvdyBuZXcgRXJyb3IoIkVuZCBvZiBkYXRhIHJlYWNoZWQgKGRhdGEgbGVuZ3RoID0gIiArIHRoaXMubGVuZ3RoICsgIiwgYXNrZWQgaW5kZXggPSAiICsgZSArICIpLiBDb3JydXB0ZWQgemlwID8iKTsKCSAgICAgICAgfSwKCSAgICAgICAgc2V0SW5kZXg6IGZ1bmN0aW9uIHNldEluZGV4KGUpIHsKCSAgICAgICAgICB0aGlzLmNoZWNrSW5kZXgoZSksIHRoaXMuaW5kZXggPSBlOwoJICAgICAgICB9LAoJICAgICAgICBza2lwOiBmdW5jdGlvbiBza2lwKGUpIHsKCSAgICAgICAgICB0aGlzLnNldEluZGV4KHRoaXMuaW5kZXggKyBlKTsKCSAgICAgICAgfSwKCSAgICAgICAgYnl0ZUF0OiBmdW5jdGlvbiBieXRlQXQoKSB7fSwKCSAgICAgICAgcmVhZEludDogZnVuY3Rpb24gcmVhZEludChlKSB7CgkgICAgICAgICAgdmFyIHQsCgkgICAgICAgICAgICByID0gMDsKCSAgICAgICAgICBmb3IgKHRoaXMuY2hlY2tPZmZzZXQoZSksIHQgPSB0aGlzLmluZGV4ICsgZSAtIDE7IHQgPj0gdGhpcy5pbmRleDsgdC0tKSByID0gKHIgPDwgOCkgKyB0aGlzLmJ5dGVBdCh0KTsKCSAgICAgICAgICByZXR1cm4gdGhpcy5pbmRleCArPSBlLCByOwoJICAgICAgICB9LAoJICAgICAgICByZWFkU3RyaW5nOiBmdW5jdGlvbiByZWFkU3RyaW5nKGUpIHsKCSAgICAgICAgICByZXR1cm4gbi50cmFuc2Zvcm1Ubygic3RyaW5nIiwgdGhpcy5yZWFkRGF0YShlKSk7CgkgICAgICAgIH0sCgkgICAgICAgIHJlYWREYXRhOiBmdW5jdGlvbiByZWFkRGF0YSgpIHt9LAoJICAgICAgICBsYXN0SW5kZXhPZlNpZ25hdHVyZTogZnVuY3Rpb24gbGFzdEluZGV4T2ZTaWduYXR1cmUoKSB7fSwKCSAgICAgICAgcmVhZEFuZENoZWNrU2lnbmF0dXJlOiBmdW5jdGlvbiByZWFkQW5kQ2hlY2tTaWduYXR1cmUoKSB7fSwKCSAgICAgICAgcmVhZERhdGU6IGZ1bmN0aW9uIHJlYWREYXRlKCkgewoJICAgICAgICAgIHZhciBlID0gdGhpcy5yZWFkSW50KDQpOwoJICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShEYXRlLlVUQygxOTgwICsgKGUgPj4gMjUgJiAxMjcpLCAoZSA+PiAyMSAmIDE1KSAtIDEsIGUgPj4gMTYgJiAzMSwgZSA+PiAxMSAmIDMxLCBlID4+IDUgJiA2MywgKDMxICYgZSkgPDwgMSkpOwoJICAgICAgICB9CgkgICAgICB9LCB0LmV4cG9ydHMgPSBpOwoJICAgIH0sIHsKCSAgICAgICIuLi91dGlscyI6IDMyCgkgICAgfV0sCgkgICAgMTk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBuID0gZSgiLi9VaW50OEFycmF5UmVhZGVyIik7CgkgICAgICBmdW5jdGlvbiBpKGUpIHsKCSAgICAgICAgbi5jYWxsKHRoaXMsIGUpOwoJICAgICAgfQoJICAgICAgZSgiLi4vdXRpbHMiKS5pbmhlcml0cyhpLCBuKSwgaS5wcm90b3R5cGUucmVhZERhdGEgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICB0aGlzLmNoZWNrT2Zmc2V0KGUpOwoJICAgICAgICB2YXIgdCA9IHRoaXMuZGF0YS5zbGljZSh0aGlzLnplcm8gKyB0aGlzLmluZGV4LCB0aGlzLnplcm8gKyB0aGlzLmluZGV4ICsgZSk7CgkgICAgICAgIHJldHVybiB0aGlzLmluZGV4ICs9IGUsIHQ7CgkgICAgICB9LCB0LmV4cG9ydHMgPSBpOwoJICAgIH0sIHsKCSAgICAgICIuLi91dGlscyI6IDMyLAoJICAgICAgIi4vVWludDhBcnJheVJlYWRlciI6IDIxCgkgICAgfV0sCgkgICAgMjA6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBuID0gZSgiLi9EYXRhUmVhZGVyIik7CgkgICAgICBmdW5jdGlvbiBpKGUpIHsKCSAgICAgICAgbi5jYWxsKHRoaXMsIGUpOwoJICAgICAgfQoJICAgICAgZSgiLi4vdXRpbHMiKS5pbmhlcml0cyhpLCBuKSwgaS5wcm90b3R5cGUuYnl0ZUF0ID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5jaGFyQ29kZUF0KHRoaXMuemVybyArIGUpOwoJICAgICAgfSwgaS5wcm90b3R5cGUubGFzdEluZGV4T2ZTaWduYXR1cmUgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmxhc3RJbmRleE9mKGUpIC0gdGhpcy56ZXJvOwoJICAgICAgfSwgaS5wcm90b3R5cGUucmVhZEFuZENoZWNrU2lnbmF0dXJlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgcmV0dXJuIGUgPT09IHRoaXMucmVhZERhdGEoNCk7CgkgICAgICB9LCBpLnByb3RvdHlwZS5yZWFkRGF0YSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHRoaXMuY2hlY2tPZmZzZXQoZSk7CgkgICAgICAgIHZhciB0ID0gdGhpcy5kYXRhLnNsaWNlKHRoaXMuemVybyArIHRoaXMuaW5kZXgsIHRoaXMuemVybyArIHRoaXMuaW5kZXggKyBlKTsKCSAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXggKz0gZSwgdDsKCSAgICAgIH0sIHQuZXhwb3J0cyA9IGk7CgkgICAgfSwgewoJICAgICAgIi4uL3V0aWxzIjogMzIsCgkgICAgICAiLi9EYXRhUmVhZGVyIjogMTgKCSAgICB9XSwKCSAgICAyMTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG4gPSBlKCIuL0FycmF5UmVhZGVyIik7CgkgICAgICBmdW5jdGlvbiBpKGUpIHsKCSAgICAgICAgbi5jYWxsKHRoaXMsIGUpOwoJICAgICAgfQoJICAgICAgZSgiLi4vdXRpbHMiKS5pbmhlcml0cyhpLCBuKSwgaS5wcm90b3R5cGUucmVhZERhdGEgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICBpZiAodGhpcy5jaGVja09mZnNldChlKSwgMCA9PT0gZSkgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwoJICAgICAgICB2YXIgdCA9IHRoaXMuZGF0YS5zdWJhcnJheSh0aGlzLnplcm8gKyB0aGlzLmluZGV4LCB0aGlzLnplcm8gKyB0aGlzLmluZGV4ICsgZSk7CgkgICAgICAgIHJldHVybiB0aGlzLmluZGV4ICs9IGUsIHQ7CgkgICAgICB9LCB0LmV4cG9ydHMgPSBpOwoJICAgIH0sIHsKCSAgICAgICIuLi91dGlscyI6IDMyLAoJICAgICAgIi4vQXJyYXlSZWFkZXIiOiAxNwoJICAgIH1dLAoJICAgIDIyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgbiA9IGUoIi4uL3V0aWxzIiksCgkgICAgICAgIGkgPSBlKCIuLi9zdXBwb3J0IiksCgkgICAgICAgIHMgPSBlKCIuL0FycmF5UmVhZGVyIiksCgkgICAgICAgIGEgPSBlKCIuL1N0cmluZ1JlYWRlciIpLAoJICAgICAgICBvID0gZSgiLi9Ob2RlQnVmZmVyUmVhZGVyIiksCgkgICAgICAgIGggPSBlKCIuL1VpbnQ4QXJyYXlSZWFkZXIiKTsKCSAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHZhciB0ID0gbi5nZXRUeXBlT2YoZSk7CgkgICAgICAgIHJldHVybiBuLmNoZWNrU3VwcG9ydCh0KSwgInN0cmluZyIgIT09IHQgfHwgaS51aW50OGFycmF5ID8gIm5vZGVidWZmZXIiID09PSB0ID8gbmV3IG8oZSkgOiBpLnVpbnQ4YXJyYXkgPyBuZXcgaChuLnRyYW5zZm9ybVRvKCJ1aW50OGFycmF5IiwgZSkpIDogbmV3IHMobi50cmFuc2Zvcm1UbygiYXJyYXkiLCBlKSkgOiBuZXcgYShlKTsKCSAgICAgIH07CgkgICAgfSwgewoJICAgICAgIi4uL3N1cHBvcnQiOiAzMCwKCSAgICAgICIuLi91dGlscyI6IDMyLAoJICAgICAgIi4vQXJyYXlSZWFkZXIiOiAxNywKCSAgICAgICIuL05vZGVCdWZmZXJSZWFkZXIiOiAxOSwKCSAgICAgICIuL1N0cmluZ1JlYWRlciI6IDIwLAoJICAgICAgIi4vVWludDhBcnJheVJlYWRlciI6IDIxCgkgICAgfV0sCgkgICAgMjM6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHIuTE9DQUxfRklMRV9IRUFERVIgPSAiUEsDBCIsIHIuQ0VOVFJBTF9GSUxFX0hFQURFUiA9ICJQSwECIiwgci5DRU5UUkFMX0RJUkVDVE9SWV9FTkQgPSAiUEsFBiIsIHIuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfTE9DQVRPUiA9ICJQSwYHIiwgci5aSVA2NF9DRU5UUkFMX0RJUkVDVE9SWV9FTkQgPSAiUEsGBiIsIHIuREFUQV9ERVNDUklQVE9SID0gIlBLB1xiIjsKCSAgICB9LCB7fV0sCgkgICAgMjQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBuID0gZSgiLi9HZW5lcmljV29ya2VyIiksCgkgICAgICAgIGkgPSBlKCIuLi91dGlscyIpOwoJICAgICAgZnVuY3Rpb24gcyhlKSB7CgkgICAgICAgIG4uY2FsbCh0aGlzLCAiQ29udmVydFdvcmtlciB0byAiICsgZSksIHRoaXMuZGVzdFR5cGUgPSBlOwoJICAgICAgfQoJICAgICAgaS5pbmhlcml0cyhzLCBuKSwgcy5wcm90b3R5cGUucHJvY2Vzc0NodW5rID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdGhpcy5wdXNoKHsKCSAgICAgICAgICBkYXRhOiBpLnRyYW5zZm9ybVRvKHRoaXMuZGVzdFR5cGUsIGUuZGF0YSksCgkgICAgICAgICAgbWV0YTogZS5tZXRhCgkgICAgICAgIH0pOwoJICAgICAgfSwgdC5leHBvcnRzID0gczsKCSAgICB9LCB7CgkgICAgICAiLi4vdXRpbHMiOiAzMiwKCSAgICAgICIuL0dlbmVyaWNXb3JrZXIiOiAyOAoJICAgIH1dLAoJICAgIDI1OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgbiA9IGUoIi4vR2VuZXJpY1dvcmtlciIpLAoJICAgICAgICBpID0gZSgiLi4vY3JjMzIiKTsKCSAgICAgIGZ1bmN0aW9uIHMoKSB7CgkgICAgICAgIG4uY2FsbCh0aGlzLCAiQ3JjMzJQcm9iZSIpLCB0aGlzLndpdGhTdHJlYW1JbmZvKCJjcmMzMiIsIDApOwoJICAgICAgfQoJICAgICAgZSgiLi4vdXRpbHMiKS5pbmhlcml0cyhzLCBuKSwgcy5wcm90b3R5cGUucHJvY2Vzc0NodW5rID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdGhpcy5zdHJlYW1JbmZvLmNyYzMyID0gaShlLmRhdGEsIHRoaXMuc3RyZWFtSW5mby5jcmMzMiB8fCAwKSwgdGhpcy5wdXNoKGUpOwoJICAgICAgfSwgdC5leHBvcnRzID0gczsKCSAgICB9LCB7CgkgICAgICAiLi4vY3JjMzIiOiA0LAoJICAgICAgIi4uL3V0aWxzIjogMzIsCgkgICAgICAiLi9HZW5lcmljV29ya2VyIjogMjgKCSAgICB9XSwKCSAgICAyNjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG4gPSBlKCIuLi91dGlscyIpLAoJICAgICAgICBpID0gZSgiLi9HZW5lcmljV29ya2VyIik7CgkgICAgICBmdW5jdGlvbiBzKGUpIHsKCSAgICAgICAgaS5jYWxsKHRoaXMsICJEYXRhTGVuZ3RoUHJvYmUgZm9yICIgKyBlKSwgdGhpcy5wcm9wTmFtZSA9IGUsIHRoaXMud2l0aFN0cmVhbUluZm8oZSwgMCk7CgkgICAgICB9CgkgICAgICBuLmluaGVyaXRzKHMsIGkpLCBzLnByb3RvdHlwZS5wcm9jZXNzQ2h1bmsgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICBpZiAoZSkgewoJICAgICAgICAgIHZhciB0ID0gdGhpcy5zdHJlYW1JbmZvW3RoaXMucHJvcE5hbWVdIHx8IDA7CgkgICAgICAgICAgdGhpcy5zdHJlYW1JbmZvW3RoaXMucHJvcE5hbWVdID0gdCArIGUuZGF0YS5sZW5ndGg7CgkgICAgICAgIH0KCSAgICAgICAgaS5wcm90b3R5cGUucHJvY2Vzc0NodW5rLmNhbGwodGhpcywgZSk7CgkgICAgICB9LCB0LmV4cG9ydHMgPSBzOwoJICAgIH0sIHsKCSAgICAgICIuLi91dGlscyI6IDMyLAoJICAgICAgIi4vR2VuZXJpY1dvcmtlciI6IDI4CgkgICAgfV0sCgkgICAgMjc6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBuID0gZSgiLi4vdXRpbHMiKSwKCSAgICAgICAgaSA9IGUoIi4vR2VuZXJpY1dvcmtlciIpOwoJICAgICAgZnVuY3Rpb24gcyhlKSB7CgkgICAgICAgIGkuY2FsbCh0aGlzLCAiRGF0YVdvcmtlciIpOwoJICAgICAgICB2YXIgdCA9IHRoaXM7CgkgICAgICAgIHRoaXMuZGF0YUlzUmVhZHkgPSAhMSwgdGhpcy5pbmRleCA9IDAsIHRoaXMubWF4ID0gMCwgdGhpcy5kYXRhID0gbnVsbCwgdGhpcy50eXBlID0gIiIsIHRoaXMuX3RpY2tTY2hlZHVsZWQgPSAhMSwgZS50aGVuKGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdC5kYXRhSXNSZWFkeSA9ICEwLCB0LmRhdGEgPSBlLCB0Lm1heCA9IGUgJiYgZS5sZW5ndGggfHwgMCwgdC50eXBlID0gbi5nZXRUeXBlT2YoZSksIHQuaXNQYXVzZWQgfHwgdC5fdGlja0FuZFJlcGVhdCgpOwoJICAgICAgICB9LCBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgIHQuZXJyb3IoZSk7CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgICAgbi5pbmhlcml0cyhzLCBpKSwgcy5wcm90b3R5cGUuY2xlYW5VcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaS5wcm90b3R5cGUuY2xlYW5VcC5jYWxsKHRoaXMpLCB0aGlzLmRhdGEgPSBudWxsOwoJICAgICAgfSwgcy5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gISFpLnByb3RvdHlwZS5yZXN1bWUuY2FsbCh0aGlzKSAmJiAoIXRoaXMuX3RpY2tTY2hlZHVsZWQgJiYgdGhpcy5kYXRhSXNSZWFkeSAmJiAodGhpcy5fdGlja1NjaGVkdWxlZCA9ICEwLCBuLmRlbGF5KHRoaXMuX3RpY2tBbmRSZXBlYXQsIFtdLCB0aGlzKSksICEwKTsKCSAgICAgIH0sIHMucHJvdG90eXBlLl90aWNrQW5kUmVwZWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aGlzLl90aWNrU2NoZWR1bGVkID0gITEsIHRoaXMuaXNQYXVzZWQgfHwgdGhpcy5pc0ZpbmlzaGVkIHx8ICh0aGlzLl90aWNrKCksIHRoaXMuaXNGaW5pc2hlZCB8fCAobi5kZWxheSh0aGlzLl90aWNrQW5kUmVwZWF0LCBbXSwgdGhpcyksIHRoaXMuX3RpY2tTY2hlZHVsZWQgPSAhMCkpOwoJICAgICAgfSwgcy5wcm90b3R5cGUuX3RpY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLmlzUGF1c2VkIHx8IHRoaXMuaXNGaW5pc2hlZCkgcmV0dXJuICExOwoJICAgICAgICB2YXIgZSA9IG51bGwsCgkgICAgICAgICAgdCA9IE1hdGgubWluKHRoaXMubWF4LCB0aGlzLmluZGV4ICsgMTYzODQpOwoJICAgICAgICBpZiAodGhpcy5pbmRleCA+PSB0aGlzLm1heCkgcmV0dXJuIHRoaXMuZW5kKCk7CgkgICAgICAgIHN3aXRjaCAodGhpcy50eXBlKSB7CgkgICAgICAgICAgY2FzZSAic3RyaW5nIjoKCSAgICAgICAgICAgIGUgPSB0aGlzLmRhdGEuc3Vic3RyaW5nKHRoaXMuaW5kZXgsIHQpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgY2FzZSAidWludDhhcnJheSI6CgkgICAgICAgICAgICBlID0gdGhpcy5kYXRhLnN1YmFycmF5KHRoaXMuaW5kZXgsIHQpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgY2FzZSAiYXJyYXkiOgoJICAgICAgICAgIGNhc2UgIm5vZGVidWZmZXIiOgoJICAgICAgICAgICAgZSA9IHRoaXMuZGF0YS5zbGljZSh0aGlzLmluZGV4LCB0KTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5pbmRleCA9IHQsIHRoaXMucHVzaCh7CgkgICAgICAgICAgZGF0YTogZSwKCSAgICAgICAgICBtZXRhOiB7CgkgICAgICAgICAgICBwZXJjZW50OiB0aGlzLm1heCA/IHRoaXMuaW5kZXggLyB0aGlzLm1heCAqIDEwMCA6IDAKCSAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgICAgfSwgdC5leHBvcnRzID0gczsKCSAgICB9LCB7CgkgICAgICAiLi4vdXRpbHMiOiAzMiwKCSAgICAgICIuL0dlbmVyaWNXb3JrZXIiOiAyOAoJICAgIH1dLAoJICAgIDI4OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICBmdW5jdGlvbiBuKGUpIHsKCSAgICAgICAgdGhpcy5uYW1lID0gZSB8fCAiZGVmYXVsdCIsIHRoaXMuc3RyZWFtSW5mbyA9IHt9LCB0aGlzLmdlbmVyYXRlZEVycm9yID0gbnVsbCwgdGhpcy5leHRyYVN0cmVhbUluZm8gPSB7fSwgdGhpcy5pc1BhdXNlZCA9ICEwLCB0aGlzLmlzRmluaXNoZWQgPSAhMSwgdGhpcy5pc0xvY2tlZCA9ICExLCB0aGlzLl9saXN0ZW5lcnMgPSB7CgkgICAgICAgICAgZGF0YTogW10sCgkgICAgICAgICAgZW5kOiBbXSwKCSAgICAgICAgICBlcnJvcjogW10KCSAgICAgICAgfSwgdGhpcy5wcmV2aW91cyA9IG51bGw7CgkgICAgICB9CgkgICAgICBuLnByb3RvdHlwZSA9IHsKCSAgICAgICAgcHVzaDogZnVuY3Rpb24gcHVzaChlKSB7CgkgICAgICAgICAgdGhpcy5lbWl0KCJkYXRhIiwgZSk7CgkgICAgICAgIH0sCgkgICAgICAgIGVuZDogZnVuY3Rpb24gZW5kKCkgewoJICAgICAgICAgIGlmICh0aGlzLmlzRmluaXNoZWQpIHJldHVybiAhMTsKCSAgICAgICAgICB0aGlzLmZsdXNoKCk7CgkgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMuZW1pdCgiZW5kIiksIHRoaXMuY2xlYW5VcCgpLCB0aGlzLmlzRmluaXNoZWQgPSAhMDsKCSAgICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgICB0aGlzLmVtaXQoImVycm9yIiwgZSk7CgkgICAgICAgICAgfQoJICAgICAgICAgIHJldHVybiAhMDsKCSAgICAgICAgfSwKCSAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKGUpIHsKCSAgICAgICAgICByZXR1cm4gIXRoaXMuaXNGaW5pc2hlZCAmJiAodGhpcy5pc1BhdXNlZCA/IHRoaXMuZ2VuZXJhdGVkRXJyb3IgPSBlIDogKHRoaXMuaXNGaW5pc2hlZCA9ICEwLCB0aGlzLmVtaXQoImVycm9yIiwgZSksIHRoaXMucHJldmlvdXMgJiYgdGhpcy5wcmV2aW91cy5lcnJvcihlKSwgdGhpcy5jbGVhblVwKCkpLCAhMCk7CgkgICAgICAgIH0sCgkgICAgICAgIG9uOiBmdW5jdGlvbiBvbihlLCB0KSB7CgkgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3RlbmVyc1tlXS5wdXNoKHQpLCB0aGlzOwoJICAgICAgICB9LAoJICAgICAgICBjbGVhblVwOiBmdW5jdGlvbiBjbGVhblVwKCkgewoJICAgICAgICAgIHRoaXMuc3RyZWFtSW5mbyA9IHRoaXMuZ2VuZXJhdGVkRXJyb3IgPSB0aGlzLmV4dHJhU3RyZWFtSW5mbyA9IG51bGwsIHRoaXMuX2xpc3RlbmVycyA9IFtdOwoJICAgICAgICB9LAoJICAgICAgICBlbWl0OiBmdW5jdGlvbiBlbWl0KGUsIHQpIHsKCSAgICAgICAgICBpZiAodGhpcy5fbGlzdGVuZXJzW2VdKSBmb3IgKHZhciByID0gMDsgciA8IHRoaXMuX2xpc3RlbmVyc1tlXS5sZW5ndGg7IHIrKykgdGhpcy5fbGlzdGVuZXJzW2VdW3JdLmNhbGwodGhpcywgdCk7CgkgICAgICAgIH0sCgkgICAgICAgIHBpcGU6IGZ1bmN0aW9uIHBpcGUoZSkgewoJICAgICAgICAgIHJldHVybiBlLnJlZ2lzdGVyUHJldmlvdXModGhpcyk7CgkgICAgICAgIH0sCgkgICAgICAgIHJlZ2lzdGVyUHJldmlvdXM6IGZ1bmN0aW9uIHJlZ2lzdGVyUHJldmlvdXMoZSkgewoJICAgICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKSB0aHJvdyBuZXcgRXJyb3IoIlRoZSBzdHJlYW0gJyIgKyB0aGlzICsgIicgaGFzIGFscmVhZHkgYmVlbiB1c2VkLiIpOwoJICAgICAgICAgIHRoaXMuc3RyZWFtSW5mbyA9IGUuc3RyZWFtSW5mbywgdGhpcy5tZXJnZVN0cmVhbUluZm8oKSwgdGhpcy5wcmV2aW91cyA9IGU7CgkgICAgICAgICAgdmFyIHQgPSB0aGlzOwoJICAgICAgICAgIHJldHVybiBlLm9uKCJkYXRhIiwgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgIHQucHJvY2Vzc0NodW5rKGUpOwoJICAgICAgICAgIH0pLCBlLm9uKCJlbmQiLCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICB0LmVuZCgpOwoJICAgICAgICAgIH0pLCBlLm9uKCJlcnJvciIsIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICB0LmVycm9yKGUpOwoJICAgICAgICAgIH0pLCB0aGlzOwoJICAgICAgICB9LAoJICAgICAgICBwYXVzZTogZnVuY3Rpb24gcGF1c2UoKSB7CgkgICAgICAgICAgcmV0dXJuICF0aGlzLmlzUGF1c2VkICYmICF0aGlzLmlzRmluaXNoZWQgJiYgKHRoaXMuaXNQYXVzZWQgPSAhMCwgdGhpcy5wcmV2aW91cyAmJiB0aGlzLnByZXZpb3VzLnBhdXNlKCksICEwKTsKCSAgICAgICAgfSwKCSAgICAgICAgcmVzdW1lOiBmdW5jdGlvbiByZXN1bWUoKSB7CgkgICAgICAgICAgaWYgKCF0aGlzLmlzUGF1c2VkIHx8IHRoaXMuaXNGaW5pc2hlZCkgcmV0dXJuICExOwoJICAgICAgICAgIHZhciBlID0gdGhpcy5pc1BhdXNlZCA9ICExOwoJICAgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlZEVycm9yICYmICh0aGlzLmVycm9yKHRoaXMuZ2VuZXJhdGVkRXJyb3IpLCBlID0gITApLCB0aGlzLnByZXZpb3VzICYmIHRoaXMucHJldmlvdXMucmVzdW1lKCksICFlOwoJICAgICAgICB9LAoJICAgICAgICBmbHVzaDogZnVuY3Rpb24gZmx1c2goKSB7fSwKCSAgICAgICAgcHJvY2Vzc0NodW5rOiBmdW5jdGlvbiBwcm9jZXNzQ2h1bmsoZSkgewoJICAgICAgICAgIHRoaXMucHVzaChlKTsKCSAgICAgICAgfSwKCSAgICAgICAgd2l0aFN0cmVhbUluZm86IGZ1bmN0aW9uIHdpdGhTdHJlYW1JbmZvKGUsIHQpIHsKCSAgICAgICAgICByZXR1cm4gdGhpcy5leHRyYVN0cmVhbUluZm9bZV0gPSB0LCB0aGlzLm1lcmdlU3RyZWFtSW5mbygpLCB0aGlzOwoJICAgICAgICB9LAoJICAgICAgICBtZXJnZVN0cmVhbUluZm86IGZ1bmN0aW9uIG1lcmdlU3RyZWFtSW5mbygpIHsKCSAgICAgICAgICBmb3IgKHZhciBlIGluIHRoaXMuZXh0cmFTdHJlYW1JbmZvKSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5leHRyYVN0cmVhbUluZm8sIGUpICYmICh0aGlzLnN0cmVhbUluZm9bZV0gPSB0aGlzLmV4dHJhU3RyZWFtSW5mb1tlXSk7CgkgICAgICAgIH0sCgkgICAgICAgIGxvY2s6IGZ1bmN0aW9uIGxvY2soKSB7CgkgICAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQpIHRocm93IG5ldyBFcnJvcigiVGhlIHN0cmVhbSAnIiArIHRoaXMgKyAiJyBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuIik7CgkgICAgICAgICAgdGhpcy5pc0xvY2tlZCA9ICEwLCB0aGlzLnByZXZpb3VzICYmIHRoaXMucHJldmlvdXMubG9jaygpOwoJICAgICAgICB9LAoJICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CgkgICAgICAgICAgdmFyIGUgPSAiV29ya2VyICIgKyB0aGlzLm5hbWU7CgkgICAgICAgICAgcmV0dXJuIHRoaXMucHJldmlvdXMgPyB0aGlzLnByZXZpb3VzICsgIiAtPiAiICsgZSA6IGU7CgkgICAgICAgIH0KCSAgICAgIH0sIHQuZXhwb3J0cyA9IG47CgkgICAgfSwge31dLAoJICAgIDI5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgaCA9IGUoIi4uL3V0aWxzIiksCgkgICAgICAgIGkgPSBlKCIuL0NvbnZlcnRXb3JrZXIiKSwKCSAgICAgICAgcyA9IGUoIi4vR2VuZXJpY1dvcmtlciIpLAoJICAgICAgICB1ID0gZSgiLi4vYmFzZTY0IiksCgkgICAgICAgIG4gPSBlKCIuLi9zdXBwb3J0IiksCgkgICAgICAgIGEgPSBlKCIuLi9leHRlcm5hbCIpLAoJICAgICAgICBvID0gbnVsbDsKCSAgICAgIGlmIChuLm5vZGVzdHJlYW0pIHRyeSB7CgkgICAgICAgIG8gPSBlKCIuLi9ub2RlanMvTm9kZWpzU3RyZWFtT3V0cHV0QWRhcHRlciIpOwoJICAgICAgfSBjYXRjaCAoZSkge30KCSAgICAgIGZ1bmN0aW9uIGwoZSwgbykgewoJICAgICAgICByZXR1cm4gbmV3IGEuUHJvbWlzZShmdW5jdGlvbiAodCwgcikgewoJICAgICAgICAgIHZhciBuID0gW10sCgkgICAgICAgICAgICBpID0gZS5faW50ZXJuYWxUeXBlLAoJICAgICAgICAgICAgcyA9IGUuX291dHB1dFR5cGUsCgkgICAgICAgICAgICBhID0gZS5fbWltZVR5cGU7CgkgICAgICAgICAgZS5vbigiZGF0YSIsIGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgICAgICBuLnB1c2goZSksIG8gJiYgbyh0KTsKCSAgICAgICAgICB9KS5vbigiZXJyb3IiLCBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgICAgbiA9IFtdLCByKGUpOwoJICAgICAgICAgIH0pLm9uKCJlbmQiLCBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICB2YXIgZSA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CgkgICAgICAgICAgICAgICAgc3dpdGNoIChlKSB7CgkgICAgICAgICAgICAgICAgICBjYXNlICJibG9iIjoKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGgubmV3QmxvYihoLnRyYW5zZm9ybVRvKCJhcnJheWJ1ZmZlciIsIHQpLCByKTsKCSAgICAgICAgICAgICAgICAgIGNhc2UgImJhc2U2NCI6CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB1LmVuY29kZSh0KTsKCSAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBoLnRyYW5zZm9ybVRvKGUsIHQpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgfShzLCBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICAgICAgICAgIHZhciByLAoJICAgICAgICAgICAgICAgICAgbiA9IDAsCgkgICAgICAgICAgICAgICAgICBpID0gbnVsbCwKCSAgICAgICAgICAgICAgICAgIHMgPSAwOwoJICAgICAgICAgICAgICAgIGZvciAociA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSBzICs9IHRbcl0ubGVuZ3RoOwoJICAgICAgICAgICAgICAgIHN3aXRjaCAoZSkgewoJICAgICAgICAgICAgICAgICAgY2FzZSAic3RyaW5nIjoKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuam9pbigiIik7CgkgICAgICAgICAgICAgICAgICBjYXNlICJhcnJheSI6CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCB0KTsKCSAgICAgICAgICAgICAgICAgIGNhc2UgInVpbnQ4YXJyYXkiOgoJICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBuZXcgVWludDhBcnJheShzKSwgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSBpLnNldCh0W3JdLCBuKSwgbiArPSB0W3JdLmxlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7CgkgICAgICAgICAgICAgICAgICBjYXNlICJub2RlYnVmZmVyIjoKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEJ1ZmZlci5jb25jYXQodCk7CgkgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoImNvbmNhdCA6IHVuc3VwcG9ydGVkIHR5cGUgJyIgKyBlICsgIiciKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIH0oaSwgbiksIGEpOwoJICAgICAgICAgICAgICB0KGUpOwoJICAgICAgICAgICAgfSBjYXRjaCAoZSkgewoJICAgICAgICAgICAgICByKGUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbiA9IFtdOwoJICAgICAgICAgIH0pLnJlc3VtZSgpOwoJICAgICAgICB9KTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIGYoZSwgdCwgcikgewoJICAgICAgICB2YXIgbiA9IHQ7CgkgICAgICAgIHN3aXRjaCAodCkgewoJICAgICAgICAgIGNhc2UgImJsb2IiOgoJICAgICAgICAgIGNhc2UgImFycmF5YnVmZmVyIjoKCSAgICAgICAgICAgIG4gPSAidWludDhhcnJheSI7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICBjYXNlICJiYXNlNjQiOgoJICAgICAgICAgICAgbiA9ICJzdHJpbmciOwoJICAgICAgICB9CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgdGhpcy5faW50ZXJuYWxUeXBlID0gbiwgdGhpcy5fb3V0cHV0VHlwZSA9IHQsIHRoaXMuX21pbWVUeXBlID0gciwgaC5jaGVja1N1cHBvcnQobiksIHRoaXMuX3dvcmtlciA9IGUucGlwZShuZXcgaShuKSksIGUubG9jaygpOwoJICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgdGhpcy5fd29ya2VyID0gbmV3IHMoImVycm9yIiksIHRoaXMuX3dvcmtlci5lcnJvcihlKTsKCSAgICAgICAgfQoJICAgICAgfQoJICAgICAgZi5wcm90b3R5cGUgPSB7CgkgICAgICAgIGFjY3VtdWxhdGU6IGZ1bmN0aW9uIGFjY3VtdWxhdGUoZSkgewoJICAgICAgICAgIHJldHVybiBsKHRoaXMsIGUpOwoJICAgICAgICB9LAoJICAgICAgICBvbjogZnVuY3Rpb24gb24oZSwgdCkgewoJICAgICAgICAgIHZhciByID0gdGhpczsKCSAgICAgICAgICByZXR1cm4gImRhdGEiID09PSBlID8gdGhpcy5fd29ya2VyLm9uKGUsIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICB0LmNhbGwociwgZS5kYXRhLCBlLm1ldGEpOwoJICAgICAgICAgIH0pIDogdGhpcy5fd29ya2VyLm9uKGUsIGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGguZGVsYXkodCwgYXJndW1lbnRzLCByKTsKCSAgICAgICAgICB9KSwgdGhpczsKCSAgICAgICAgfSwKCSAgICAgICAgcmVzdW1lOiBmdW5jdGlvbiByZXN1bWUoKSB7CgkgICAgICAgICAgcmV0dXJuIGguZGVsYXkodGhpcy5fd29ya2VyLnJlc3VtZSwgW10sIHRoaXMuX3dvcmtlciksIHRoaXM7CgkgICAgICAgIH0sCgkgICAgICAgIHBhdXNlOiBmdW5jdGlvbiBwYXVzZSgpIHsKCSAgICAgICAgICByZXR1cm4gdGhpcy5fd29ya2VyLnBhdXNlKCksIHRoaXM7CgkgICAgICAgIH0sCgkgICAgICAgIHRvTm9kZWpzU3RyZWFtOiBmdW5jdGlvbiB0b05vZGVqc1N0cmVhbShlKSB7CgkgICAgICAgICAgaWYgKGguY2hlY2tTdXBwb3J0KCJub2Rlc3RyZWFtIiksICJub2RlYnVmZmVyIiAhPT0gdGhpcy5fb3V0cHV0VHlwZSkgdGhyb3cgbmV3IEVycm9yKHRoaXMuX291dHB1dFR5cGUgKyAiIGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhpcyBtZXRob2QiKTsKCSAgICAgICAgICByZXR1cm4gbmV3IG8odGhpcywgewoJICAgICAgICAgICAgb2JqZWN0TW9kZTogIm5vZGVidWZmZXIiICE9PSB0aGlzLl9vdXRwdXRUeXBlCgkgICAgICAgICAgfSwgZSk7CgkgICAgICAgIH0KCSAgICAgIH0sIHQuZXhwb3J0cyA9IGY7CgkgICAgfSwgewoJICAgICAgIi4uL2Jhc2U2NCI6IDEsCgkgICAgICAiLi4vZXh0ZXJuYWwiOiA2LAoJICAgICAgIi4uL25vZGVqcy9Ob2RlanNTdHJlYW1PdXRwdXRBZGFwdGVyIjogMTMsCgkgICAgICAiLi4vc3VwcG9ydCI6IDMwLAoJICAgICAgIi4uL3V0aWxzIjogMzIsCgkgICAgICAiLi9Db252ZXJ0V29ya2VyIjogMjQsCgkgICAgICAiLi9HZW5lcmljV29ya2VyIjogMjgKCSAgICB9XSwKCSAgICAzMDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgaWYgKHIuYmFzZTY0ID0gITAsIHIuYXJyYXkgPSAhMCwgci5zdHJpbmcgPSAhMCwgci5hcnJheWJ1ZmZlciA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBBcnJheUJ1ZmZlciAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgVWludDhBcnJheSwgci5ub2RlYnVmZmVyID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIEJ1ZmZlciwgci51aW50OGFycmF5ID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIFVpbnQ4QXJyYXksICJ1bmRlZmluZWQiID09IHR5cGVvZiBBcnJheUJ1ZmZlcikgci5ibG9iID0gITE7ZWxzZSB7CgkgICAgICAgIHZhciBuID0gbmV3IEFycmF5QnVmZmVyKDApOwoJICAgICAgICB0cnkgewoJICAgICAgICAgIHIuYmxvYiA9IDAgPT09IG5ldyBCbG9iKFtuXSwgewoJICAgICAgICAgICAgdHlwZTogImFwcGxpY2F0aW9uL3ppcCIKCSAgICAgICAgICB9KS5zaXplOwoJICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHZhciBpID0gbmV3IChzZWxmLkJsb2JCdWlsZGVyIHx8IHNlbGYuV2ViS2l0QmxvYkJ1aWxkZXIgfHwgc2VsZi5Nb3pCbG9iQnVpbGRlciB8fCBzZWxmLk1TQmxvYkJ1aWxkZXIpKCk7CgkgICAgICAgICAgICBpLmFwcGVuZChuKSwgci5ibG9iID0gMCA9PT0gaS5nZXRCbG9iKCJhcHBsaWNhdGlvbi96aXAiKS5zaXplOwoJICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgICAgIHIuYmxvYiA9ICExOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgfQoJICAgICAgdHJ5IHsKCSAgICAgICAgci5ub2Rlc3RyZWFtID0gISFlKCJyZWFkYWJsZS1zdHJlYW0iKS5SZWFkYWJsZTsKCSAgICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgci5ub2Rlc3RyZWFtID0gITE7CgkgICAgICB9CgkgICAgfSwgewoJICAgICAgInJlYWRhYmxlLXN0cmVhbSI6IDE2CgkgICAgfV0sCgkgICAgMzE6IFtmdW5jdGlvbiAoZSwgdCwgcykgewoKCSAgICAgIGZvciAodmFyIG8gPSBlKCIuL3V0aWxzIiksIGggPSBlKCIuL3N1cHBvcnQiKSwgciA9IGUoIi4vbm9kZWpzVXRpbHMiKSwgbiA9IGUoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKSwgdSA9IG5ldyBBcnJheSgyNTYpLCBpID0gMDsgaSA8IDI1NjsgaSsrKSB1W2ldID0gMjUyIDw9IGkgPyA2IDogMjQ4IDw9IGkgPyA1IDogMjQwIDw9IGkgPyA0IDogMjI0IDw9IGkgPyAzIDogMTkyIDw9IGkgPyAyIDogMTsKCSAgICAgIHVbMjU0XSA9IHVbMjU0XSA9IDE7CgkgICAgICBmdW5jdGlvbiBhKCkgewoJICAgICAgICBuLmNhbGwodGhpcywgInV0Zi04IGRlY29kZSIpLCB0aGlzLmxlZnRPdmVyID0gbnVsbDsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIGwoKSB7CgkgICAgICAgIG4uY2FsbCh0aGlzLCAidXRmLTggZW5jb2RlIik7CgkgICAgICB9CgkgICAgICBzLnV0ZjhlbmNvZGUgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICByZXR1cm4gaC5ub2RlYnVmZmVyID8gci5uZXdCdWZmZXJGcm9tKGUsICJ1dGYtOCIpIDogZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICB2YXIgdCwKCSAgICAgICAgICAgIHIsCgkgICAgICAgICAgICBuLAoJICAgICAgICAgICAgaSwKCSAgICAgICAgICAgIHMsCgkgICAgICAgICAgICBhID0gZS5sZW5ndGgsCgkgICAgICAgICAgICBvID0gMDsKCSAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYTsgaSsrKSA1NTI5NiA9PSAoNjQ1MTIgJiAociA9IGUuY2hhckNvZGVBdChpKSkpICYmIGkgKyAxIDwgYSAmJiA1NjMyMCA9PSAoNjQ1MTIgJiAobiA9IGUuY2hhckNvZGVBdChpICsgMSkpKSAmJiAociA9IDY1NTM2ICsgKHIgLSA1NTI5NiA8PCAxMCkgKyAobiAtIDU2MzIwKSwgaSsrKSwgbyArPSByIDwgMTI4ID8gMSA6IHIgPCAyMDQ4ID8gMiA6IHIgPCA2NTUzNiA/IDMgOiA0OwoJICAgICAgICAgIGZvciAodCA9IGgudWludDhhcnJheSA/IG5ldyBVaW50OEFycmF5KG8pIDogbmV3IEFycmF5KG8pLCBpID0gcyA9IDA7IHMgPCBvOyBpKyspIDU1Mjk2ID09ICg2NDUxMiAmIChyID0gZS5jaGFyQ29kZUF0KGkpKSkgJiYgaSArIDEgPCBhICYmIDU2MzIwID09ICg2NDUxMiAmIChuID0gZS5jaGFyQ29kZUF0KGkgKyAxKSkpICYmIChyID0gNjU1MzYgKyAociAtIDU1Mjk2IDw8IDEwKSArIChuIC0gNTYzMjApLCBpKyspLCByIDwgMTI4ID8gdFtzKytdID0gciA6IChyIDwgMjA0OCA/IHRbcysrXSA9IDE5MiB8IHIgPj4+IDYgOiAociA8IDY1NTM2ID8gdFtzKytdID0gMjI0IHwgciA+Pj4gMTIgOiAodFtzKytdID0gMjQwIHwgciA+Pj4gMTgsIHRbcysrXSA9IDEyOCB8IHIgPj4+IDEyICYgNjMpLCB0W3MrK10gPSAxMjggfCByID4+PiA2ICYgNjMpLCB0W3MrK10gPSAxMjggfCA2MyAmIHIpOwoJICAgICAgICAgIHJldHVybiB0OwoJICAgICAgICB9KGUpOwoJICAgICAgfSwgcy51dGY4ZGVjb2RlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgcmV0dXJuIGgubm9kZWJ1ZmZlciA/IG8udHJhbnNmb3JtVG8oIm5vZGVidWZmZXIiLCBlKS50b1N0cmluZygidXRmLTgiKSA6IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdmFyIHQsCgkgICAgICAgICAgICByLAoJICAgICAgICAgICAgbiwKCSAgICAgICAgICAgIGksCgkgICAgICAgICAgICBzID0gZS5sZW5ndGgsCgkgICAgICAgICAgICBhID0gbmV3IEFycmF5KDIgKiBzKTsKCSAgICAgICAgICBmb3IgKHQgPSByID0gMDsgdCA8IHM7KSBpZiAoKG4gPSBlW3QrK10pIDwgMTI4KSBhW3IrK10gPSBuO2Vsc2UgaWYgKDQgPCAoaSA9IHVbbl0pKSBhW3IrK10gPSA2NTUzMywgdCArPSBpIC0gMTtlbHNlIHsKCSAgICAgICAgICAgIGZvciAobiAmPSAyID09PSBpID8gMzEgOiAzID09PSBpID8gMTUgOiA3OyAxIDwgaSAmJiB0IDwgczspIG4gPSBuIDw8IDYgfCA2MyAmIGVbdCsrXSwgaS0tOwoJICAgICAgICAgICAgMSA8IGkgPyBhW3IrK10gPSA2NTUzMyA6IG4gPCA2NTUzNiA/IGFbcisrXSA9IG4gOiAobiAtPSA2NTUzNiwgYVtyKytdID0gNTUyOTYgfCBuID4+IDEwICYgMTAyMywgYVtyKytdID0gNTYzMjAgfCAxMDIzICYgbik7CgkgICAgICAgICAgfQoJICAgICAgICAgIHJldHVybiBhLmxlbmd0aCAhPT0gciAmJiAoYS5zdWJhcnJheSA/IGEgPSBhLnN1YmFycmF5KDAsIHIpIDogYS5sZW5ndGggPSByKSwgby5hcHBseUZyb21DaGFyQ29kZShhKTsKCSAgICAgICAgfShlID0gby50cmFuc2Zvcm1UbyhoLnVpbnQ4YXJyYXkgPyAidWludDhhcnJheSIgOiAiYXJyYXkiLCBlKSk7CgkgICAgICB9LCBvLmluaGVyaXRzKGEsIG4pLCBhLnByb3RvdHlwZS5wcm9jZXNzQ2h1bmsgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICB2YXIgdCA9IG8udHJhbnNmb3JtVG8oaC51aW50OGFycmF5ID8gInVpbnQ4YXJyYXkiIDogImFycmF5IiwgZS5kYXRhKTsKCSAgICAgICAgaWYgKHRoaXMubGVmdE92ZXIgJiYgdGhpcy5sZWZ0T3Zlci5sZW5ndGgpIHsKCSAgICAgICAgICBpZiAoaC51aW50OGFycmF5KSB7CgkgICAgICAgICAgICB2YXIgciA9IHQ7CgkgICAgICAgICAgICAodCA9IG5ldyBVaW50OEFycmF5KHIubGVuZ3RoICsgdGhpcy5sZWZ0T3Zlci5sZW5ndGgpKS5zZXQodGhpcy5sZWZ0T3ZlciwgMCksIHQuc2V0KHIsIHRoaXMubGVmdE92ZXIubGVuZ3RoKTsKCSAgICAgICAgICB9IGVsc2UgdCA9IHRoaXMubGVmdE92ZXIuY29uY2F0KHQpOwoJICAgICAgICAgIHRoaXMubGVmdE92ZXIgPSBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgICAgIHZhciByOwoJICAgICAgICAgICAgZm9yICgodCA9IHQgfHwgZS5sZW5ndGgpID4gZS5sZW5ndGggJiYgKHQgPSBlLmxlbmd0aCksIHIgPSB0IC0gMTsgMCA8PSByICYmIDEyOCA9PSAoMTkyICYgZVtyXSk7KSByLS07CgkgICAgICAgICAgICByZXR1cm4gciA8IDAgPyB0IDogMCA9PT0gciA/IHQgOiByICsgdVtlW3JdXSA+IHQgPyByIDogdDsKCSAgICAgICAgICB9KHQpLAoJICAgICAgICAgIGkgPSB0OwoJICAgICAgICBuICE9PSB0Lmxlbmd0aCAmJiAoaC51aW50OGFycmF5ID8gKGkgPSB0LnN1YmFycmF5KDAsIG4pLCB0aGlzLmxlZnRPdmVyID0gdC5zdWJhcnJheShuLCB0Lmxlbmd0aCkpIDogKGkgPSB0LnNsaWNlKDAsIG4pLCB0aGlzLmxlZnRPdmVyID0gdC5zbGljZShuLCB0Lmxlbmd0aCkpKSwgdGhpcy5wdXNoKHsKCSAgICAgICAgICBkYXRhOiBzLnV0ZjhkZWNvZGUoaSksCgkgICAgICAgICAgbWV0YTogZS5tZXRhCgkgICAgICAgIH0pOwoJICAgICAgfSwgYS5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMubGVmdE92ZXIgJiYgdGhpcy5sZWZ0T3Zlci5sZW5ndGggJiYgKHRoaXMucHVzaCh7CgkgICAgICAgICAgZGF0YTogcy51dGY4ZGVjb2RlKHRoaXMubGVmdE92ZXIpLAoJICAgICAgICAgIG1ldGE6IHt9CgkgICAgICAgIH0pLCB0aGlzLmxlZnRPdmVyID0gbnVsbCk7CgkgICAgICB9LCBzLlV0ZjhEZWNvZGVXb3JrZXIgPSBhLCBvLmluaGVyaXRzKGwsIG4pLCBsLnByb3RvdHlwZS5wcm9jZXNzQ2h1bmsgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICB0aGlzLnB1c2goewoJICAgICAgICAgIGRhdGE6IHMudXRmOGVuY29kZShlLmRhdGEpLAoJICAgICAgICAgIG1ldGE6IGUubWV0YQoJICAgICAgICB9KTsKCSAgICAgIH0sIHMuVXRmOEVuY29kZVdvcmtlciA9IGw7CgkgICAgfSwgewoJICAgICAgIi4vbm9kZWpzVXRpbHMiOiAxNCwKCSAgICAgICIuL3N0cmVhbS9HZW5lcmljV29ya2VyIjogMjgsCgkgICAgICAiLi9zdXBwb3J0IjogMzAsCgkgICAgICAiLi91dGlscyI6IDMyCgkgICAgfV0sCgkgICAgMzI6IFtmdW5jdGlvbiAoZSwgdCwgYSkgewoKCSAgICAgIHZhciBvID0gZSgiLi9zdXBwb3J0IiksCgkgICAgICAgIGggPSBlKCIuL2Jhc2U2NCIpLAoJICAgICAgICByID0gZSgiLi9ub2RlanNVdGlscyIpLAoJICAgICAgICB1ID0gZSgiLi9leHRlcm5hbCIpOwoJICAgICAgZnVuY3Rpb24gbihlKSB7CgkgICAgICAgIHJldHVybiBlOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gbChlLCB0KSB7CgkgICAgICAgIGZvciAodmFyIHIgPSAwOyByIDwgZS5sZW5ndGg7ICsrcikgdFtyXSA9IDI1NSAmIGUuY2hhckNvZGVBdChyKTsKCSAgICAgICAgcmV0dXJuIHQ7CgkgICAgICB9CgkgICAgICBlKCJzZXRpbW1lZGlhdGUiKSwgYS5uZXdCbG9iID0gZnVuY3Rpb24gKHQsIHIpIHsKCSAgICAgICAgYS5jaGVja1N1cHBvcnQoImJsb2IiKTsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICByZXR1cm4gbmV3IEJsb2IoW3RdLCB7CgkgICAgICAgICAgICB0eXBlOiByCgkgICAgICAgICAgfSk7CgkgICAgICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgdmFyIG4gPSBuZXcgKHNlbGYuQmxvYkJ1aWxkZXIgfHwgc2VsZi5XZWJLaXRCbG9iQnVpbGRlciB8fCBzZWxmLk1vekJsb2JCdWlsZGVyIHx8IHNlbGYuTVNCbG9iQnVpbGRlcikoKTsKCSAgICAgICAgICAgIHJldHVybiBuLmFwcGVuZCh0KSwgbi5nZXRCbG9iKHIpOwoJICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQnVnIDogY2FuJ3QgY29uc3RydWN0IHRoZSBCbG9iLiIpOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgfTsKCSAgICAgIHZhciBpID0gewoJICAgICAgICBzdHJpbmdpZnlCeUNodW5rOiBmdW5jdGlvbiBzdHJpbmdpZnlCeUNodW5rKGUsIHQsIHIpIHsKCSAgICAgICAgICB2YXIgbiA9IFtdLAoJICAgICAgICAgICAgaSA9IDAsCgkgICAgICAgICAgICBzID0gZS5sZW5ndGg7CgkgICAgICAgICAgaWYgKHMgPD0gcikgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgZSk7CgkgICAgICAgICAgZm9yICg7IGkgPCBzOykgImFycmF5IiA9PT0gdCB8fCAibm9kZWJ1ZmZlciIgPT09IHQgPyBuLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBlLnNsaWNlKGksIE1hdGgubWluKGkgKyByLCBzKSkpKSA6IG4ucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGUuc3ViYXJyYXkoaSwgTWF0aC5taW4oaSArIHIsIHMpKSkpLCBpICs9IHI7CgkgICAgICAgICAgcmV0dXJuIG4uam9pbigiIik7CgkgICAgICAgIH0sCgkgICAgICAgIHN0cmluZ2lmeUJ5Q2hhcjogZnVuY3Rpb24gc3RyaW5naWZ5QnlDaGFyKGUpIHsKCSAgICAgICAgICBmb3IgKHZhciB0ID0gIiIsIHIgPSAwOyByIDwgZS5sZW5ndGg7IHIrKykgdCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGVbcl0pOwoJICAgICAgICAgIHJldHVybiB0OwoJICAgICAgICB9LAoJICAgICAgICBhcHBseUNhbkJlVXNlZDogewoJICAgICAgICAgIHVpbnQ4YXJyYXk6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgIHJldHVybiBvLnVpbnQ4YXJyYXkgJiYgMSA9PT0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBuZXcgVWludDhBcnJheSgxKSkubGVuZ3RoOwoJICAgICAgICAgICAgfSBjYXRjaCAoZSkgewoJICAgICAgICAgICAgICByZXR1cm4gITE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgfSgpLAoJICAgICAgICAgIG5vZGVidWZmZXI6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgIHJldHVybiBvLm5vZGVidWZmZXIgJiYgMSA9PT0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCByLmFsbG9jQnVmZmVyKDEpKS5sZW5ndGg7CgkgICAgICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgICAgIHJldHVybiAhMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9KCkKCSAgICAgICAgfQoJICAgICAgfTsKCSAgICAgIGZ1bmN0aW9uIHMoZSkgewoJICAgICAgICB2YXIgdCA9IDY1NTM2LAoJICAgICAgICAgIHIgPSBhLmdldFR5cGVPZihlKSwKCSAgICAgICAgICBuID0gITA7CgkgICAgICAgIGlmICgidWludDhhcnJheSIgPT09IHIgPyBuID0gaS5hcHBseUNhbkJlVXNlZC51aW50OGFycmF5IDogIm5vZGVidWZmZXIiID09PSByICYmIChuID0gaS5hcHBseUNhbkJlVXNlZC5ub2RlYnVmZmVyKSwgbikgZm9yICg7IDEgPCB0OykgdHJ5IHsKCSAgICAgICAgICByZXR1cm4gaS5zdHJpbmdpZnlCeUNodW5rKGUsIHIsIHQpOwoJICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgdCA9IE1hdGguZmxvb3IodCAvIDIpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpLnN0cmluZ2lmeUJ5Q2hhcihlKTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIGYoZSwgdCkgewoJICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IGUubGVuZ3RoOyByKyspIHRbcl0gPSBlW3JdOwoJICAgICAgICByZXR1cm4gdDsKCSAgICAgIH0KCSAgICAgIGEuYXBwbHlGcm9tQ2hhckNvZGUgPSBzOwoJICAgICAgdmFyIGMgPSB7fTsKCSAgICAgIGMuc3RyaW5nID0gewoJICAgICAgICBzdHJpbmc6IG4sCgkgICAgICAgIGFycmF5OiBmdW5jdGlvbiBhcnJheShlKSB7CgkgICAgICAgICAgcmV0dXJuIGwoZSwgbmV3IEFycmF5KGUubGVuZ3RoKSk7CgkgICAgICAgIH0sCgkgICAgICAgIGFycmF5YnVmZmVyOiBmdW5jdGlvbiBhcnJheWJ1ZmZlcihlKSB7CgkgICAgICAgICAgcmV0dXJuIGMuc3RyaW5nLnVpbnQ4YXJyYXkoZSkuYnVmZmVyOwoJICAgICAgICB9LAoJICAgICAgICB1aW50OGFycmF5OiBmdW5jdGlvbiB1aW50OGFycmF5KGUpIHsKCSAgICAgICAgICByZXR1cm4gbChlLCBuZXcgVWludDhBcnJheShlLmxlbmd0aCkpOwoJICAgICAgICB9LAoJICAgICAgICBub2RlYnVmZmVyOiBmdW5jdGlvbiBub2RlYnVmZmVyKGUpIHsKCSAgICAgICAgICByZXR1cm4gbChlLCByLmFsbG9jQnVmZmVyKGUubGVuZ3RoKSk7CgkgICAgICAgIH0KCSAgICAgIH0sIGMuYXJyYXkgPSB7CgkgICAgICAgIHN0cmluZzogcywKCSAgICAgICAgYXJyYXk6IG4sCgkgICAgICAgIGFycmF5YnVmZmVyOiBmdW5jdGlvbiBhcnJheWJ1ZmZlcihlKSB7CgkgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGUpLmJ1ZmZlcjsKCSAgICAgICAgfSwKCSAgICAgICAgdWludDhhcnJheTogZnVuY3Rpb24gdWludDhhcnJheShlKSB7CgkgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGUpOwoJICAgICAgICB9LAoJICAgICAgICBub2RlYnVmZmVyOiBmdW5jdGlvbiBub2RlYnVmZmVyKGUpIHsKCSAgICAgICAgICByZXR1cm4gci5uZXdCdWZmZXJGcm9tKGUpOwoJICAgICAgICB9CgkgICAgICB9LCBjLmFycmF5YnVmZmVyID0gewoJICAgICAgICBzdHJpbmc6IGZ1bmN0aW9uIHN0cmluZyhlKSB7CgkgICAgICAgICAgcmV0dXJuIHMobmV3IFVpbnQ4QXJyYXkoZSkpOwoJICAgICAgICB9LAoJICAgICAgICBhcnJheTogZnVuY3Rpb24gYXJyYXkoZSkgewoJICAgICAgICAgIHJldHVybiBmKG5ldyBVaW50OEFycmF5KGUpLCBuZXcgQXJyYXkoZS5ieXRlTGVuZ3RoKSk7CgkgICAgICAgIH0sCgkgICAgICAgIGFycmF5YnVmZmVyOiBuLAoJICAgICAgICB1aW50OGFycmF5OiBmdW5jdGlvbiB1aW50OGFycmF5KGUpIHsKCSAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoZSk7CgkgICAgICAgIH0sCgkgICAgICAgIG5vZGVidWZmZXI6IGZ1bmN0aW9uIG5vZGVidWZmZXIoZSkgewoJICAgICAgICAgIHJldHVybiByLm5ld0J1ZmZlckZyb20obmV3IFVpbnQ4QXJyYXkoZSkpOwoJICAgICAgICB9CgkgICAgICB9LCBjLnVpbnQ4YXJyYXkgPSB7CgkgICAgICAgIHN0cmluZzogcywKCSAgICAgICAgYXJyYXk6IGZ1bmN0aW9uIGFycmF5KGUpIHsKCSAgICAgICAgICByZXR1cm4gZihlLCBuZXcgQXJyYXkoZS5sZW5ndGgpKTsKCSAgICAgICAgfSwKCSAgICAgICAgYXJyYXlidWZmZXI6IGZ1bmN0aW9uIGFycmF5YnVmZmVyKGUpIHsKCSAgICAgICAgICByZXR1cm4gZS5idWZmZXI7CgkgICAgICAgIH0sCgkgICAgICAgIHVpbnQ4YXJyYXk6IG4sCgkgICAgICAgIG5vZGVidWZmZXI6IGZ1bmN0aW9uIG5vZGVidWZmZXIoZSkgewoJICAgICAgICAgIHJldHVybiByLm5ld0J1ZmZlckZyb20oZSk7CgkgICAgICAgIH0KCSAgICAgIH0sIGMubm9kZWJ1ZmZlciA9IHsKCSAgICAgICAgc3RyaW5nOiBzLAoJICAgICAgICBhcnJheTogZnVuY3Rpb24gYXJyYXkoZSkgewoJICAgICAgICAgIHJldHVybiBmKGUsIG5ldyBBcnJheShlLmxlbmd0aCkpOwoJICAgICAgICB9LAoJICAgICAgICBhcnJheWJ1ZmZlcjogZnVuY3Rpb24gYXJyYXlidWZmZXIoZSkgewoJICAgICAgICAgIHJldHVybiBjLm5vZGVidWZmZXIudWludDhhcnJheShlKS5idWZmZXI7CgkgICAgICAgIH0sCgkgICAgICAgIHVpbnQ4YXJyYXk6IGZ1bmN0aW9uIHVpbnQ4YXJyYXkoZSkgewoJICAgICAgICAgIHJldHVybiBmKGUsIG5ldyBVaW50OEFycmF5KGUubGVuZ3RoKSk7CgkgICAgICAgIH0sCgkgICAgICAgIG5vZGVidWZmZXI6IG4KCSAgICAgIH0sIGEudHJhbnNmb3JtVG8gPSBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICBpZiAodCA9IHQgfHwgIiIsICFlKSByZXR1cm4gdDsKCSAgICAgICAgYS5jaGVja1N1cHBvcnQoZSk7CgkgICAgICAgIHZhciByID0gYS5nZXRUeXBlT2YodCk7CgkgICAgICAgIHJldHVybiBjW3JdW2VdKHQpOwoJICAgICAgfSwgYS5yZXNvbHZlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgZm9yICh2YXIgdCA9IGUuc3BsaXQoIi8iKSwgciA9IFtdLCBuID0gMDsgbiA8IHQubGVuZ3RoOyBuKyspIHsKCSAgICAgICAgICB2YXIgaSA9IHRbbl07CgkgICAgICAgICAgIi4iID09PSBpIHx8ICIiID09PSBpICYmIDAgIT09IG4gJiYgbiAhPT0gdC5sZW5ndGggLSAxIHx8ICgiLi4iID09PSBpID8gci5wb3AoKSA6IHIucHVzaChpKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHIuam9pbigiLyIpOwoJICAgICAgfSwgYS5nZXRUeXBlT2YgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICByZXR1cm4gInN0cmluZyIgPT0gdHlwZW9mIGUgPyAic3RyaW5nIiA6ICJbb2JqZWN0IEFycmF5XSIgPT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKSA/ICJhcnJheSIgOiBvLm5vZGVidWZmZXIgJiYgci5pc0J1ZmZlcihlKSA/ICJub2RlYnVmZmVyIiA6IG8udWludDhhcnJheSAmJiBlIGluc3RhbmNlb2YgVWludDhBcnJheSA/ICJ1aW50OGFycmF5IiA6IG8uYXJyYXlidWZmZXIgJiYgZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyID8gImFycmF5YnVmZmVyIiA6IHZvaWQgMDsKCSAgICAgIH0sIGEuY2hlY2tTdXBwb3J0ID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgaWYgKCFvW2UudG9Mb3dlckNhc2UoKV0pIHRocm93IG5ldyBFcnJvcihlICsgIiBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgcGxhdGZvcm0iKTsKCSAgICAgIH0sIGEuTUFYX1ZBTFVFXzE2QklUUyA9IDY1NTM1LCBhLk1BWF9WQUxVRV8zMkJJVFMgPSAtMSwgYS5wcmV0dHkgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICB2YXIgdCwKCSAgICAgICAgICByLAoJICAgICAgICAgIG4gPSAiIjsKCSAgICAgICAgZm9yIChyID0gMDsgciA8IChlIHx8ICIiKS5sZW5ndGg7IHIrKykgbiArPSAiXFx4IiArICgodCA9IGUuY2hhckNvZGVBdChyKSkgPCAxNiA/ICIwIiA6ICIiKSArIHQudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCk7CgkgICAgICAgIHJldHVybiBuOwoJICAgICAgfSwgYS5kZWxheSA9IGZ1bmN0aW9uIChlLCB0LCByKSB7CgkgICAgICAgIHNldEltbWVkaWF0ZShmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgZS5hcHBseShyIHx8IG51bGwsIHQgfHwgW10pOwoJICAgICAgICB9KTsKCSAgICAgIH0sIGEuaW5oZXJpdHMgPSBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICBmdW5jdGlvbiByKCkge30KCSAgICAgICAgci5wcm90b3R5cGUgPSB0LnByb3RvdHlwZSwgZS5wcm90b3R5cGUgPSBuZXcgcigpOwoJICAgICAgfSwgYS5leHRlbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBlLAoJICAgICAgICAgIHQsCgkgICAgICAgICAgciA9IHt9OwoJICAgICAgICBmb3IgKGUgPSAwOyBlIDwgYXJndW1lbnRzLmxlbmd0aDsgZSsrKSBmb3IgKHQgaW4gYXJndW1lbnRzW2VdKSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYXJndW1lbnRzW2VdLCB0KSAmJiB2b2lkIDAgPT09IHJbdF0gJiYgKHJbdF0gPSBhcmd1bWVudHNbZV1bdF0pOwoJICAgICAgICByZXR1cm4gcjsKCSAgICAgIH0sIGEucHJlcGFyZUNvbnRlbnQgPSBmdW5jdGlvbiAociwgZSwgbiwgaSwgcykgewoJICAgICAgICByZXR1cm4gdS5Qcm9taXNlLnJlc29sdmUoZSkudGhlbihmdW5jdGlvbiAobikgewoJICAgICAgICAgIHJldHVybiBvLmJsb2IgJiYgKG4gaW5zdGFuY2VvZiBCbG9iIHx8IC0xICE9PSBbIltvYmplY3QgRmlsZV0iLCAiW29iamVjdCBCbG9iXSJdLmluZGV4T2YoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG4pKSkgJiYgInVuZGVmaW5lZCIgIT0gdHlwZW9mIEZpbGVSZWFkZXIgPyBuZXcgdS5Qcm9taXNlKGZ1bmN0aW9uICh0LCByKSB7CgkgICAgICAgICAgICB2YXIgZSA9IG5ldyBGaWxlUmVhZGVyKCk7CgkgICAgICAgICAgICBlLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICAgIHQoZS50YXJnZXQucmVzdWx0KTsKCSAgICAgICAgICAgIH0sIGUub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICAgIHIoZS50YXJnZXQuZXJyb3IpOwoJICAgICAgICAgICAgfSwgZS5yZWFkQXNBcnJheUJ1ZmZlcihuKTsKCSAgICAgICAgICB9KSA6IG47CgkgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICB2YXIgdCA9IGEuZ2V0VHlwZU9mKGUpOwoJICAgICAgICAgIHJldHVybiB0ID8gKCJhcnJheWJ1ZmZlciIgPT09IHQgPyBlID0gYS50cmFuc2Zvcm1UbygidWludDhhcnJheSIsIGUpIDogInN0cmluZyIgPT09IHQgJiYgKHMgPyBlID0gaC5kZWNvZGUoZSkgOiBuICYmICEwICE9PSBpICYmIChlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgIHJldHVybiBsKGUsIG8udWludDhhcnJheSA/IG5ldyBVaW50OEFycmF5KGUubGVuZ3RoKSA6IG5ldyBBcnJheShlLmxlbmd0aCkpOwoJICAgICAgICAgIH0oZSkpKSwgZSkgOiB1LlByb21pc2UucmVqZWN0KG5ldyBFcnJvcigiQ2FuJ3QgcmVhZCB0aGUgZGF0YSBvZiAnIiArIHIgKyAiJy4gSXMgaXQgaW4gYSBzdXBwb3J0ZWQgSmF2YVNjcmlwdCB0eXBlIChTdHJpbmcsIEJsb2IsIEFycmF5QnVmZmVyLCBldGMpID8iKSk7CgkgICAgICAgIH0pOwoJICAgICAgfTsKCSAgICB9LCB7CgkgICAgICAiLi9iYXNlNjQiOiAxLAoJICAgICAgIi4vZXh0ZXJuYWwiOiA2LAoJICAgICAgIi4vbm9kZWpzVXRpbHMiOiAxNCwKCSAgICAgICIuL3N1cHBvcnQiOiAzMCwKCSAgICAgIHNldGltbWVkaWF0ZTogNTQKCSAgICB9XSwKCSAgICAzMzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG4gPSBlKCIuL3JlYWRlci9yZWFkZXJGb3IiKSwKCSAgICAgICAgaSA9IGUoIi4vdXRpbHMiKSwKCSAgICAgICAgcyA9IGUoIi4vc2lnbmF0dXJlIiksCgkgICAgICAgIGEgPSBlKCIuL3ppcEVudHJ5IiksCgkgICAgICAgIG8gPSBlKCIuL3N1cHBvcnQiKTsKCSAgICAgIGZ1bmN0aW9uIGgoZSkgewoJICAgICAgICB0aGlzLmZpbGVzID0gW10sIHRoaXMubG9hZE9wdGlvbnMgPSBlOwoJICAgICAgfQoJICAgICAgaC5wcm90b3R5cGUgPSB7CgkgICAgICAgIGNoZWNrU2lnbmF0dXJlOiBmdW5jdGlvbiBjaGVja1NpZ25hdHVyZShlKSB7CgkgICAgICAgICAgaWYgKCF0aGlzLnJlYWRlci5yZWFkQW5kQ2hlY2tTaWduYXR1cmUoZSkpIHsKCSAgICAgICAgICAgIHRoaXMucmVhZGVyLmluZGV4IC09IDQ7CgkgICAgICAgICAgICB2YXIgdCA9IHRoaXMucmVhZGVyLnJlYWRTdHJpbmcoNCk7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXAgb3IgYnVnOiB1bmV4cGVjdGVkIHNpZ25hdHVyZSAoIiArIGkucHJldHR5KHQpICsgIiwgZXhwZWN0ZWQgIiArIGkucHJldHR5KGUpICsgIikiKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0sCgkgICAgICAgIGlzU2lnbmF0dXJlOiBmdW5jdGlvbiBpc1NpZ25hdHVyZShlLCB0KSB7CgkgICAgICAgICAgdmFyIHIgPSB0aGlzLnJlYWRlci5pbmRleDsKCSAgICAgICAgICB0aGlzLnJlYWRlci5zZXRJbmRleChlKTsKCSAgICAgICAgICB2YXIgbiA9IHRoaXMucmVhZGVyLnJlYWRTdHJpbmcoNCkgPT09IHQ7CgkgICAgICAgICAgcmV0dXJuIHRoaXMucmVhZGVyLnNldEluZGV4KHIpLCBuOwoJICAgICAgICB9LAoJICAgICAgICByZWFkQmxvY2tFbmRPZkNlbnRyYWw6IGZ1bmN0aW9uIHJlYWRCbG9ja0VuZE9mQ2VudHJhbCgpIHsKCSAgICAgICAgICB0aGlzLmRpc2tOdW1iZXIgPSB0aGlzLnJlYWRlci5yZWFkSW50KDIpLCB0aGlzLmRpc2tXaXRoQ2VudHJhbERpclN0YXJ0ID0gdGhpcy5yZWFkZXIucmVhZEludCgyKSwgdGhpcy5jZW50cmFsRGlyUmVjb3Jkc09uVGhpc0Rpc2sgPSB0aGlzLnJlYWRlci5yZWFkSW50KDIpLCB0aGlzLmNlbnRyYWxEaXJSZWNvcmRzID0gdGhpcy5yZWFkZXIucmVhZEludCgyKSwgdGhpcy5jZW50cmFsRGlyU2l6ZSA9IHRoaXMucmVhZGVyLnJlYWRJbnQoNCksIHRoaXMuY2VudHJhbERpck9mZnNldCA9IHRoaXMucmVhZGVyLnJlYWRJbnQoNCksIHRoaXMuemlwQ29tbWVudExlbmd0aCA9IHRoaXMucmVhZGVyLnJlYWRJbnQoMik7CgkgICAgICAgICAgdmFyIGUgPSB0aGlzLnJlYWRlci5yZWFkRGF0YSh0aGlzLnppcENvbW1lbnRMZW5ndGgpLAoJICAgICAgICAgICAgdCA9IG8udWludDhhcnJheSA/ICJ1aW50OGFycmF5IiA6ICJhcnJheSIsCgkgICAgICAgICAgICByID0gaS50cmFuc2Zvcm1Ubyh0LCBlKTsKCSAgICAgICAgICB0aGlzLnppcENvbW1lbnQgPSB0aGlzLmxvYWRPcHRpb25zLmRlY29kZUZpbGVOYW1lKHIpOwoJICAgICAgICB9LAoJICAgICAgICByZWFkQmxvY2taaXA2NEVuZE9mQ2VudHJhbDogZnVuY3Rpb24gcmVhZEJsb2NrWmlwNjRFbmRPZkNlbnRyYWwoKSB7CgkgICAgICAgICAgdGhpcy56aXA2NEVuZE9mQ2VudHJhbFNpemUgPSB0aGlzLnJlYWRlci5yZWFkSW50KDgpLCB0aGlzLnJlYWRlci5za2lwKDQpLCB0aGlzLmRpc2tOdW1iZXIgPSB0aGlzLnJlYWRlci5yZWFkSW50KDQpLCB0aGlzLmRpc2tXaXRoQ2VudHJhbERpclN0YXJ0ID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSwgdGhpcy5jZW50cmFsRGlyUmVjb3Jkc09uVGhpc0Rpc2sgPSB0aGlzLnJlYWRlci5yZWFkSW50KDgpLCB0aGlzLmNlbnRyYWxEaXJSZWNvcmRzID0gdGhpcy5yZWFkZXIucmVhZEludCg4KSwgdGhpcy5jZW50cmFsRGlyU2l6ZSA9IHRoaXMucmVhZGVyLnJlYWRJbnQoOCksIHRoaXMuY2VudHJhbERpck9mZnNldCA9IHRoaXMucmVhZGVyLnJlYWRJbnQoOCksIHRoaXMuemlwNjRFeHRlbnNpYmxlRGF0YSA9IHt9OwoJICAgICAgICAgIGZvciAodmFyIGUsIHQsIHIsIG4gPSB0aGlzLnppcDY0RW5kT2ZDZW50cmFsU2l6ZSAtIDQ0OyAwIDwgbjspIGUgPSB0aGlzLnJlYWRlci5yZWFkSW50KDIpLCB0ID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSwgciA9IHRoaXMucmVhZGVyLnJlYWREYXRhKHQpLCB0aGlzLnppcDY0RXh0ZW5zaWJsZURhdGFbZV0gPSB7CgkgICAgICAgICAgICBpZDogZSwKCSAgICAgICAgICAgIGxlbmd0aDogdCwKCSAgICAgICAgICAgIHZhbHVlOiByCgkgICAgICAgICAgfTsKCSAgICAgICAgfSwKCSAgICAgICAgcmVhZEJsb2NrWmlwNjRFbmRPZkNlbnRyYWxMb2NhdG9yOiBmdW5jdGlvbiByZWFkQmxvY2taaXA2NEVuZE9mQ2VudHJhbExvY2F0b3IoKSB7CgkgICAgICAgICAgaWYgKHRoaXMuZGlza1dpdGhaaXA2NENlbnRyYWxEaXJTdGFydCA9IHRoaXMucmVhZGVyLnJlYWRJbnQoNCksIHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpciA9IHRoaXMucmVhZGVyLnJlYWRJbnQoOCksIHRoaXMuZGlza3NDb3VudCA9IHRoaXMucmVhZGVyLnJlYWRJbnQoNCksIDEgPCB0aGlzLmRpc2tzQ291bnQpIHRocm93IG5ldyBFcnJvcigiTXVsdGktdm9sdW1lcyB6aXAgYXJlIG5vdCBzdXBwb3J0ZWQiKTsKCSAgICAgICAgfSwKCSAgICAgICAgcmVhZExvY2FsRmlsZXM6IGZ1bmN0aW9uIHJlYWRMb2NhbEZpbGVzKCkgewoJICAgICAgICAgIHZhciBlLCB0OwoJICAgICAgICAgIGZvciAoZSA9IDA7IGUgPCB0aGlzLmZpbGVzLmxlbmd0aDsgZSsrKSB0ID0gdGhpcy5maWxlc1tlXSwgdGhpcy5yZWFkZXIuc2V0SW5kZXgodC5sb2NhbEhlYWRlck9mZnNldCksIHRoaXMuY2hlY2tTaWduYXR1cmUocy5MT0NBTF9GSUxFX0hFQURFUiksIHQucmVhZExvY2FsUGFydCh0aGlzLnJlYWRlciksIHQuaGFuZGxlVVRGOCgpLCB0LnByb2Nlc3NBdHRyaWJ1dGVzKCk7CgkgICAgICAgIH0sCgkgICAgICAgIHJlYWRDZW50cmFsRGlyOiBmdW5jdGlvbiByZWFkQ2VudHJhbERpcigpIHsKCSAgICAgICAgICB2YXIgZTsKCSAgICAgICAgICBmb3IgKHRoaXMucmVhZGVyLnNldEluZGV4KHRoaXMuY2VudHJhbERpck9mZnNldCk7IHRoaXMucmVhZGVyLnJlYWRBbmRDaGVja1NpZ25hdHVyZShzLkNFTlRSQUxfRklMRV9IRUFERVIpOykgKGUgPSBuZXcgYSh7CgkgICAgICAgICAgICB6aXA2NDogdGhpcy56aXA2NAoJICAgICAgICAgIH0sIHRoaXMubG9hZE9wdGlvbnMpKS5yZWFkQ2VudHJhbFBhcnQodGhpcy5yZWFkZXIpLCB0aGlzLmZpbGVzLnB1c2goZSk7CgkgICAgICAgICAgaWYgKHRoaXMuY2VudHJhbERpclJlY29yZHMgIT09IHRoaXMuZmlsZXMubGVuZ3RoICYmIDAgIT09IHRoaXMuY2VudHJhbERpclJlY29yZHMgJiYgMCA9PT0gdGhpcy5maWxlcy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcigiQ29ycnVwdGVkIHppcCBvciBidWc6IGV4cGVjdGVkICIgKyB0aGlzLmNlbnRyYWxEaXJSZWNvcmRzICsgIiByZWNvcmRzIGluIGNlbnRyYWwgZGlyLCBnb3QgIiArIHRoaXMuZmlsZXMubGVuZ3RoKTsKCSAgICAgICAgfSwKCSAgICAgICAgcmVhZEVuZE9mQ2VudHJhbDogZnVuY3Rpb24gcmVhZEVuZE9mQ2VudHJhbCgpIHsKCSAgICAgICAgICB2YXIgZSA9IHRoaXMucmVhZGVyLmxhc3RJbmRleE9mU2lnbmF0dXJlKHMuQ0VOVFJBTF9ESVJFQ1RPUllfRU5EKTsKCSAgICAgICAgICBpZiAoZSA8IDApIHRocm93ICF0aGlzLmlzU2lnbmF0dXJlKDAsIHMuTE9DQUxfRklMRV9IRUFERVIpID8gbmV3IEVycm9yKCJDYW4ndCBmaW5kIGVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSA6IGlzIHRoaXMgYSB6aXAgZmlsZSA/IElmIGl0IGlzLCBzZWUgaHR0cHM6Ly9zdHVrLmdpdGh1Yi5pby9qc3ppcC9kb2N1bWVudGF0aW9uL2hvd3RvL3JlYWRfemlwLmh0bWwiKSA6IG5ldyBFcnJvcigiQ29ycnVwdGVkIHppcDogY2FuJ3QgZmluZCBlbmQgb2YgY2VudHJhbCBkaXJlY3RvcnkiKTsKCSAgICAgICAgICB0aGlzLnJlYWRlci5zZXRJbmRleChlKTsKCSAgICAgICAgICB2YXIgdCA9IGU7CgkgICAgICAgICAgaWYgKHRoaXMuY2hlY2tTaWduYXR1cmUocy5DRU5UUkFMX0RJUkVDVE9SWV9FTkQpLCB0aGlzLnJlYWRCbG9ja0VuZE9mQ2VudHJhbCgpLCB0aGlzLmRpc2tOdW1iZXIgPT09IGkuTUFYX1ZBTFVFXzE2QklUUyB8fCB0aGlzLmRpc2tXaXRoQ2VudHJhbERpclN0YXJ0ID09PSBpLk1BWF9WQUxVRV8xNkJJVFMgfHwgdGhpcy5jZW50cmFsRGlyUmVjb3Jkc09uVGhpc0Rpc2sgPT09IGkuTUFYX1ZBTFVFXzE2QklUUyB8fCB0aGlzLmNlbnRyYWxEaXJSZWNvcmRzID09PSBpLk1BWF9WQUxVRV8xNkJJVFMgfHwgdGhpcy5jZW50cmFsRGlyU2l6ZSA9PT0gaS5NQVhfVkFMVUVfMzJCSVRTIHx8IHRoaXMuY2VudHJhbERpck9mZnNldCA9PT0gaS5NQVhfVkFMVUVfMzJCSVRTKSB7CgkgICAgICAgICAgICBpZiAodGhpcy56aXA2NCA9ICEwLCAoZSA9IHRoaXMucmVhZGVyLmxhc3RJbmRleE9mU2lnbmF0dXJlKHMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfTE9DQVRPUikpIDwgMCkgdGhyb3cgbmV3IEVycm9yKCJDb3JydXB0ZWQgemlwOiBjYW4ndCBmaW5kIHRoZSBaSVA2NCBlbmQgb2YgY2VudHJhbCBkaXJlY3RvcnkgbG9jYXRvciIpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVhZGVyLnNldEluZGV4KGUpLCB0aGlzLmNoZWNrU2lnbmF0dXJlKHMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfTE9DQVRPUiksIHRoaXMucmVhZEJsb2NrWmlwNjRFbmRPZkNlbnRyYWxMb2NhdG9yKCksICF0aGlzLmlzU2lnbmF0dXJlKHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpciwgcy5aSVA2NF9DRU5UUkFMX0RJUkVDVE9SWV9FTkQpICYmICh0aGlzLnJlbGF0aXZlT2Zmc2V0RW5kT2ZaaXA2NENlbnRyYWxEaXIgPSB0aGlzLnJlYWRlci5sYXN0SW5kZXhPZlNpZ25hdHVyZShzLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0VORCksIHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpciA8IDApKSB0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXA6IGNhbid0IGZpbmQgdGhlIFpJUDY0IGVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSIpOwoJICAgICAgICAgICAgdGhpcy5yZWFkZXIuc2V0SW5kZXgodGhpcy5yZWxhdGl2ZU9mZnNldEVuZE9mWmlwNjRDZW50cmFsRGlyKSwgdGhpcy5jaGVja1NpZ25hdHVyZShzLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0VORCksIHRoaXMucmVhZEJsb2NrWmlwNjRFbmRPZkNlbnRyYWwoKTsKCSAgICAgICAgICB9CgkgICAgICAgICAgdmFyIHIgPSB0aGlzLmNlbnRyYWxEaXJPZmZzZXQgKyB0aGlzLmNlbnRyYWxEaXJTaXplOwoJICAgICAgICAgIHRoaXMuemlwNjQgJiYgKHIgKz0gMjAsIHIgKz0gMTIgKyB0aGlzLnppcDY0RW5kT2ZDZW50cmFsU2l6ZSk7CgkgICAgICAgICAgdmFyIG4gPSB0IC0gcjsKCSAgICAgICAgICBpZiAoMCA8IG4pIHRoaXMuaXNTaWduYXR1cmUodCwgcy5DRU5UUkFMX0ZJTEVfSEVBREVSKSB8fCAodGhpcy5yZWFkZXIuemVybyA9IG4pO2Vsc2UgaWYgKG4gPCAwKSB0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXA6IG1pc3NpbmcgIiArIE1hdGguYWJzKG4pICsgIiBieXRlcy4iKTsKCSAgICAgICAgfSwKCSAgICAgICAgcHJlcGFyZVJlYWRlcjogZnVuY3Rpb24gcHJlcGFyZVJlYWRlcihlKSB7CgkgICAgICAgICAgdGhpcy5yZWFkZXIgPSBuKGUpOwoJICAgICAgICB9LAoJICAgICAgICBsb2FkOiBmdW5jdGlvbiBsb2FkKGUpIHsKCSAgICAgICAgICB0aGlzLnByZXBhcmVSZWFkZXIoZSksIHRoaXMucmVhZEVuZE9mQ2VudHJhbCgpLCB0aGlzLnJlYWRDZW50cmFsRGlyKCksIHRoaXMucmVhZExvY2FsRmlsZXMoKTsKCSAgICAgICAgfQoJICAgICAgfSwgdC5leHBvcnRzID0gaDsKCSAgICB9LCB7CgkgICAgICAiLi9yZWFkZXIvcmVhZGVyRm9yIjogMjIsCgkgICAgICAiLi9zaWduYXR1cmUiOiAyMywKCSAgICAgICIuL3N1cHBvcnQiOiAzMCwKCSAgICAgICIuL3V0aWxzIjogMzIsCgkgICAgICAiLi96aXBFbnRyeSI6IDM0CgkgICAgfV0sCgkgICAgMzQ6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBuID0gZSgiLi9yZWFkZXIvcmVhZGVyRm9yIiksCgkgICAgICAgIHMgPSBlKCIuL3V0aWxzIiksCgkgICAgICAgIGkgPSBlKCIuL2NvbXByZXNzZWRPYmplY3QiKSwKCSAgICAgICAgYSA9IGUoIi4vY3JjMzIiKSwKCSAgICAgICAgbyA9IGUoIi4vdXRmOCIpLAoJICAgICAgICBoID0gZSgiLi9jb21wcmVzc2lvbnMiKSwKCSAgICAgICAgdSA9IGUoIi4vc3VwcG9ydCIpOwoJICAgICAgZnVuY3Rpb24gbChlLCB0KSB7CgkgICAgICAgIHRoaXMub3B0aW9ucyA9IGUsIHRoaXMubG9hZE9wdGlvbnMgPSB0OwoJICAgICAgfQoJICAgICAgbC5wcm90b3R5cGUgPSB7CgkgICAgICAgIGlzRW5jcnlwdGVkOiBmdW5jdGlvbiBpc0VuY3J5cHRlZCgpIHsKCSAgICAgICAgICByZXR1cm4gMSA9PSAoMSAmIHRoaXMuYml0RmxhZyk7CgkgICAgICAgIH0sCgkgICAgICAgIHVzZVVURjg6IGZ1bmN0aW9uIHVzZVVURjgoKSB7CgkgICAgICAgICAgcmV0dXJuIDIwNDggPT0gKDIwNDggJiB0aGlzLmJpdEZsYWcpOwoJICAgICAgICB9LAoJICAgICAgICByZWFkTG9jYWxQYXJ0OiBmdW5jdGlvbiByZWFkTG9jYWxQYXJ0KGUpIHsKCSAgICAgICAgICB2YXIgdCwgcjsKCSAgICAgICAgICBpZiAoZS5za2lwKDIyKSwgdGhpcy5maWxlTmFtZUxlbmd0aCA9IGUucmVhZEludCgyKSwgciA9IGUucmVhZEludCgyKSwgdGhpcy5maWxlTmFtZSA9IGUucmVhZERhdGEodGhpcy5maWxlTmFtZUxlbmd0aCksIGUuc2tpcChyKSwgLTEgPT09IHRoaXMuY29tcHJlc3NlZFNpemUgfHwgLTEgPT09IHRoaXMudW5jb21wcmVzc2VkU2l6ZSkgdGhyb3cgbmV3IEVycm9yKCJCdWcgb3IgY29ycnVwdGVkIHppcCA6IGRpZG4ndCBnZXQgZW5vdWdoIGluZm9ybWF0aW9uIGZyb20gdGhlIGNlbnRyYWwgZGlyZWN0b3J5IChjb21wcmVzc2VkU2l6ZSA9PT0gLTEgfHwgdW5jb21wcmVzc2VkU2l6ZSA9PT0gLTEpIik7CgkgICAgICAgICAgaWYgKG51bGwgPT09ICh0ID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgIGZvciAodmFyIHQgaW4gaCkgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChoLCB0KSAmJiBoW3RdLm1hZ2ljID09PSBlKSByZXR1cm4gaFt0XTsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICAgIH0odGhpcy5jb21wcmVzc2lvbk1ldGhvZCkpKSB0aHJvdyBuZXcgRXJyb3IoIkNvcnJ1cHRlZCB6aXAgOiBjb21wcmVzc2lvbiAiICsgcy5wcmV0dHkodGhpcy5jb21wcmVzc2lvbk1ldGhvZCkgKyAiIHVua25vd24gKGlubmVyIGZpbGUgOiAiICsgcy50cmFuc2Zvcm1Ubygic3RyaW5nIiwgdGhpcy5maWxlTmFtZSkgKyAiKSIpOwoJICAgICAgICAgIHRoaXMuZGVjb21wcmVzc2VkID0gbmV3IGkodGhpcy5jb21wcmVzc2VkU2l6ZSwgdGhpcy51bmNvbXByZXNzZWRTaXplLCB0aGlzLmNyYzMyLCB0LCBlLnJlYWREYXRhKHRoaXMuY29tcHJlc3NlZFNpemUpKTsKCSAgICAgICAgfSwKCSAgICAgICAgcmVhZENlbnRyYWxQYXJ0OiBmdW5jdGlvbiByZWFkQ2VudHJhbFBhcnQoZSkgewoJICAgICAgICAgIHRoaXMudmVyc2lvbk1hZGVCeSA9IGUucmVhZEludCgyKSwgZS5za2lwKDIpLCB0aGlzLmJpdEZsYWcgPSBlLnJlYWRJbnQoMiksIHRoaXMuY29tcHJlc3Npb25NZXRob2QgPSBlLnJlYWRTdHJpbmcoMiksIHRoaXMuZGF0ZSA9IGUucmVhZERhdGUoKSwgdGhpcy5jcmMzMiA9IGUucmVhZEludCg0KSwgdGhpcy5jb21wcmVzc2VkU2l6ZSA9IGUucmVhZEludCg0KSwgdGhpcy51bmNvbXByZXNzZWRTaXplID0gZS5yZWFkSW50KDQpOwoJICAgICAgICAgIHZhciB0ID0gZS5yZWFkSW50KDIpOwoJICAgICAgICAgIGlmICh0aGlzLmV4dHJhRmllbGRzTGVuZ3RoID0gZS5yZWFkSW50KDIpLCB0aGlzLmZpbGVDb21tZW50TGVuZ3RoID0gZS5yZWFkSW50KDIpLCB0aGlzLmRpc2tOdW1iZXJTdGFydCA9IGUucmVhZEludCgyKSwgdGhpcy5pbnRlcm5hbEZpbGVBdHRyaWJ1dGVzID0gZS5yZWFkSW50KDIpLCB0aGlzLmV4dGVybmFsRmlsZUF0dHJpYnV0ZXMgPSBlLnJlYWRJbnQoNCksIHRoaXMubG9jYWxIZWFkZXJPZmZzZXQgPSBlLnJlYWRJbnQoNCksIHRoaXMuaXNFbmNyeXB0ZWQoKSkgdGhyb3cgbmV3IEVycm9yKCJFbmNyeXB0ZWQgemlwIGFyZSBub3Qgc3VwcG9ydGVkIik7CgkgICAgICAgICAgZS5za2lwKHQpLCB0aGlzLnJlYWRFeHRyYUZpZWxkcyhlKSwgdGhpcy5wYXJzZVpJUDY0RXh0cmFGaWVsZChlKSwgdGhpcy5maWxlQ29tbWVudCA9IGUucmVhZERhdGEodGhpcy5maWxlQ29tbWVudExlbmd0aCk7CgkgICAgICAgIH0sCgkgICAgICAgIHByb2Nlc3NBdHRyaWJ1dGVzOiBmdW5jdGlvbiBwcm9jZXNzQXR0cmlidXRlcygpIHsKCSAgICAgICAgICB0aGlzLnVuaXhQZXJtaXNzaW9ucyA9IG51bGwsIHRoaXMuZG9zUGVybWlzc2lvbnMgPSBudWxsOwoJICAgICAgICAgIHZhciBlID0gdGhpcy52ZXJzaW9uTWFkZUJ5ID4+IDg7CgkgICAgICAgICAgdGhpcy5kaXIgPSAhISgxNiAmIHRoaXMuZXh0ZXJuYWxGaWxlQXR0cmlidXRlcyksIDAgPT0gZSAmJiAodGhpcy5kb3NQZXJtaXNzaW9ucyA9IDYzICYgdGhpcy5leHRlcm5hbEZpbGVBdHRyaWJ1dGVzKSwgMyA9PSBlICYmICh0aGlzLnVuaXhQZXJtaXNzaW9ucyA9IHRoaXMuZXh0ZXJuYWxGaWxlQXR0cmlidXRlcyA+PiAxNiAmIDY1NTM1KSwgdGhpcy5kaXIgfHwgIi8iICE9PSB0aGlzLmZpbGVOYW1lU3RyLnNsaWNlKC0xKSB8fCAodGhpcy5kaXIgPSAhMCk7CgkgICAgICAgIH0sCgkgICAgICAgIHBhcnNlWklQNjRFeHRyYUZpZWxkOiBmdW5jdGlvbiBwYXJzZVpJUDY0RXh0cmFGaWVsZCgpIHsKCSAgICAgICAgICBpZiAodGhpcy5leHRyYUZpZWxkc1sxXSkgewoJICAgICAgICAgICAgdmFyIGUgPSBuKHRoaXMuZXh0cmFGaWVsZHNbMV0udmFsdWUpOwoJICAgICAgICAgICAgdGhpcy51bmNvbXByZXNzZWRTaXplID09PSBzLk1BWF9WQUxVRV8zMkJJVFMgJiYgKHRoaXMudW5jb21wcmVzc2VkU2l6ZSA9IGUucmVhZEludCg4KSksIHRoaXMuY29tcHJlc3NlZFNpemUgPT09IHMuTUFYX1ZBTFVFXzMyQklUUyAmJiAodGhpcy5jb21wcmVzc2VkU2l6ZSA9IGUucmVhZEludCg4KSksIHRoaXMubG9jYWxIZWFkZXJPZmZzZXQgPT09IHMuTUFYX1ZBTFVFXzMyQklUUyAmJiAodGhpcy5sb2NhbEhlYWRlck9mZnNldCA9IGUucmVhZEludCg4KSksIHRoaXMuZGlza051bWJlclN0YXJ0ID09PSBzLk1BWF9WQUxVRV8zMkJJVFMgJiYgKHRoaXMuZGlza051bWJlclN0YXJ0ID0gZS5yZWFkSW50KDQpKTsKCSAgICAgICAgICB9CgkgICAgICAgIH0sCgkgICAgICAgIHJlYWRFeHRyYUZpZWxkczogZnVuY3Rpb24gcmVhZEV4dHJhRmllbGRzKGUpIHsKCSAgICAgICAgICB2YXIgdCwKCSAgICAgICAgICAgIHIsCgkgICAgICAgICAgICBuLAoJICAgICAgICAgICAgaSA9IGUuaW5kZXggKyB0aGlzLmV4dHJhRmllbGRzTGVuZ3RoOwoJICAgICAgICAgIGZvciAodGhpcy5leHRyYUZpZWxkcyB8fCAodGhpcy5leHRyYUZpZWxkcyA9IHt9KTsgZS5pbmRleCArIDQgPCBpOykgdCA9IGUucmVhZEludCgyKSwgciA9IGUucmVhZEludCgyKSwgbiA9IGUucmVhZERhdGEociksIHRoaXMuZXh0cmFGaWVsZHNbdF0gPSB7CgkgICAgICAgICAgICBpZDogdCwKCSAgICAgICAgICAgIGxlbmd0aDogciwKCSAgICAgICAgICAgIHZhbHVlOiBuCgkgICAgICAgICAgfTsKCSAgICAgICAgICBlLnNldEluZGV4KGkpOwoJICAgICAgICB9LAoJICAgICAgICBoYW5kbGVVVEY4OiBmdW5jdGlvbiBoYW5kbGVVVEY4KCkgewoJICAgICAgICAgIHZhciBlID0gdS51aW50OGFycmF5ID8gInVpbnQ4YXJyYXkiIDogImFycmF5IjsKCSAgICAgICAgICBpZiAodGhpcy51c2VVVEY4KCkpIHRoaXMuZmlsZU5hbWVTdHIgPSBvLnV0ZjhkZWNvZGUodGhpcy5maWxlTmFtZSksIHRoaXMuZmlsZUNvbW1lbnRTdHIgPSBvLnV0ZjhkZWNvZGUodGhpcy5maWxlQ29tbWVudCk7ZWxzZSB7CgkgICAgICAgICAgICB2YXIgdCA9IHRoaXMuZmluZEV4dHJhRmllbGRVbmljb2RlUGF0aCgpOwoJICAgICAgICAgICAgaWYgKG51bGwgIT09IHQpIHRoaXMuZmlsZU5hbWVTdHIgPSB0O2Vsc2UgewoJICAgICAgICAgICAgICB2YXIgciA9IHMudHJhbnNmb3JtVG8oZSwgdGhpcy5maWxlTmFtZSk7CgkgICAgICAgICAgICAgIHRoaXMuZmlsZU5hbWVTdHIgPSB0aGlzLmxvYWRPcHRpb25zLmRlY29kZUZpbGVOYW1lKHIpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG4gPSB0aGlzLmZpbmRFeHRyYUZpZWxkVW5pY29kZUNvbW1lbnQoKTsKCSAgICAgICAgICAgIGlmIChudWxsICE9PSBuKSB0aGlzLmZpbGVDb21tZW50U3RyID0gbjtlbHNlIHsKCSAgICAgICAgICAgICAgdmFyIGkgPSBzLnRyYW5zZm9ybVRvKGUsIHRoaXMuZmlsZUNvbW1lbnQpOwoJICAgICAgICAgICAgICB0aGlzLmZpbGVDb21tZW50U3RyID0gdGhpcy5sb2FkT3B0aW9ucy5kZWNvZGVGaWxlTmFtZShpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgIH0sCgkgICAgICAgIGZpbmRFeHRyYUZpZWxkVW5pY29kZVBhdGg6IGZ1bmN0aW9uIGZpbmRFeHRyYUZpZWxkVW5pY29kZVBhdGgoKSB7CgkgICAgICAgICAgdmFyIGUgPSB0aGlzLmV4dHJhRmllbGRzWzI4Nzg5XTsKCSAgICAgICAgICBpZiAoZSkgewoJICAgICAgICAgICAgdmFyIHQgPSBuKGUudmFsdWUpOwoJICAgICAgICAgICAgcmV0dXJuIDEgIT09IHQucmVhZEludCgxKSA/IG51bGwgOiBhKHRoaXMuZmlsZU5hbWUpICE9PSB0LnJlYWRJbnQoNCkgPyBudWxsIDogby51dGY4ZGVjb2RlKHQucmVhZERhdGEoZS5sZW5ndGggLSA1KSk7CgkgICAgICAgICAgfQoJICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9LAoJICAgICAgICBmaW5kRXh0cmFGaWVsZFVuaWNvZGVDb21tZW50OiBmdW5jdGlvbiBmaW5kRXh0cmFGaWVsZFVuaWNvZGVDb21tZW50KCkgewoJICAgICAgICAgIHZhciBlID0gdGhpcy5leHRyYUZpZWxkc1syNTQ2MV07CgkgICAgICAgICAgaWYgKGUpIHsKCSAgICAgICAgICAgIHZhciB0ID0gbihlLnZhbHVlKTsKCSAgICAgICAgICAgIHJldHVybiAxICE9PSB0LnJlYWRJbnQoMSkgPyBudWxsIDogYSh0aGlzLmZpbGVDb21tZW50KSAhPT0gdC5yZWFkSW50KDQpID8gbnVsbCA6IG8udXRmOGRlY29kZSh0LnJlYWREYXRhKGUubGVuZ3RoIC0gNSkpOwoJICAgICAgICAgIH0KCSAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgfSwgdC5leHBvcnRzID0gbDsKCSAgICB9LCB7CgkgICAgICAiLi9jb21wcmVzc2VkT2JqZWN0IjogMiwKCSAgICAgICIuL2NvbXByZXNzaW9ucyI6IDMsCgkgICAgICAiLi9jcmMzMiI6IDQsCgkgICAgICAiLi9yZWFkZXIvcmVhZGVyRm9yIjogMjIsCgkgICAgICAiLi9zdXBwb3J0IjogMzAsCgkgICAgICAiLi91dGY4IjogMzEsCgkgICAgICAiLi91dGlscyI6IDMyCgkgICAgfV0sCgkgICAgMzU6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIGZ1bmN0aW9uIG4oZSwgdCwgcikgewoJICAgICAgICB0aGlzLm5hbWUgPSBlLCB0aGlzLmRpciA9IHIuZGlyLCB0aGlzLmRhdGUgPSByLmRhdGUsIHRoaXMuY29tbWVudCA9IHIuY29tbWVudCwgdGhpcy51bml4UGVybWlzc2lvbnMgPSByLnVuaXhQZXJtaXNzaW9ucywgdGhpcy5kb3NQZXJtaXNzaW9ucyA9IHIuZG9zUGVybWlzc2lvbnMsIHRoaXMuX2RhdGEgPSB0LCB0aGlzLl9kYXRhQmluYXJ5ID0gci5iaW5hcnksIHRoaXMub3B0aW9ucyA9IHsKCSAgICAgICAgICBjb21wcmVzc2lvbjogci5jb21wcmVzc2lvbiwKCSAgICAgICAgICBjb21wcmVzc2lvbk9wdGlvbnM6IHIuY29tcHJlc3Npb25PcHRpb25zCgkgICAgICAgIH07CgkgICAgICB9CgkgICAgICB2YXIgcyA9IGUoIi4vc3RyZWFtL1N0cmVhbUhlbHBlciIpLAoJICAgICAgICBpID0gZSgiLi9zdHJlYW0vRGF0YVdvcmtlciIpLAoJICAgICAgICBhID0gZSgiLi91dGY4IiksCgkgICAgICAgIG8gPSBlKCIuL2NvbXByZXNzZWRPYmplY3QiKSwKCSAgICAgICAgaCA9IGUoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKTsKCSAgICAgIG4ucHJvdG90eXBlID0gewoJICAgICAgICBpbnRlcm5hbFN0cmVhbTogZnVuY3Rpb24gaW50ZXJuYWxTdHJlYW0oZSkgewoJICAgICAgICAgIHZhciB0ID0gbnVsbCwKCSAgICAgICAgICAgIHIgPSAic3RyaW5nIjsKCSAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgaWYgKCFlKSB0aHJvdyBuZXcgRXJyb3IoIk5vIG91dHB1dCB0eXBlIHNwZWNpZmllZC4iKTsKCSAgICAgICAgICAgIHZhciBuID0gInN0cmluZyIgPT09IChyID0gZS50b0xvd2VyQ2FzZSgpKSB8fCAidGV4dCIgPT09IHI7CgkgICAgICAgICAgICAiYmluYXJ5c3RyaW5nIiAhPT0gciAmJiAidGV4dCIgIT09IHIgfHwgKHIgPSAic3RyaW5nIiksIHQgPSB0aGlzLl9kZWNvbXByZXNzV29ya2VyKCk7CgkgICAgICAgICAgICB2YXIgaSA9ICF0aGlzLl9kYXRhQmluYXJ5OwoJICAgICAgICAgICAgaSAmJiAhbiAmJiAodCA9IHQucGlwZShuZXcgYS5VdGY4RW5jb2RlV29ya2VyKCkpKSwgIWkgJiYgbiAmJiAodCA9IHQucGlwZShuZXcgYS5VdGY4RGVjb2RlV29ya2VyKCkpKTsKCSAgICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgICAodCA9IG5ldyBoKCJlcnJvciIpKS5lcnJvcihlKTsKCSAgICAgICAgICB9CgkgICAgICAgICAgcmV0dXJuIG5ldyBzKHQsIHIsICIiKTsKCSAgICAgICAgfSwKCSAgICAgICAgYXN5bmM6IGZ1bmN0aW9uIGFzeW5jKGUsIHQpIHsKCSAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFN0cmVhbShlKS5hY2N1bXVsYXRlKHQpOwoJICAgICAgICB9LAoJICAgICAgICBub2RlU3RyZWFtOiBmdW5jdGlvbiBub2RlU3RyZWFtKGUsIHQpIHsKCSAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFN0cmVhbShlIHx8ICJub2RlYnVmZmVyIikudG9Ob2RlanNTdHJlYW0odCk7CgkgICAgICAgIH0sCgkgICAgICAgIF9jb21wcmVzc1dvcmtlcjogZnVuY3Rpb24gX2NvbXByZXNzV29ya2VyKGUsIHQpIHsKCSAgICAgICAgICBpZiAodGhpcy5fZGF0YSBpbnN0YW5jZW9mIG8gJiYgdGhpcy5fZGF0YS5jb21wcmVzc2lvbi5tYWdpYyA9PT0gZS5tYWdpYykgcmV0dXJuIHRoaXMuX2RhdGEuZ2V0Q29tcHJlc3NlZFdvcmtlcigpOwoJICAgICAgICAgIHZhciByID0gdGhpcy5fZGVjb21wcmVzc1dvcmtlcigpOwoJICAgICAgICAgIHJldHVybiB0aGlzLl9kYXRhQmluYXJ5IHx8IChyID0gci5waXBlKG5ldyBhLlV0ZjhFbmNvZGVXb3JrZXIoKSkpLCBvLmNyZWF0ZVdvcmtlckZyb20ociwgZSwgdCk7CgkgICAgICAgIH0sCgkgICAgICAgIF9kZWNvbXByZXNzV29ya2VyOiBmdW5jdGlvbiBfZGVjb21wcmVzc1dvcmtlcigpIHsKCSAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YSBpbnN0YW5jZW9mIG8gPyB0aGlzLl9kYXRhLmdldENvbnRlbnRXb3JrZXIoKSA6IHRoaXMuX2RhdGEgaW5zdGFuY2VvZiBoID8gdGhpcy5fZGF0YSA6IG5ldyBpKHRoaXMuX2RhdGEpOwoJICAgICAgICB9CgkgICAgICB9OwoJICAgICAgZm9yICh2YXIgdSA9IFsiYXNUZXh0IiwgImFzQmluYXJ5IiwgImFzTm9kZUJ1ZmZlciIsICJhc1VpbnQ4QXJyYXkiLCAiYXNBcnJheUJ1ZmZlciJdLCBsID0gZnVuY3Rpb24gbCgpIHsKCSAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlRoaXMgbWV0aG9kIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuIik7CgkgICAgICAgIH0sIGYgPSAwOyBmIDwgdS5sZW5ndGg7IGYrKykgbi5wcm90b3R5cGVbdVtmXV0gPSBsOwoJICAgICAgdC5leHBvcnRzID0gbjsKCSAgICB9LCB7CgkgICAgICAiLi9jb21wcmVzc2VkT2JqZWN0IjogMiwKCSAgICAgICIuL3N0cmVhbS9EYXRhV29ya2VyIjogMjcsCgkgICAgICAiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6IDI4LAoJICAgICAgIi4vc3RyZWFtL1N0cmVhbUhlbHBlciI6IDI5LAoJICAgICAgIi4vdXRmOCI6IDMxCgkgICAgfV0sCgkgICAgMzY6IFtmdW5jdGlvbiAoZSwgbCwgdCkgewoJICAgICAgKGZ1bmN0aW9uICh0KSB7CgoJICAgICAgICB2YXIgciwKCSAgICAgICAgICBuLAoJICAgICAgICAgIGUgPSB0Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgdC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyOwoJICAgICAgICBpZiAoZSkgewoJICAgICAgICAgIHZhciBpID0gMCwKCSAgICAgICAgICAgIHMgPSBuZXcgZSh1KSwKCSAgICAgICAgICAgIGEgPSB0LmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIiKTsKCSAgICAgICAgICBzLm9ic2VydmUoYSwgewoJICAgICAgICAgICAgY2hhcmFjdGVyRGF0YTogITAKCSAgICAgICAgICB9KSwgciA9IGZ1bmN0aW9uIHIoKSB7CgkgICAgICAgICAgICBhLmRhdGEgPSBpID0gKytpICUgMjsKCSAgICAgICAgICB9OwoJICAgICAgICB9IGVsc2UgaWYgKHQuc2V0SW1tZWRpYXRlIHx8IHZvaWQgMCA9PT0gdC5NZXNzYWdlQ2hhbm5lbCkgciA9ICJkb2N1bWVudCIgaW4gdCAmJiAib25yZWFkeXN0YXRlY2hhbmdlIiBpbiB0LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpID8gZnVuY3Rpb24gKCkgewoJICAgICAgICAgIHZhciBlID0gdC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKCSAgICAgICAgICBlLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIHUoKSwgZS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsLCBlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZSksIGUgPSBudWxsOwoJICAgICAgICAgIH0sIHQuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGUpOwoJICAgICAgICB9IDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgIHNldFRpbWVvdXQodSwgMCk7CgkgICAgICAgIH07ZWxzZSB7CgkgICAgICAgICAgdmFyIG8gPSBuZXcgdC5NZXNzYWdlQ2hhbm5lbCgpOwoJICAgICAgICAgIG8ucG9ydDEub25tZXNzYWdlID0gdSwgciA9IGZ1bmN0aW9uIHIoKSB7CgkgICAgICAgICAgICBvLnBvcnQyLnBvc3RNZXNzYWdlKDApOwoJICAgICAgICAgIH07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGggPSBbXTsKCSAgICAgICAgZnVuY3Rpb24gdSgpIHsKCSAgICAgICAgICB2YXIgZSwgdDsKCSAgICAgICAgICBuID0gITA7CgkgICAgICAgICAgZm9yICh2YXIgciA9IGgubGVuZ3RoOyByOykgewoJICAgICAgICAgICAgZm9yICh0ID0gaCwgaCA9IFtdLCBlID0gLTE7ICsrZSA8IHI7KSB0W2VdKCk7CgkgICAgICAgICAgICByID0gaC5sZW5ndGg7CgkgICAgICAgICAgfQoJICAgICAgICAgIG4gPSAhMTsKCSAgICAgICAgfQoJICAgICAgICBsLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgIDEgIT09IGgucHVzaChlKSB8fCBuIHx8IHIoKTsKCSAgICAgICAgfTsKCSAgICAgIH0pLmNhbGwodGhpcywgInVuZGVmaW5lZCIgIT0gdHlwZW9mIGNvbW1vbmpzR2xvYmFsID8gY29tbW9uanNHbG9iYWwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygc2VsZiA/IHNlbGYgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDoge30pOwoJICAgIH0sIHt9XSwKCSAgICAzNzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIGkgPSBlKCJpbW1lZGlhdGUiKTsKCSAgICAgIGZ1bmN0aW9uIHUoKSB7fQoJICAgICAgdmFyIGwgPSB7fSwKCSAgICAgICAgcyA9IFsiUkVKRUNURUQiXSwKCSAgICAgICAgYSA9IFsiRlVMRklMTEVEIl0sCgkgICAgICAgIG4gPSBbIlBFTkRJTkciXTsKCSAgICAgIGZ1bmN0aW9uIG8oZSkgewoJICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IFR5cGVFcnJvcigicmVzb2x2ZXIgbXVzdCBiZSBhIGZ1bmN0aW9uIik7CgkgICAgICAgIHRoaXMuc3RhdGUgPSBuLCB0aGlzLnF1ZXVlID0gW10sIHRoaXMub3V0Y29tZSA9IHZvaWQgMCwgZSAhPT0gdSAmJiBkKHRoaXMsIGUpOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gaChlLCB0LCByKSB7CgkgICAgICAgIHRoaXMucHJvbWlzZSA9IGUsICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQgJiYgKHRoaXMub25GdWxmaWxsZWQgPSB0LCB0aGlzLmNhbGxGdWxmaWxsZWQgPSB0aGlzLm90aGVyQ2FsbEZ1bGZpbGxlZCksICJmdW5jdGlvbiIgPT0gdHlwZW9mIHIgJiYgKHRoaXMub25SZWplY3RlZCA9IHIsIHRoaXMuY2FsbFJlamVjdGVkID0gdGhpcy5vdGhlckNhbGxSZWplY3RlZCk7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBmKHQsIHIsIG4pIHsKCSAgICAgICAgaShmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgdmFyIGU7CgkgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGUgPSByKG4pOwoJICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgICAgIHJldHVybiBsLnJlamVjdCh0LCBlKTsKCSAgICAgICAgICB9CgkgICAgICAgICAgZSA9PT0gdCA/IGwucmVqZWN0KHQsIG5ldyBUeXBlRXJyb3IoIkNhbm5vdCByZXNvbHZlIHByb21pc2Ugd2l0aCBpdHNlbGYiKSkgOiBsLnJlc29sdmUodCwgZSk7CgkgICAgICAgIH0pOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gYyhlKSB7CgkgICAgICAgIHZhciB0ID0gZSAmJiBlLnRoZW47CgkgICAgICAgIGlmIChlICYmICgib2JqZWN0IiA9PSBfdHlwZW9mKGUpIHx8ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUpICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQpIHJldHVybiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgdC5hcHBseShlLCBhcmd1bWVudHMpOwoJICAgICAgICB9OwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gZCh0LCBlKSB7CgkgICAgICAgIHZhciByID0gITE7CgkgICAgICAgIGZ1bmN0aW9uIG4oZSkgewoJICAgICAgICAgIHIgfHwgKHIgPSAhMCwgbC5yZWplY3QodCwgZSkpOwoJICAgICAgICB9CgkgICAgICAgIGZ1bmN0aW9uIGkoZSkgewoJICAgICAgICAgIHIgfHwgKHIgPSAhMCwgbC5yZXNvbHZlKHQsIGUpKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcyA9IHAoZnVuY3Rpb24gKCkgewoJICAgICAgICAgIGUoaSwgbik7CgkgICAgICAgIH0pOwoJICAgICAgICAiZXJyb3IiID09PSBzLnN0YXR1cyAmJiBuKHMudmFsdWUpOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gcChlLCB0KSB7CgkgICAgICAgIHZhciByID0ge307CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgci52YWx1ZSA9IGUodCksIHIuc3RhdHVzID0gInN1Y2Nlc3MiOwoJICAgICAgICB9IGNhdGNoIChlKSB7CgkgICAgICAgICAgci5zdGF0dXMgPSAiZXJyb3IiLCByLnZhbHVlID0gZTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcjsKCSAgICAgIH0KCSAgICAgICh0LmV4cG9ydHMgPSBvKS5wcm90b3R5cGVbImZpbmFsbHkiXSA9IGZ1bmN0aW9uICh0KSB7CgkgICAgICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiB0KSByZXR1cm4gdGhpczsKCSAgICAgICAgdmFyIHIgPSB0aGlzLmNvbnN0cnVjdG9yOwoJICAgICAgICByZXR1cm4gdGhpcy50aGVuKGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgcmV0dXJuIHIucmVzb2x2ZSh0KCkpLnRoZW4oZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgcmV0dXJuIGU7CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgcmV0dXJuIHIucmVzb2x2ZSh0KCkpLnRoZW4oZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgdGhyb3cgZTsKCSAgICAgICAgICB9KTsKCSAgICAgICAgfSk7CgkgICAgICB9LCBvLnByb3RvdHlwZVsiY2F0Y2giXSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRoZW4obnVsbCwgZSk7CgkgICAgICB9LCBvLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUgJiYgdGhpcy5zdGF0ZSA9PT0gYSB8fCAiZnVuY3Rpb24iICE9IHR5cGVvZiB0ICYmIHRoaXMuc3RhdGUgPT09IHMpIHJldHVybiB0aGlzOwoJICAgICAgICB2YXIgciA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHUpOwoJICAgICAgICB0aGlzLnN0YXRlICE9PSBuID8gZihyLCB0aGlzLnN0YXRlID09PSBhID8gZSA6IHQsIHRoaXMub3V0Y29tZSkgOiB0aGlzLnF1ZXVlLnB1c2gobmV3IGgociwgZSwgdCkpOwoJICAgICAgICByZXR1cm4gcjsKCSAgICAgIH0sIGgucHJvdG90eXBlLmNhbGxGdWxmaWxsZWQgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICBsLnJlc29sdmUodGhpcy5wcm9taXNlLCBlKTsKCSAgICAgIH0sIGgucHJvdG90eXBlLm90aGVyQ2FsbEZ1bGZpbGxlZCA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIGYodGhpcy5wcm9taXNlLCB0aGlzLm9uRnVsZmlsbGVkLCBlKTsKCSAgICAgIH0sIGgucHJvdG90eXBlLmNhbGxSZWplY3RlZCA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIGwucmVqZWN0KHRoaXMucHJvbWlzZSwgZSk7CgkgICAgICB9LCBoLnByb3RvdHlwZS5vdGhlckNhbGxSZWplY3RlZCA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIGYodGhpcy5wcm9taXNlLCB0aGlzLm9uUmVqZWN0ZWQsIGUpOwoJICAgICAgfSwgbC5yZXNvbHZlID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgdmFyIHIgPSBwKGMsIHQpOwoJICAgICAgICBpZiAoImVycm9yIiA9PT0gci5zdGF0dXMpIHJldHVybiBsLnJlamVjdChlLCByLnZhbHVlKTsKCSAgICAgICAgdmFyIG4gPSByLnZhbHVlOwoJICAgICAgICBpZiAobikgZChlLCBuKTtlbHNlIHsKCSAgICAgICAgICBlLnN0YXRlID0gYSwgZS5vdXRjb21lID0gdDsKCSAgICAgICAgICBmb3IgKHZhciBpID0gLTEsIHMgPSBlLnF1ZXVlLmxlbmd0aDsgKytpIDwgczspIGUucXVldWVbaV0uY2FsbEZ1bGZpbGxlZCh0KTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gZTsKCSAgICAgIH0sIGwucmVqZWN0ID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgZS5zdGF0ZSA9IHMsIGUub3V0Y29tZSA9IHQ7CgkgICAgICAgIGZvciAodmFyIHIgPSAtMSwgbiA9IGUucXVldWUubGVuZ3RoOyArK3IgPCBuOykgZS5xdWV1ZVtyXS5jYWxsUmVqZWN0ZWQodCk7CgkgICAgICAgIHJldHVybiBlOwoJICAgICAgfSwgby5yZXNvbHZlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiB0aGlzKSByZXR1cm4gZTsKCSAgICAgICAgcmV0dXJuIGwucmVzb2x2ZShuZXcgdGhpcyh1KSwgZSk7CgkgICAgICB9LCBvLnJlamVjdCA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHZhciB0ID0gbmV3IHRoaXModSk7CgkgICAgICAgIHJldHVybiBsLnJlamVjdCh0LCBlKTsKCSAgICAgIH0sIG8uYWxsID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdmFyIHIgPSB0aGlzOwoJICAgICAgICBpZiAoIltvYmplY3QgQXJyYXldIiAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpKSByZXR1cm4gdGhpcy5yZWplY3QobmV3IFR5cGVFcnJvcigibXVzdCBiZSBhbiBhcnJheSIpKTsKCSAgICAgICAgdmFyIG4gPSBlLmxlbmd0aCwKCSAgICAgICAgICBpID0gITE7CgkgICAgICAgIGlmICghbikgcmV0dXJuIHRoaXMucmVzb2x2ZShbXSk7CgkgICAgICAgIHZhciBzID0gbmV3IEFycmF5KG4pLAoJICAgICAgICAgIGEgPSAwLAoJICAgICAgICAgIHQgPSAtMSwKCSAgICAgICAgICBvID0gbmV3IHRoaXModSk7CgkgICAgICAgIGZvciAoOyArK3QgPCBuOykgaChlW3RdLCB0KTsKCSAgICAgICAgcmV0dXJuIG87CgkgICAgICAgIGZ1bmN0aW9uIGgoZSwgdCkgewoJICAgICAgICAgIHIucmVzb2x2ZShlKS50aGVuKGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICBzW3RdID0gZSwgKythICE9PSBuIHx8IGkgfHwgKGkgPSAhMCwgbC5yZXNvbHZlKG8sIHMpKTsKCSAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgICAgaSB8fCAoaSA9ICEwLCBsLnJlamVjdChvLCBlKSk7CgkgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICAgIH0sIG8ucmFjZSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHZhciB0ID0gdGhpczsKCSAgICAgICAgaWYgKCJbb2JqZWN0IEFycmF5XSIgIT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKSkgcmV0dXJuIHRoaXMucmVqZWN0KG5ldyBUeXBlRXJyb3IoIm11c3QgYmUgYW4gYXJyYXkiKSk7CgkgICAgICAgIHZhciByID0gZS5sZW5ndGgsCgkgICAgICAgICAgbiA9ICExOwoJICAgICAgICBpZiAoIXIpIHJldHVybiB0aGlzLnJlc29sdmUoW10pOwoJICAgICAgICB2YXIgaSA9IC0xLAoJICAgICAgICAgIHMgPSBuZXcgdGhpcyh1KTsKCSAgICAgICAgZm9yICg7ICsraSA8IHI7KSBhID0gZVtpXSwgdC5yZXNvbHZlKGEpLnRoZW4oZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICBuIHx8IChuID0gITAsIGwucmVzb2x2ZShzLCBlKSk7CgkgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgbiB8fCAobiA9ICEwLCBsLnJlamVjdChzLCBlKSk7CgkgICAgICAgIH0pOwoJICAgICAgICB2YXIgYTsKCSAgICAgICAgcmV0dXJuIHM7CgkgICAgICB9OwoJICAgIH0sIHsKCSAgICAgIGltbWVkaWF0ZTogMzYKCSAgICB9XSwKCSAgICAzODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG4gPSB7fTsKCSAgICAgICgwLCBlKCIuL2xpYi91dGlscy9jb21tb24iKS5hc3NpZ24pKG4sIGUoIi4vbGliL2RlZmxhdGUiKSwgZSgiLi9saWIvaW5mbGF0ZSIpLCBlKCIuL2xpYi96bGliL2NvbnN0YW50cyIpKSwgdC5leHBvcnRzID0gbjsKCSAgICB9LCB7CgkgICAgICAiLi9saWIvZGVmbGF0ZSI6IDM5LAoJICAgICAgIi4vbGliL2luZmxhdGUiOiA0MCwKCSAgICAgICIuL2xpYi91dGlscy9jb21tb24iOiA0MSwKCSAgICAgICIuL2xpYi96bGliL2NvbnN0YW50cyI6IDQ0CgkgICAgfV0sCgkgICAgMzk6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBhID0gZSgiLi96bGliL2RlZmxhdGUiKSwKCSAgICAgICAgbyA9IGUoIi4vdXRpbHMvY29tbW9uIiksCgkgICAgICAgIGggPSBlKCIuL3V0aWxzL3N0cmluZ3MiKSwKCSAgICAgICAgaSA9IGUoIi4vemxpYi9tZXNzYWdlcyIpLAoJICAgICAgICBzID0gZSgiLi96bGliL3pzdHJlYW0iKSwKCSAgICAgICAgdSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsCgkgICAgICAgIGwgPSAwLAoJICAgICAgICBmID0gLTEsCgkgICAgICAgIGMgPSAwLAoJICAgICAgICBkID0gODsKCSAgICAgIGZ1bmN0aW9uIHAoZSkgewoJICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgcCkpIHJldHVybiBuZXcgcChlKTsKCSAgICAgICAgdGhpcy5vcHRpb25zID0gby5hc3NpZ24oewoJICAgICAgICAgIGxldmVsOiBmLAoJICAgICAgICAgIG1ldGhvZDogZCwKCSAgICAgICAgICBjaHVua1NpemU6IDE2Mzg0LAoJICAgICAgICAgIHdpbmRvd0JpdHM6IDE1LAoJICAgICAgICAgIG1lbUxldmVsOiA4LAoJICAgICAgICAgIHN0cmF0ZWd5OiBjLAoJICAgICAgICAgIHRvOiAiIgoJICAgICAgICB9LCBlIHx8IHt9KTsKCSAgICAgICAgdmFyIHQgPSB0aGlzLm9wdGlvbnM7CgkgICAgICAgIHQucmF3ICYmIDAgPCB0LndpbmRvd0JpdHMgPyB0LndpbmRvd0JpdHMgPSAtdC53aW5kb3dCaXRzIDogdC5nemlwICYmIDAgPCB0LndpbmRvd0JpdHMgJiYgdC53aW5kb3dCaXRzIDwgMTYgJiYgKHQud2luZG93Qml0cyArPSAxNiksIHRoaXMuZXJyID0gMCwgdGhpcy5tc2cgPSAiIiwgdGhpcy5lbmRlZCA9ICExLCB0aGlzLmNodW5rcyA9IFtdLCB0aGlzLnN0cm0gPSBuZXcgcygpLCB0aGlzLnN0cm0uYXZhaWxfb3V0ID0gMDsKCSAgICAgICAgdmFyIHIgPSBhLmRlZmxhdGVJbml0Mih0aGlzLnN0cm0sIHQubGV2ZWwsIHQubWV0aG9kLCB0LndpbmRvd0JpdHMsIHQubWVtTGV2ZWwsIHQuc3RyYXRlZ3kpOwoJICAgICAgICBpZiAociAhPT0gbCkgdGhyb3cgbmV3IEVycm9yKGlbcl0pOwoJICAgICAgICBpZiAodC5oZWFkZXIgJiYgYS5kZWZsYXRlU2V0SGVhZGVyKHRoaXMuc3RybSwgdC5oZWFkZXIpLCB0LmRpY3Rpb25hcnkpIHsKCSAgICAgICAgICB2YXIgbjsKCSAgICAgICAgICBpZiAobiA9ICJzdHJpbmciID09IHR5cGVvZiB0LmRpY3Rpb25hcnkgPyBoLnN0cmluZzJidWYodC5kaWN0aW9uYXJ5KSA6ICJbb2JqZWN0IEFycmF5QnVmZmVyXSIgPT09IHUuY2FsbCh0LmRpY3Rpb25hcnkpID8gbmV3IFVpbnQ4QXJyYXkodC5kaWN0aW9uYXJ5KSA6IHQuZGljdGlvbmFyeSwgKHIgPSBhLmRlZmxhdGVTZXREaWN0aW9uYXJ5KHRoaXMuc3RybSwgbikpICE9PSBsKSB0aHJvdyBuZXcgRXJyb3IoaVtyXSk7CgkgICAgICAgICAgdGhpcy5fZGljdF9zZXQgPSAhMDsKCSAgICAgICAgfQoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gbihlLCB0KSB7CgkgICAgICAgIHZhciByID0gbmV3IHAodCk7CgkgICAgICAgIGlmIChyLnB1c2goZSwgITApLCByLmVycikgdGhyb3cgci5tc2cgfHwgaVtyLmVycl07CgkgICAgICAgIHJldHVybiByLnJlc3VsdDsKCSAgICAgIH0KCSAgICAgIHAucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICB2YXIgciwKCSAgICAgICAgICBuLAoJICAgICAgICAgIGkgPSB0aGlzLnN0cm0sCgkgICAgICAgICAgcyA9IHRoaXMub3B0aW9ucy5jaHVua1NpemU7CgkgICAgICAgIGlmICh0aGlzLmVuZGVkKSByZXR1cm4gITE7CgkgICAgICAgIG4gPSB0ID09PSB+fnQgPyB0IDogITAgPT09IHQgPyA0IDogMCwgInN0cmluZyIgPT0gdHlwZW9mIGUgPyBpLmlucHV0ID0gaC5zdHJpbmcyYnVmKGUpIDogIltvYmplY3QgQXJyYXlCdWZmZXJdIiA9PT0gdS5jYWxsKGUpID8gaS5pbnB1dCA9IG5ldyBVaW50OEFycmF5KGUpIDogaS5pbnB1dCA9IGUsIGkubmV4dF9pbiA9IDAsIGkuYXZhaWxfaW4gPSBpLmlucHV0Lmxlbmd0aDsKCSAgICAgICAgZG8gewoJICAgICAgICAgIGlmICgwID09PSBpLmF2YWlsX291dCAmJiAoaS5vdXRwdXQgPSBuZXcgby5CdWY4KHMpLCBpLm5leHRfb3V0ID0gMCwgaS5hdmFpbF9vdXQgPSBzKSwgMSAhPT0gKHIgPSBhLmRlZmxhdGUoaSwgbikpICYmIHIgIT09IGwpIHJldHVybiB0aGlzLm9uRW5kKHIpLCAhKHRoaXMuZW5kZWQgPSAhMCk7CgkgICAgICAgICAgMCAhPT0gaS5hdmFpbF9vdXQgJiYgKDAgIT09IGkuYXZhaWxfaW4gfHwgNCAhPT0gbiAmJiAyICE9PSBuKSB8fCAoInN0cmluZyIgPT09IHRoaXMub3B0aW9ucy50byA/IHRoaXMub25EYXRhKGguYnVmMmJpbnN0cmluZyhvLnNocmlua0J1ZihpLm91dHB1dCwgaS5uZXh0X291dCkpKSA6IHRoaXMub25EYXRhKG8uc2hyaW5rQnVmKGkub3V0cHV0LCBpLm5leHRfb3V0KSkpOwoJICAgICAgICB9IHdoaWxlICgoMCA8IGkuYXZhaWxfaW4gfHwgMCA9PT0gaS5hdmFpbF9vdXQpICYmIDEgIT09IHIpOwoJICAgICAgICByZXR1cm4gNCA9PT0gbiA/IChyID0gYS5kZWZsYXRlRW5kKHRoaXMuc3RybSksIHRoaXMub25FbmQociksIHRoaXMuZW5kZWQgPSAhMCwgciA9PT0gbCkgOiAyICE9PSBuIHx8ICh0aGlzLm9uRW5kKGwpLCAhKGkuYXZhaWxfb3V0ID0gMCkpOwoJICAgICAgfSwgcC5wcm90b3R5cGUub25EYXRhID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdGhpcy5jaHVua3MucHVzaChlKTsKCSAgICAgIH0sIHAucHJvdG90eXBlLm9uRW5kID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgZSA9PT0gbCAmJiAoInN0cmluZyIgPT09IHRoaXMub3B0aW9ucy50byA/IHRoaXMucmVzdWx0ID0gdGhpcy5jaHVua3Muam9pbigiIikgOiB0aGlzLnJlc3VsdCA9IG8uZmxhdHRlbkNodW5rcyh0aGlzLmNodW5rcykpLCB0aGlzLmNodW5rcyA9IFtdLCB0aGlzLmVyciA9IGUsIHRoaXMubXNnID0gdGhpcy5zdHJtLm1zZzsKCSAgICAgIH0sIHIuRGVmbGF0ZSA9IHAsIHIuZGVmbGF0ZSA9IG4sIHIuZGVmbGF0ZVJhdyA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHJldHVybiAodCA9IHQgfHwge30pLnJhdyA9ICEwLCBuKGUsIHQpOwoJICAgICAgfSwgci5nemlwID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgcmV0dXJuICh0ID0gdCB8fCB7fSkuZ3ppcCA9ICEwLCBuKGUsIHQpOwoJICAgICAgfTsKCSAgICB9LCB7CgkgICAgICAiLi91dGlscy9jb21tb24iOiA0MSwKCSAgICAgICIuL3V0aWxzL3N0cmluZ3MiOiA0MiwKCSAgICAgICIuL3psaWIvZGVmbGF0ZSI6IDQ2LAoJICAgICAgIi4vemxpYi9tZXNzYWdlcyI6IDUxLAoJICAgICAgIi4vemxpYi96c3RyZWFtIjogNTMKCSAgICB9XSwKCSAgICA0MDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIGMgPSBlKCIuL3psaWIvaW5mbGF0ZSIpLAoJICAgICAgICBkID0gZSgiLi91dGlscy9jb21tb24iKSwKCSAgICAgICAgcCA9IGUoIi4vdXRpbHMvc3RyaW5ncyIpLAoJICAgICAgICBtID0gZSgiLi96bGliL2NvbnN0YW50cyIpLAoJICAgICAgICBuID0gZSgiLi96bGliL21lc3NhZ2VzIiksCgkgICAgICAgIGkgPSBlKCIuL3psaWIvenN0cmVhbSIpLAoJICAgICAgICBzID0gZSgiLi96bGliL2d6aGVhZGVyIiksCgkgICAgICAgIF8gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwoJICAgICAgZnVuY3Rpb24gYShlKSB7CgkgICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBhKSkgcmV0dXJuIG5ldyBhKGUpOwoJICAgICAgICB0aGlzLm9wdGlvbnMgPSBkLmFzc2lnbih7CgkgICAgICAgICAgY2h1bmtTaXplOiAxNjM4NCwKCSAgICAgICAgICB3aW5kb3dCaXRzOiAwLAoJICAgICAgICAgIHRvOiAiIgoJICAgICAgICB9LCBlIHx8IHt9KTsKCSAgICAgICAgdmFyIHQgPSB0aGlzLm9wdGlvbnM7CgkgICAgICAgIHQucmF3ICYmIDAgPD0gdC53aW5kb3dCaXRzICYmIHQud2luZG93Qml0cyA8IDE2ICYmICh0LndpbmRvd0JpdHMgPSAtdC53aW5kb3dCaXRzLCAwID09PSB0LndpbmRvd0JpdHMgJiYgKHQud2luZG93Qml0cyA9IC0xNSkpLCAhKDAgPD0gdC53aW5kb3dCaXRzICYmIHQud2luZG93Qml0cyA8IDE2KSB8fCBlICYmIGUud2luZG93Qml0cyB8fCAodC53aW5kb3dCaXRzICs9IDMyKSwgMTUgPCB0LndpbmRvd0JpdHMgJiYgdC53aW5kb3dCaXRzIDwgNDggJiYgMCA9PSAoMTUgJiB0LndpbmRvd0JpdHMpICYmICh0LndpbmRvd0JpdHMgfD0gMTUpLCB0aGlzLmVyciA9IDAsIHRoaXMubXNnID0gIiIsIHRoaXMuZW5kZWQgPSAhMSwgdGhpcy5jaHVua3MgPSBbXSwgdGhpcy5zdHJtID0gbmV3IGkoKSwgdGhpcy5zdHJtLmF2YWlsX291dCA9IDA7CgkgICAgICAgIHZhciByID0gYy5pbmZsYXRlSW5pdDIodGhpcy5zdHJtLCB0LndpbmRvd0JpdHMpOwoJICAgICAgICBpZiAociAhPT0gbS5aX09LKSB0aHJvdyBuZXcgRXJyb3IobltyXSk7CgkgICAgICAgIHRoaXMuaGVhZGVyID0gbmV3IHMoKSwgYy5pbmZsYXRlR2V0SGVhZGVyKHRoaXMuc3RybSwgdGhpcy5oZWFkZXIpOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gbyhlLCB0KSB7CgkgICAgICAgIHZhciByID0gbmV3IGEodCk7CgkgICAgICAgIGlmIChyLnB1c2goZSwgITApLCByLmVycikgdGhyb3cgci5tc2cgfHwgbltyLmVycl07CgkgICAgICAgIHJldHVybiByLnJlc3VsdDsKCSAgICAgIH0KCSAgICAgIGEucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICB2YXIgciwKCSAgICAgICAgICBuLAoJICAgICAgICAgIGksCgkgICAgICAgICAgcywKCSAgICAgICAgICBhLAoJICAgICAgICAgIG8sCgkgICAgICAgICAgaCA9IHRoaXMuc3RybSwKCSAgICAgICAgICB1ID0gdGhpcy5vcHRpb25zLmNodW5rU2l6ZSwKCSAgICAgICAgICBsID0gdGhpcy5vcHRpb25zLmRpY3Rpb25hcnksCgkgICAgICAgICAgZiA9ICExOwoJICAgICAgICBpZiAodGhpcy5lbmRlZCkgcmV0dXJuICExOwoJICAgICAgICBuID0gdCA9PT0gfn50ID8gdCA6ICEwID09PSB0ID8gbS5aX0ZJTklTSCA6IG0uWl9OT19GTFVTSCwgInN0cmluZyIgPT0gdHlwZW9mIGUgPyBoLmlucHV0ID0gcC5iaW5zdHJpbmcyYnVmKGUpIDogIltvYmplY3QgQXJyYXlCdWZmZXJdIiA9PT0gXy5jYWxsKGUpID8gaC5pbnB1dCA9IG5ldyBVaW50OEFycmF5KGUpIDogaC5pbnB1dCA9IGUsIGgubmV4dF9pbiA9IDAsIGguYXZhaWxfaW4gPSBoLmlucHV0Lmxlbmd0aDsKCSAgICAgICAgZG8gewoJICAgICAgICAgIGlmICgwID09PSBoLmF2YWlsX291dCAmJiAoaC5vdXRwdXQgPSBuZXcgZC5CdWY4KHUpLCBoLm5leHRfb3V0ID0gMCwgaC5hdmFpbF9vdXQgPSB1KSwgKHIgPSBjLmluZmxhdGUoaCwgbS5aX05PX0ZMVVNIKSkgPT09IG0uWl9ORUVEX0RJQ1QgJiYgbCAmJiAobyA9ICJzdHJpbmciID09IHR5cGVvZiBsID8gcC5zdHJpbmcyYnVmKGwpIDogIltvYmplY3QgQXJyYXlCdWZmZXJdIiA9PT0gXy5jYWxsKGwpID8gbmV3IFVpbnQ4QXJyYXkobCkgOiBsLCByID0gYy5pbmZsYXRlU2V0RGljdGlvbmFyeSh0aGlzLnN0cm0sIG8pKSwgciA9PT0gbS5aX0JVRl9FUlJPUiAmJiAhMCA9PT0gZiAmJiAociA9IG0uWl9PSywgZiA9ICExKSwgciAhPT0gbS5aX1NUUkVBTV9FTkQgJiYgciAhPT0gbS5aX09LKSByZXR1cm4gdGhpcy5vbkVuZChyKSwgISh0aGlzLmVuZGVkID0gITApOwoJICAgICAgICAgIGgubmV4dF9vdXQgJiYgKDAgIT09IGguYXZhaWxfb3V0ICYmIHIgIT09IG0uWl9TVFJFQU1fRU5EICYmICgwICE9PSBoLmF2YWlsX2luIHx8IG4gIT09IG0uWl9GSU5JU0ggJiYgbiAhPT0gbS5aX1NZTkNfRkxVU0gpIHx8ICgic3RyaW5nIiA9PT0gdGhpcy5vcHRpb25zLnRvID8gKGkgPSBwLnV0Zjhib3JkZXIoaC5vdXRwdXQsIGgubmV4dF9vdXQpLCBzID0gaC5uZXh0X291dCAtIGksIGEgPSBwLmJ1ZjJzdHJpbmcoaC5vdXRwdXQsIGkpLCBoLm5leHRfb3V0ID0gcywgaC5hdmFpbF9vdXQgPSB1IC0gcywgcyAmJiBkLmFycmF5U2V0KGgub3V0cHV0LCBoLm91dHB1dCwgaSwgcywgMCksIHRoaXMub25EYXRhKGEpKSA6IHRoaXMub25EYXRhKGQuc2hyaW5rQnVmKGgub3V0cHV0LCBoLm5leHRfb3V0KSkpKSwgMCA9PT0gaC5hdmFpbF9pbiAmJiAwID09PSBoLmF2YWlsX291dCAmJiAoZiA9ICEwKTsKCSAgICAgICAgfSB3aGlsZSAoKDAgPCBoLmF2YWlsX2luIHx8IDAgPT09IGguYXZhaWxfb3V0KSAmJiByICE9PSBtLlpfU1RSRUFNX0VORCk7CgkgICAgICAgIHJldHVybiByID09PSBtLlpfU1RSRUFNX0VORCAmJiAobiA9IG0uWl9GSU5JU0gpLCBuID09PSBtLlpfRklOSVNIID8gKHIgPSBjLmluZmxhdGVFbmQodGhpcy5zdHJtKSwgdGhpcy5vbkVuZChyKSwgdGhpcy5lbmRlZCA9ICEwLCByID09PSBtLlpfT0spIDogbiAhPT0gbS5aX1NZTkNfRkxVU0ggfHwgKHRoaXMub25FbmQobS5aX09LKSwgIShoLmF2YWlsX291dCA9IDApKTsKCSAgICAgIH0sIGEucHJvdG90eXBlLm9uRGF0YSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIHRoaXMuY2h1bmtzLnB1c2goZSk7CgkgICAgICB9LCBhLnByb3RvdHlwZS5vbkVuZCA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIGUgPT09IG0uWl9PSyAmJiAoInN0cmluZyIgPT09IHRoaXMub3B0aW9ucy50byA/IHRoaXMucmVzdWx0ID0gdGhpcy5jaHVua3Muam9pbigiIikgOiB0aGlzLnJlc3VsdCA9IGQuZmxhdHRlbkNodW5rcyh0aGlzLmNodW5rcykpLCB0aGlzLmNodW5rcyA9IFtdLCB0aGlzLmVyciA9IGUsIHRoaXMubXNnID0gdGhpcy5zdHJtLm1zZzsKCSAgICAgIH0sIHIuSW5mbGF0ZSA9IGEsIHIuaW5mbGF0ZSA9IG8sIHIuaW5mbGF0ZVJhdyA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHJldHVybiAodCA9IHQgfHwge30pLnJhdyA9ICEwLCBvKGUsIHQpOwoJICAgICAgfSwgci51bmd6aXAgPSBvOwoJICAgIH0sIHsKCSAgICAgICIuL3V0aWxzL2NvbW1vbiI6IDQxLAoJICAgICAgIi4vdXRpbHMvc3RyaW5ncyI6IDQyLAoJICAgICAgIi4vemxpYi9jb25zdGFudHMiOiA0NCwKCSAgICAgICIuL3psaWIvZ3poZWFkZXIiOiA0NywKCSAgICAgICIuL3psaWIvaW5mbGF0ZSI6IDQ5LAoJICAgICAgIi4vemxpYi9tZXNzYWdlcyI6IDUxLAoJICAgICAgIi4vemxpYi96c3RyZWFtIjogNTMKCSAgICB9XSwKCSAgICA0MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG4gPSAidW5kZWZpbmVkIiAhPSB0eXBlb2YgVWludDhBcnJheSAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgVWludDE2QXJyYXkgJiYgInVuZGVmaW5lZCIgIT0gdHlwZW9mIEludDMyQXJyYXk7CgkgICAgICByLmFzc2lnbiA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIGZvciAodmFyIHQgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOyB0Lmxlbmd0aDspIHsKCSAgICAgICAgICB2YXIgciA9IHQuc2hpZnQoKTsKCSAgICAgICAgICBpZiAocikgewoJICAgICAgICAgICAgaWYgKCJvYmplY3QiICE9IF90eXBlb2YocikpIHRocm93IG5ldyBUeXBlRXJyb3IociArICJtdXN0IGJlIG5vbi1vYmplY3QiKTsKCSAgICAgICAgICAgIGZvciAodmFyIG4gaW4gcikgci5oYXNPd25Qcm9wZXJ0eShuKSAmJiAoZVtuXSA9IHJbbl0pOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gZTsKCSAgICAgIH0sIHIuc2hyaW5rQnVmID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgcmV0dXJuIGUubGVuZ3RoID09PSB0ID8gZSA6IGUuc3ViYXJyYXkgPyBlLnN1YmFycmF5KDAsIHQpIDogKGUubGVuZ3RoID0gdCwgZSk7CgkgICAgICB9OwoJICAgICAgdmFyIGkgPSB7CgkgICAgICAgICAgYXJyYXlTZXQ6IGZ1bmN0aW9uIGFycmF5U2V0KGUsIHQsIHIsIG4sIGkpIHsKCSAgICAgICAgICAgIGlmICh0LnN1YmFycmF5ICYmIGUuc3ViYXJyYXkpIGUuc2V0KHQuc3ViYXJyYXkociwgciArIG4pLCBpKTtlbHNlIGZvciAodmFyIHMgPSAwOyBzIDwgbjsgcysrKSBlW2kgKyBzXSA9IHRbciArIHNdOwoJICAgICAgICAgIH0sCgkgICAgICAgICAgZmxhdHRlbkNodW5rczogZnVuY3Rpb24gZmxhdHRlbkNodW5rcyhlKSB7CgkgICAgICAgICAgICB2YXIgdCwgciwgbiwgaSwgcywgYTsKCSAgICAgICAgICAgIGZvciAodCA9IG4gPSAwLCByID0gZS5sZW5ndGg7IHQgPCByOyB0KyspIG4gKz0gZVt0XS5sZW5ndGg7CgkgICAgICAgICAgICBmb3IgKGEgPSBuZXcgVWludDhBcnJheShuKSwgdCA9IGkgPSAwLCByID0gZS5sZW5ndGg7IHQgPCByOyB0KyspIHMgPSBlW3RdLCBhLnNldChzLCBpKSwgaSArPSBzLmxlbmd0aDsKCSAgICAgICAgICAgIHJldHVybiBhOwoJICAgICAgICAgIH0KCSAgICAgICAgfSwKCSAgICAgICAgcyA9IHsKCSAgICAgICAgICBhcnJheVNldDogZnVuY3Rpb24gYXJyYXlTZXQoZSwgdCwgciwgbiwgaSkgewoJICAgICAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBuOyBzKyspIGVbaSArIHNdID0gdFtyICsgc107CgkgICAgICAgICAgfSwKCSAgICAgICAgICBmbGF0dGVuQ2h1bmtzOiBmdW5jdGlvbiBmbGF0dGVuQ2h1bmtzKGUpIHsKCSAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQuYXBwbHkoW10sIGUpOwoJICAgICAgICAgIH0KCSAgICAgICAgfTsKCSAgICAgIHIuc2V0VHlwZWQgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICBlID8gKHIuQnVmOCA9IFVpbnQ4QXJyYXksIHIuQnVmMTYgPSBVaW50MTZBcnJheSwgci5CdWYzMiA9IEludDMyQXJyYXksIHIuYXNzaWduKHIsIGkpKSA6IChyLkJ1ZjggPSBBcnJheSwgci5CdWYxNiA9IEFycmF5LCByLkJ1ZjMyID0gQXJyYXksIHIuYXNzaWduKHIsIHMpKTsKCSAgICAgIH0sIHIuc2V0VHlwZWQobik7CgkgICAgfSwge31dLAoJICAgIDQyOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgaCA9IGUoIi4vY29tbW9uIiksCgkgICAgICAgIGkgPSAhMCwKCSAgICAgICAgcyA9ICEwOwoJICAgICAgdHJ5IHsKCSAgICAgICAgU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBbMF0pOwoJICAgICAgfSBjYXRjaCAoZSkgewoJICAgICAgICBpID0gITE7CgkgICAgICB9CgkgICAgICB0cnkgewoJICAgICAgICBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIG5ldyBVaW50OEFycmF5KDEpKTsKCSAgICAgIH0gY2F0Y2ggKGUpIHsKCSAgICAgICAgcyA9ICExOwoJICAgICAgfQoJICAgICAgZm9yICh2YXIgdSA9IG5ldyBoLkJ1ZjgoMjU2KSwgbiA9IDA7IG4gPCAyNTY7IG4rKykgdVtuXSA9IDI1MiA8PSBuID8gNiA6IDI0OCA8PSBuID8gNSA6IDI0MCA8PSBuID8gNCA6IDIyNCA8PSBuID8gMyA6IDE5MiA8PSBuID8gMiA6IDE7CgkgICAgICBmdW5jdGlvbiBsKGUsIHQpIHsKCSAgICAgICAgaWYgKHQgPCA2NTUzNyAmJiAoZS5zdWJhcnJheSAmJiBzIHx8ICFlLnN1YmFycmF5ICYmIGkpKSByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBoLnNocmlua0J1ZihlLCB0KSk7CgkgICAgICAgIGZvciAodmFyIHIgPSAiIiwgbiA9IDA7IG4gPCB0OyBuKyspIHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShlW25dKTsKCSAgICAgICAgcmV0dXJuIHI7CgkgICAgICB9CgkgICAgICB1WzI1NF0gPSB1WzI1NF0gPSAxLCByLnN0cmluZzJidWYgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICB2YXIgdCwKCSAgICAgICAgICByLAoJICAgICAgICAgIG4sCgkgICAgICAgICAgaSwKCSAgICAgICAgICBzLAoJICAgICAgICAgIGEgPSBlLmxlbmd0aCwKCSAgICAgICAgICBvID0gMDsKCSAgICAgICAgZm9yIChpID0gMDsgaSA8IGE7IGkrKykgNTUyOTYgPT0gKDY0NTEyICYgKHIgPSBlLmNoYXJDb2RlQXQoaSkpKSAmJiBpICsgMSA8IGEgJiYgNTYzMjAgPT0gKDY0NTEyICYgKG4gPSBlLmNoYXJDb2RlQXQoaSArIDEpKSkgJiYgKHIgPSA2NTUzNiArIChyIC0gNTUyOTYgPDwgMTApICsgKG4gLSA1NjMyMCksIGkrKyksIG8gKz0gciA8IDEyOCA/IDEgOiByIDwgMjA0OCA/IDIgOiByIDwgNjU1MzYgPyAzIDogNDsKCSAgICAgICAgZm9yICh0ID0gbmV3IGguQnVmOChvKSwgaSA9IHMgPSAwOyBzIDwgbzsgaSsrKSA1NTI5NiA9PSAoNjQ1MTIgJiAociA9IGUuY2hhckNvZGVBdChpKSkpICYmIGkgKyAxIDwgYSAmJiA1NjMyMCA9PSAoNjQ1MTIgJiAobiA9IGUuY2hhckNvZGVBdChpICsgMSkpKSAmJiAociA9IDY1NTM2ICsgKHIgLSA1NTI5NiA8PCAxMCkgKyAobiAtIDU2MzIwKSwgaSsrKSwgciA8IDEyOCA/IHRbcysrXSA9IHIgOiAociA8IDIwNDggPyB0W3MrK10gPSAxOTIgfCByID4+PiA2IDogKHIgPCA2NTUzNiA/IHRbcysrXSA9IDIyNCB8IHIgPj4+IDEyIDogKHRbcysrXSA9IDI0MCB8IHIgPj4+IDE4LCB0W3MrK10gPSAxMjggfCByID4+PiAxMiAmIDYzKSwgdFtzKytdID0gMTI4IHwgciA+Pj4gNiAmIDYzKSwgdFtzKytdID0gMTI4IHwgNjMgJiByKTsKCSAgICAgICAgcmV0dXJuIHQ7CgkgICAgICB9LCByLmJ1ZjJiaW5zdHJpbmcgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICByZXR1cm4gbChlLCBlLmxlbmd0aCk7CgkgICAgICB9LCByLmJpbnN0cmluZzJidWYgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICBmb3IgKHZhciB0ID0gbmV3IGguQnVmOChlLmxlbmd0aCksIHIgPSAwLCBuID0gdC5sZW5ndGg7IHIgPCBuOyByKyspIHRbcl0gPSBlLmNoYXJDb2RlQXQocik7CgkgICAgICAgIHJldHVybiB0OwoJICAgICAgfSwgci5idWYyc3RyaW5nID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgdmFyIHIsCgkgICAgICAgICAgbiwKCSAgICAgICAgICBpLAoJICAgICAgICAgIHMsCgkgICAgICAgICAgYSA9IHQgfHwgZS5sZW5ndGgsCgkgICAgICAgICAgbyA9IG5ldyBBcnJheSgyICogYSk7CgkgICAgICAgIGZvciAociA9IG4gPSAwOyByIDwgYTspIGlmICgoaSA9IGVbcisrXSkgPCAxMjgpIG9bbisrXSA9IGk7ZWxzZSBpZiAoNCA8IChzID0gdVtpXSkpIG9bbisrXSA9IDY1NTMzLCByICs9IHMgLSAxO2Vsc2UgewoJICAgICAgICAgIGZvciAoaSAmPSAyID09PSBzID8gMzEgOiAzID09PSBzID8gMTUgOiA3OyAxIDwgcyAmJiByIDwgYTspIGkgPSBpIDw8IDYgfCA2MyAmIGVbcisrXSwgcy0tOwoJICAgICAgICAgIDEgPCBzID8gb1tuKytdID0gNjU1MzMgOiBpIDwgNjU1MzYgPyBvW24rK10gPSBpIDogKGkgLT0gNjU1MzYsIG9bbisrXSA9IDU1Mjk2IHwgaSA+PiAxMCAmIDEwMjMsIG9bbisrXSA9IDU2MzIwIHwgMTAyMyAmIGkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBsKG8sIG4pOwoJICAgICAgfSwgci51dGY4Ym9yZGVyID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgdmFyIHI7CgkgICAgICAgIGZvciAoKHQgPSB0IHx8IGUubGVuZ3RoKSA+IGUubGVuZ3RoICYmICh0ID0gZS5sZW5ndGgpLCByID0gdCAtIDE7IDAgPD0gciAmJiAxMjggPT0gKDE5MiAmIGVbcl0pOykgci0tOwoJICAgICAgICByZXR1cm4gciA8IDAgPyB0IDogMCA9PT0gciA/IHQgOiByICsgdVtlW3JdXSA+IHQgPyByIDogdDsKCSAgICAgIH07CgkgICAgfSwgewoJICAgICAgIi4vY29tbW9uIjogNDEKCSAgICB9XSwKCSAgICA0MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDY1NTM1ICYgZSB8IDAsIHMgPSBlID4+PiAxNiAmIDY1NTM1IHwgMCwgYSA9IDA7IDAgIT09IHI7KSB7CgkgICAgICAgICAgZm9yIChyIC09IGEgPSAyZTMgPCByID8gMmUzIDogcjsgcyA9IHMgKyAoaSA9IGkgKyB0W24rK10gfCAwKSB8IDAsIC0tYTspOwoJICAgICAgICAgIGkgJT0gNjU1MjEsIHMgJT0gNjU1MjE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGkgfCBzIDw8IDE2IHwgMDsKCSAgICAgIH07CgkgICAgfSwge31dLAoJICAgIDQ0OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB0LmV4cG9ydHMgPSB7CgkgICAgICAgIFpfTk9fRkxVU0g6IDAsCgkgICAgICAgIFpfUEFSVElBTF9GTFVTSDogMSwKCSAgICAgICAgWl9TWU5DX0ZMVVNIOiAyLAoJICAgICAgICBaX0ZVTExfRkxVU0g6IDMsCgkgICAgICAgIFpfRklOSVNIOiA0LAoJICAgICAgICBaX0JMT0NLOiA1LAoJICAgICAgICBaX1RSRUVTOiA2LAoJICAgICAgICBaX09LOiAwLAoJICAgICAgICBaX1NUUkVBTV9FTkQ6IDEsCgkgICAgICAgIFpfTkVFRF9ESUNUOiAyLAoJICAgICAgICBaX0VSUk5POiAtMSwKCSAgICAgICAgWl9TVFJFQU1fRVJST1I6IC0yLAoJICAgICAgICBaX0RBVEFfRVJST1I6IC0zLAoJICAgICAgICBaX0JVRl9FUlJPUjogLTUsCgkgICAgICAgIFpfTk9fQ09NUFJFU1NJT046IDAsCgkgICAgICAgIFpfQkVTVF9TUEVFRDogMSwKCSAgICAgICAgWl9CRVNUX0NPTVBSRVNTSU9OOiA5LAoJICAgICAgICBaX0RFRkFVTFRfQ09NUFJFU1NJT046IC0xLAoJICAgICAgICBaX0ZJTFRFUkVEOiAxLAoJICAgICAgICBaX0hVRkZNQU5fT05MWTogMiwKCSAgICAgICAgWl9STEU6IDMsCgkgICAgICAgIFpfRklYRUQ6IDQsCgkgICAgICAgIFpfREVGQVVMVF9TVFJBVEVHWTogMCwKCSAgICAgICAgWl9CSU5BUlk6IDAsCgkgICAgICAgIFpfVEVYVDogMSwKCSAgICAgICAgWl9VTktOT1dOOiAyLAoJICAgICAgICBaX0RFRkxBVEVEOiA4CgkgICAgICB9OwoJICAgIH0sIHt9XSwKCSAgICA0NTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIG8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGZvciAodmFyIGUsIHQgPSBbXSwgciA9IDA7IHIgPCAyNTY7IHIrKykgewoJICAgICAgICAgIGUgPSByOwoJICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgODsgbisrKSBlID0gMSAmIGUgPyAzOTg4MjkyMzg0IF4gZSA+Pj4gMSA6IGUgPj4+IDE7CgkgICAgICAgICAgdFtyXSA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHQ7CgkgICAgICB9KCk7CgkgICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgciwgbikgewoJICAgICAgICB2YXIgaSA9IG8sCgkgICAgICAgICAgcyA9IG4gKyByOwoJICAgICAgICBlIF49IC0xOwoJICAgICAgICBmb3IgKHZhciBhID0gbjsgYSA8IHM7IGErKykgZSA9IGUgPj4+IDggXiBpWzI1NSAmIChlIF4gdFthXSldOwoJICAgICAgICByZXR1cm4gLTEgXiBlOwoJICAgICAgfTsKCSAgICB9LCB7fV0sCgkgICAgNDY6IFtmdW5jdGlvbiAoZSwgdCwgcikgewoKCSAgICAgIHZhciBoLAoJICAgICAgICBjID0gZSgiLi4vdXRpbHMvY29tbW9uIiksCgkgICAgICAgIHUgPSBlKCIuL3RyZWVzIiksCgkgICAgICAgIGQgPSBlKCIuL2FkbGVyMzIiKSwKCSAgICAgICAgcCA9IGUoIi4vY3JjMzIiKSwKCSAgICAgICAgbiA9IGUoIi4vbWVzc2FnZXMiKSwKCSAgICAgICAgbCA9IDAsCgkgICAgICAgIGYgPSA0LAoJICAgICAgICBtID0gMCwKCSAgICAgICAgXyA9IC0yLAoJICAgICAgICBnID0gLTEsCgkgICAgICAgIGIgPSA0LAoJICAgICAgICBpID0gMiwKCSAgICAgICAgdiA9IDgsCgkgICAgICAgIHkgPSA5LAoJICAgICAgICBzID0gMjg2LAoJICAgICAgICBhID0gMzAsCgkgICAgICAgIG8gPSAxOSwKCSAgICAgICAgdyA9IDIgKiBzICsgMSwKCSAgICAgICAgayA9IDE1LAoJICAgICAgICB4ID0gMywKCSAgICAgICAgUyA9IDI1OCwKCSAgICAgICAgeiA9IFMgKyB4ICsgMSwKCSAgICAgICAgQyA9IDQyLAoJICAgICAgICBFID0gMTEzLAoJICAgICAgICBBID0gMSwKCSAgICAgICAgSSA9IDIsCgkgICAgICAgIE8gPSAzLAoJICAgICAgICBCID0gNDsKCSAgICAgIGZ1bmN0aW9uIFIoZSwgdCkgewoJICAgICAgICByZXR1cm4gZS5tc2cgPSBuW3RdLCB0OwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gVChlKSB7CgkgICAgICAgIHJldHVybiAoZSA8PCAxKSAtICg0IDwgZSA/IDkgOiAwKTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIEQoZSkgewoJICAgICAgICBmb3IgKHZhciB0ID0gZS5sZW5ndGg7IDAgPD0gLS10OykgZVt0XSA9IDA7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBGKGUpIHsKCSAgICAgICAgdmFyIHQgPSBlLnN0YXRlLAoJICAgICAgICAgIHIgPSB0LnBlbmRpbmc7CgkgICAgICAgIHIgPiBlLmF2YWlsX291dCAmJiAociA9IGUuYXZhaWxfb3V0KSwgMCAhPT0gciAmJiAoYy5hcnJheVNldChlLm91dHB1dCwgdC5wZW5kaW5nX2J1ZiwgdC5wZW5kaW5nX291dCwgciwgZS5uZXh0X291dCksIGUubmV4dF9vdXQgKz0gciwgdC5wZW5kaW5nX291dCArPSByLCBlLnRvdGFsX291dCArPSByLCBlLmF2YWlsX291dCAtPSByLCB0LnBlbmRpbmcgLT0gciwgMCA9PT0gdC5wZW5kaW5nICYmICh0LnBlbmRpbmdfb3V0ID0gMCkpOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gTihlLCB0KSB7CgkgICAgICAgIHUuX3RyX2ZsdXNoX2Jsb2NrKGUsIDAgPD0gZS5ibG9ja19zdGFydCA/IGUuYmxvY2tfc3RhcnQgOiAtMSwgZS5zdHJzdGFydCAtIGUuYmxvY2tfc3RhcnQsIHQpLCBlLmJsb2NrX3N0YXJ0ID0gZS5zdHJzdGFydCwgRihlLnN0cm0pOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gVShlLCB0KSB7CgkgICAgICAgIGUucGVuZGluZ19idWZbZS5wZW5kaW5nKytdID0gdDsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIFAoZSwgdCkgewoJICAgICAgICBlLnBlbmRpbmdfYnVmW2UucGVuZGluZysrXSA9IHQgPj4+IDggJiAyNTUsIGUucGVuZGluZ19idWZbZS5wZW5kaW5nKytdID0gMjU1ICYgdDsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIEwoZSwgdCkgewoJICAgICAgICB2YXIgciwKCSAgICAgICAgICBuLAoJICAgICAgICAgIGkgPSBlLm1heF9jaGFpbl9sZW5ndGgsCgkgICAgICAgICAgcyA9IGUuc3Ryc3RhcnQsCgkgICAgICAgICAgYSA9IGUucHJldl9sZW5ndGgsCgkgICAgICAgICAgbyA9IGUubmljZV9tYXRjaCwKCSAgICAgICAgICBoID0gZS5zdHJzdGFydCA+IGUud19zaXplIC0geiA/IGUuc3Ryc3RhcnQgLSAoZS53X3NpemUgLSB6KSA6IDAsCgkgICAgICAgICAgdSA9IGUud2luZG93LAoJICAgICAgICAgIGwgPSBlLndfbWFzaywKCSAgICAgICAgICBmID0gZS5wcmV2LAoJICAgICAgICAgIGMgPSBlLnN0cnN0YXJ0ICsgUywKCSAgICAgICAgICBkID0gdVtzICsgYSAtIDFdLAoJICAgICAgICAgIHAgPSB1W3MgKyBhXTsKCSAgICAgICAgZS5wcmV2X2xlbmd0aCA+PSBlLmdvb2RfbWF0Y2ggJiYgKGkgPj49IDIpLCBvID4gZS5sb29rYWhlYWQgJiYgKG8gPSBlLmxvb2thaGVhZCk7CgkgICAgICAgIGRvIHsKCSAgICAgICAgICBpZiAodVsociA9IHQpICsgYV0gPT09IHAgJiYgdVtyICsgYSAtIDFdID09PSBkICYmIHVbcl0gPT09IHVbc10gJiYgdVsrK3JdID09PSB1W3MgKyAxXSkgewoJICAgICAgICAgICAgcyArPSAyLCByKys7CgkgICAgICAgICAgICBkbyB7fSB3aGlsZSAodVsrK3NdID09PSB1Wysrcl0gJiYgdVsrK3NdID09PSB1Wysrcl0gJiYgdVsrK3NdID09PSB1Wysrcl0gJiYgdVsrK3NdID09PSB1Wysrcl0gJiYgdVsrK3NdID09PSB1Wysrcl0gJiYgdVsrK3NdID09PSB1Wysrcl0gJiYgdVsrK3NdID09PSB1Wysrcl0gJiYgdVsrK3NdID09PSB1Wysrcl0gJiYgcyA8IGMpOwoJICAgICAgICAgICAgaWYgKG4gPSBTIC0gKGMgLSBzKSwgcyA9IGMgLSBTLCBhIDwgbikgewoJICAgICAgICAgICAgICBpZiAoZS5tYXRjaF9zdGFydCA9IHQsIG8gPD0gKGEgPSBuKSkgYnJlYWs7CgkgICAgICAgICAgICAgIGQgPSB1W3MgKyBhIC0gMV0sIHAgPSB1W3MgKyBhXTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICB9CgkgICAgICAgIH0gd2hpbGUgKCh0ID0gZlt0ICYgbF0pID4gaCAmJiAwICE9IC0taSk7CgkgICAgICAgIHJldHVybiBhIDw9IGUubG9va2FoZWFkID8gYSA6IGUubG9va2FoZWFkOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gaihlKSB7CgkgICAgICAgIHZhciB0LAoJICAgICAgICAgIHIsCgkgICAgICAgICAgbiwKCSAgICAgICAgICBpLAoJICAgICAgICAgIHMsCgkgICAgICAgICAgYSwKCSAgICAgICAgICBvLAoJICAgICAgICAgIGgsCgkgICAgICAgICAgdSwKCSAgICAgICAgICBsLAoJICAgICAgICAgIGYgPSBlLndfc2l6ZTsKCSAgICAgICAgZG8gewoJICAgICAgICAgIGlmIChpID0gZS53aW5kb3dfc2l6ZSAtIGUubG9va2FoZWFkIC0gZS5zdHJzdGFydCwgZS5zdHJzdGFydCA+PSBmICsgKGYgLSB6KSkgewoJICAgICAgICAgICAgZm9yIChjLmFycmF5U2V0KGUud2luZG93LCBlLndpbmRvdywgZiwgZiwgMCksIGUubWF0Y2hfc3RhcnQgLT0gZiwgZS5zdHJzdGFydCAtPSBmLCBlLmJsb2NrX3N0YXJ0IC09IGYsIHQgPSByID0gZS5oYXNoX3NpemU7IG4gPSBlLmhlYWRbLS10XSwgZS5oZWFkW3RdID0gZiA8PSBuID8gbiAtIGYgOiAwLCAtLXI7KTsKCSAgICAgICAgICAgIGZvciAodCA9IHIgPSBmOyBuID0gZS5wcmV2Wy0tdF0sIGUucHJldlt0XSA9IGYgPD0gbiA/IG4gLSBmIDogMCwgLS1yOyk7CgkgICAgICAgICAgICBpICs9IGY7CgkgICAgICAgICAgfQoJICAgICAgICAgIGlmICgwID09PSBlLnN0cm0uYXZhaWxfaW4pIGJyZWFrOwoJICAgICAgICAgIGlmIChhID0gZS5zdHJtLCBvID0gZS53aW5kb3csIGggPSBlLnN0cnN0YXJ0ICsgZS5sb29rYWhlYWQsIHUgPSBpLCBsID0gdm9pZCAwLCBsID0gYS5hdmFpbF9pbiwgdSA8IGwgJiYgKGwgPSB1KSwgciA9IDAgPT09IGwgPyAwIDogKGEuYXZhaWxfaW4gLT0gbCwgYy5hcnJheVNldChvLCBhLmlucHV0LCBhLm5leHRfaW4sIGwsIGgpLCAxID09PSBhLnN0YXRlLndyYXAgPyBhLmFkbGVyID0gZChhLmFkbGVyLCBvLCBsLCBoKSA6IDIgPT09IGEuc3RhdGUud3JhcCAmJiAoYS5hZGxlciA9IHAoYS5hZGxlciwgbywgbCwgaCkpLCBhLm5leHRfaW4gKz0gbCwgYS50b3RhbF9pbiArPSBsLCBsKSwgZS5sb29rYWhlYWQgKz0gciwgZS5sb29rYWhlYWQgKyBlLmluc2VydCA+PSB4KSBmb3IgKHMgPSBlLnN0cnN0YXJ0IC0gZS5pbnNlcnQsIGUuaW5zX2ggPSBlLndpbmRvd1tzXSwgZS5pbnNfaCA9IChlLmluc19oIDw8IGUuaGFzaF9zaGlmdCBeIGUud2luZG93W3MgKyAxXSkgJiBlLmhhc2hfbWFzazsgZS5pbnNlcnQgJiYgKGUuaW5zX2ggPSAoZS5pbnNfaCA8PCBlLmhhc2hfc2hpZnQgXiBlLndpbmRvd1tzICsgeCAtIDFdKSAmIGUuaGFzaF9tYXNrLCBlLnByZXZbcyAmIGUud19tYXNrXSA9IGUuaGVhZFtlLmluc19oXSwgZS5oZWFkW2UuaW5zX2hdID0gcywgcysrLCBlLmluc2VydC0tLCAhKGUubG9va2FoZWFkICsgZS5pbnNlcnQgPCB4KSk7KTsKCSAgICAgICAgfSB3aGlsZSAoZS5sb29rYWhlYWQgPCB6ICYmIDAgIT09IGUuc3RybS5hdmFpbF9pbik7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBaKGUsIHQpIHsKCSAgICAgICAgZm9yICh2YXIgciwgbjs7KSB7CgkgICAgICAgICAgaWYgKGUubG9va2FoZWFkIDwgeikgewoJICAgICAgICAgICAgaWYgKGooZSksIGUubG9va2FoZWFkIDwgeiAmJiB0ID09PSBsKSByZXR1cm4gQTsKCSAgICAgICAgICAgIGlmICgwID09PSBlLmxvb2thaGVhZCkgYnJlYWs7CgkgICAgICAgICAgfQoJICAgICAgICAgIGlmIChyID0gMCwgZS5sb29rYWhlYWQgPj0geCAmJiAoZS5pbnNfaCA9IChlLmluc19oIDw8IGUuaGFzaF9zaGlmdCBeIGUud2luZG93W2Uuc3Ryc3RhcnQgKyB4IC0gMV0pICYgZS5oYXNoX21hc2ssIHIgPSBlLnByZXZbZS5zdHJzdGFydCAmIGUud19tYXNrXSA9IGUuaGVhZFtlLmluc19oXSwgZS5oZWFkW2UuaW5zX2hdID0gZS5zdHJzdGFydCksIDAgIT09IHIgJiYgZS5zdHJzdGFydCAtIHIgPD0gZS53X3NpemUgLSB6ICYmIChlLm1hdGNoX2xlbmd0aCA9IEwoZSwgcikpLCBlLm1hdGNoX2xlbmd0aCA+PSB4KSB7CgkgICAgICAgICAgICBpZiAobiA9IHUuX3RyX3RhbGx5KGUsIGUuc3Ryc3RhcnQgLSBlLm1hdGNoX3N0YXJ0LCBlLm1hdGNoX2xlbmd0aCAtIHgpLCBlLmxvb2thaGVhZCAtPSBlLm1hdGNoX2xlbmd0aCwgZS5tYXRjaF9sZW5ndGggPD0gZS5tYXhfbGF6eV9tYXRjaCAmJiBlLmxvb2thaGVhZCA+PSB4KSB7CgkgICAgICAgICAgICAgIGZvciAoZS5tYXRjaF9sZW5ndGgtLTsgZS5zdHJzdGFydCsrLCBlLmluc19oID0gKGUuaW5zX2ggPDwgZS5oYXNoX3NoaWZ0IF4gZS53aW5kb3dbZS5zdHJzdGFydCArIHggLSAxXSkgJiBlLmhhc2hfbWFzaywgciA9IGUucHJldltlLnN0cnN0YXJ0ICYgZS53X21hc2tdID0gZS5oZWFkW2UuaW5zX2hdLCBlLmhlYWRbZS5pbnNfaF0gPSBlLnN0cnN0YXJ0LCAwICE9IC0tZS5tYXRjaF9sZW5ndGg7KTsKCSAgICAgICAgICAgICAgZS5zdHJzdGFydCsrOwoJICAgICAgICAgICAgfSBlbHNlIGUuc3Ryc3RhcnQgKz0gZS5tYXRjaF9sZW5ndGgsIGUubWF0Y2hfbGVuZ3RoID0gMCwgZS5pbnNfaCA9IGUud2luZG93W2Uuc3Ryc3RhcnRdLCBlLmluc19oID0gKGUuaW5zX2ggPDwgZS5oYXNoX3NoaWZ0IF4gZS53aW5kb3dbZS5zdHJzdGFydCArIDFdKSAmIGUuaGFzaF9tYXNrOwoJICAgICAgICAgIH0gZWxzZSBuID0gdS5fdHJfdGFsbHkoZSwgMCwgZS53aW5kb3dbZS5zdHJzdGFydF0pLCBlLmxvb2thaGVhZC0tLCBlLnN0cnN0YXJ0Kys7CgkgICAgICAgICAgaWYgKG4gJiYgKE4oZSwgITEpLCAwID09PSBlLnN0cm0uYXZhaWxfb3V0KSkgcmV0dXJuIEE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGUuaW5zZXJ0ID0gZS5zdHJzdGFydCA8IHggLSAxID8gZS5zdHJzdGFydCA6IHggLSAxLCB0ID09PSBmID8gKE4oZSwgITApLCAwID09PSBlLnN0cm0uYXZhaWxfb3V0ID8gTyA6IEIpIDogZS5sYXN0X2xpdCAmJiAoTihlLCAhMSksIDAgPT09IGUuc3RybS5hdmFpbF9vdXQpID8gQSA6IEk7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBXKGUsIHQpIHsKCSAgICAgICAgZm9yICh2YXIgciwgbiwgaTs7KSB7CgkgICAgICAgICAgaWYgKGUubG9va2FoZWFkIDwgeikgewoJICAgICAgICAgICAgaWYgKGooZSksIGUubG9va2FoZWFkIDwgeiAmJiB0ID09PSBsKSByZXR1cm4gQTsKCSAgICAgICAgICAgIGlmICgwID09PSBlLmxvb2thaGVhZCkgYnJlYWs7CgkgICAgICAgICAgfQoJICAgICAgICAgIGlmIChyID0gMCwgZS5sb29rYWhlYWQgPj0geCAmJiAoZS5pbnNfaCA9IChlLmluc19oIDw8IGUuaGFzaF9zaGlmdCBeIGUud2luZG93W2Uuc3Ryc3RhcnQgKyB4IC0gMV0pICYgZS5oYXNoX21hc2ssIHIgPSBlLnByZXZbZS5zdHJzdGFydCAmIGUud19tYXNrXSA9IGUuaGVhZFtlLmluc19oXSwgZS5oZWFkW2UuaW5zX2hdID0gZS5zdHJzdGFydCksIGUucHJldl9sZW5ndGggPSBlLm1hdGNoX2xlbmd0aCwgZS5wcmV2X21hdGNoID0gZS5tYXRjaF9zdGFydCwgZS5tYXRjaF9sZW5ndGggPSB4IC0gMSwgMCAhPT0gciAmJiBlLnByZXZfbGVuZ3RoIDwgZS5tYXhfbGF6eV9tYXRjaCAmJiBlLnN0cnN0YXJ0IC0gciA8PSBlLndfc2l6ZSAtIHogJiYgKGUubWF0Y2hfbGVuZ3RoID0gTChlLCByKSwgZS5tYXRjaF9sZW5ndGggPD0gNSAmJiAoMSA9PT0gZS5zdHJhdGVneSB8fCBlLm1hdGNoX2xlbmd0aCA9PT0geCAmJiA0MDk2IDwgZS5zdHJzdGFydCAtIGUubWF0Y2hfc3RhcnQpICYmIChlLm1hdGNoX2xlbmd0aCA9IHggLSAxKSksIGUucHJldl9sZW5ndGggPj0geCAmJiBlLm1hdGNoX2xlbmd0aCA8PSBlLnByZXZfbGVuZ3RoKSB7CgkgICAgICAgICAgICBmb3IgKGkgPSBlLnN0cnN0YXJ0ICsgZS5sb29rYWhlYWQgLSB4LCBuID0gdS5fdHJfdGFsbHkoZSwgZS5zdHJzdGFydCAtIDEgLSBlLnByZXZfbWF0Y2gsIGUucHJldl9sZW5ndGggLSB4KSwgZS5sb29rYWhlYWQgLT0gZS5wcmV2X2xlbmd0aCAtIDEsIGUucHJldl9sZW5ndGggLT0gMjsgKytlLnN0cnN0YXJ0IDw9IGkgJiYgKGUuaW5zX2ggPSAoZS5pbnNfaCA8PCBlLmhhc2hfc2hpZnQgXiBlLndpbmRvd1tlLnN0cnN0YXJ0ICsgeCAtIDFdKSAmIGUuaGFzaF9tYXNrLCByID0gZS5wcmV2W2Uuc3Ryc3RhcnQgJiBlLndfbWFza10gPSBlLmhlYWRbZS5pbnNfaF0sIGUuaGVhZFtlLmluc19oXSA9IGUuc3Ryc3RhcnQpLCAwICE9IC0tZS5wcmV2X2xlbmd0aDspOwoJICAgICAgICAgICAgaWYgKGUubWF0Y2hfYXZhaWxhYmxlID0gMCwgZS5tYXRjaF9sZW5ndGggPSB4IC0gMSwgZS5zdHJzdGFydCsrLCBuICYmIChOKGUsICExKSwgMCA9PT0gZS5zdHJtLmF2YWlsX291dCkpIHJldHVybiBBOwoJICAgICAgICAgIH0gZWxzZSBpZiAoZS5tYXRjaF9hdmFpbGFibGUpIHsKCSAgICAgICAgICAgIGlmICgobiA9IHUuX3RyX3RhbGx5KGUsIDAsIGUud2luZG93W2Uuc3Ryc3RhcnQgLSAxXSkpICYmIE4oZSwgITEpLCBlLnN0cnN0YXJ0KyssIGUubG9va2FoZWFkLS0sIDAgPT09IGUuc3RybS5hdmFpbF9vdXQpIHJldHVybiBBOwoJICAgICAgICAgIH0gZWxzZSBlLm1hdGNoX2F2YWlsYWJsZSA9IDEsIGUuc3Ryc3RhcnQrKywgZS5sb29rYWhlYWQtLTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gZS5tYXRjaF9hdmFpbGFibGUgJiYgKG4gPSB1Ll90cl90YWxseShlLCAwLCBlLndpbmRvd1tlLnN0cnN0YXJ0IC0gMV0pLCBlLm1hdGNoX2F2YWlsYWJsZSA9IDApLCBlLmluc2VydCA9IGUuc3Ryc3RhcnQgPCB4IC0gMSA/IGUuc3Ryc3RhcnQgOiB4IC0gMSwgdCA9PT0gZiA/IChOKGUsICEwKSwgMCA9PT0gZS5zdHJtLmF2YWlsX291dCA/IE8gOiBCKSA6IGUubGFzdF9saXQgJiYgKE4oZSwgITEpLCAwID09PSBlLnN0cm0uYXZhaWxfb3V0KSA/IEEgOiBJOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gTShlLCB0LCByLCBuLCBpKSB7CgkgICAgICAgIHRoaXMuZ29vZF9sZW5ndGggPSBlLCB0aGlzLm1heF9sYXp5ID0gdCwgdGhpcy5uaWNlX2xlbmd0aCA9IHIsIHRoaXMubWF4X2NoYWluID0gbiwgdGhpcy5mdW5jID0gaTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIEgoKSB7CgkgICAgICAgIHRoaXMuc3RybSA9IG51bGwsIHRoaXMuc3RhdHVzID0gMCwgdGhpcy5wZW5kaW5nX2J1ZiA9IG51bGwsIHRoaXMucGVuZGluZ19idWZfc2l6ZSA9IDAsIHRoaXMucGVuZGluZ19vdXQgPSAwLCB0aGlzLnBlbmRpbmcgPSAwLCB0aGlzLndyYXAgPSAwLCB0aGlzLmd6aGVhZCA9IG51bGwsIHRoaXMuZ3ppbmRleCA9IDAsIHRoaXMubWV0aG9kID0gdiwgdGhpcy5sYXN0X2ZsdXNoID0gLTEsIHRoaXMud19zaXplID0gMCwgdGhpcy53X2JpdHMgPSAwLCB0aGlzLndfbWFzayA9IDAsIHRoaXMud2luZG93ID0gbnVsbCwgdGhpcy53aW5kb3dfc2l6ZSA9IDAsIHRoaXMucHJldiA9IG51bGwsIHRoaXMuaGVhZCA9IG51bGwsIHRoaXMuaW5zX2ggPSAwLCB0aGlzLmhhc2hfc2l6ZSA9IDAsIHRoaXMuaGFzaF9iaXRzID0gMCwgdGhpcy5oYXNoX21hc2sgPSAwLCB0aGlzLmhhc2hfc2hpZnQgPSAwLCB0aGlzLmJsb2NrX3N0YXJ0ID0gMCwgdGhpcy5tYXRjaF9sZW5ndGggPSAwLCB0aGlzLnByZXZfbWF0Y2ggPSAwLCB0aGlzLm1hdGNoX2F2YWlsYWJsZSA9IDAsIHRoaXMuc3Ryc3RhcnQgPSAwLCB0aGlzLm1hdGNoX3N0YXJ0ID0gMCwgdGhpcy5sb29rYWhlYWQgPSAwLCB0aGlzLnByZXZfbGVuZ3RoID0gMCwgdGhpcy5tYXhfY2hhaW5fbGVuZ3RoID0gMCwgdGhpcy5tYXhfbGF6eV9tYXRjaCA9IDAsIHRoaXMubGV2ZWwgPSAwLCB0aGlzLnN0cmF0ZWd5ID0gMCwgdGhpcy5nb29kX21hdGNoID0gMCwgdGhpcy5uaWNlX21hdGNoID0gMCwgdGhpcy5keW5fbHRyZWUgPSBuZXcgYy5CdWYxNigyICogdyksIHRoaXMuZHluX2R0cmVlID0gbmV3IGMuQnVmMTYoMiAqICgyICogYSArIDEpKSwgdGhpcy5ibF90cmVlID0gbmV3IGMuQnVmMTYoMiAqICgyICogbyArIDEpKSwgRCh0aGlzLmR5bl9sdHJlZSksIEQodGhpcy5keW5fZHRyZWUpLCBEKHRoaXMuYmxfdHJlZSksIHRoaXMubF9kZXNjID0gbnVsbCwgdGhpcy5kX2Rlc2MgPSBudWxsLCB0aGlzLmJsX2Rlc2MgPSBudWxsLCB0aGlzLmJsX2NvdW50ID0gbmV3IGMuQnVmMTYoayArIDEpLCB0aGlzLmhlYXAgPSBuZXcgYy5CdWYxNigyICogcyArIDEpLCBEKHRoaXMuaGVhcCksIHRoaXMuaGVhcF9sZW4gPSAwLCB0aGlzLmhlYXBfbWF4ID0gMCwgdGhpcy5kZXB0aCA9IG5ldyBjLkJ1ZjE2KDIgKiBzICsgMSksIEQodGhpcy5kZXB0aCksIHRoaXMubF9idWYgPSAwLCB0aGlzLmxpdF9idWZzaXplID0gMCwgdGhpcy5sYXN0X2xpdCA9IDAsIHRoaXMuZF9idWYgPSAwLCB0aGlzLm9wdF9sZW4gPSAwLCB0aGlzLnN0YXRpY19sZW4gPSAwLCB0aGlzLm1hdGNoZXMgPSAwLCB0aGlzLmluc2VydCA9IDAsIHRoaXMuYmlfYnVmID0gMCwgdGhpcy5iaV92YWxpZCA9IDA7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBHKGUpIHsKCSAgICAgICAgdmFyIHQ7CgkgICAgICAgIHJldHVybiBlICYmIGUuc3RhdGUgPyAoZS50b3RhbF9pbiA9IGUudG90YWxfb3V0ID0gMCwgZS5kYXRhX3R5cGUgPSBpLCAodCA9IGUuc3RhdGUpLnBlbmRpbmcgPSAwLCB0LnBlbmRpbmdfb3V0ID0gMCwgdC53cmFwIDwgMCAmJiAodC53cmFwID0gLXQud3JhcCksIHQuc3RhdHVzID0gdC53cmFwID8gQyA6IEUsIGUuYWRsZXIgPSAyID09PSB0LndyYXAgPyAwIDogMSwgdC5sYXN0X2ZsdXNoID0gbCwgdS5fdHJfaW5pdCh0KSwgbSkgOiBSKGUsIF8pOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gSyhlKSB7CgkgICAgICAgIHZhciB0ID0gRyhlKTsKCSAgICAgICAgcmV0dXJuIHQgPT09IG0gJiYgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICBlLndpbmRvd19zaXplID0gMiAqIGUud19zaXplLCBEKGUuaGVhZCksIGUubWF4X2xhenlfbWF0Y2ggPSBoW2UubGV2ZWxdLm1heF9sYXp5LCBlLmdvb2RfbWF0Y2ggPSBoW2UubGV2ZWxdLmdvb2RfbGVuZ3RoLCBlLm5pY2VfbWF0Y2ggPSBoW2UubGV2ZWxdLm5pY2VfbGVuZ3RoLCBlLm1heF9jaGFpbl9sZW5ndGggPSBoW2UubGV2ZWxdLm1heF9jaGFpbiwgZS5zdHJzdGFydCA9IDAsIGUuYmxvY2tfc3RhcnQgPSAwLCBlLmxvb2thaGVhZCA9IDAsIGUuaW5zZXJ0ID0gMCwgZS5tYXRjaF9sZW5ndGggPSBlLnByZXZfbGVuZ3RoID0geCAtIDEsIGUubWF0Y2hfYXZhaWxhYmxlID0gMCwgZS5pbnNfaCA9IDA7CgkgICAgICAgIH0oZS5zdGF0ZSksIHQ7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBZKGUsIHQsIHIsIG4sIGksIHMpIHsKCSAgICAgICAgaWYgKCFlKSByZXR1cm4gXzsKCSAgICAgICAgdmFyIGEgPSAxOwoJICAgICAgICBpZiAodCA9PT0gZyAmJiAodCA9IDYpLCBuIDwgMCA/IChhID0gMCwgbiA9IC1uKSA6IDE1IDwgbiAmJiAoYSA9IDIsIG4gLT0gMTYpLCBpIDwgMSB8fCB5IDwgaSB8fCByICE9PSB2IHx8IG4gPCA4IHx8IDE1IDwgbiB8fCB0IDwgMCB8fCA5IDwgdCB8fCBzIDwgMCB8fCBiIDwgcykgcmV0dXJuIFIoZSwgXyk7CgkgICAgICAgIDggPT09IG4gJiYgKG4gPSA5KTsKCSAgICAgICAgdmFyIG8gPSBuZXcgSCgpOwoJICAgICAgICByZXR1cm4gKGUuc3RhdGUgPSBvKS5zdHJtID0gZSwgby53cmFwID0gYSwgby5nemhlYWQgPSBudWxsLCBvLndfYml0cyA9IG4sIG8ud19zaXplID0gMSA8PCBvLndfYml0cywgby53X21hc2sgPSBvLndfc2l6ZSAtIDEsIG8uaGFzaF9iaXRzID0gaSArIDcsIG8uaGFzaF9zaXplID0gMSA8PCBvLmhhc2hfYml0cywgby5oYXNoX21hc2sgPSBvLmhhc2hfc2l6ZSAtIDEsIG8uaGFzaF9zaGlmdCA9IH5+KChvLmhhc2hfYml0cyArIHggLSAxKSAvIHgpLCBvLndpbmRvdyA9IG5ldyBjLkJ1ZjgoMiAqIG8ud19zaXplKSwgby5oZWFkID0gbmV3IGMuQnVmMTYoby5oYXNoX3NpemUpLCBvLnByZXYgPSBuZXcgYy5CdWYxNihvLndfc2l6ZSksIG8ubGl0X2J1ZnNpemUgPSAxIDw8IGkgKyA2LCBvLnBlbmRpbmdfYnVmX3NpemUgPSA0ICogby5saXRfYnVmc2l6ZSwgby5wZW5kaW5nX2J1ZiA9IG5ldyBjLkJ1Zjgoby5wZW5kaW5nX2J1Zl9zaXplKSwgby5kX2J1ZiA9IDEgKiBvLmxpdF9idWZzaXplLCBvLmxfYnVmID0gMyAqIG8ubGl0X2J1ZnNpemUsIG8ubGV2ZWwgPSB0LCBvLnN0cmF0ZWd5ID0gcywgby5tZXRob2QgPSByLCBLKGUpOwoJICAgICAgfQoJICAgICAgaCA9IFtuZXcgTSgwLCAwLCAwLCAwLCBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICB2YXIgciA9IDY1NTM1OwoJICAgICAgICBmb3IgKHIgPiBlLnBlbmRpbmdfYnVmX3NpemUgLSA1ICYmIChyID0gZS5wZW5kaW5nX2J1Zl9zaXplIC0gNSk7OykgewoJICAgICAgICAgIGlmIChlLmxvb2thaGVhZCA8PSAxKSB7CgkgICAgICAgICAgICBpZiAoaihlKSwgMCA9PT0gZS5sb29rYWhlYWQgJiYgdCA9PT0gbCkgcmV0dXJuIEE7CgkgICAgICAgICAgICBpZiAoMCA9PT0gZS5sb29rYWhlYWQpIGJyZWFrOwoJICAgICAgICAgIH0KCSAgICAgICAgICBlLnN0cnN0YXJ0ICs9IGUubG9va2FoZWFkLCBlLmxvb2thaGVhZCA9IDA7CgkgICAgICAgICAgdmFyIG4gPSBlLmJsb2NrX3N0YXJ0ICsgcjsKCSAgICAgICAgICBpZiAoKDAgPT09IGUuc3Ryc3RhcnQgfHwgZS5zdHJzdGFydCA+PSBuKSAmJiAoZS5sb29rYWhlYWQgPSBlLnN0cnN0YXJ0IC0gbiwgZS5zdHJzdGFydCA9IG4sIE4oZSwgITEpLCAwID09PSBlLnN0cm0uYXZhaWxfb3V0KSkgcmV0dXJuIEE7CgkgICAgICAgICAgaWYgKGUuc3Ryc3RhcnQgLSBlLmJsb2NrX3N0YXJ0ID49IGUud19zaXplIC0geiAmJiAoTihlLCAhMSksIDAgPT09IGUuc3RybS5hdmFpbF9vdXQpKSByZXR1cm4gQTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gZS5pbnNlcnQgPSAwLCB0ID09PSBmID8gKE4oZSwgITApLCAwID09PSBlLnN0cm0uYXZhaWxfb3V0ID8gTyA6IEIpIDogKGUuc3Ryc3RhcnQgPiBlLmJsb2NrX3N0YXJ0ICYmIChOKGUsICExKSwgZS5zdHJtLmF2YWlsX291dCksIEEpOwoJICAgICAgfSksIG5ldyBNKDQsIDQsIDgsIDQsIFopLCBuZXcgTSg0LCA1LCAxNiwgOCwgWiksIG5ldyBNKDQsIDYsIDMyLCAzMiwgWiksIG5ldyBNKDQsIDQsIDE2LCAxNiwgVyksIG5ldyBNKDgsIDE2LCAzMiwgMzIsIFcpLCBuZXcgTSg4LCAxNiwgMTI4LCAxMjgsIFcpLCBuZXcgTSg4LCAzMiwgMTI4LCAyNTYsIFcpLCBuZXcgTSgzMiwgMTI4LCAyNTgsIDEwMjQsIFcpLCBuZXcgTSgzMiwgMjU4LCAyNTgsIDQwOTYsIFcpXSwgci5kZWZsYXRlSW5pdCA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHJldHVybiBZKGUsIHQsIHYsIDE1LCA4LCAwKTsKCSAgICAgIH0sIHIuZGVmbGF0ZUluaXQyID0gWSwgci5kZWZsYXRlUmVzZXQgPSBLLCByLmRlZmxhdGVSZXNldEtlZXAgPSBHLCByLmRlZmxhdGVTZXRIZWFkZXIgPSBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICByZXR1cm4gZSAmJiBlLnN0YXRlID8gMiAhPT0gZS5zdGF0ZS53cmFwID8gXyA6IChlLnN0YXRlLmd6aGVhZCA9IHQsIG0pIDogXzsKCSAgICAgIH0sIHIuZGVmbGF0ZSA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHZhciByLCBuLCBpLCBzOwoJICAgICAgICBpZiAoIWUgfHwgIWUuc3RhdGUgfHwgNSA8IHQgfHwgdCA8IDApIHJldHVybiBlID8gUihlLCBfKSA6IF87CgkgICAgICAgIGlmIChuID0gZS5zdGF0ZSwgIWUub3V0cHV0IHx8ICFlLmlucHV0ICYmIDAgIT09IGUuYXZhaWxfaW4gfHwgNjY2ID09PSBuLnN0YXR1cyAmJiB0ICE9PSBmKSByZXR1cm4gUihlLCAwID09PSBlLmF2YWlsX291dCA/IC01IDogXyk7CgkgICAgICAgIGlmIChuLnN0cm0gPSBlLCByID0gbi5sYXN0X2ZsdXNoLCBuLmxhc3RfZmx1c2ggPSB0LCBuLnN0YXR1cyA9PT0gQykgaWYgKDIgPT09IG4ud3JhcCkgZS5hZGxlciA9IDAsIFUobiwgMzEpLCBVKG4sIDEzOSksIFUobiwgOCksIG4uZ3poZWFkID8gKFUobiwgKG4uZ3poZWFkLnRleHQgPyAxIDogMCkgKyAobi5nemhlYWQuaGNyYyA/IDIgOiAwKSArIChuLmd6aGVhZC5leHRyYSA/IDQgOiAwKSArIChuLmd6aGVhZC5uYW1lID8gOCA6IDApICsgKG4uZ3poZWFkLmNvbW1lbnQgPyAxNiA6IDApKSwgVShuLCAyNTUgJiBuLmd6aGVhZC50aW1lKSwgVShuLCBuLmd6aGVhZC50aW1lID4+IDggJiAyNTUpLCBVKG4sIG4uZ3poZWFkLnRpbWUgPj4gMTYgJiAyNTUpLCBVKG4sIG4uZ3poZWFkLnRpbWUgPj4gMjQgJiAyNTUpLCBVKG4sIDkgPT09IG4ubGV2ZWwgPyAyIDogMiA8PSBuLnN0cmF0ZWd5IHx8IG4ubGV2ZWwgPCAyID8gNCA6IDApLCBVKG4sIDI1NSAmIG4uZ3poZWFkLm9zKSwgbi5nemhlYWQuZXh0cmEgJiYgbi5nemhlYWQuZXh0cmEubGVuZ3RoICYmIChVKG4sIDI1NSAmIG4uZ3poZWFkLmV4dHJhLmxlbmd0aCksIFUobiwgbi5nemhlYWQuZXh0cmEubGVuZ3RoID4+IDggJiAyNTUpKSwgbi5nemhlYWQuaGNyYyAmJiAoZS5hZGxlciA9IHAoZS5hZGxlciwgbi5wZW5kaW5nX2J1Ziwgbi5wZW5kaW5nLCAwKSksIG4uZ3ppbmRleCA9IDAsIG4uc3RhdHVzID0gNjkpIDogKFUobiwgMCksIFUobiwgMCksIFUobiwgMCksIFUobiwgMCksIFUobiwgMCksIFUobiwgOSA9PT0gbi5sZXZlbCA/IDIgOiAyIDw9IG4uc3RyYXRlZ3kgfHwgbi5sZXZlbCA8IDIgPyA0IDogMCksIFUobiwgMyksIG4uc3RhdHVzID0gRSk7ZWxzZSB7CgkgICAgICAgICAgdmFyIGEgPSB2ICsgKG4ud19iaXRzIC0gOCA8PCA0KSA8PCA4OwoJICAgICAgICAgIGEgfD0gKDIgPD0gbi5zdHJhdGVneSB8fCBuLmxldmVsIDwgMiA/IDAgOiBuLmxldmVsIDwgNiA/IDEgOiA2ID09PSBuLmxldmVsID8gMiA6IDMpIDw8IDYsIDAgIT09IG4uc3Ryc3RhcnQgJiYgKGEgfD0gMzIpLCBhICs9IDMxIC0gYSAlIDMxLCBuLnN0YXR1cyA9IEUsIFAobiwgYSksIDAgIT09IG4uc3Ryc3RhcnQgJiYgKFAobiwgZS5hZGxlciA+Pj4gMTYpLCBQKG4sIDY1NTM1ICYgZS5hZGxlcikpLCBlLmFkbGVyID0gMTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoNjkgPT09IG4uc3RhdHVzKSBpZiAobi5nemhlYWQuZXh0cmEpIHsKCSAgICAgICAgICBmb3IgKGkgPSBuLnBlbmRpbmc7IG4uZ3ppbmRleCA8ICg2NTUzNSAmIG4uZ3poZWFkLmV4dHJhLmxlbmd0aCkgJiYgKG4ucGVuZGluZyAhPT0gbi5wZW5kaW5nX2J1Zl9zaXplIHx8IChuLmd6aGVhZC5oY3JjICYmIG4ucGVuZGluZyA+IGkgJiYgKGUuYWRsZXIgPSBwKGUuYWRsZXIsIG4ucGVuZGluZ19idWYsIG4ucGVuZGluZyAtIGksIGkpKSwgRihlKSwgaSA9IG4ucGVuZGluZywgbi5wZW5kaW5nICE9PSBuLnBlbmRpbmdfYnVmX3NpemUpKTspIFUobiwgMjU1ICYgbi5nemhlYWQuZXh0cmFbbi5nemluZGV4XSksIG4uZ3ppbmRleCsrOwoJICAgICAgICAgIG4uZ3poZWFkLmhjcmMgJiYgbi5wZW5kaW5nID4gaSAmJiAoZS5hZGxlciA9IHAoZS5hZGxlciwgbi5wZW5kaW5nX2J1Ziwgbi5wZW5kaW5nIC0gaSwgaSkpLCBuLmd6aW5kZXggPT09IG4uZ3poZWFkLmV4dHJhLmxlbmd0aCAmJiAobi5nemluZGV4ID0gMCwgbi5zdGF0dXMgPSA3Myk7CgkgICAgICAgIH0gZWxzZSBuLnN0YXR1cyA9IDczOwoJICAgICAgICBpZiAoNzMgPT09IG4uc3RhdHVzKSBpZiAobi5nemhlYWQubmFtZSkgewoJICAgICAgICAgIGkgPSBuLnBlbmRpbmc7CgkgICAgICAgICAgZG8gewoJICAgICAgICAgICAgaWYgKG4ucGVuZGluZyA9PT0gbi5wZW5kaW5nX2J1Zl9zaXplICYmIChuLmd6aGVhZC5oY3JjICYmIG4ucGVuZGluZyA+IGkgJiYgKGUuYWRsZXIgPSBwKGUuYWRsZXIsIG4ucGVuZGluZ19idWYsIG4ucGVuZGluZyAtIGksIGkpKSwgRihlKSwgaSA9IG4ucGVuZGluZywgbi5wZW5kaW5nID09PSBuLnBlbmRpbmdfYnVmX3NpemUpKSB7CgkgICAgICAgICAgICAgIHMgPSAxOwoJICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHMgPSBuLmd6aW5kZXggPCBuLmd6aGVhZC5uYW1lLmxlbmd0aCA/IDI1NSAmIG4uZ3poZWFkLm5hbWUuY2hhckNvZGVBdChuLmd6aW5kZXgrKykgOiAwLCBVKG4sIHMpOwoJICAgICAgICAgIH0gd2hpbGUgKDAgIT09IHMpOwoJICAgICAgICAgIG4uZ3poZWFkLmhjcmMgJiYgbi5wZW5kaW5nID4gaSAmJiAoZS5hZGxlciA9IHAoZS5hZGxlciwgbi5wZW5kaW5nX2J1Ziwgbi5wZW5kaW5nIC0gaSwgaSkpLCAwID09PSBzICYmIChuLmd6aW5kZXggPSAwLCBuLnN0YXR1cyA9IDkxKTsKCSAgICAgICAgfSBlbHNlIG4uc3RhdHVzID0gOTE7CgkgICAgICAgIGlmICg5MSA9PT0gbi5zdGF0dXMpIGlmIChuLmd6aGVhZC5jb21tZW50KSB7CgkgICAgICAgICAgaSA9IG4ucGVuZGluZzsKCSAgICAgICAgICBkbyB7CgkgICAgICAgICAgICBpZiAobi5wZW5kaW5nID09PSBuLnBlbmRpbmdfYnVmX3NpemUgJiYgKG4uZ3poZWFkLmhjcmMgJiYgbi5wZW5kaW5nID4gaSAmJiAoZS5hZGxlciA9IHAoZS5hZGxlciwgbi5wZW5kaW5nX2J1Ziwgbi5wZW5kaW5nIC0gaSwgaSkpLCBGKGUpLCBpID0gbi5wZW5kaW5nLCBuLnBlbmRpbmcgPT09IG4ucGVuZGluZ19idWZfc2l6ZSkpIHsKCSAgICAgICAgICAgICAgcyA9IDE7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcyA9IG4uZ3ppbmRleCA8IG4uZ3poZWFkLmNvbW1lbnQubGVuZ3RoID8gMjU1ICYgbi5nemhlYWQuY29tbWVudC5jaGFyQ29kZUF0KG4uZ3ppbmRleCsrKSA6IDAsIFUobiwgcyk7CgkgICAgICAgICAgfSB3aGlsZSAoMCAhPT0gcyk7CgkgICAgICAgICAgbi5nemhlYWQuaGNyYyAmJiBuLnBlbmRpbmcgPiBpICYmIChlLmFkbGVyID0gcChlLmFkbGVyLCBuLnBlbmRpbmdfYnVmLCBuLnBlbmRpbmcgLSBpLCBpKSksIDAgPT09IHMgJiYgKG4uc3RhdHVzID0gMTAzKTsKCSAgICAgICAgfSBlbHNlIG4uc3RhdHVzID0gMTAzOwoJICAgICAgICBpZiAoMTAzID09PSBuLnN0YXR1cyAmJiAobi5nemhlYWQuaGNyYyA/IChuLnBlbmRpbmcgKyAyID4gbi5wZW5kaW5nX2J1Zl9zaXplICYmIEYoZSksIG4ucGVuZGluZyArIDIgPD0gbi5wZW5kaW5nX2J1Zl9zaXplICYmIChVKG4sIDI1NSAmIGUuYWRsZXIpLCBVKG4sIGUuYWRsZXIgPj4gOCAmIDI1NSksIGUuYWRsZXIgPSAwLCBuLnN0YXR1cyA9IEUpKSA6IG4uc3RhdHVzID0gRSksIDAgIT09IG4ucGVuZGluZykgewoJICAgICAgICAgIGlmIChGKGUpLCAwID09PSBlLmF2YWlsX291dCkgcmV0dXJuIG4ubGFzdF9mbHVzaCA9IC0xLCBtOwoJICAgICAgICB9IGVsc2UgaWYgKDAgPT09IGUuYXZhaWxfaW4gJiYgVCh0KSA8PSBUKHIpICYmIHQgIT09IGYpIHJldHVybiBSKGUsIC01KTsKCSAgICAgICAgaWYgKDY2NiA9PT0gbi5zdGF0dXMgJiYgMCAhPT0gZS5hdmFpbF9pbikgcmV0dXJuIFIoZSwgLTUpOwoJICAgICAgICBpZiAoMCAhPT0gZS5hdmFpbF9pbiB8fCAwICE9PSBuLmxvb2thaGVhZCB8fCB0ICE9PSBsICYmIDY2NiAhPT0gbi5zdGF0dXMpIHsKCSAgICAgICAgICB2YXIgbyA9IDIgPT09IG4uc3RyYXRlZ3kgPyBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICAgICAgZm9yICh2YXIgcjs7KSB7CgkgICAgICAgICAgICAgIGlmICgwID09PSBlLmxvb2thaGVhZCAmJiAoaihlKSwgMCA9PT0gZS5sb29rYWhlYWQpKSB7CgkgICAgICAgICAgICAgICAgaWYgKHQgPT09IGwpIHJldHVybiBBOwoJICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIGlmIChlLm1hdGNoX2xlbmd0aCA9IDAsIHIgPSB1Ll90cl90YWxseShlLCAwLCBlLndpbmRvd1tlLnN0cnN0YXJ0XSksIGUubG9va2FoZWFkLS0sIGUuc3Ryc3RhcnQrKywgciAmJiAoTihlLCAhMSksIDAgPT09IGUuc3RybS5hdmFpbF9vdXQpKSByZXR1cm4gQTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiBlLmluc2VydCA9IDAsIHQgPT09IGYgPyAoTihlLCAhMCksIDAgPT09IGUuc3RybS5hdmFpbF9vdXQgPyBPIDogQikgOiBlLmxhc3RfbGl0ICYmIChOKGUsICExKSwgMCA9PT0gZS5zdHJtLmF2YWlsX291dCkgPyBBIDogSTsKCSAgICAgICAgICB9KG4sIHQpIDogMyA9PT0gbi5zdHJhdGVneSA/IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgICAgICBmb3IgKHZhciByLCBuLCBpLCBzLCBhID0gZS53aW5kb3c7OykgewoJICAgICAgICAgICAgICBpZiAoZS5sb29rYWhlYWQgPD0gUykgewoJICAgICAgICAgICAgICAgIGlmIChqKGUpLCBlLmxvb2thaGVhZCA8PSBTICYmIHQgPT09IGwpIHJldHVybiBBOwoJICAgICAgICAgICAgICAgIGlmICgwID09PSBlLmxvb2thaGVhZCkgYnJlYWs7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgaWYgKGUubWF0Y2hfbGVuZ3RoID0gMCwgZS5sb29rYWhlYWQgPj0geCAmJiAwIDwgZS5zdHJzdGFydCAmJiAobiA9IGFbaSA9IGUuc3Ryc3RhcnQgLSAxXSkgPT09IGFbKytpXSAmJiBuID09PSBhWysraV0gJiYgbiA9PT0gYVsrK2ldKSB7CgkgICAgICAgICAgICAgICAgcyA9IGUuc3Ryc3RhcnQgKyBTOwoJICAgICAgICAgICAgICAgIGRvIHt9IHdoaWxlIChuID09PSBhWysraV0gJiYgbiA9PT0gYVsrK2ldICYmIG4gPT09IGFbKytpXSAmJiBuID09PSBhWysraV0gJiYgbiA9PT0gYVsrK2ldICYmIG4gPT09IGFbKytpXSAmJiBuID09PSBhWysraV0gJiYgbiA9PT0gYVsrK2ldICYmIGkgPCBzKTsKCSAgICAgICAgICAgICAgICBlLm1hdGNoX2xlbmd0aCA9IFMgLSAocyAtIGkpLCBlLm1hdGNoX2xlbmd0aCA+IGUubG9va2FoZWFkICYmIChlLm1hdGNoX2xlbmd0aCA9IGUubG9va2FoZWFkKTsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICBpZiAoZS5tYXRjaF9sZW5ndGggPj0geCA/IChyID0gdS5fdHJfdGFsbHkoZSwgMSwgZS5tYXRjaF9sZW5ndGggLSB4KSwgZS5sb29rYWhlYWQgLT0gZS5tYXRjaF9sZW5ndGgsIGUuc3Ryc3RhcnQgKz0gZS5tYXRjaF9sZW5ndGgsIGUubWF0Y2hfbGVuZ3RoID0gMCkgOiAociA9IHUuX3RyX3RhbGx5KGUsIDAsIGUud2luZG93W2Uuc3Ryc3RhcnRdKSwgZS5sb29rYWhlYWQtLSwgZS5zdHJzdGFydCsrKSwgciAmJiAoTihlLCAhMSksIDAgPT09IGUuc3RybS5hdmFpbF9vdXQpKSByZXR1cm4gQTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiBlLmluc2VydCA9IDAsIHQgPT09IGYgPyAoTihlLCAhMCksIDAgPT09IGUuc3RybS5hdmFpbF9vdXQgPyBPIDogQikgOiBlLmxhc3RfbGl0ICYmIChOKGUsICExKSwgMCA9PT0gZS5zdHJtLmF2YWlsX291dCkgPyBBIDogSTsKCSAgICAgICAgICB9KG4sIHQpIDogaFtuLmxldmVsXS5mdW5jKG4sIHQpOwoJICAgICAgICAgIGlmIChvICE9PSBPICYmIG8gIT09IEIgfHwgKG4uc3RhdHVzID0gNjY2KSwgbyA9PT0gQSB8fCBvID09PSBPKSByZXR1cm4gMCA9PT0gZS5hdmFpbF9vdXQgJiYgKG4ubGFzdF9mbHVzaCA9IC0xKSwgbTsKCSAgICAgICAgICBpZiAobyA9PT0gSSAmJiAoMSA9PT0gdCA/IHUuX3RyX2FsaWduKG4pIDogNSAhPT0gdCAmJiAodS5fdHJfc3RvcmVkX2Jsb2NrKG4sIDAsIDAsICExKSwgMyA9PT0gdCAmJiAoRChuLmhlYWQpLCAwID09PSBuLmxvb2thaGVhZCAmJiAobi5zdHJzdGFydCA9IDAsIG4uYmxvY2tfc3RhcnQgPSAwLCBuLmluc2VydCA9IDApKSksIEYoZSksIDAgPT09IGUuYXZhaWxfb3V0KSkgcmV0dXJuIG4ubGFzdF9mbHVzaCA9IC0xLCBtOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0ICE9PSBmID8gbSA6IG4ud3JhcCA8PSAwID8gMSA6ICgyID09PSBuLndyYXAgPyAoVShuLCAyNTUgJiBlLmFkbGVyKSwgVShuLCBlLmFkbGVyID4+IDggJiAyNTUpLCBVKG4sIGUuYWRsZXIgPj4gMTYgJiAyNTUpLCBVKG4sIGUuYWRsZXIgPj4gMjQgJiAyNTUpLCBVKG4sIDI1NSAmIGUudG90YWxfaW4pLCBVKG4sIGUudG90YWxfaW4gPj4gOCAmIDI1NSksIFUobiwgZS50b3RhbF9pbiA+PiAxNiAmIDI1NSksIFUobiwgZS50b3RhbF9pbiA+PiAyNCAmIDI1NSkpIDogKFAobiwgZS5hZGxlciA+Pj4gMTYpLCBQKG4sIDY1NTM1ICYgZS5hZGxlcikpLCBGKGUpLCAwIDwgbi53cmFwICYmIChuLndyYXAgPSAtbi53cmFwKSwgMCAhPT0gbi5wZW5kaW5nID8gbSA6IDEpOwoJICAgICAgfSwgci5kZWZsYXRlRW5kID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgdmFyIHQ7CgkgICAgICAgIHJldHVybiBlICYmIGUuc3RhdGUgPyAodCA9IGUuc3RhdGUuc3RhdHVzKSAhPT0gQyAmJiA2OSAhPT0gdCAmJiA3MyAhPT0gdCAmJiA5MSAhPT0gdCAmJiAxMDMgIT09IHQgJiYgdCAhPT0gRSAmJiA2NjYgIT09IHQgPyBSKGUsIF8pIDogKGUuc3RhdGUgPSBudWxsLCB0ID09PSBFID8gUihlLCAtMykgOiBtKSA6IF87CgkgICAgICB9LCByLmRlZmxhdGVTZXREaWN0aW9uYXJ5ID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgdmFyIHIsCgkgICAgICAgICAgbiwKCSAgICAgICAgICBpLAoJICAgICAgICAgIHMsCgkgICAgICAgICAgYSwKCSAgICAgICAgICBvLAoJICAgICAgICAgIGgsCgkgICAgICAgICAgdSwKCSAgICAgICAgICBsID0gdC5sZW5ndGg7CgkgICAgICAgIGlmICghZSB8fCAhZS5zdGF0ZSkgcmV0dXJuIF87CgkgICAgICAgIGlmICgyID09PSAocyA9IChyID0gZS5zdGF0ZSkud3JhcCkgfHwgMSA9PT0gcyAmJiByLnN0YXR1cyAhPT0gQyB8fCByLmxvb2thaGVhZCkgcmV0dXJuIF87CgkgICAgICAgIGZvciAoMSA9PT0gcyAmJiAoZS5hZGxlciA9IGQoZS5hZGxlciwgdCwgbCwgMCkpLCByLndyYXAgPSAwLCBsID49IHIud19zaXplICYmICgwID09PSBzICYmIChEKHIuaGVhZCksIHIuc3Ryc3RhcnQgPSAwLCByLmJsb2NrX3N0YXJ0ID0gMCwgci5pbnNlcnQgPSAwKSwgdSA9IG5ldyBjLkJ1Zjgoci53X3NpemUpLCBjLmFycmF5U2V0KHUsIHQsIGwgLSByLndfc2l6ZSwgci53X3NpemUsIDApLCB0ID0gdSwgbCA9IHIud19zaXplKSwgYSA9IGUuYXZhaWxfaW4sIG8gPSBlLm5leHRfaW4sIGggPSBlLmlucHV0LCBlLmF2YWlsX2luID0gbCwgZS5uZXh0X2luID0gMCwgZS5pbnB1dCA9IHQsIGoocik7IHIubG9va2FoZWFkID49IHg7KSB7CgkgICAgICAgICAgZm9yIChuID0gci5zdHJzdGFydCwgaSA9IHIubG9va2FoZWFkIC0gKHggLSAxKTsgci5pbnNfaCA9IChyLmluc19oIDw8IHIuaGFzaF9zaGlmdCBeIHIud2luZG93W24gKyB4IC0gMV0pICYgci5oYXNoX21hc2ssIHIucHJldltuICYgci53X21hc2tdID0gci5oZWFkW3IuaW5zX2hdLCByLmhlYWRbci5pbnNfaF0gPSBuLCBuKyssIC0taTspOwoJICAgICAgICAgIHIuc3Ryc3RhcnQgPSBuLCByLmxvb2thaGVhZCA9IHggLSAxLCBqKHIpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByLnN0cnN0YXJ0ICs9IHIubG9va2FoZWFkLCByLmJsb2NrX3N0YXJ0ID0gci5zdHJzdGFydCwgci5pbnNlcnQgPSByLmxvb2thaGVhZCwgci5sb29rYWhlYWQgPSAwLCByLm1hdGNoX2xlbmd0aCA9IHIucHJldl9sZW5ndGggPSB4IC0gMSwgci5tYXRjaF9hdmFpbGFibGUgPSAwLCBlLm5leHRfaW4gPSBvLCBlLmlucHV0ID0gaCwgZS5hdmFpbF9pbiA9IGEsIHIud3JhcCA9IHMsIG07CgkgICAgICB9LCByLmRlZmxhdGVJbmZvID0gInBha28gZGVmbGF0ZSAoZnJvbSBOb2RlY2EgcHJvamVjdCkiOwoJICAgIH0sIHsKCSAgICAgICIuLi91dGlscy9jb21tb24iOiA0MSwKCSAgICAgICIuL2FkbGVyMzIiOiA0MywKCSAgICAgICIuL2NyYzMyIjogNDUsCgkgICAgICAiLi9tZXNzYWdlcyI6IDUxLAoJICAgICAgIi4vdHJlZXMiOiA1MgoJICAgIH1dLAoJICAgIDQ3OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudGV4dCA9IDAsIHRoaXMudGltZSA9IDAsIHRoaXMueGZsYWdzID0gMCwgdGhpcy5vcyA9IDAsIHRoaXMuZXh0cmEgPSBudWxsLCB0aGlzLmV4dHJhX2xlbiA9IDAsIHRoaXMubmFtZSA9ICIiLCB0aGlzLmNvbW1lbnQgPSAiIiwgdGhpcy5oY3JjID0gMCwgdGhpcy5kb25lID0gITE7CgkgICAgICB9OwoJICAgIH0sIHt9XSwKCSAgICA0ODogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKCSAgICAgICAgdmFyIHIsIG4sIGksIHMsIGEsIG8sIGgsIHUsIGwsIGYsIGMsIGQsIHAsIG0sIF8sIGcsIGIsIHYsIHksIHcsIGssIHgsIFMsIHosIEM7CgkgICAgICAgIHIgPSBlLnN0YXRlLCBuID0gZS5uZXh0X2luLCB6ID0gZS5pbnB1dCwgaSA9IG4gKyAoZS5hdmFpbF9pbiAtIDUpLCBzID0gZS5uZXh0X291dCwgQyA9IGUub3V0cHV0LCBhID0gcyAtICh0IC0gZS5hdmFpbF9vdXQpLCBvID0gcyArIChlLmF2YWlsX291dCAtIDI1NyksIGggPSByLmRtYXgsIHUgPSByLndzaXplLCBsID0gci53aGF2ZSwgZiA9IHIud25leHQsIGMgPSByLndpbmRvdywgZCA9IHIuaG9sZCwgcCA9IHIuYml0cywgbSA9IHIubGVuY29kZSwgXyA9IHIuZGlzdGNvZGUsIGcgPSAoMSA8PCByLmxlbmJpdHMpIC0gMSwgYiA9ICgxIDw8IHIuZGlzdGJpdHMpIC0gMTsKCSAgICAgICAgZTogZG8gewoJICAgICAgICAgIHAgPCAxNSAmJiAoZCArPSB6W24rK10gPDwgcCwgcCArPSA4LCBkICs9IHpbbisrXSA8PCBwLCBwICs9IDgpLCB2ID0gbVtkICYgZ107CgkgICAgICAgICAgdDogZm9yICg7OykgewoJICAgICAgICAgICAgaWYgKGQgPj4+PSB5ID0gdiA+Pj4gMjQsIHAgLT0geSwgMCA9PT0gKHkgPSB2ID4+PiAxNiAmIDI1NSkpIENbcysrXSA9IDY1NTM1ICYgdjtlbHNlIHsKCSAgICAgICAgICAgICAgaWYgKCEoMTYgJiB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgwID09ICg2NCAmIHkpKSB7CgkgICAgICAgICAgICAgICAgICB2ID0gbVsoNjU1MzUgJiB2KSArIChkICYgKDEgPDwgeSkgLSAxKV07CgkgICAgICAgICAgICAgICAgICBjb250aW51ZSB0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZiAoMzIgJiB5KSB7CgkgICAgICAgICAgICAgICAgICByLm1vZGUgPSAxMjsKCSAgICAgICAgICAgICAgICAgIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGUubXNnID0gImludmFsaWQgbGl0ZXJhbC9sZW5ndGggY29kZSIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgICAgIGJyZWFrIGU7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgdyA9IDY1NTM1ICYgdiwgKHkgJj0gMTUpICYmIChwIDwgeSAmJiAoZCArPSB6W24rK10gPDwgcCwgcCArPSA4KSwgdyArPSBkICYgKDEgPDwgeSkgLSAxLCBkID4+Pj0geSwgcCAtPSB5KSwgcCA8IDE1ICYmIChkICs9IHpbbisrXSA8PCBwLCBwICs9IDgsIGQgKz0geltuKytdIDw8IHAsIHAgKz0gOCksIHYgPSBfW2QgJiBiXTsKCSAgICAgICAgICAgICAgcjogZm9yICg7OykgewoJICAgICAgICAgICAgICAgIGlmIChkID4+Pj0geSA9IHYgPj4+IDI0LCBwIC09IHksICEoMTYgJiAoeSA9IHYgPj4+IDE2ICYgMjU1KSkpIHsKCSAgICAgICAgICAgICAgICAgIGlmICgwID09ICg2NCAmIHkpKSB7CgkgICAgICAgICAgICAgICAgICAgIHYgPSBfWyg2NTUzNSAmIHYpICsgKGQgJiAoMSA8PCB5KSAtIDEpXTsKCSAgICAgICAgICAgICAgICAgICAgY29udGludWUgcjsKCSAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgIGUubXNnID0gImludmFsaWQgZGlzdGFuY2UgY29kZSIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgICAgICAgYnJlYWsgZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKGsgPSA2NTUzNSAmIHYsIHAgPCAoeSAmPSAxNSkgJiYgKGQgKz0geltuKytdIDw8IHAsIChwICs9IDgpIDwgeSAmJiAoZCArPSB6W24rK10gPDwgcCwgcCArPSA4KSksIGggPCAoayArPSBkICYgKDEgPDwgeSkgLSAxKSkgewoJICAgICAgICAgICAgICAgICAgZS5tc2cgPSAiaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2siLCByLm1vZGUgPSAzMDsKCSAgICAgICAgICAgICAgICAgIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkID4+Pj0geSwgcCAtPSB5LCAoeSA9IHMgLSBhKSA8IGspIHsKCSAgICAgICAgICAgICAgICAgIGlmIChsIDwgKHkgPSBrIC0geSkgJiYgci5zYW5lKSB7CgkgICAgICAgICAgICAgICAgICAgIGUubXNnID0gImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICBpZiAoUyA9IGMsICh4ID0gMCkgPT09IGYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHggKz0gdSAtIHksIHkgPCB3KSB7CgkgICAgICAgICAgICAgICAgICAgICAgZm9yICh3IC09IHk7IENbcysrXSA9IGNbeCsrXSwgLS15Oyk7CgkgICAgICAgICAgICAgICAgICAgICAgeCA9IHMgLSBrLCBTID0gQzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmIDwgeSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeCArPSB1ICsgZiAtIHksICh5IC09IGYpIDwgdykgewoJICAgICAgICAgICAgICAgICAgICAgIGZvciAodyAtPSB5OyBDW3MrK10gPSBjW3grK10sIC0teTspOwoJICAgICAgICAgICAgICAgICAgICAgIGlmICh4ID0gMCwgZiA8IHcpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodyAtPSB5ID0gZjsgQ1tzKytdID0gY1t4KytdLCAtLXk7KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHggPSBzIC0gaywgUyA9IEM7CgkgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHggKz0gZiAtIHksIHkgPCB3KSB7CgkgICAgICAgICAgICAgICAgICAgIGZvciAodyAtPSB5OyBDW3MrK10gPSBjW3grK10sIC0teTspOwoJICAgICAgICAgICAgICAgICAgICB4ID0gcyAtIGssIFMgPSBDOwoJICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgZm9yICg7IDIgPCB3OykgQ1tzKytdID0gU1t4KytdLCBDW3MrK10gPSBTW3grK10sIENbcysrXSA9IFNbeCsrXSwgdyAtPSAzOwoJICAgICAgICAgICAgICAgICAgdyAmJiAoQ1tzKytdID0gU1t4KytdLCAxIDwgdyAmJiAoQ1tzKytdID0gU1t4KytdKSk7CgkgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgIGZvciAoeCA9IHMgLSBrOyBDW3MrK10gPSBDW3grK10sIENbcysrXSA9IENbeCsrXSwgQ1tzKytdID0gQ1t4KytdLCAyIDwgKHcgLT0gMyk7KTsKCSAgICAgICAgICAgICAgICAgIHcgJiYgKENbcysrXSA9IENbeCsrXSwgMSA8IHcgJiYgKENbcysrXSA9IENbeCsrXSkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgfQoJICAgICAgICB9IHdoaWxlIChuIDwgaSAmJiBzIDwgbyk7CgkgICAgICAgIG4gLT0gdyA9IHAgPj4gMywgZCAmPSAoMSA8PCAocCAtPSB3IDw8IDMpKSAtIDEsIGUubmV4dF9pbiA9IG4sIGUubmV4dF9vdXQgPSBzLCBlLmF2YWlsX2luID0gbiA8IGkgPyBpIC0gbiArIDUgOiA1IC0gKG4gLSBpKSwgZS5hdmFpbF9vdXQgPSBzIDwgbyA/IG8gLSBzICsgMjU3IDogMjU3IC0gKHMgLSBvKSwgci5ob2xkID0gZCwgci5iaXRzID0gcDsKCSAgICAgIH07CgkgICAgfSwge31dLAoJICAgIDQ5OiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgSSA9IGUoIi4uL3V0aWxzL2NvbW1vbiIpLAoJICAgICAgICBPID0gZSgiLi9hZGxlcjMyIiksCgkgICAgICAgIEIgPSBlKCIuL2NyYzMyIiksCgkgICAgICAgIFIgPSBlKCIuL2luZmZhc3QiKSwKCSAgICAgICAgVCA9IGUoIi4vaW5mdHJlZXMiKSwKCSAgICAgICAgRCA9IDEsCgkgICAgICAgIEYgPSAyLAoJICAgICAgICBOID0gMCwKCSAgICAgICAgVSA9IC0yLAoJICAgICAgICBQID0gMSwKCSAgICAgICAgbiA9IDg1MiwKCSAgICAgICAgaSA9IDU5MjsKCSAgICAgIGZ1bmN0aW9uIEwoZSkgewoJICAgICAgICByZXR1cm4gKGUgPj4+IDI0ICYgMjU1KSArIChlID4+PiA4ICYgNjUyODApICsgKCg2NTI4MCAmIGUpIDw8IDgpICsgKCgyNTUgJiBlKSA8PCAyNCk7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBzKCkgewoJICAgICAgICB0aGlzLm1vZGUgPSAwLCB0aGlzLmxhc3QgPSAhMSwgdGhpcy53cmFwID0gMCwgdGhpcy5oYXZlZGljdCA9ICExLCB0aGlzLmZsYWdzID0gMCwgdGhpcy5kbWF4ID0gMCwgdGhpcy5jaGVjayA9IDAsIHRoaXMudG90YWwgPSAwLCB0aGlzLmhlYWQgPSBudWxsLCB0aGlzLndiaXRzID0gMCwgdGhpcy53c2l6ZSA9IDAsIHRoaXMud2hhdmUgPSAwLCB0aGlzLnduZXh0ID0gMCwgdGhpcy53aW5kb3cgPSBudWxsLCB0aGlzLmhvbGQgPSAwLCB0aGlzLmJpdHMgPSAwLCB0aGlzLmxlbmd0aCA9IDAsIHRoaXMub2Zmc2V0ID0gMCwgdGhpcy5leHRyYSA9IDAsIHRoaXMubGVuY29kZSA9IG51bGwsIHRoaXMuZGlzdGNvZGUgPSBudWxsLCB0aGlzLmxlbmJpdHMgPSAwLCB0aGlzLmRpc3RiaXRzID0gMCwgdGhpcy5uY29kZSA9IDAsIHRoaXMubmxlbiA9IDAsIHRoaXMubmRpc3QgPSAwLCB0aGlzLmhhdmUgPSAwLCB0aGlzLm5leHQgPSBudWxsLCB0aGlzLmxlbnMgPSBuZXcgSS5CdWYxNigzMjApLCB0aGlzLndvcmsgPSBuZXcgSS5CdWYxNigyODgpLCB0aGlzLmxlbmR5biA9IG51bGwsIHRoaXMuZGlzdGR5biA9IG51bGwsIHRoaXMuc2FuZSA9IDAsIHRoaXMuYmFjayA9IDAsIHRoaXMud2FzID0gMDsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIGEoZSkgewoJICAgICAgICB2YXIgdDsKCSAgICAgICAgcmV0dXJuIGUgJiYgZS5zdGF0ZSA/ICh0ID0gZS5zdGF0ZSwgZS50b3RhbF9pbiA9IGUudG90YWxfb3V0ID0gdC50b3RhbCA9IDAsIGUubXNnID0gIiIsIHQud3JhcCAmJiAoZS5hZGxlciA9IDEgJiB0LndyYXApLCB0Lm1vZGUgPSBQLCB0Lmxhc3QgPSAwLCB0LmhhdmVkaWN0ID0gMCwgdC5kbWF4ID0gMzI3NjgsIHQuaGVhZCA9IG51bGwsIHQuaG9sZCA9IDAsIHQuYml0cyA9IDAsIHQubGVuY29kZSA9IHQubGVuZHluID0gbmV3IEkuQnVmMzIobiksIHQuZGlzdGNvZGUgPSB0LmRpc3RkeW4gPSBuZXcgSS5CdWYzMihpKSwgdC5zYW5lID0gMSwgdC5iYWNrID0gLTEsIE4pIDogVTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIG8oZSkgewoJICAgICAgICB2YXIgdDsKCSAgICAgICAgcmV0dXJuIGUgJiYgZS5zdGF0ZSA/ICgodCA9IGUuc3RhdGUpLndzaXplID0gMCwgdC53aGF2ZSA9IDAsIHQud25leHQgPSAwLCBhKGUpKSA6IFU7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBoKGUsIHQpIHsKCSAgICAgICAgdmFyIHIsIG47CgkgICAgICAgIHJldHVybiBlICYmIGUuc3RhdGUgPyAobiA9IGUuc3RhdGUsIHQgPCAwID8gKHIgPSAwLCB0ID0gLXQpIDogKHIgPSAxICsgKHQgPj4gNCksIHQgPCA0OCAmJiAodCAmPSAxNSkpLCB0ICYmICh0IDwgOCB8fCAxNSA8IHQpID8gVSA6IChudWxsICE9PSBuLndpbmRvdyAmJiBuLndiaXRzICE9PSB0ICYmIChuLndpbmRvdyA9IG51bGwpLCBuLndyYXAgPSByLCBuLndiaXRzID0gdCwgbyhlKSkpIDogVTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIHUoZSwgdCkgewoJICAgICAgICB2YXIgciwgbjsKCSAgICAgICAgcmV0dXJuIGUgPyAobiA9IG5ldyBzKCksIChlLnN0YXRlID0gbikud2luZG93ID0gbnVsbCwgKHIgPSBoKGUsIHQpKSAhPT0gTiAmJiAoZS5zdGF0ZSA9IG51bGwpLCByKSA6IFU7CgkgICAgICB9CgkgICAgICB2YXIgbCwKCSAgICAgICAgZiwKCSAgICAgICAgYyA9ICEwOwoJICAgICAgZnVuY3Rpb24gaihlKSB7CgkgICAgICAgIGlmIChjKSB7CgkgICAgICAgICAgdmFyIHQ7CgkgICAgICAgICAgZm9yIChsID0gbmV3IEkuQnVmMzIoNTEyKSwgZiA9IG5ldyBJLkJ1ZjMyKDMyKSwgdCA9IDA7IHQgPCAxNDQ7KSBlLmxlbnNbdCsrXSA9IDg7CgkgICAgICAgICAgZm9yICg7IHQgPCAyNTY7KSBlLmxlbnNbdCsrXSA9IDk7CgkgICAgICAgICAgZm9yICg7IHQgPCAyODA7KSBlLmxlbnNbdCsrXSA9IDc7CgkgICAgICAgICAgZm9yICg7IHQgPCAyODg7KSBlLmxlbnNbdCsrXSA9IDg7CgkgICAgICAgICAgZm9yIChUKEQsIGUubGVucywgMCwgMjg4LCBsLCAwLCBlLndvcmssIHsKCSAgICAgICAgICAgIGJpdHM6IDkKCSAgICAgICAgICB9KSwgdCA9IDA7IHQgPCAzMjspIGUubGVuc1t0KytdID0gNTsKCSAgICAgICAgICBUKEYsIGUubGVucywgMCwgMzIsIGYsIDAsIGUud29yaywgewoJICAgICAgICAgICAgYml0czogNQoJICAgICAgICAgIH0pLCBjID0gITE7CgkgICAgICAgIH0KCSAgICAgICAgZS5sZW5jb2RlID0gbCwgZS5sZW5iaXRzID0gOSwgZS5kaXN0Y29kZSA9IGYsIGUuZGlzdGJpdHMgPSA1OwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gWihlLCB0LCByLCBuKSB7CgkgICAgICAgIHZhciBpLAoJICAgICAgICAgIHMgPSBlLnN0YXRlOwoJICAgICAgICByZXR1cm4gbnVsbCA9PT0gcy53aW5kb3cgJiYgKHMud3NpemUgPSAxIDw8IHMud2JpdHMsIHMud25leHQgPSAwLCBzLndoYXZlID0gMCwgcy53aW5kb3cgPSBuZXcgSS5CdWY4KHMud3NpemUpKSwgbiA+PSBzLndzaXplID8gKEkuYXJyYXlTZXQocy53aW5kb3csIHQsIHIgLSBzLndzaXplLCBzLndzaXplLCAwKSwgcy53bmV4dCA9IDAsIHMud2hhdmUgPSBzLndzaXplKSA6IChuIDwgKGkgPSBzLndzaXplIC0gcy53bmV4dCkgJiYgKGkgPSBuKSwgSS5hcnJheVNldChzLndpbmRvdywgdCwgciAtIG4sIGksIHMud25leHQpLCAobiAtPSBpKSA/IChJLmFycmF5U2V0KHMud2luZG93LCB0LCByIC0gbiwgbiwgMCksIHMud25leHQgPSBuLCBzLndoYXZlID0gcy53c2l6ZSkgOiAocy53bmV4dCArPSBpLCBzLnduZXh0ID09PSBzLndzaXplICYmIChzLnduZXh0ID0gMCksIHMud2hhdmUgPCBzLndzaXplICYmIChzLndoYXZlICs9IGkpKSksIDA7CgkgICAgICB9CgkgICAgICByLmluZmxhdGVSZXNldCA9IG8sIHIuaW5mbGF0ZVJlc2V0MiA9IGgsIHIuaW5mbGF0ZVJlc2V0S2VlcCA9IGEsIHIuaW5mbGF0ZUluaXQgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICByZXR1cm4gdShlLCAxNSk7CgkgICAgICB9LCByLmluZmxhdGVJbml0MiA9IHUsIHIuaW5mbGF0ZSA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHZhciByLAoJICAgICAgICAgIG4sCgkgICAgICAgICAgaSwKCSAgICAgICAgICBzLAoJICAgICAgICAgIGEsCgkgICAgICAgICAgbywKCSAgICAgICAgICBoLAoJICAgICAgICAgIHUsCgkgICAgICAgICAgbCwKCSAgICAgICAgICBmLAoJICAgICAgICAgIGMsCgkgICAgICAgICAgZCwKCSAgICAgICAgICBwLAoJICAgICAgICAgIG0sCgkgICAgICAgICAgXywKCSAgICAgICAgICBnLAoJICAgICAgICAgIGIsCgkgICAgICAgICAgdiwKCSAgICAgICAgICB5LAoJICAgICAgICAgIHcsCgkgICAgICAgICAgaywKCSAgICAgICAgICB4LAoJICAgICAgICAgIFMsCgkgICAgICAgICAgeiwKCSAgICAgICAgICBDID0gMCwKCSAgICAgICAgICBFID0gbmV3IEkuQnVmOCg0KSwKCSAgICAgICAgICBBID0gWzE2LCAxNywgMTgsIDAsIDgsIDcsIDksIDYsIDEwLCA1LCAxMSwgNCwgMTIsIDMsIDEzLCAyLCAxNCwgMSwgMTVdOwoJICAgICAgICBpZiAoIWUgfHwgIWUuc3RhdGUgfHwgIWUub3V0cHV0IHx8ICFlLmlucHV0ICYmIDAgIT09IGUuYXZhaWxfaW4pIHJldHVybiBVOwoJICAgICAgICAxMiA9PT0gKHIgPSBlLnN0YXRlKS5tb2RlICYmIChyLm1vZGUgPSAxMyksIGEgPSBlLm5leHRfb3V0LCBpID0gZS5vdXRwdXQsIGggPSBlLmF2YWlsX291dCwgcyA9IGUubmV4dF9pbiwgbiA9IGUuaW5wdXQsIG8gPSBlLmF2YWlsX2luLCB1ID0gci5ob2xkLCBsID0gci5iaXRzLCBmID0gbywgYyA9IGgsIHggPSBOOwoJICAgICAgICBlOiBmb3IgKDs7KSBzd2l0Y2ggKHIubW9kZSkgewoJICAgICAgICAgIGNhc2UgUDoKCSAgICAgICAgICAgIGlmICgwID09PSByLndyYXApIHsKCSAgICAgICAgICAgICAgci5tb2RlID0gMTM7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZm9yICg7IGwgPCAxNjspIHsKCSAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgIG8tLSwgdSArPSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKDIgJiByLndyYXAgJiYgMzU2MTUgPT09IHUpIHsKCSAgICAgICAgICAgICAgRVtyLmNoZWNrID0gMF0gPSAyNTUgJiB1LCBFWzFdID0gdSA+Pj4gOCAmIDI1NSwgci5jaGVjayA9IEIoci5jaGVjaywgRSwgMiwgMCksIGwgPSB1ID0gMCwgci5tb2RlID0gMjsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoci5mbGFncyA9IDAsIHIuaGVhZCAmJiAoci5oZWFkLmRvbmUgPSAhMSksICEoMSAmIHIud3JhcCkgfHwgKCgoMjU1ICYgdSkgPDwgOCkgKyAodSA+PiA4KSkgJSAzMSkgewoJICAgICAgICAgICAgICBlLm1zZyA9ICJpbmNvcnJlY3QgaGVhZGVyIGNoZWNrIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKDggIT0gKDE1ICYgdSkpIHsKCSAgICAgICAgICAgICAgZS5tc2cgPSAidW5rbm93biBjb21wcmVzc2lvbiBtZXRob2QiLCByLm1vZGUgPSAzMDsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAobCAtPSA0LCBrID0gOCArICgxNSAmICh1ID4+Pj0gNCkpLCAwID09PSByLndiaXRzKSByLndiaXRzID0gaztlbHNlIGlmIChrID4gci53Yml0cykgewoJICAgICAgICAgICAgICBlLm1zZyA9ICJpbnZhbGlkIHdpbmRvdyBzaXplIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgci5kbWF4ID0gMSA8PCBrLCBlLmFkbGVyID0gci5jaGVjayA9IDEsIHIubW9kZSA9IDUxMiAmIHUgPyAxMCA6IDEyLCBsID0gdSA9IDA7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICBjYXNlIDI6CgkgICAgICAgICAgICBmb3IgKDsgbCA8IDE2OykgewoJICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgby0tLCB1ICs9IG5bcysrXSA8PCBsLCBsICs9IDg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoci5mbGFncyA9IHUsIDggIT0gKDI1NSAmIHIuZmxhZ3MpKSB7CgkgICAgICAgICAgICAgIGUubXNnID0gInVua25vd24gY29tcHJlc3Npb24gbWV0aG9kIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKDU3MzQ0ICYgci5mbGFncykgewoJICAgICAgICAgICAgICBlLm1zZyA9ICJ1bmtub3duIGhlYWRlciBmbGFncyBzZXQiLCByLm1vZGUgPSAzMDsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByLmhlYWQgJiYgKHIuaGVhZC50ZXh0ID0gdSA+PiA4ICYgMSksIDUxMiAmIHIuZmxhZ3MgJiYgKEVbMF0gPSAyNTUgJiB1LCBFWzFdID0gdSA+Pj4gOCAmIDI1NSwgci5jaGVjayA9IEIoci5jaGVjaywgRSwgMiwgMCkpLCBsID0gdSA9IDAsIHIubW9kZSA9IDM7CgkgICAgICAgICAgY2FzZSAzOgoJICAgICAgICAgICAgZm9yICg7IGwgPCAzMjspIHsKCSAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgIG8tLSwgdSArPSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgci5oZWFkICYmIChyLmhlYWQudGltZSA9IHUpLCA1MTIgJiByLmZsYWdzICYmIChFWzBdID0gMjU1ICYgdSwgRVsxXSA9IHUgPj4+IDggJiAyNTUsIEVbMl0gPSB1ID4+PiAxNiAmIDI1NSwgRVszXSA9IHUgPj4+IDI0ICYgMjU1LCByLmNoZWNrID0gQihyLmNoZWNrLCBFLCA0LCAwKSksIGwgPSB1ID0gMCwgci5tb2RlID0gNDsKCSAgICAgICAgICBjYXNlIDQ6CgkgICAgICAgICAgICBmb3IgKDsgbCA8IDE2OykgewoJICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgby0tLCB1ICs9IG5bcysrXSA8PCBsLCBsICs9IDg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByLmhlYWQgJiYgKHIuaGVhZC54ZmxhZ3MgPSAyNTUgJiB1LCByLmhlYWQub3MgPSB1ID4+IDgpLCA1MTIgJiByLmZsYWdzICYmIChFWzBdID0gMjU1ICYgdSwgRVsxXSA9IHUgPj4+IDggJiAyNTUsIHIuY2hlY2sgPSBCKHIuY2hlY2ssIEUsIDIsIDApKSwgbCA9IHUgPSAwLCByLm1vZGUgPSA1OwoJICAgICAgICAgIGNhc2UgNToKCSAgICAgICAgICAgIGlmICgxMDI0ICYgci5mbGFncykgewoJICAgICAgICAgICAgICBmb3IgKDsgbCA8IDE2OykgewoJICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICAgIG8tLSwgdSArPSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIHIubGVuZ3RoID0gdSwgci5oZWFkICYmIChyLmhlYWQuZXh0cmFfbGVuID0gdSksIDUxMiAmIHIuZmxhZ3MgJiYgKEVbMF0gPSAyNTUgJiB1LCBFWzFdID0gdSA+Pj4gOCAmIDI1NSwgci5jaGVjayA9IEIoci5jaGVjaywgRSwgMiwgMCkpLCBsID0gdSA9IDA7CgkgICAgICAgICAgICB9IGVsc2Ugci5oZWFkICYmIChyLmhlYWQuZXh0cmEgPSBudWxsKTsKCSAgICAgICAgICAgIHIubW9kZSA9IDY7CgkgICAgICAgICAgY2FzZSA2OgoJICAgICAgICAgICAgaWYgKDEwMjQgJiByLmZsYWdzICYmIChvIDwgKGQgPSByLmxlbmd0aCkgJiYgKGQgPSBvKSwgZCAmJiAoci5oZWFkICYmIChrID0gci5oZWFkLmV4dHJhX2xlbiAtIHIubGVuZ3RoLCByLmhlYWQuZXh0cmEgfHwgKHIuaGVhZC5leHRyYSA9IG5ldyBBcnJheShyLmhlYWQuZXh0cmFfbGVuKSksIEkuYXJyYXlTZXQoci5oZWFkLmV4dHJhLCBuLCBzLCBkLCBrKSksIDUxMiAmIHIuZmxhZ3MgJiYgKHIuY2hlY2sgPSBCKHIuY2hlY2ssIG4sIGQsIHMpKSwgbyAtPSBkLCBzICs9IGQsIHIubGVuZ3RoIC09IGQpLCByLmxlbmd0aCkpIGJyZWFrIGU7CgkgICAgICAgICAgICByLmxlbmd0aCA9IDAsIHIubW9kZSA9IDc7CgkgICAgICAgICAgY2FzZSA3OgoJICAgICAgICAgICAgaWYgKDIwNDggJiByLmZsYWdzKSB7CgkgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICBmb3IgKGQgPSAwOyBrID0gbltzICsgZCsrXSwgci5oZWFkICYmIGsgJiYgci5sZW5ndGggPCA2NTUzNiAmJiAoci5oZWFkLm5hbWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShrKSksIGsgJiYgZCA8IG87KTsKCSAgICAgICAgICAgICAgaWYgKDUxMiAmIHIuZmxhZ3MgJiYgKHIuY2hlY2sgPSBCKHIuY2hlY2ssIG4sIGQsIHMpKSwgbyAtPSBkLCBzICs9IGQsIGspIGJyZWFrIGU7CgkgICAgICAgICAgICB9IGVsc2Ugci5oZWFkICYmIChyLmhlYWQubmFtZSA9IG51bGwpOwoJICAgICAgICAgICAgci5sZW5ndGggPSAwLCByLm1vZGUgPSA4OwoJICAgICAgICAgIGNhc2UgODoKCSAgICAgICAgICAgIGlmICg0MDk2ICYgci5mbGFncykgewoJICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgZm9yIChkID0gMDsgayA9IG5bcyArIGQrK10sIHIuaGVhZCAmJiBrICYmIHIubGVuZ3RoIDwgNjU1MzYgJiYgKHIuaGVhZC5jb21tZW50ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoaykpLCBrICYmIGQgPCBvOyk7CgkgICAgICAgICAgICAgIGlmICg1MTIgJiByLmZsYWdzICYmIChyLmNoZWNrID0gQihyLmNoZWNrLCBuLCBkLCBzKSksIG8gLT0gZCwgcyArPSBkLCBrKSBicmVhayBlOwoJICAgICAgICAgICAgfSBlbHNlIHIuaGVhZCAmJiAoci5oZWFkLmNvbW1lbnQgPSBudWxsKTsKCSAgICAgICAgICAgIHIubW9kZSA9IDk7CgkgICAgICAgICAgY2FzZSA5OgoJICAgICAgICAgICAgaWYgKDUxMiAmIHIuZmxhZ3MpIHsKCSAgICAgICAgICAgICAgZm9yICg7IGwgPCAxNjspIHsKCSAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICBpZiAodSAhPT0gKDY1NTM1ICYgci5jaGVjaykpIHsKCSAgICAgICAgICAgICAgICBlLm1zZyA9ICJoZWFkZXIgY3JjIG1pc21hdGNoIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgbCA9IHUgPSAwOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgci5oZWFkICYmIChyLmhlYWQuaGNyYyA9IHIuZmxhZ3MgPj4gOSAmIDEsIHIuaGVhZC5kb25lID0gITApLCBlLmFkbGVyID0gci5jaGVjayA9IDAsIHIubW9kZSA9IDEyOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgY2FzZSAxMDoKCSAgICAgICAgICAgIGZvciAoOyBsIDwgMzI7KSB7CgkgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGUuYWRsZXIgPSByLmNoZWNrID0gTCh1KSwgbCA9IHUgPSAwLCByLm1vZGUgPSAxMTsKCSAgICAgICAgICBjYXNlIDExOgoJICAgICAgICAgICAgaWYgKDAgPT09IHIuaGF2ZWRpY3QpIHJldHVybiBlLm5leHRfb3V0ID0gYSwgZS5hdmFpbF9vdXQgPSBoLCBlLm5leHRfaW4gPSBzLCBlLmF2YWlsX2luID0gbywgci5ob2xkID0gdSwgci5iaXRzID0gbCwgMjsKCSAgICAgICAgICAgIGUuYWRsZXIgPSByLmNoZWNrID0gMSwgci5tb2RlID0gMTI7CgkgICAgICAgICAgY2FzZSAxMjoKCSAgICAgICAgICAgIGlmICg1ID09PSB0IHx8IDYgPT09IHQpIGJyZWFrIGU7CgkgICAgICAgICAgY2FzZSAxMzoKCSAgICAgICAgICAgIGlmIChyLmxhc3QpIHsKCSAgICAgICAgICAgICAgdSA+Pj49IDcgJiBsLCBsIC09IDcgJiBsLCByLm1vZGUgPSAyNzsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKDsgbCA8IDM7KSB7CgkgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHN3aXRjaCAoci5sYXN0ID0gMSAmIHUsIGwgLT0gMSwgMyAmICh1ID4+Pj0gMSkpIHsKCSAgICAgICAgICAgICAgY2FzZSAwOgoJICAgICAgICAgICAgICAgIHIubW9kZSA9IDE0OwoJICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICBjYXNlIDE6CgkgICAgICAgICAgICAgICAgaWYgKGoociksIHIubW9kZSA9IDIwLCA2ICE9PSB0KSBicmVhazsKCSAgICAgICAgICAgICAgICB1ID4+Pj0gMiwgbCAtPSAyOwoJICAgICAgICAgICAgICAgIGJyZWFrIGU7CgkgICAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICByLm1vZGUgPSAxNzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgY2FzZSAzOgoJICAgICAgICAgICAgICAgIGUubXNnID0gImludmFsaWQgYmxvY2sgdHlwZSIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdSA+Pj49IDIsIGwgLT0gMjsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgIGNhc2UgMTQ6CgkgICAgICAgICAgICBmb3IgKHUgPj4+PSA3ICYgbCwgbCAtPSA3ICYgbDsgbCA8IDMyOykgewoJICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgby0tLCB1ICs9IG5bcysrXSA8PCBsLCBsICs9IDg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoKDY1NTM1ICYgdSkgIT0gKHUgPj4+IDE2IF4gNjU1MzUpKSB7CgkgICAgICAgICAgICAgIGUubXNnID0gImludmFsaWQgc3RvcmVkIGJsb2NrIGxlbmd0aHMiLCByLm1vZGUgPSAzMDsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoci5sZW5ndGggPSA2NTUzNSAmIHUsIGwgPSB1ID0gMCwgci5tb2RlID0gMTUsIDYgPT09IHQpIGJyZWFrIGU7CgkgICAgICAgICAgY2FzZSAxNToKCSAgICAgICAgICAgIHIubW9kZSA9IDE2OwoJICAgICAgICAgIGNhc2UgMTY6CgkgICAgICAgICAgICBpZiAoZCA9IHIubGVuZ3RoKSB7CgkgICAgICAgICAgICAgIGlmIChvIDwgZCAmJiAoZCA9IG8pLCBoIDwgZCAmJiAoZCA9IGgpLCAwID09PSBkKSBicmVhayBlOwoJICAgICAgICAgICAgICBJLmFycmF5U2V0KGksIG4sIHMsIGQsIGEpLCBvIC09IGQsIHMgKz0gZCwgaCAtPSBkLCBhICs9IGQsIHIubGVuZ3RoIC09IGQ7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgci5tb2RlID0gMTI7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICBjYXNlIDE3OgoJICAgICAgICAgICAgZm9yICg7IGwgPCAxNDspIHsKCSAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgIG8tLSwgdSArPSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKHIubmxlbiA9IDI1NyArICgzMSAmIHUpLCB1ID4+Pj0gNSwgbCAtPSA1LCByLm5kaXN0ID0gMSArICgzMSAmIHUpLCB1ID4+Pj0gNSwgbCAtPSA1LCByLm5jb2RlID0gNCArICgxNSAmIHUpLCB1ID4+Pj0gNCwgbCAtPSA0LCAyODYgPCByLm5sZW4gfHwgMzAgPCByLm5kaXN0KSB7CgkgICAgICAgICAgICAgIGUubXNnID0gInRvbyBtYW55IGxlbmd0aCBvciBkaXN0YW5jZSBzeW1ib2xzIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgci5oYXZlID0gMCwgci5tb2RlID0gMTg7CgkgICAgICAgICAgY2FzZSAxODoKCSAgICAgICAgICAgIGZvciAoOyByLmhhdmUgPCByLm5jb2RlOykgewoJICAgICAgICAgICAgICBmb3IgKDsgbCA8IDM7KSB7CgkgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgby0tLCB1ICs9IG5bcysrXSA8PCBsLCBsICs9IDg7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgci5sZW5zW0Fbci5oYXZlKytdXSA9IDcgJiB1LCB1ID4+Pj0gMywgbCAtPSAzOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZm9yICg7IHIuaGF2ZSA8IDE5Oykgci5sZW5zW0Fbci5oYXZlKytdXSA9IDA7CgkgICAgICAgICAgICBpZiAoci5sZW5jb2RlID0gci5sZW5keW4sIHIubGVuYml0cyA9IDcsIFMgPSB7CgkgICAgICAgICAgICAgIGJpdHM6IHIubGVuYml0cwoJICAgICAgICAgICAgfSwgeCA9IFQoMCwgci5sZW5zLCAwLCAxOSwgci5sZW5jb2RlLCAwLCByLndvcmssIFMpLCByLmxlbmJpdHMgPSBTLmJpdHMsIHgpIHsKCSAgICAgICAgICAgICAgZS5tc2cgPSAiaW52YWxpZCBjb2RlIGxlbmd0aHMgc2V0Iiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgci5oYXZlID0gMCwgci5tb2RlID0gMTk7CgkgICAgICAgICAgY2FzZSAxOToKCSAgICAgICAgICAgIGZvciAoOyByLmhhdmUgPCByLm5sZW4gKyByLm5kaXN0OykgewoJICAgICAgICAgICAgICBmb3IgKDsgZyA9IChDID0gci5sZW5jb2RlW3UgJiAoMSA8PCByLmxlbmJpdHMpIC0gMV0pID4+PiAxNiAmIDI1NSwgYiA9IDY1NTM1ICYgQywgISgoXyA9IEMgPj4+IDI0KSA8PSBsKTspIHsKCSAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICBpZiAoYiA8IDE2KSB1ID4+Pj0gXywgbCAtPSBfLCByLmxlbnNbci5oYXZlKytdID0gYjtlbHNlIHsKCSAgICAgICAgICAgICAgICBpZiAoMTYgPT09IGIpIHsKCSAgICAgICAgICAgICAgICAgIGZvciAoeiA9IF8gKyAyOyBsIDwgejspIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgICAgIG8tLSwgdSArPSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgaWYgKHUgPj4+PSBfLCBsIC09IF8sIDAgPT09IHIuaGF2ZSkgewoJICAgICAgICAgICAgICAgICAgICBlLm1zZyA9ICJpbnZhbGlkIGJpdCBsZW5ndGggcmVwZWF0Iiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgayA9IHIubGVuc1tyLmhhdmUgLSAxXSwgZCA9IDMgKyAoMyAmIHUpLCB1ID4+Pj0gMiwgbCAtPSAyOwoJICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoMTcgPT09IGIpIHsKCSAgICAgICAgICAgICAgICAgIGZvciAoeiA9IF8gKyAzOyBsIDwgejspIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgICAgIG8tLSwgdSArPSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgbCAtPSBfLCBrID0gMCwgZCA9IDMgKyAoNyAmICh1ID4+Pj0gXykpLCB1ID4+Pj0gMywgbCAtPSAzOwoJICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgICAgICBmb3IgKHogPSBfICsgNzsgbCA8IHo7KSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgIGwgLT0gXywgayA9IDAsIGQgPSAxMSArICgxMjcgJiAodSA+Pj49IF8pKSwgdSA+Pj49IDcsIGwgLT0gNzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKHIuaGF2ZSArIGQgPiByLm5sZW4gKyByLm5kaXN0KSB7CgkgICAgICAgICAgICAgICAgICBlLm1zZyA9ICJpbnZhbGlkIGJpdCBsZW5ndGggcmVwZWF0Iiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZm9yICg7IGQtLTspIHIubGVuc1tyLmhhdmUrK10gPSBrOwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoMzAgPT09IHIubW9kZSkgYnJlYWs7CgkgICAgICAgICAgICBpZiAoMCA9PT0gci5sZW5zWzI1Nl0pIHsKCSAgICAgICAgICAgICAgZS5tc2cgPSAiaW52YWxpZCBjb2RlIC0tIG1pc3NpbmcgZW5kLW9mLWJsb2NrIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKHIubGVuYml0cyA9IDksIFMgPSB7CgkgICAgICAgICAgICAgIGJpdHM6IHIubGVuYml0cwoJICAgICAgICAgICAgfSwgeCA9IFQoRCwgci5sZW5zLCAwLCByLm5sZW4sIHIubGVuY29kZSwgMCwgci53b3JrLCBTKSwgci5sZW5iaXRzID0gUy5iaXRzLCB4KSB7CgkgICAgICAgICAgICAgIGUubXNnID0gImludmFsaWQgbGl0ZXJhbC9sZW5ndGhzIHNldCIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChyLmRpc3RiaXRzID0gNiwgci5kaXN0Y29kZSA9IHIuZGlzdGR5biwgUyA9IHsKCSAgICAgICAgICAgICAgYml0czogci5kaXN0Yml0cwoJICAgICAgICAgICAgfSwgeCA9IFQoRiwgci5sZW5zLCByLm5sZW4sIHIubmRpc3QsIHIuZGlzdGNvZGUsIDAsIHIud29yaywgUyksIHIuZGlzdGJpdHMgPSBTLmJpdHMsIHgpIHsKCSAgICAgICAgICAgICAgZS5tc2cgPSAiaW52YWxpZCBkaXN0YW5jZXMgc2V0Iiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKHIubW9kZSA9IDIwLCA2ID09PSB0KSBicmVhayBlOwoJICAgICAgICAgIGNhc2UgMjA6CgkgICAgICAgICAgICByLm1vZGUgPSAyMTsKCSAgICAgICAgICBjYXNlIDIxOgoJICAgICAgICAgICAgaWYgKDYgPD0gbyAmJiAyNTggPD0gaCkgewoJICAgICAgICAgICAgICBlLm5leHRfb3V0ID0gYSwgZS5hdmFpbF9vdXQgPSBoLCBlLm5leHRfaW4gPSBzLCBlLmF2YWlsX2luID0gbywgci5ob2xkID0gdSwgci5iaXRzID0gbCwgUihlLCBjKSwgYSA9IGUubmV4dF9vdXQsIGkgPSBlLm91dHB1dCwgaCA9IGUuYXZhaWxfb3V0LCBzID0gZS5uZXh0X2luLCBuID0gZS5pbnB1dCwgbyA9IGUuYXZhaWxfaW4sIHUgPSByLmhvbGQsIGwgPSByLmJpdHMsIDEyID09PSByLm1vZGUgJiYgKHIuYmFjayA9IC0xKTsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHIuYmFjayA9IDA7IGcgPSAoQyA9IHIubGVuY29kZVt1ICYgKDEgPDwgci5sZW5iaXRzKSAtIDFdKSA+Pj4gMTYgJiAyNTUsIGIgPSA2NTUzNSAmIEMsICEoKF8gPSBDID4+PiAyNCkgPD0gbCk7KSB7CgkgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChnICYmIDAgPT0gKDI0MCAmIGcpKSB7CgkgICAgICAgICAgICAgIGZvciAodiA9IF8sIHkgPSBnLCB3ID0gYjsgZyA9IChDID0gci5sZW5jb2RlW3cgKyAoKHUgJiAoMSA8PCB2ICsgeSkgLSAxKSA+PiB2KV0pID4+PiAxNiAmIDI1NSwgYiA9IDY1NTM1ICYgQywgISh2ICsgKF8gPSBDID4+PiAyNCkgPD0gbCk7KSB7CgkgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgby0tLCB1ICs9IG5bcysrXSA8PCBsLCBsICs9IDg7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgdSA+Pj49IHYsIGwgLT0gdiwgci5iYWNrICs9IHY7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodSA+Pj49IF8sIGwgLT0gXywgci5iYWNrICs9IF8sIHIubGVuZ3RoID0gYiwgMCA9PT0gZykgewoJICAgICAgICAgICAgICByLm1vZGUgPSAyNjsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoMzIgJiBnKSB7CgkgICAgICAgICAgICAgIHIuYmFjayA9IC0xLCByLm1vZGUgPSAxMjsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoNjQgJiBnKSB7CgkgICAgICAgICAgICAgIGUubXNnID0gImludmFsaWQgbGl0ZXJhbC9sZW5ndGggY29kZSIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHIuZXh0cmEgPSAxNSAmIGcsIHIubW9kZSA9IDIyOwoJICAgICAgICAgIGNhc2UgMjI6CgkgICAgICAgICAgICBpZiAoci5leHRyYSkgewoJICAgICAgICAgICAgICBmb3IgKHogPSByLmV4dHJhOyBsIDwgejspIHsKCSAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICByLmxlbmd0aCArPSB1ICYgKDEgPDwgci5leHRyYSkgLSAxLCB1ID4+Pj0gci5leHRyYSwgbCAtPSByLmV4dHJhLCByLmJhY2sgKz0gci5leHRyYTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHIud2FzID0gci5sZW5ndGgsIHIubW9kZSA9IDIzOwoJICAgICAgICAgIGNhc2UgMjM6CgkgICAgICAgICAgICBmb3IgKDsgZyA9IChDID0gci5kaXN0Y29kZVt1ICYgKDEgPDwgci5kaXN0Yml0cykgLSAxXSkgPj4+IDE2ICYgMjU1LCBiID0gNjU1MzUgJiBDLCAhKChfID0gQyA+Pj4gMjQpIDw9IGwpOykgewoJICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgby0tLCB1ICs9IG5bcysrXSA8PCBsLCBsICs9IDg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoMCA9PSAoMjQwICYgZykpIHsKCSAgICAgICAgICAgICAgZm9yICh2ID0gXywgeSA9IGcsIHcgPSBiOyBnID0gKEMgPSByLmRpc3Rjb2RlW3cgKyAoKHUgJiAoMSA8PCB2ICsgeSkgLSAxKSA+PiB2KV0pID4+PiAxNiAmIDI1NSwgYiA9IDY1NTM1ICYgQywgISh2ICsgKF8gPSBDID4+PiAyNCkgPD0gbCk7KSB7CgkgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIGU7CgkgICAgICAgICAgICAgICAgby0tLCB1ICs9IG5bcysrXSA8PCBsLCBsICs9IDg7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgdSA+Pj49IHYsIGwgLT0gdiwgci5iYWNrICs9IHY7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodSA+Pj49IF8sIGwgLT0gXywgci5iYWNrICs9IF8sIDY0ICYgZykgewoJICAgICAgICAgICAgICBlLm1zZyA9ICJpbnZhbGlkIGRpc3RhbmNlIGNvZGUiLCByLm1vZGUgPSAzMDsKCSAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByLm9mZnNldCA9IGIsIHIuZXh0cmEgPSAxNSAmIGcsIHIubW9kZSA9IDI0OwoJICAgICAgICAgIGNhc2UgMjQ6CgkgICAgICAgICAgICBpZiAoci5leHRyYSkgewoJICAgICAgICAgICAgICBmb3IgKHogPSByLmV4dHJhOyBsIDwgejspIHsKCSAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgZTsKCSAgICAgICAgICAgICAgICBvLS0sIHUgKz0gbltzKytdIDw8IGwsIGwgKz0gODsKCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICByLm9mZnNldCArPSB1ICYgKDEgPDwgci5leHRyYSkgLSAxLCB1ID4+Pj0gci5leHRyYSwgbCAtPSByLmV4dHJhLCByLmJhY2sgKz0gci5leHRyYTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChyLm9mZnNldCA+IHIuZG1heCkgewoJICAgICAgICAgICAgICBlLm1zZyA9ICJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHIubW9kZSA9IDI1OwoJICAgICAgICAgIGNhc2UgMjU6CgkgICAgICAgICAgICBpZiAoMCA9PT0gaCkgYnJlYWsgZTsKCSAgICAgICAgICAgIGlmIChkID0gYyAtIGgsIHIub2Zmc2V0ID4gZCkgewoJICAgICAgICAgICAgICBpZiAoKGQgPSByLm9mZnNldCAtIGQpID4gci53aGF2ZSAmJiByLnNhbmUpIHsKCSAgICAgICAgICAgICAgICBlLm1zZyA9ICJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIHAgPSBkID4gci53bmV4dCA/IChkIC09IHIud25leHQsIHIud3NpemUgLSBkKSA6IHIud25leHQgLSBkLCBkID4gci5sZW5ndGggJiYgKGQgPSByLmxlbmd0aCksIG0gPSByLndpbmRvdzsKCSAgICAgICAgICAgIH0gZWxzZSBtID0gaSwgcCA9IGEgLSByLm9mZnNldCwgZCA9IHIubGVuZ3RoOwoJICAgICAgICAgICAgZm9yIChoIDwgZCAmJiAoZCA9IGgpLCBoIC09IGQsIHIubGVuZ3RoIC09IGQ7IGlbYSsrXSA9IG1bcCsrXSwgLS1kOyk7CgkgICAgICAgICAgICAwID09PSByLmxlbmd0aCAmJiAoci5tb2RlID0gMjEpOwoJICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgY2FzZSAyNjoKCSAgICAgICAgICAgIGlmICgwID09PSBoKSBicmVhayBlOwoJICAgICAgICAgICAgaVthKytdID0gci5sZW5ndGgsIGgtLSwgci5tb2RlID0gMjE7CgkgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICBjYXNlIDI3OgoJICAgICAgICAgICAgaWYgKHIud3JhcCkgewoJICAgICAgICAgICAgICBmb3IgKDsgbCA8IDMyOykgewoJICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICAgIG8tLSwgdSB8PSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIGlmIChjIC09IGgsIGUudG90YWxfb3V0ICs9IGMsIHIudG90YWwgKz0gYywgYyAmJiAoZS5hZGxlciA9IHIuY2hlY2sgPSByLmZsYWdzID8gQihyLmNoZWNrLCBpLCBjLCBhIC0gYykgOiBPKHIuY2hlY2ssIGksIGMsIGEgLSBjKSksIGMgPSBoLCAoci5mbGFncyA/IHUgOiBMKHUpKSAhPT0gci5jaGVjaykgewoJICAgICAgICAgICAgICAgIGUubXNnID0gImluY29ycmVjdCBkYXRhIGNoZWNrIiwgci5tb2RlID0gMzA7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgbCA9IHUgPSAwOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgci5tb2RlID0gMjg7CgkgICAgICAgICAgY2FzZSAyODoKCSAgICAgICAgICAgIGlmIChyLndyYXAgJiYgci5mbGFncykgewoJICAgICAgICAgICAgICBmb3IgKDsgbCA8IDMyOykgewoJICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayBlOwoJICAgICAgICAgICAgICAgIG8tLSwgdSArPSBuW3MrK10gPDwgbCwgbCArPSA4OwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIGlmICh1ICE9PSAoNDI5NDk2NzI5NSAmIHIudG90YWwpKSB7CgkgICAgICAgICAgICAgICAgZS5tc2cgPSAiaW5jb3JyZWN0IGxlbmd0aCBjaGVjayIsIHIubW9kZSA9IDMwOwoJICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgIGwgPSB1ID0gMDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHIubW9kZSA9IDI5OwoJICAgICAgICAgIGNhc2UgMjk6CgkgICAgICAgICAgICB4ID0gMTsKCSAgICAgICAgICAgIGJyZWFrIGU7CgkgICAgICAgICAgY2FzZSAzMDoKCSAgICAgICAgICAgIHggPSAtMzsKCSAgICAgICAgICAgIGJyZWFrIGU7CgkgICAgICAgICAgY2FzZSAzMToKCSAgICAgICAgICAgIHJldHVybiAtNDsKCSAgICAgICAgICBjYXNlIDMyOgoJICAgICAgICAgIGRlZmF1bHQ6CgkgICAgICAgICAgICByZXR1cm4gVTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gZS5uZXh0X291dCA9IGEsIGUuYXZhaWxfb3V0ID0gaCwgZS5uZXh0X2luID0gcywgZS5hdmFpbF9pbiA9IG8sIHIuaG9sZCA9IHUsIHIuYml0cyA9IGwsIChyLndzaXplIHx8IGMgIT09IGUuYXZhaWxfb3V0ICYmIHIubW9kZSA8IDMwICYmIChyLm1vZGUgPCAyNyB8fCA0ICE9PSB0KSkgJiYgWihlLCBlLm91dHB1dCwgZS5uZXh0X291dCwgYyAtIGUuYXZhaWxfb3V0KSA/IChyLm1vZGUgPSAzMSwgLTQpIDogKGYgLT0gZS5hdmFpbF9pbiwgYyAtPSBlLmF2YWlsX291dCwgZS50b3RhbF9pbiArPSBmLCBlLnRvdGFsX291dCArPSBjLCByLnRvdGFsICs9IGMsIHIud3JhcCAmJiBjICYmIChlLmFkbGVyID0gci5jaGVjayA9IHIuZmxhZ3MgPyBCKHIuY2hlY2ssIGksIGMsIGUubmV4dF9vdXQgLSBjKSA6IE8oci5jaGVjaywgaSwgYywgZS5uZXh0X291dCAtIGMpKSwgZS5kYXRhX3R5cGUgPSByLmJpdHMgKyAoci5sYXN0ID8gNjQgOiAwKSArICgxMiA9PT0gci5tb2RlID8gMTI4IDogMCkgKyAoMjAgPT09IHIubW9kZSB8fCAxNSA9PT0gci5tb2RlID8gMjU2IDogMCksICgwID09IGYgJiYgMCA9PT0gYyB8fCA0ID09PSB0KSAmJiB4ID09PSBOICYmICh4ID0gLTUpLCB4KTsKCSAgICAgIH0sIHIuaW5mbGF0ZUVuZCA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgIGlmICghZSB8fCAhZS5zdGF0ZSkgcmV0dXJuIFU7CgkgICAgICAgIHZhciB0ID0gZS5zdGF0ZTsKCSAgICAgICAgcmV0dXJuIHQud2luZG93ICYmICh0LndpbmRvdyA9IG51bGwpLCBlLnN0YXRlID0gbnVsbCwgTjsKCSAgICAgIH0sIHIuaW5mbGF0ZUdldEhlYWRlciA9IGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgIHZhciByOwoJICAgICAgICByZXR1cm4gZSAmJiBlLnN0YXRlID8gMCA9PSAoMiAmIChyID0gZS5zdGF0ZSkud3JhcCkgPyBVIDogKChyLmhlYWQgPSB0KS5kb25lID0gITEsIE4pIDogVTsKCSAgICAgIH0sIHIuaW5mbGF0ZVNldERpY3Rpb25hcnkgPSBmdW5jdGlvbiAoZSwgdCkgewoJICAgICAgICB2YXIgciwKCSAgICAgICAgICBuID0gdC5sZW5ndGg7CgkgICAgICAgIHJldHVybiBlICYmIGUuc3RhdGUgPyAwICE9PSAociA9IGUuc3RhdGUpLndyYXAgJiYgMTEgIT09IHIubW9kZSA/IFUgOiAxMSA9PT0gci5tb2RlICYmIE8oMSwgdCwgbiwgMCkgIT09IHIuY2hlY2sgPyAtMyA6IFooZSwgdCwgbiwgbikgPyAoci5tb2RlID0gMzEsIC00KSA6IChyLmhhdmVkaWN0ID0gMSwgTikgOiBVOwoJICAgICAgfSwgci5pbmZsYXRlSW5mbyA9ICJwYWtvIGluZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpIjsKCSAgICB9LCB7CgkgICAgICAiLi4vdXRpbHMvY29tbW9uIjogNDEsCgkgICAgICAiLi9hZGxlcjMyIjogNDMsCgkgICAgICAiLi9jcmMzMiI6IDQ1LAoJICAgICAgIi4vaW5mZmFzdCI6IDQ4LAoJICAgICAgIi4vaW5mdHJlZXMiOiA1MAoJICAgIH1dLAoJICAgIDUwOiBbZnVuY3Rpb24gKGUsIHQsIHIpIHsKCgkgICAgICB2YXIgRCA9IGUoIi4uL3V0aWxzL2NvbW1vbiIpLAoJICAgICAgICBGID0gWzMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMTMsIDE1LCAxNywgMTksIDIzLCAyNywgMzEsIDM1LCA0MywgNTEsIDU5LCA2NywgODMsIDk5LCAxMTUsIDEzMSwgMTYzLCAxOTUsIDIyNywgMjU4LCAwLCAwXSwKCSAgICAgICAgTiA9IFsxNiwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE3LCAxNywgMTcsIDE3LCAxOCwgMTgsIDE4LCAxOCwgMTksIDE5LCAxOSwgMTksIDIwLCAyMCwgMjAsIDIwLCAyMSwgMjEsIDIxLCAyMSwgMTYsIDcyLCA3OF0sCgkgICAgICAgIFUgPSBbMSwgMiwgMywgNCwgNSwgNywgOSwgMTMsIDE3LCAyNSwgMzMsIDQ5LCA2NSwgOTcsIDEyOSwgMTkzLCAyNTcsIDM4NSwgNTEzLCA3NjksIDEwMjUsIDE1MzcsIDIwNDksIDMwNzMsIDQwOTcsIDYxNDUsIDgxOTMsIDEyMjg5LCAxNjM4NSwgMjQ1NzcsIDAsIDBdLAoJICAgICAgICBQID0gWzE2LCAxNiwgMTYsIDE2LCAxNywgMTcsIDE4LCAxOCwgMTksIDE5LCAyMCwgMjAsIDIxLCAyMSwgMjIsIDIyLCAyMywgMjMsIDI0LCAyNCwgMjUsIDI1LCAyNiwgMjYsIDI3LCAyNywgMjgsIDI4LCAyOSwgMjksIDY0LCA2NF07CgkgICAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCwgciwgbiwgaSwgcywgYSwgbykgewoJICAgICAgICB2YXIgaCwKCSAgICAgICAgICB1LAoJICAgICAgICAgIGwsCgkgICAgICAgICAgZiwKCSAgICAgICAgICBjLAoJICAgICAgICAgIGQsCgkgICAgICAgICAgcCwKCSAgICAgICAgICBtLAoJICAgICAgICAgIF8sCgkgICAgICAgICAgZyA9IG8uYml0cywKCSAgICAgICAgICBiID0gMCwKCSAgICAgICAgICB2ID0gMCwKCSAgICAgICAgICB5ID0gMCwKCSAgICAgICAgICB3ID0gMCwKCSAgICAgICAgICBrID0gMCwKCSAgICAgICAgICB4ID0gMCwKCSAgICAgICAgICBTID0gMCwKCSAgICAgICAgICB6ID0gMCwKCSAgICAgICAgICBDID0gMCwKCSAgICAgICAgICBFID0gMCwKCSAgICAgICAgICBBID0gbnVsbCwKCSAgICAgICAgICBJID0gMCwKCSAgICAgICAgICBPID0gbmV3IEQuQnVmMTYoMTYpLAoJICAgICAgICAgIEIgPSBuZXcgRC5CdWYxNigxNiksCgkgICAgICAgICAgUiA9IG51bGwsCgkgICAgICAgICAgVCA9IDA7CgkgICAgICAgIGZvciAoYiA9IDA7IGIgPD0gMTU7IGIrKykgT1tiXSA9IDA7CgkgICAgICAgIGZvciAodiA9IDA7IHYgPCBuOyB2KyspIE9bdFtyICsgdl1dKys7CgkgICAgICAgIGZvciAoayA9IGcsIHcgPSAxNTsgMSA8PSB3ICYmIDAgPT09IE9bd107IHctLSk7CgkgICAgICAgIGlmICh3IDwgayAmJiAoayA9IHcpLCAwID09PSB3KSByZXR1cm4gaVtzKytdID0gMjA5NzE1MjAsIGlbcysrXSA9IDIwOTcxNTIwLCBvLmJpdHMgPSAxLCAwOwoJICAgICAgICBmb3IgKHkgPSAxOyB5IDwgdyAmJiAwID09PSBPW3ldOyB5KyspOwoJICAgICAgICBmb3IgKGsgPCB5ICYmIChrID0geSksIGIgPSB6ID0gMTsgYiA8PSAxNTsgYisrKSBpZiAoeiA8PD0gMSwgKHogLT0gT1tiXSkgPCAwKSByZXR1cm4gLTE7CgkgICAgICAgIGlmICgwIDwgeiAmJiAoMCA9PT0gZSB8fCAxICE9PSB3KSkgcmV0dXJuIC0xOwoJICAgICAgICBmb3IgKEJbMV0gPSAwLCBiID0gMTsgYiA8IDE1OyBiKyspIEJbYiArIDFdID0gQltiXSArIE9bYl07CgkgICAgICAgIGZvciAodiA9IDA7IHYgPCBuOyB2KyspIDAgIT09IHRbciArIHZdICYmIChhW0JbdFtyICsgdl1dKytdID0gdik7CgkgICAgICAgIGlmIChkID0gMCA9PT0gZSA/IChBID0gUiA9IGEsIDE5KSA6IDEgPT09IGUgPyAoQSA9IEYsIEkgLT0gMjU3LCBSID0gTiwgVCAtPSAyNTcsIDI1NikgOiAoQSA9IFUsIFIgPSBQLCAtMSksIGIgPSB5LCBjID0gcywgUyA9IHYgPSBFID0gMCwgbCA9IC0xLCBmID0gKEMgPSAxIDw8ICh4ID0gaykpIC0gMSwgMSA9PT0gZSAmJiA4NTIgPCBDIHx8IDIgPT09IGUgJiYgNTkyIDwgQykgcmV0dXJuIDE7CgkgICAgICAgIGZvciAoOzspIHsKCSAgICAgICAgICBmb3IgKHAgPSBiIC0gUywgXyA9IGFbdl0gPCBkID8gKG0gPSAwLCBhW3ZdKSA6IGFbdl0gPiBkID8gKG0gPSBSW1QgKyBhW3ZdXSwgQVtJICsgYVt2XV0pIDogKG0gPSA5NiwgMCksIGggPSAxIDw8IGIgLSBTLCB5ID0gdSA9IDEgPDwgeDsgaVtjICsgKEUgPj4gUykgKyAodSAtPSBoKV0gPSBwIDw8IDI0IHwgbSA8PCAxNiB8IF8gfCAwLCAwICE9PSB1Oyk7CgkgICAgICAgICAgZm9yIChoID0gMSA8PCBiIC0gMTsgRSAmIGg7KSBoID4+PSAxOwoJICAgICAgICAgIGlmICgwICE9PSBoID8gKEUgJj0gaCAtIDEsIEUgKz0gaCkgOiBFID0gMCwgdisrLCAwID09IC0tT1tiXSkgewoJICAgICAgICAgICAgaWYgKGIgPT09IHcpIGJyZWFrOwoJICAgICAgICAgICAgYiA9IHRbciArIGFbdl1dOwoJICAgICAgICAgIH0KCSAgICAgICAgICBpZiAoayA8IGIgJiYgKEUgJiBmKSAhPT0gbCkgewoJICAgICAgICAgICAgZm9yICgwID09PSBTICYmIChTID0gayksIGMgKz0geSwgeiA9IDEgPDwgKHggPSBiIC0gUyk7IHggKyBTIDwgdyAmJiAhKCh6IC09IE9beCArIFNdKSA8PSAwKTspIHgrKywgeiA8PD0gMTsKCSAgICAgICAgICAgIGlmIChDICs9IDEgPDwgeCwgMSA9PT0gZSAmJiA4NTIgPCBDIHx8IDIgPT09IGUgJiYgNTkyIDwgQykgcmV0dXJuIDE7CgkgICAgICAgICAgICBpW2wgPSBFICYgZl0gPSBrIDw8IDI0IHwgeCA8PCAxNiB8IGMgLSBzIHwgMDsKCSAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIDAgIT09IEUgJiYgKGlbYyArIEVdID0gYiAtIFMgPDwgMjQgfCA2NCA8PCAxNiB8IDApLCBvLmJpdHMgPSBrLCAwOwoJICAgICAgfTsKCSAgICB9LCB7CgkgICAgICAiLi4vdXRpbHMvY29tbW9uIjogNDEKCSAgICB9XSwKCSAgICA1MTogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdC5leHBvcnRzID0gewoJICAgICAgICAyOiAibmVlZCBkaWN0aW9uYXJ5IiwKCSAgICAgICAgMTogInN0cmVhbSBlbmQiLAoJICAgICAgICAwOiAiIiwKCSAgICAgICAgIi0xIjogImZpbGUgZXJyb3IiLAoJICAgICAgICAiLTIiOiAic3RyZWFtIGVycm9yIiwKCSAgICAgICAgIi0zIjogImRhdGEgZXJyb3IiLAoJICAgICAgICAiLTQiOiAiaW5zdWZmaWNpZW50IG1lbW9yeSIsCgkgICAgICAgICItNSI6ICJidWZmZXIgZXJyb3IiLAoJICAgICAgICAiLTYiOiAiaW5jb21wYXRpYmxlIHZlcnNpb24iCgkgICAgICB9OwoJICAgIH0sIHt9XSwKCSAgICA1MjogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdmFyIGkgPSBlKCIuLi91dGlscy9jb21tb24iKSwKCSAgICAgICAgbyA9IDAsCgkgICAgICAgIGggPSAxOwoJICAgICAgZnVuY3Rpb24gbihlKSB7CgkgICAgICAgIGZvciAodmFyIHQgPSBlLmxlbmd0aDsgMCA8PSAtLXQ7KSBlW3RdID0gMDsKCSAgICAgIH0KCSAgICAgIHZhciBzID0gMCwKCSAgICAgICAgYSA9IDI5LAoJICAgICAgICB1ID0gMjU2LAoJICAgICAgICBsID0gdSArIDEgKyBhLAoJICAgICAgICBmID0gMzAsCgkgICAgICAgIGMgPSAxOSwKCSAgICAgICAgXyA9IDIgKiBsICsgMSwKCSAgICAgICAgZyA9IDE1LAoJICAgICAgICBkID0gMTYsCgkgICAgICAgIHAgPSA3LAoJICAgICAgICBtID0gMjU2LAoJICAgICAgICBiID0gMTYsCgkgICAgICAgIHYgPSAxNywKCSAgICAgICAgeSA9IDE4LAoJICAgICAgICB3ID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsIDEsIDIsIDIsIDIsIDIsIDMsIDMsIDMsIDMsIDQsIDQsIDQsIDQsIDUsIDUsIDUsIDUsIDBdLAoJICAgICAgICBrID0gWzAsIDAsIDAsIDAsIDEsIDEsIDIsIDIsIDMsIDMsIDQsIDQsIDUsIDUsIDYsIDYsIDcsIDcsIDgsIDgsIDksIDksIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxM10sCgkgICAgICAgIHggPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMiwgMywgN10sCgkgICAgICAgIFMgPSBbMTYsIDE3LCAxOCwgMCwgOCwgNywgOSwgNiwgMTAsIDUsIDExLCA0LCAxMiwgMywgMTMsIDIsIDE0LCAxLCAxNV0sCgkgICAgICAgIHogPSBuZXcgQXJyYXkoMiAqIChsICsgMikpOwoJICAgICAgbih6KTsKCSAgICAgIHZhciBDID0gbmV3IEFycmF5KDIgKiBmKTsKCSAgICAgIG4oQyk7CgkgICAgICB2YXIgRSA9IG5ldyBBcnJheSg1MTIpOwoJICAgICAgbihFKTsKCSAgICAgIHZhciBBID0gbmV3IEFycmF5KDI1Nik7CgkgICAgICBuKEEpOwoJICAgICAgdmFyIEkgPSBuZXcgQXJyYXkoYSk7CgkgICAgICBuKEkpOwoJICAgICAgdmFyIE8sCgkgICAgICAgIEIsCgkgICAgICAgIFIsCgkgICAgICAgIFQgPSBuZXcgQXJyYXkoZik7CgkgICAgICBmdW5jdGlvbiBEKGUsIHQsIHIsIG4sIGkpIHsKCSAgICAgICAgdGhpcy5zdGF0aWNfdHJlZSA9IGUsIHRoaXMuZXh0cmFfYml0cyA9IHQsIHRoaXMuZXh0cmFfYmFzZSA9IHIsIHRoaXMuZWxlbXMgPSBuLCB0aGlzLm1heF9sZW5ndGggPSBpLCB0aGlzLmhhc19zdHJlZSA9IGUgJiYgZS5sZW5ndGg7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBGKGUsIHQpIHsKCSAgICAgICAgdGhpcy5keW5fdHJlZSA9IGUsIHRoaXMubWF4X2NvZGUgPSAwLCB0aGlzLnN0YXRfZGVzYyA9IHQ7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBOKGUpIHsKCSAgICAgICAgcmV0dXJuIGUgPCAyNTYgPyBFW2VdIDogRVsyNTYgKyAoZSA+Pj4gNyldOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gVShlLCB0KSB7CgkgICAgICAgIGUucGVuZGluZ19idWZbZS5wZW5kaW5nKytdID0gMjU1ICYgdCwgZS5wZW5kaW5nX2J1ZltlLnBlbmRpbmcrK10gPSB0ID4+PiA4ICYgMjU1OwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gUChlLCB0LCByKSB7CgkgICAgICAgIGUuYmlfdmFsaWQgPiBkIC0gciA/IChlLmJpX2J1ZiB8PSB0IDw8IGUuYmlfdmFsaWQgJiA2NTUzNSwgVShlLCBlLmJpX2J1ZiksIGUuYmlfYnVmID0gdCA+PiBkIC0gZS5iaV92YWxpZCwgZS5iaV92YWxpZCArPSByIC0gZCkgOiAoZS5iaV9idWYgfD0gdCA8PCBlLmJpX3ZhbGlkICYgNjU1MzUsIGUuYmlfdmFsaWQgKz0gcik7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBMKGUsIHQsIHIpIHsKCSAgICAgICAgUChlLCByWzIgKiB0XSwgclsyICogdCArIDFdKTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIGooZSwgdCkgewoJICAgICAgICBmb3IgKHZhciByID0gMDsgciB8PSAxICYgZSwgZSA+Pj49IDEsIHIgPDw9IDEsIDAgPCAtLXQ7KTsKCSAgICAgICAgcmV0dXJuIHIgPj4+IDE7CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBaKGUsIHQsIHIpIHsKCSAgICAgICAgdmFyIG4sCgkgICAgICAgICAgaSwKCSAgICAgICAgICBzID0gbmV3IEFycmF5KGcgKyAxKSwKCSAgICAgICAgICBhID0gMDsKCSAgICAgICAgZm9yIChuID0gMTsgbiA8PSBnOyBuKyspIHNbbl0gPSBhID0gYSArIHJbbiAtIDFdIDw8IDE7CgkgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gdDsgaSsrKSB7CgkgICAgICAgICAgdmFyIG8gPSBlWzIgKiBpICsgMV07CgkgICAgICAgICAgMCAhPT0gbyAmJiAoZVsyICogaV0gPSBqKHNbb10rKywgbykpOwoJICAgICAgICB9CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBXKGUpIHsKCSAgICAgICAgdmFyIHQ7CgkgICAgICAgIGZvciAodCA9IDA7IHQgPCBsOyB0KyspIGUuZHluX2x0cmVlWzIgKiB0XSA9IDA7CgkgICAgICAgIGZvciAodCA9IDA7IHQgPCBmOyB0KyspIGUuZHluX2R0cmVlWzIgKiB0XSA9IDA7CgkgICAgICAgIGZvciAodCA9IDA7IHQgPCBjOyB0KyspIGUuYmxfdHJlZVsyICogdF0gPSAwOwoJICAgICAgICBlLmR5bl9sdHJlZVsyICogbV0gPSAxLCBlLm9wdF9sZW4gPSBlLnN0YXRpY19sZW4gPSAwLCBlLmxhc3RfbGl0ID0gZS5tYXRjaGVzID0gMDsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIE0oZSkgewoJICAgICAgICA4IDwgZS5iaV92YWxpZCA/IFUoZSwgZS5iaV9idWYpIDogMCA8IGUuYmlfdmFsaWQgJiYgKGUucGVuZGluZ19idWZbZS5wZW5kaW5nKytdID0gZS5iaV9idWYpLCBlLmJpX2J1ZiA9IDAsIGUuYmlfdmFsaWQgPSAwOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gSChlLCB0LCByLCBuKSB7CgkgICAgICAgIHZhciBpID0gMiAqIHQsCgkgICAgICAgICAgcyA9IDIgKiByOwoJICAgICAgICByZXR1cm4gZVtpXSA8IGVbc10gfHwgZVtpXSA9PT0gZVtzXSAmJiBuW3RdIDw9IG5bcl07CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBHKGUsIHQsIHIpIHsKCSAgICAgICAgZm9yICh2YXIgbiA9IGUuaGVhcFtyXSwgaSA9IHIgPDwgMTsgaSA8PSBlLmhlYXBfbGVuICYmIChpIDwgZS5oZWFwX2xlbiAmJiBIKHQsIGUuaGVhcFtpICsgMV0sIGUuaGVhcFtpXSwgZS5kZXB0aCkgJiYgaSsrLCAhSCh0LCBuLCBlLmhlYXBbaV0sIGUuZGVwdGgpKTspIGUuaGVhcFtyXSA9IGUuaGVhcFtpXSwgciA9IGksIGkgPDw9IDE7CgkgICAgICAgIGUuaGVhcFtyXSA9IG47CgkgICAgICB9CgkgICAgICBmdW5jdGlvbiBLKGUsIHQsIHIpIHsKCSAgICAgICAgdmFyIG4sCgkgICAgICAgICAgaSwKCSAgICAgICAgICBzLAoJICAgICAgICAgIGEsCgkgICAgICAgICAgbyA9IDA7CgkgICAgICAgIGlmICgwICE9PSBlLmxhc3RfbGl0KSBmb3IgKDsgbiA9IGUucGVuZGluZ19idWZbZS5kX2J1ZiArIDIgKiBvXSA8PCA4IHwgZS5wZW5kaW5nX2J1ZltlLmRfYnVmICsgMiAqIG8gKyAxXSwgaSA9IGUucGVuZGluZ19idWZbZS5sX2J1ZiArIG9dLCBvKyssIDAgPT09IG4gPyBMKGUsIGksIHQpIDogKEwoZSwgKHMgPSBBW2ldKSArIHUgKyAxLCB0KSwgMCAhPT0gKGEgPSB3W3NdKSAmJiBQKGUsIGkgLT0gSVtzXSwgYSksIEwoZSwgcyA9IE4oLS1uKSwgciksIDAgIT09IChhID0ga1tzXSkgJiYgUChlLCBuIC09IFRbc10sIGEpKSwgbyA8IGUubGFzdF9saXQ7KTsKCSAgICAgICAgTChlLCBtLCB0KTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIFkoZSwgdCkgewoJICAgICAgICB2YXIgciwKCSAgICAgICAgICBuLAoJICAgICAgICAgIGksCgkgICAgICAgICAgcyA9IHQuZHluX3RyZWUsCgkgICAgICAgICAgYSA9IHQuc3RhdF9kZXNjLnN0YXRpY190cmVlLAoJICAgICAgICAgIG8gPSB0LnN0YXRfZGVzYy5oYXNfc3RyZWUsCgkgICAgICAgICAgaCA9IHQuc3RhdF9kZXNjLmVsZW1zLAoJICAgICAgICAgIHUgPSAtMTsKCSAgICAgICAgZm9yIChlLmhlYXBfbGVuID0gMCwgZS5oZWFwX21heCA9IF8sIHIgPSAwOyByIDwgaDsgcisrKSAwICE9PSBzWzIgKiByXSA/IChlLmhlYXBbKytlLmhlYXBfbGVuXSA9IHUgPSByLCBlLmRlcHRoW3JdID0gMCkgOiBzWzIgKiByICsgMV0gPSAwOwoJICAgICAgICBmb3IgKDsgZS5oZWFwX2xlbiA8IDI7KSBzWzIgKiAoaSA9IGUuaGVhcFsrK2UuaGVhcF9sZW5dID0gdSA8IDIgPyArK3UgOiAwKV0gPSAxLCBlLmRlcHRoW2ldID0gMCwgZS5vcHRfbGVuLS0sIG8gJiYgKGUuc3RhdGljX2xlbiAtPSBhWzIgKiBpICsgMV0pOwoJICAgICAgICBmb3IgKHQubWF4X2NvZGUgPSB1LCByID0gZS5oZWFwX2xlbiA+PiAxOyAxIDw9IHI7IHItLSkgRyhlLCBzLCByKTsKCSAgICAgICAgZm9yIChpID0gaDsgciA9IGUuaGVhcFsxXSwgZS5oZWFwWzFdID0gZS5oZWFwW2UuaGVhcF9sZW4tLV0sIEcoZSwgcywgMSksIG4gPSBlLmhlYXBbMV0sIGUuaGVhcFstLWUuaGVhcF9tYXhdID0gciwgZS5oZWFwWy0tZS5oZWFwX21heF0gPSBuLCBzWzIgKiBpXSA9IHNbMiAqIHJdICsgc1syICogbl0sIGUuZGVwdGhbaV0gPSAoZS5kZXB0aFtyXSA+PSBlLmRlcHRoW25dID8gZS5kZXB0aFtyXSA6IGUuZGVwdGhbbl0pICsgMSwgc1syICogciArIDFdID0gc1syICogbiArIDFdID0gaSwgZS5oZWFwWzFdID0gaSsrLCBHKGUsIHMsIDEpLCAyIDw9IGUuaGVhcF9sZW47KTsKCSAgICAgICAgZS5oZWFwWy0tZS5oZWFwX21heF0gPSBlLmhlYXBbMV0sIGZ1bmN0aW9uIChlLCB0KSB7CgkgICAgICAgICAgdmFyIHIsCgkgICAgICAgICAgICBuLAoJICAgICAgICAgICAgaSwKCSAgICAgICAgICAgIHMsCgkgICAgICAgICAgICBhLAoJICAgICAgICAgICAgbywKCSAgICAgICAgICAgIGggPSB0LmR5bl90cmVlLAoJICAgICAgICAgICAgdSA9IHQubWF4X2NvZGUsCgkgICAgICAgICAgICBsID0gdC5zdGF0X2Rlc2Muc3RhdGljX3RyZWUsCgkgICAgICAgICAgICBmID0gdC5zdGF0X2Rlc2MuaGFzX3N0cmVlLAoJICAgICAgICAgICAgYyA9IHQuc3RhdF9kZXNjLmV4dHJhX2JpdHMsCgkgICAgICAgICAgICBkID0gdC5zdGF0X2Rlc2MuZXh0cmFfYmFzZSwKCSAgICAgICAgICAgIHAgPSB0LnN0YXRfZGVzYy5tYXhfbGVuZ3RoLAoJICAgICAgICAgICAgbSA9IDA7CgkgICAgICAgICAgZm9yIChzID0gMDsgcyA8PSBnOyBzKyspIGUuYmxfY291bnRbc10gPSAwOwoJICAgICAgICAgIGZvciAoaFsyICogZS5oZWFwW2UuaGVhcF9tYXhdICsgMV0gPSAwLCByID0gZS5oZWFwX21heCArIDE7IHIgPCBfOyByKyspIHAgPCAocyA9IGhbMiAqIGhbMiAqIChuID0gZS5oZWFwW3JdKSArIDFdICsgMV0gKyAxKSAmJiAocyA9IHAsIG0rKyksIGhbMiAqIG4gKyAxXSA9IHMsIHUgPCBuIHx8IChlLmJsX2NvdW50W3NdKyssIGEgPSAwLCBkIDw9IG4gJiYgKGEgPSBjW24gLSBkXSksIG8gPSBoWzIgKiBuXSwgZS5vcHRfbGVuICs9IG8gKiAocyArIGEpLCBmICYmIChlLnN0YXRpY19sZW4gKz0gbyAqIChsWzIgKiBuICsgMV0gKyBhKSkpOwoJICAgICAgICAgIGlmICgwICE9PSBtKSB7CgkgICAgICAgICAgICBkbyB7CgkgICAgICAgICAgICAgIGZvciAocyA9IHAgLSAxOyAwID09PSBlLmJsX2NvdW50W3NdOykgcy0tOwoJICAgICAgICAgICAgICBlLmJsX2NvdW50W3NdLS0sIGUuYmxfY291bnRbcyArIDFdICs9IDIsIGUuYmxfY291bnRbcF0tLSwgbSAtPSAyOwoJICAgICAgICAgICAgfSB3aGlsZSAoMCA8IG0pOwoJICAgICAgICAgICAgZm9yIChzID0gcDsgMCAhPT0gczsgcy0tKSBmb3IgKG4gPSBlLmJsX2NvdW50W3NdOyAwICE9PSBuOykgdSA8IChpID0gZS5oZWFwWy0tcl0pIHx8IChoWzIgKiBpICsgMV0gIT09IHMgJiYgKGUub3B0X2xlbiArPSAocyAtIGhbMiAqIGkgKyAxXSkgKiBoWzIgKiBpXSwgaFsyICogaSArIDFdID0gcyksIG4tLSk7CgkgICAgICAgICAgfQoJICAgICAgICB9KGUsIHQpLCBaKHMsIHUsIGUuYmxfY291bnQpOwoJICAgICAgfQoJICAgICAgZnVuY3Rpb24gWChlLCB0LCByKSB7CgkgICAgICAgIHZhciBuLAoJICAgICAgICAgIGksCgkgICAgICAgICAgcyA9IC0xLAoJICAgICAgICAgIGEgPSB0WzFdLAoJICAgICAgICAgIG8gPSAwLAoJICAgICAgICAgIGggPSA3LAoJICAgICAgICAgIHUgPSA0OwoJICAgICAgICBmb3IgKDAgPT09IGEgJiYgKGggPSAxMzgsIHUgPSAzKSwgdFsyICogKHIgKyAxKSArIDFdID0gNjU1MzUsIG4gPSAwOyBuIDw9IHI7IG4rKykgaSA9IGEsIGEgPSB0WzIgKiAobiArIDEpICsgMV0sICsrbyA8IGggJiYgaSA9PT0gYSB8fCAobyA8IHUgPyBlLmJsX3RyZWVbMiAqIGldICs9IG8gOiAwICE9PSBpID8gKGkgIT09IHMgJiYgZS5ibF90cmVlWzIgKiBpXSsrLCBlLmJsX3RyZWVbMiAqIGJdKyspIDogbyA8PSAxMCA/IGUuYmxfdHJlZVsyICogdl0rKyA6IGUuYmxfdHJlZVsyICogeV0rKywgcyA9IGksIHUgPSAobyA9IDApID09PSBhID8gKGggPSAxMzgsIDMpIDogaSA9PT0gYSA/IChoID0gNiwgMykgOiAoaCA9IDcsIDQpKTsKCSAgICAgIH0KCSAgICAgIGZ1bmN0aW9uIFYoZSwgdCwgcikgewoJICAgICAgICB2YXIgbiwKCSAgICAgICAgICBpLAoJICAgICAgICAgIHMgPSAtMSwKCSAgICAgICAgICBhID0gdFsxXSwKCSAgICAgICAgICBvID0gMCwKCSAgICAgICAgICBoID0gNywKCSAgICAgICAgICB1ID0gNDsKCSAgICAgICAgZm9yICgwID09PSBhICYmIChoID0gMTM4LCB1ID0gMyksIG4gPSAwOyBuIDw9IHI7IG4rKykgaWYgKGkgPSBhLCBhID0gdFsyICogKG4gKyAxKSArIDFdLCAhKCsrbyA8IGggJiYgaSA9PT0gYSkpIHsKCSAgICAgICAgICBpZiAobyA8IHUpIGZvciAoOyBMKGUsIGksIGUuYmxfdHJlZSksIDAgIT0gLS1vOyk7ZWxzZSAwICE9PSBpID8gKGkgIT09IHMgJiYgKEwoZSwgaSwgZS5ibF90cmVlKSwgby0tKSwgTChlLCBiLCBlLmJsX3RyZWUpLCBQKGUsIG8gLSAzLCAyKSkgOiBvIDw9IDEwID8gKEwoZSwgdiwgZS5ibF90cmVlKSwgUChlLCBvIC0gMywgMykpIDogKEwoZSwgeSwgZS5ibF90cmVlKSwgUChlLCBvIC0gMTEsIDcpKTsKCSAgICAgICAgICBzID0gaSwgdSA9IChvID0gMCkgPT09IGEgPyAoaCA9IDEzOCwgMykgOiBpID09PSBhID8gKGggPSA2LCAzKSA6IChoID0gNywgNCk7CgkgICAgICAgIH0KCSAgICAgIH0KCSAgICAgIG4oVCk7CgkgICAgICB2YXIgcSA9ICExOwoJICAgICAgZnVuY3Rpb24gSihlLCB0LCByLCBuKSB7CgkgICAgICAgIFAoZSwgKHMgPDwgMSkgKyAobiA/IDEgOiAwKSwgMyksIGZ1bmN0aW9uIChlLCB0LCByLCBuKSB7CgkgICAgICAgICAgTShlKSwgbiAmJiAoVShlLCByKSwgVShlLCB+cikpLCBpLmFycmF5U2V0KGUucGVuZGluZ19idWYsIGUud2luZG93LCB0LCByLCBlLnBlbmRpbmcpLCBlLnBlbmRpbmcgKz0gcjsKCSAgICAgICAgfShlLCB0LCByLCAhMCk7CgkgICAgICB9CgkgICAgICByLl90cl9pbml0ID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgcSB8fCAoZnVuY3Rpb24gKCkgewoJICAgICAgICAgIHZhciBlLAoJICAgICAgICAgICAgdCwKCSAgICAgICAgICAgIHIsCgkgICAgICAgICAgICBuLAoJICAgICAgICAgICAgaSwKCSAgICAgICAgICAgIHMgPSBuZXcgQXJyYXkoZyArIDEpOwoJICAgICAgICAgIGZvciAobiA9IHIgPSAwOyBuIDwgYSAtIDE7IG4rKykgZm9yIChJW25dID0gciwgZSA9IDA7IGUgPCAxIDw8IHdbbl07IGUrKykgQVtyKytdID0gbjsKCSAgICAgICAgICBmb3IgKEFbciAtIDFdID0gbiwgbiA9IGkgPSAwOyBuIDwgMTY7IG4rKykgZm9yIChUW25dID0gaSwgZSA9IDA7IGUgPCAxIDw8IGtbbl07IGUrKykgRVtpKytdID0gbjsKCSAgICAgICAgICBmb3IgKGkgPj49IDc7IG4gPCBmOyBuKyspIGZvciAoVFtuXSA9IGkgPDwgNywgZSA9IDA7IGUgPCAxIDw8IGtbbl0gLSA3OyBlKyspIEVbMjU2ICsgaSsrXSA9IG47CgkgICAgICAgICAgZm9yICh0ID0gMDsgdCA8PSBnOyB0KyspIHNbdF0gPSAwOwoJICAgICAgICAgIGZvciAoZSA9IDA7IGUgPD0gMTQzOykgelsyICogZSArIDFdID0gOCwgZSsrLCBzWzhdKys7CgkgICAgICAgICAgZm9yICg7IGUgPD0gMjU1OykgelsyICogZSArIDFdID0gOSwgZSsrLCBzWzldKys7CgkgICAgICAgICAgZm9yICg7IGUgPD0gMjc5OykgelsyICogZSArIDFdID0gNywgZSsrLCBzWzddKys7CgkgICAgICAgICAgZm9yICg7IGUgPD0gMjg3OykgelsyICogZSArIDFdID0gOCwgZSsrLCBzWzhdKys7CgkgICAgICAgICAgZm9yIChaKHosIGwgKyAxLCBzKSwgZSA9IDA7IGUgPCBmOyBlKyspIENbMiAqIGUgKyAxXSA9IDUsIENbMiAqIGVdID0gaihlLCA1KTsKCSAgICAgICAgICBPID0gbmV3IEQoeiwgdywgdSArIDEsIGwsIGcpLCBCID0gbmV3IEQoQywgaywgMCwgZiwgZyksIFIgPSBuZXcgRChuZXcgQXJyYXkoMCksIHgsIDAsIGMsIHApOwoJICAgICAgICB9KCksIHEgPSAhMCksIGUubF9kZXNjID0gbmV3IEYoZS5keW5fbHRyZWUsIE8pLCBlLmRfZGVzYyA9IG5ldyBGKGUuZHluX2R0cmVlLCBCKSwgZS5ibF9kZXNjID0gbmV3IEYoZS5ibF90cmVlLCBSKSwgZS5iaV9idWYgPSAwLCBlLmJpX3ZhbGlkID0gMCwgVyhlKTsKCSAgICAgIH0sIHIuX3RyX3N0b3JlZF9ibG9jayA9IEosIHIuX3RyX2ZsdXNoX2Jsb2NrID0gZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKCSAgICAgICAgdmFyIGksCgkgICAgICAgICAgcywKCSAgICAgICAgICBhID0gMDsKCSAgICAgICAgMCA8IGUubGV2ZWwgPyAoMiA9PT0gZS5zdHJtLmRhdGFfdHlwZSAmJiAoZS5zdHJtLmRhdGFfdHlwZSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdmFyIHQsCgkgICAgICAgICAgICByID0gNDA5MzYyNDQ0NzsKCSAgICAgICAgICBmb3IgKHQgPSAwOyB0IDw9IDMxOyB0KyssIHIgPj4+PSAxKSBpZiAoMSAmIHIgJiYgMCAhPT0gZS5keW5fbHRyZWVbMiAqIHRdKSByZXR1cm4gbzsKCSAgICAgICAgICBpZiAoMCAhPT0gZS5keW5fbHRyZWVbMThdIHx8IDAgIT09IGUuZHluX2x0cmVlWzIwXSB8fCAwICE9PSBlLmR5bl9sdHJlZVsyNl0pIHJldHVybiBoOwoJICAgICAgICAgIGZvciAodCA9IDMyOyB0IDwgdTsgdCsrKSBpZiAoMCAhPT0gZS5keW5fbHRyZWVbMiAqIHRdKSByZXR1cm4gaDsKCSAgICAgICAgICByZXR1cm4gbzsKCSAgICAgICAgfShlKSksIFkoZSwgZS5sX2Rlc2MpLCBZKGUsIGUuZF9kZXNjKSwgYSA9IGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgdmFyIHQ7CgkgICAgICAgICAgZm9yIChYKGUsIGUuZHluX2x0cmVlLCBlLmxfZGVzYy5tYXhfY29kZSksIFgoZSwgZS5keW5fZHRyZWUsIGUuZF9kZXNjLm1heF9jb2RlKSwgWShlLCBlLmJsX2Rlc2MpLCB0ID0gYyAtIDE7IDMgPD0gdCAmJiAwID09PSBlLmJsX3RyZWVbMiAqIFNbdF0gKyAxXTsgdC0tKTsKCSAgICAgICAgICByZXR1cm4gZS5vcHRfbGVuICs9IDMgKiAodCArIDEpICsgNSArIDUgKyA0LCB0OwoJICAgICAgICB9KGUpLCBpID0gZS5vcHRfbGVuICsgMyArIDcgPj4+IDMsIChzID0gZS5zdGF0aWNfbGVuICsgMyArIDcgPj4+IDMpIDw9IGkgJiYgKGkgPSBzKSkgOiBpID0gcyA9IHIgKyA1LCByICsgNCA8PSBpICYmIC0xICE9PSB0ID8gSihlLCB0LCByLCBuKSA6IDQgPT09IGUuc3RyYXRlZ3kgfHwgcyA9PT0gaSA/IChQKGUsIDIgKyAobiA/IDEgOiAwKSwgMyksIEsoZSwgeiwgQykpIDogKFAoZSwgNCArIChuID8gMSA6IDApLCAzKSwgZnVuY3Rpb24gKGUsIHQsIHIsIG4pIHsKCSAgICAgICAgICB2YXIgaTsKCSAgICAgICAgICBmb3IgKFAoZSwgdCAtIDI1NywgNSksIFAoZSwgciAtIDEsIDUpLCBQKGUsIG4gLSA0LCA0KSwgaSA9IDA7IGkgPCBuOyBpKyspIFAoZSwgZS5ibF90cmVlWzIgKiBTW2ldICsgMV0sIDMpOwoJICAgICAgICAgIFYoZSwgZS5keW5fbHRyZWUsIHQgLSAxKSwgVihlLCBlLmR5bl9kdHJlZSwgciAtIDEpOwoJICAgICAgICB9KGUsIGUubF9kZXNjLm1heF9jb2RlICsgMSwgZS5kX2Rlc2MubWF4X2NvZGUgKyAxLCBhICsgMSksIEsoZSwgZS5keW5fbHRyZWUsIGUuZHluX2R0cmVlKSksIFcoZSksIG4gJiYgTShlKTsKCSAgICAgIH0sIHIuX3RyX3RhbGx5ID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsKCSAgICAgICAgcmV0dXJuIGUucGVuZGluZ19idWZbZS5kX2J1ZiArIDIgKiBlLmxhc3RfbGl0XSA9IHQgPj4+IDggJiAyNTUsIGUucGVuZGluZ19idWZbZS5kX2J1ZiArIDIgKiBlLmxhc3RfbGl0ICsgMV0gPSAyNTUgJiB0LCBlLnBlbmRpbmdfYnVmW2UubF9idWYgKyBlLmxhc3RfbGl0XSA9IDI1NSAmIHIsIGUubGFzdF9saXQrKywgMCA9PT0gdCA/IGUuZHluX2x0cmVlWzIgKiByXSsrIDogKGUubWF0Y2hlcysrLCB0LS0sIGUuZHluX2x0cmVlWzIgKiAoQVtyXSArIHUgKyAxKV0rKywgZS5keW5fZHRyZWVbMiAqIE4odCldKyspLCBlLmxhc3RfbGl0ID09PSBlLmxpdF9idWZzaXplIC0gMTsKCSAgICAgIH0sIHIuX3RyX2FsaWduID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgUChlLCAyLCAzKSwgTChlLCBtLCB6KSwgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAxNiA9PT0gZS5iaV92YWxpZCA/IChVKGUsIGUuYmlfYnVmKSwgZS5iaV9idWYgPSAwLCBlLmJpX3ZhbGlkID0gMCkgOiA4IDw9IGUuYmlfdmFsaWQgJiYgKGUucGVuZGluZ19idWZbZS5wZW5kaW5nKytdID0gMjU1ICYgZS5iaV9idWYsIGUuYmlfYnVmID4+PSA4LCBlLmJpX3ZhbGlkIC09IDgpOwoJICAgICAgICB9KGUpOwoJICAgICAgfTsKCSAgICB9LCB7CgkgICAgICAiLi4vdXRpbHMvY29tbW9uIjogNDEKCSAgICB9XSwKCSAgICA1MzogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgoJICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aGlzLmlucHV0ID0gbnVsbCwgdGhpcy5uZXh0X2luID0gMCwgdGhpcy5hdmFpbF9pbiA9IDAsIHRoaXMudG90YWxfaW4gPSAwLCB0aGlzLm91dHB1dCA9IG51bGwsIHRoaXMubmV4dF9vdXQgPSAwLCB0aGlzLmF2YWlsX291dCA9IDAsIHRoaXMudG90YWxfb3V0ID0gMCwgdGhpcy5tc2cgPSAiIiwgdGhpcy5zdGF0ZSA9IG51bGwsIHRoaXMuZGF0YV90eXBlID0gMiwgdGhpcy5hZGxlciA9IDA7CgkgICAgICB9OwoJICAgIH0sIHt9XSwKCSAgICA1NDogW2Z1bmN0aW9uIChlLCB0LCByKSB7CgkgICAgICAoZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgIWZ1bmN0aW9uIChyLCBuKSB7CgoJICAgICAgICAgIGlmICghci5zZXRJbW1lZGlhdGUpIHsKCSAgICAgICAgICAgIHZhciBpLAoJICAgICAgICAgICAgICBzLAoJICAgICAgICAgICAgICB0LAoJICAgICAgICAgICAgICBhLAoJICAgICAgICAgICAgICBvID0gMSwKCSAgICAgICAgICAgICAgaCA9IHt9LAoJICAgICAgICAgICAgICB1ID0gITEsCgkgICAgICAgICAgICAgIGwgPSByLmRvY3VtZW50LAoJICAgICAgICAgICAgICBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mICYmIE9iamVjdC5nZXRQcm90b3R5cGVPZihyKTsKCSAgICAgICAgICAgIGUgPSBlICYmIGUuc2V0VGltZW91dCA/IGUgOiByLCBpID0gIltvYmplY3QgcHJvY2Vzc10iID09PSB7fS50b1N0cmluZy5jYWxsKHIucHJvY2VzcykgPyBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgICAgICBjKGUpOwoJICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgIH0gOiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICAgIGlmIChyLnBvc3RNZXNzYWdlICYmICFyLmltcG9ydFNjcmlwdHMpIHsKCSAgICAgICAgICAgICAgICB2YXIgZSA9ICEwLAoJICAgICAgICAgICAgICAgICAgdCA9IHIub25tZXNzYWdlOwoJICAgICAgICAgICAgICAgIHJldHVybiByLm9ubWVzc2FnZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgICAgICAgIGUgPSAhMTsKCSAgICAgICAgICAgICAgICB9LCByLnBvc3RNZXNzYWdlKCIiLCAiKiIpLCByLm9ubWVzc2FnZSA9IHQsIGU7CgkgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0oKSA/IChhID0gInNldEltbWVkaWF0ZSQiICsgTWF0aC5yYW5kb20oKSArICIkIiwgci5hZGRFdmVudExpc3RlbmVyID8gci5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgZCwgITEpIDogci5hdHRhY2hFdmVudCgib25tZXNzYWdlIiwgZCksIGZ1bmN0aW9uIChlKSB7CgkgICAgICAgICAgICAgIHIucG9zdE1lc3NhZ2UoYSArIGUsICIqIik7CgkgICAgICAgICAgICB9KSA6IHIuTWVzc2FnZUNoYW5uZWwgPyAoKHQgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKSkucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgICAgYyhlLmRhdGEpOwoJICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgICAgdC5wb3J0Mi5wb3N0TWVzc2FnZShlKTsKCSAgICAgICAgICAgIH0pIDogbCAmJiAib25yZWFkeXN0YXRlY2hhbmdlIiBpbiBsLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpID8gKHMgPSBsLmRvY3VtZW50RWxlbWVudCwgZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgICAgdmFyIHQgPSBsLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwoJICAgICAgICAgICAgICB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgICAgICBjKGUpLCB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGwsIHMucmVtb3ZlQ2hpbGQodCksIHQgPSBudWxsOwoJICAgICAgICAgICAgICB9LCBzLmFwcGVuZENoaWxkKHQpOwoJICAgICAgICAgICAgfSkgOiBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgICAgICBzZXRUaW1lb3V0KGMsIDAsIGUpOwoJICAgICAgICAgICAgfSwgZS5zZXRJbW1lZGlhdGUgPSBmdW5jdGlvbiAoZSkgewoJICAgICAgICAgICAgICAiZnVuY3Rpb24iICE9IHR5cGVvZiBlICYmIChlID0gbmV3IEZ1bmN0aW9uKCIiICsgZSkpOwoJICAgICAgICAgICAgICBmb3IgKHZhciB0ID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKSwgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB0W3JdID0gYXJndW1lbnRzW3IgKyAxXTsKCSAgICAgICAgICAgICAgdmFyIG4gPSB7CgkgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGUsCgkgICAgICAgICAgICAgICAgYXJnczogdAoJICAgICAgICAgICAgICB9OwoJICAgICAgICAgICAgICByZXR1cm4gaFtvXSA9IG4sIGkobyksIG8rKzsKCSAgICAgICAgICAgIH0sIGUuY2xlYXJJbW1lZGlhdGUgPSBmOwoJICAgICAgICAgIH0KCSAgICAgICAgICBmdW5jdGlvbiBmKGUpIHsKCSAgICAgICAgICAgIGRlbGV0ZSBoW2VdOwoJICAgICAgICAgIH0KCSAgICAgICAgICBmdW5jdGlvbiBjKGUpIHsKCSAgICAgICAgICAgIGlmICh1KSBzZXRUaW1lb3V0KGMsIDAsIGUpO2Vsc2UgewoJICAgICAgICAgICAgICB2YXIgdCA9IGhbZV07CgkgICAgICAgICAgICAgIGlmICh0KSB7CgkgICAgICAgICAgICAgICAgdSA9ICEwOwoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAhZnVuY3Rpb24gKGUpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBlLmNhbGxiYWNrLAoJICAgICAgICAgICAgICAgICAgICAgIHIgPSBlLmFyZ3M7CgkgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoci5sZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CgkgICAgICAgICAgICAgICAgICAgICAgICB0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CgkgICAgICAgICAgICAgICAgICAgICAgICB0KHJbMF0pOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgoJICAgICAgICAgICAgICAgICAgICAgICAgdChyWzBdLCByWzFdKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICAgICAgICAgIHQoclswXSwgclsxXSwgclsyXSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgdC5hcHBseShuLCByKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgfSh0KTsKCSAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewoJICAgICAgICAgICAgICAgICAgZihlKSwgdSA9ICExOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0KCSAgICAgICAgICBmdW5jdGlvbiBkKGUpIHsKCSAgICAgICAgICAgIGUuc291cmNlID09PSByICYmICJzdHJpbmciID09IHR5cGVvZiBlLmRhdGEgJiYgMCA9PT0gZS5kYXRhLmluZGV4T2YoYSkgJiYgYygrZS5kYXRhLnNsaWNlKGEubGVuZ3RoKSk7CgkgICAgICAgICAgfQoJICAgICAgICB9KCJ1bmRlZmluZWQiID09IHR5cGVvZiBzZWxmID8gdm9pZCAwID09PSBlID8gdGhpcyA6IGUgOiBzZWxmKTsKCSAgICAgIH0pLmNhbGwodGhpcywgInVuZGVmaW5lZCIgIT0gdHlwZW9mIGNvbW1vbmpzR2xvYmFsID8gY29tbW9uanNHbG9iYWwgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygc2VsZiA/IHNlbGYgOiAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDoge30pOwoJICAgIH0sIHt9XQoJICB9LCB7fSwgWzEwXSkoMTApOwoJfSk7Cgl9KGpzemlwX21pbiwganN6aXBfbWluLmV4cG9ydHMpKTsKCgl2YXIgSlNaaXAgPSBqc3ppcF9taW4uZXhwb3J0czsKCgl2YXIgaW5zdGFuY2VPZkFueSA9IGZ1bmN0aW9uIGluc3RhbmNlT2ZBbnkob2JqZWN0LCBjb25zdHJ1Y3RvcnMpIHsKCSAgcmV0dXJuIGNvbnN0cnVjdG9ycy5zb21lKGZ1bmN0aW9uIChjKSB7CgkgICAgcmV0dXJuIG9iamVjdCBpbnN0YW5jZW9mIGM7CgkgIH0pOwoJfTsKCXZhciBpZGJQcm94eWFibGVUeXBlczsKCXZhciBjdXJzb3JBZHZhbmNlTWV0aG9kczsKCS8vIFRoaXMgaXMgYSBmdW5jdGlvbiB0byBwcmV2ZW50IGl0IHRocm93aW5nIHVwIGluIG5vZGUgZW52aXJvbm1lbnRzLgoJZnVuY3Rpb24gZ2V0SWRiUHJveHlhYmxlVHlwZXMoKSB7CgkgIHJldHVybiBpZGJQcm94eWFibGVUeXBlcyB8fCAoaWRiUHJveHlhYmxlVHlwZXMgPSBbSURCRGF0YWJhc2UsIElEQk9iamVjdFN0b3JlLCBJREJJbmRleCwgSURCQ3Vyc29yLCBJREJUcmFuc2FjdGlvbl0pOwoJfQoJLy8gVGhpcyBpcyBhIGZ1bmN0aW9uIHRvIHByZXZlbnQgaXQgdGhyb3dpbmcgdXAgaW4gbm9kZSBlbnZpcm9ubWVudHMuCglmdW5jdGlvbiBnZXRDdXJzb3JBZHZhbmNlTWV0aG9kcygpIHsKCSAgcmV0dXJuIGN1cnNvckFkdmFuY2VNZXRob2RzIHx8IChjdXJzb3JBZHZhbmNlTWV0aG9kcyA9IFtJREJDdXJzb3IucHJvdG90eXBlLmFkdmFuY2UsIElEQkN1cnNvci5wcm90b3R5cGVbImNvbnRpbnVlIl0sIElEQkN1cnNvci5wcm90b3R5cGUuY29udGludWVQcmltYXJ5S2V5XSk7Cgl9Cgl2YXIgY3Vyc29yUmVxdWVzdE1hcCA9IG5ldyBXZWFrTWFwKCk7Cgl2YXIgdHJhbnNhY3Rpb25Eb25lTWFwID0gbmV3IFdlYWtNYXAoKTsKCXZhciB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAgPSBuZXcgV2Vha01hcCgpOwoJdmFyIHRyYW5zZm9ybUNhY2hlID0gbmV3IFdlYWtNYXAoKTsKCXZhciByZXZlcnNlVHJhbnNmb3JtQ2FjaGUgPSBuZXcgV2Vha01hcCgpOwoJZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7CgkgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJICAgIHZhciB1bmxpc3RlbiA9IGZ1bmN0aW9uIHVubGlzdGVuKCkgewoJICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgc3VjY2Vzcyk7CgkgICAgICByZXF1ZXN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpOwoJICAgIH07CgkgICAgdmFyIHN1Y2Nlc3MgPSBmdW5jdGlvbiBzdWNjZXNzKCkgewoJICAgICAgcmVzb2x2ZSh3cmFwKHJlcXVlc3QucmVzdWx0KSk7CgkgICAgICB1bmxpc3RlbigpOwoJICAgIH07CgkgICAgdmFyIGVycm9yID0gZnVuY3Rpb24gZXJyb3IoKSB7CgkgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7CgkgICAgICB1bmxpc3RlbigpOwoJICAgIH07CgkgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgc3VjY2Vzcyk7CgkgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTsKCSAgfSk7CgkgIHByb21pc2UudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKCSAgICAvLyBTaW5jZSBjdXJzb3JpbmcgcmV1c2VzIHRoZSBJREJSZXF1ZXN0ICgqc2lnaCopLCB3ZSBjYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsCgkgICAgLy8gKHNlZSB3cmFwRnVuY3Rpb24pLgoJICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEQkN1cnNvcikgewoJICAgICAgY3Vyc29yUmVxdWVzdE1hcC5zZXQodmFsdWUsIHJlcXVlc3QpOwoJICAgIH0KCSAgICAvLyBDYXRjaGluZyB0byBhdm9pZCAiVW5jYXVnaHQgUHJvbWlzZSBleGNlcHRpb25zIgoJICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7fSk7CgkgIC8vIFRoaXMgbWFwcGluZyBleGlzdHMgaW4gcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGJ1dCBkb2Vzbid0IGRvZXNuJ3QgZXhpc3QgaW4gdHJhbnNmb3JtQ2FjaGUuIFRoaXMKCSAgLy8gaXMgYmVjYXVzZSB3ZSBjcmVhdGUgbWFueSBwcm9taXNlcyBmcm9tIGEgc2luZ2xlIElEQlJlcXVlc3QuCgkgIHJldmVyc2VUcmFuc2Zvcm1DYWNoZS5zZXQocHJvbWlzZSwgcmVxdWVzdCk7CgkgIHJldHVybiBwcm9taXNlOwoJfQoJZnVuY3Rpb24gY2FjaGVEb25lUHJvbWlzZUZvclRyYW5zYWN0aW9uKHR4KSB7CgkgIC8vIEVhcmx5IGJhaWwgaWYgd2UndmUgYWxyZWFkeSBjcmVhdGVkIGEgZG9uZSBwcm9taXNlIGZvciB0aGlzIHRyYW5zYWN0aW9uLgoJICBpZiAodHJhbnNhY3Rpb25Eb25lTWFwLmhhcyh0eCkpIHJldHVybjsKCSAgdmFyIGRvbmUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CgkgICAgdmFyIHVubGlzdGVuID0gZnVuY3Rpb24gdW5saXN0ZW4oKSB7CgkgICAgICB0eC5yZW1vdmVFdmVudExpc3RlbmVyKCdjb21wbGV0ZScsIGNvbXBsZXRlKTsKCSAgICAgIHR4LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpOwoJICAgICAgdHgucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBlcnJvcik7CgkgICAgfTsKCSAgICB2YXIgY29tcGxldGUgPSBmdW5jdGlvbiBjb21wbGV0ZSgpIHsKCSAgICAgIHJlc29sdmUoKTsKCSAgICAgIHVubGlzdGVuKCk7CgkgICAgfTsKCSAgICB2YXIgZXJyb3IgPSBmdW5jdGlvbiBlcnJvcigpIHsKCSAgICAgIHJlamVjdCh0eC5lcnJvciB8fCBuZXcgRE9NRXhjZXB0aW9uKCdBYm9ydEVycm9yJywgJ0Fib3J0RXJyb3InKSk7CgkgICAgICB1bmxpc3RlbigpOwoJICAgIH07CgkgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBjb21wbGV0ZSk7CgkgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBlcnJvcik7CgkgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBlcnJvcik7CgkgIH0pOwoJICAvLyBDYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsLgoJICB0cmFuc2FjdGlvbkRvbmVNYXAuc2V0KHR4LCBkb25lKTsKCX0KCXZhciBpZGJQcm94eVRyYXBzID0gewoJICBnZXQ6IGZ1bmN0aW9uIGdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7CgkgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uKSB7CgkgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciB0cmFuc2FjdGlvbi5kb25lLgoJICAgICAgaWYgKHByb3AgPT09ICdkb25lJykgcmV0dXJuIHRyYW5zYWN0aW9uRG9uZU1hcC5nZXQodGFyZ2V0KTsKCSAgICAgIC8vIFBvbHlmaWxsIGZvciBvYmplY3RTdG9yZU5hbWVzIGJlY2F1c2Ugb2YgRWRnZS4KCSAgICAgIGlmIChwcm9wID09PSAnb2JqZWN0U3RvcmVOYW1lcycpIHsKCSAgICAgICAgcmV0dXJuIHRhcmdldC5vYmplY3RTdG9yZU5hbWVzIHx8IHRyYW5zYWN0aW9uU3RvcmVOYW1lc01hcC5nZXQodGFyZ2V0KTsKCSAgICAgIH0KCSAgICAgIC8vIE1ha2UgdHguc3RvcmUgcmV0dXJuIHRoZSBvbmx5IHN0b3JlIGluIHRoZSB0cmFuc2FjdGlvbiwgb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGFyZSBtYW55LgoJICAgICAgaWYgKHByb3AgPT09ICdzdG9yZScpIHsKCSAgICAgICAgcmV0dXJuIHJlY2VpdmVyLm9iamVjdFN0b3JlTmFtZXNbMV0gPyB1bmRlZmluZWQgOiByZWNlaXZlci5vYmplY3RTdG9yZShyZWNlaXZlci5vYmplY3RTdG9yZU5hbWVzWzBdKTsKCSAgICAgIH0KCSAgICB9CgkgICAgLy8gRWxzZSB0cmFuc2Zvcm0gd2hhdGV2ZXIgd2UgZ2V0IGJhY2suCgkgICAgcmV0dXJuIHdyYXAodGFyZ2V0W3Byb3BdKTsKCSAgfSwKCSAgc2V0OiBmdW5jdGlvbiBzZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSkgewoJICAgIHRhcmdldFtwcm9wXSA9IHZhbHVlOwoJICAgIHJldHVybiB0cnVlOwoJICB9LAoJICBoYXM6IGZ1bmN0aW9uIGhhcyh0YXJnZXQsIHByb3ApIHsKCSAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgSURCVHJhbnNhY3Rpb24gJiYgKHByb3AgPT09ICdkb25lJyB8fCBwcm9wID09PSAnc3RvcmUnKSkgewoJICAgICAgcmV0dXJuIHRydWU7CgkgICAgfQoJICAgIHJldHVybiBwcm9wIGluIHRhcmdldDsKCSAgfQoJfTsKCWZ1bmN0aW9uIHJlcGxhY2VUcmFwcyhjYWxsYmFjaykgewoJICBpZGJQcm94eVRyYXBzID0gY2FsbGJhY2soaWRiUHJveHlUcmFwcyk7Cgl9CglmdW5jdGlvbiB3cmFwRnVuY3Rpb24oZnVuYykgewoJICAvLyBEdWUgdG8gZXhwZWN0ZWQgb2JqZWN0IGVxdWFsaXR5ICh3aGljaCBpcyBlbmZvcmNlZCBieSB0aGUgY2FjaGluZyBpbiBgd3JhcGApLCB3ZQoJICAvLyBvbmx5IGNyZWF0ZSBvbmUgbmV3IGZ1bmMgcGVyIGZ1bmMuCgkgIC8vIEVkZ2UgZG9lc24ndCBzdXBwb3J0IG9iamVjdFN0b3JlTmFtZXMgKGJvb28pLCBzbyB3ZSBwb2x5ZmlsbCBpdCBoZXJlLgoJICBpZiAoZnVuYyA9PT0gSURCRGF0YWJhc2UucHJvdG90eXBlLnRyYW5zYWN0aW9uICYmICEoJ29iamVjdFN0b3JlTmFtZXMnIGluIElEQlRyYW5zYWN0aW9uLnByb3RvdHlwZSkpIHsKCSAgICByZXR1cm4gZnVuY3Rpb24gKHN0b3JlTmFtZXMpIHsKCSAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKCSAgICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07CgkgICAgICB9CgkgICAgICB2YXIgdHggPSBmdW5jLmNhbGwuYXBwbHkoZnVuYywgW3Vud3JhcCh0aGlzKSwgc3RvcmVOYW1lc10uY29uY2F0KGFyZ3MpKTsKCSAgICAgIHRyYW5zYWN0aW9uU3RvcmVOYW1lc01hcC5zZXQodHgsIHN0b3JlTmFtZXMuc29ydCA/IHN0b3JlTmFtZXMuc29ydCgpIDogW3N0b3JlTmFtZXNdKTsKCSAgICAgIHJldHVybiB3cmFwKHR4KTsKCSAgICB9OwoJICB9CgkgIC8vIEN1cnNvciBtZXRob2RzIGFyZSBzcGVjaWFsLCBhcyB0aGUgYmVoYXZpb3VyIGlzIGEgbGl0dGxlIG1vcmUgZGlmZmVyZW50IHRvIHN0YW5kYXJkIElEQi4gSW4KCSAgLy8gSURCLCB5b3UgYWR2YW5jZSB0aGUgY3Vyc29yIGFuZCB3YWl0IGZvciBhIG5ldyAnc3VjY2Vzcycgb24gdGhlIElEQlJlcXVlc3QgdGhhdCBnYXZlIHlvdSB0aGUKCSAgLy8gY3Vyc29yLiBJdCdzIGtpbmRhIGxpa2UgYSBwcm9taXNlIHRoYXQgY2FuIHJlc29sdmUgd2l0aCBtYW55IHZhbHVlcy4gVGhhdCBkb2Vzbid0IG1ha2Ugc2Vuc2UKCSAgLy8gd2l0aCByZWFsIHByb21pc2VzLCBzbyBlYWNoIGFkdmFuY2UgbWV0aG9kcyByZXR1cm5zIGEgbmV3IHByb21pc2UgZm9yIHRoZSBjdXJzb3Igb2JqZWN0LCBvcgoJICAvLyB1bmRlZmluZWQgaWYgdGhlIGVuZCBvZiB0aGUgY3Vyc29yIGhhcyBiZWVuIHJlYWNoZWQuCgkgIGlmIChnZXRDdXJzb3JBZHZhbmNlTWV0aG9kcygpLmluY2x1ZGVzKGZ1bmMpKSB7CgkgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKCSAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykgewoJICAgICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07CgkgICAgICB9CgkgICAgICAvLyBDYWxsaW5nIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm94eSBhcyAndGhpcycgY2F1c2VzIElMTEVHQUwgSU5WT0NBVElPTiwgc28gd2UgdXNlCgkgICAgICAvLyB0aGUgb3JpZ2luYWwgb2JqZWN0LgoJICAgICAgZnVuYy5hcHBseSh1bndyYXAodGhpcyksIGFyZ3MpOwoJICAgICAgcmV0dXJuIHdyYXAoY3Vyc29yUmVxdWVzdE1hcC5nZXQodGhpcykpOwoJICAgIH07CgkgIH0KCSAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKCSAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjMpLCBfa2V5MyA9IDA7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHsKCSAgICAgIGFyZ3NbX2tleTNdID0gYXJndW1lbnRzW19rZXkzXTsKCSAgICB9CgkgICAgLy8gQ2FsbGluZyB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gd2l0aCB0aGUgcHJveHkgYXMgJ3RoaXMnIGNhdXNlcyBJTExFR0FMIElOVk9DQVRJT04sIHNvIHdlIHVzZQoJICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuCgkgICAgcmV0dXJuIHdyYXAoZnVuYy5hcHBseSh1bndyYXAodGhpcyksIGFyZ3MpKTsKCSAgfTsKCX0KCWZ1bmN0aW9uIHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpIHsKCSAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHdyYXBGdW5jdGlvbih2YWx1ZSk7CgkgIC8vIFRoaXMgZG9lc24ndCByZXR1cm4sIGl0IGp1c3QgY3JlYXRlcyBhICdkb25lJyBwcm9taXNlIGZvciB0aGUgdHJhbnNhY3Rpb24sCgkgIC8vIHdoaWNoIGlzIGxhdGVyIHJldHVybmVkIGZvciB0cmFuc2FjdGlvbi5kb25lIChzZWUgaWRiT2JqZWN0SGFuZGxlcikuCgkgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uKSBjYWNoZURvbmVQcm9taXNlRm9yVHJhbnNhY3Rpb24odmFsdWUpOwoJICBpZiAoaW5zdGFuY2VPZkFueSh2YWx1ZSwgZ2V0SWRiUHJveHlhYmxlVHlwZXMoKSkpIHJldHVybiBuZXcgUHJveHkodmFsdWUsIGlkYlByb3h5VHJhcHMpOwoJICAvLyBSZXR1cm4gdGhlIHNhbWUgdmFsdWUgYmFjayBpZiB3ZSdyZSBub3QgZ29pbmcgdG8gdHJhbnNmb3JtIGl0LgoJICByZXR1cm4gdmFsdWU7Cgl9CglmdW5jdGlvbiB3cmFwKHZhbHVlKSB7CgkgIC8vIFdlIHNvbWV0aW1lcyBnZW5lcmF0ZSBtdWx0aXBsZSBwcm9taXNlcyBmcm9tIGEgc2luZ2xlIElEQlJlcXVlc3QgKGVnIHdoZW4gY3Vyc29yaW5nKSwgYmVjYXVzZQoJICAvLyBJREIgaXMgd2VpcmQgYW5kIGEgc2luZ2xlIElEQlJlcXVlc3QgY2FuIHlpZWxkIG1hbnkgcmVzcG9uc2VzLCBzbyB0aGVzZSBjYW4ndCBiZSBjYWNoZWQuCgkgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEQlJlcXVlc3QpIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KHZhbHVlKTsKCSAgLy8gSWYgd2UndmUgYWxyZWFkeSB0cmFuc2Zvcm1lZCB0aGlzIHZhbHVlIGJlZm9yZSwgcmV1c2UgdGhlIHRyYW5zZm9ybWVkIHZhbHVlLgoJICAvLyBUaGlzIGlzIGZhc3RlciwgYnV0IGl0IGFsc28gcHJvdmlkZXMgb2JqZWN0IGVxdWFsaXR5LgoJICBpZiAodHJhbnNmb3JtQ2FjaGUuaGFzKHZhbHVlKSkgcmV0dXJuIHRyYW5zZm9ybUNhY2hlLmdldCh2YWx1ZSk7CgkgIHZhciBuZXdWYWx1ZSA9IHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpOwoJICAvLyBOb3QgYWxsIHR5cGVzIGFyZSB0cmFuc2Zvcm1lZC4KCSAgLy8gVGhlc2UgbWF5IGJlIHByaW1pdGl2ZSB0eXBlcywgc28gdGhleSBjYW4ndCBiZSBXZWFrTWFwIGtleXMuCgkgIGlmIChuZXdWYWx1ZSAhPT0gdmFsdWUpIHsKCSAgICB0cmFuc2Zvcm1DYWNoZS5zZXQodmFsdWUsIG5ld1ZhbHVlKTsKCSAgICByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuc2V0KG5ld1ZhbHVlLCB2YWx1ZSk7CgkgIH0KCSAgcmV0dXJuIG5ld1ZhbHVlOwoJfQoJdmFyIHVud3JhcCA9IGZ1bmN0aW9uIHVud3JhcCh2YWx1ZSkgewoJICByZXR1cm4gcmV2ZXJzZVRyYW5zZm9ybUNhY2hlLmdldCh2YWx1ZSk7Cgl9OwoKCWZ1bmN0aW9uIF90eXBlb2YkMShvKSB7ICJAYmFiZWwvaGVscGVycyAtIHR5cGVvZiI7IHJldHVybiBfdHlwZW9mJDEgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvKSB7IHJldHVybiB0eXBlb2YgbzsgfSA6IGZ1bmN0aW9uIChvKSB7IHJldHVybiBvICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiBvLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgbyAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG87IH0sIF90eXBlb2YkMShvKTsgfQoJZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7IHZhciB0ID0gT2JqZWN0LmtleXMoZSk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHIpLmVudW1lcmFibGU7IH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pOyB9IHJldHVybiB0OyB9CglmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKGUpIHsgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHsgdmFyIHQgPSBudWxsICE9IGFyZ3VtZW50c1tyXSA/IGFyZ3VtZW50c1tyXSA6IHt9OyByICUgMiA/IG93bktleXMoT2JqZWN0KHQpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBfZGVmaW5lUHJvcGVydHkoZSwgciwgdFtyXSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyh0KSkgOiBvd25LZXlzKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgciwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCByKSk7IH0pOyB9IHJldHVybiBlOyB9CglmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGtleSA9IF90b1Byb3BlcnR5S2V5KGtleSk7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfQoJZnVuY3Rpb24gX3RvUHJvcGVydHlLZXkoYXJnKSB7IHZhciBrZXkgPSBfdG9QcmltaXRpdmUoYXJnLCAic3RyaW5nIik7IHJldHVybiBfdHlwZW9mJDEoa2V5KSA9PT0gInN5bWJvbCIgPyBrZXkgOiBTdHJpbmcoa2V5KTsgfQoJZnVuY3Rpb24gX3RvUHJpbWl0aXZlKGlucHV0LCBoaW50KSB7IGlmIChfdHlwZW9mJDEoaW5wdXQpICE9PSAib2JqZWN0IiB8fCBpbnB1dCA9PT0gbnVsbCkgcmV0dXJuIGlucHV0OyB2YXIgcHJpbSA9IGlucHV0W1N5bWJvbC50b1ByaW1pdGl2ZV07IGlmIChwcmltICE9PSB1bmRlZmluZWQpIHsgdmFyIHJlcyA9IHByaW0uY2FsbChpbnB1dCwgaGludCB8fCAiZGVmYXVsdCIpOyBpZiAoX3R5cGVvZiQxKHJlcykgIT09ICJvYmplY3QiKSByZXR1cm4gcmVzOyB0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpOyB9IHJldHVybiAoaGludCA9PT0gInN0cmluZyIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTsgfQoJZnVuY3Rpb24gX3JlZ2VuZXJhdG9yUnVudGltZSQxKCkgeyAvKiEgcmVnZW5lcmF0b3ItcnVudGltZSAtLSBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy4gLS0gbGljZW5zZSAoTUlUKTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlZ2VuZXJhdG9yL2Jsb2IvbWFpbi9MSUNFTlNFICovIF9yZWdlbmVyYXRvclJ1bnRpbWUkMSA9IGZ1bmN0aW9uIF9yZWdlbmVyYXRvclJ1bnRpbWUoKSB7IHJldHVybiBlOyB9OyB2YXIgdCwgZSA9IHt9LCByID0gT2JqZWN0LnByb3RvdHlwZSwgbiA9IHIuaGFzT3duUHJvcGVydHksIG8gPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgfHwgZnVuY3Rpb24gKHQsIGUsIHIpIHsgdFtlXSA9IHIudmFsdWU7IH0sIGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgPyBTeW1ib2wgOiB7fSwgYSA9IGkuaXRlcmF0b3IgfHwgIkBAaXRlcmF0b3IiLCBjID0gaS5hc3luY0l0ZXJhdG9yIHx8ICJAQGFzeW5jSXRlcmF0b3IiLCB1ID0gaS50b1N0cmluZ1RhZyB8fCAiQEB0b1N0cmluZ1RhZyI7IGZ1bmN0aW9uIGRlZmluZSh0LCBlLCByKSB7IHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgZSwgeyB2YWx1ZTogciwgZW51bWVyYWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAsIHdyaXRhYmxlOiAhMCB9KSwgdFtlXTsgfSB0cnkgeyBkZWZpbmUoe30sICIiKTsgfSBjYXRjaCAodCkgeyBkZWZpbmUgPSBmdW5jdGlvbiBkZWZpbmUodCwgZSwgcikgeyByZXR1cm4gdFtlXSA9IHI7IH07IH0gZnVuY3Rpb24gd3JhcCh0LCBlLCByLCBuKSB7IHZhciBpID0gZSAmJiBlLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvciA/IGUgOiBHZW5lcmF0b3IsIGEgPSBPYmplY3QuY3JlYXRlKGkucHJvdG90eXBlKSwgYyA9IG5ldyBDb250ZXh0KG4gfHwgW10pOyByZXR1cm4gbyhhLCAiX2ludm9rZSIsIHsgdmFsdWU6IG1ha2VJbnZva2VNZXRob2QodCwgciwgYykgfSksIGE7IH0gZnVuY3Rpb24gdHJ5Q2F0Y2godCwgZSwgcikgeyB0cnkgeyByZXR1cm4geyB0eXBlOiAibm9ybWFsIiwgYXJnOiB0LmNhbGwoZSwgcikgfTsgfSBjYXRjaCAodCkgeyByZXR1cm4geyB0eXBlOiAidGhyb3ciLCBhcmc6IHQgfTsgfSB9IGUud3JhcCA9IHdyYXA7IHZhciBoID0gInN1c3BlbmRlZFN0YXJ0IiwgbCA9ICJzdXNwZW5kZWRZaWVsZCIsIGYgPSAiZXhlY3V0aW5nIiwgcyA9ICJjb21wbGV0ZWQiLCB5ID0ge307IGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9IGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uKCkge30gZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUoKSB7fSB2YXIgcCA9IHt9OyBkZWZpbmUocCwgYSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSk7IHZhciBkID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLCB2ID0gZCAmJiBkKGQodmFsdWVzKFtdKSkpOyB2ICYmIHYgIT09IHIgJiYgbi5jYWxsKHYsIGEpICYmIChwID0gdik7IHZhciBnID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID0gR2VuZXJhdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocCk7IGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyh0KSB7IFsibmV4dCIsICJ0aHJvdyIsICJyZXR1cm4iXS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7IGRlZmluZSh0LCBlLCBmdW5jdGlvbiAodCkgeyByZXR1cm4gdGhpcy5faW52b2tlKGUsIHQpOyB9KTsgfSk7IH0gZnVuY3Rpb24gQXN5bmNJdGVyYXRvcih0LCBlKSB7IGZ1bmN0aW9uIGludm9rZShyLCBvLCBpLCBhKSB7IHZhciBjID0gdHJ5Q2F0Y2godFtyXSwgdCwgbyk7IGlmICgidGhyb3ciICE9PSBjLnR5cGUpIHsgdmFyIHUgPSBjLmFyZywgaCA9IHUudmFsdWU7IHJldHVybiBoICYmICJvYmplY3QiID09IF90eXBlb2YkMShoKSAmJiBuLmNhbGwoaCwgIl9fYXdhaXQiKSA/IGUucmVzb2x2ZShoLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24gKHQpIHsgaW52b2tlKCJuZXh0IiwgdCwgaSwgYSk7IH0sIGZ1bmN0aW9uICh0KSB7IGludm9rZSgidGhyb3ciLCB0LCBpLCBhKTsgfSkgOiBlLnJlc29sdmUoaCkudGhlbihmdW5jdGlvbiAodCkgeyB1LnZhbHVlID0gdCwgaSh1KTsgfSwgZnVuY3Rpb24gKHQpIHsgcmV0dXJuIGludm9rZSgidGhyb3ciLCB0LCBpLCBhKTsgfSk7IH0gYShjLmFyZyk7IH0gdmFyIHI7IG8odGhpcywgIl9pbnZva2UiLCB7IHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSh0LCBuKSB7IGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkgeyByZXR1cm4gbmV3IGUoZnVuY3Rpb24gKGUsIHIpIHsgaW52b2tlKHQsIG4sIGUsIHIpOyB9KTsgfSByZXR1cm4gciA9IHIgPyByLnRoZW4oY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcsIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKSA6IGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCk7IH0gfSk7IH0gZnVuY3Rpb24gbWFrZUludm9rZU1ldGhvZChlLCByLCBuKSB7IHZhciBvID0gaDsgcmV0dXJuIGZ1bmN0aW9uIChpLCBhKSB7IGlmIChvID09PSBmKSB0aHJvdyBuZXcgRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmciKTsgaWYgKG8gPT09IHMpIHsgaWYgKCJ0aHJvdyIgPT09IGkpIHRocm93IGE7IHJldHVybiB7IHZhbHVlOiB0LCBkb25lOiAhMCB9OyB9IGZvciAobi5tZXRob2QgPSBpLCBuLmFyZyA9IGE7OykgeyB2YXIgYyA9IG4uZGVsZWdhdGU7IGlmIChjKSB7IHZhciB1ID0gbWF5YmVJbnZva2VEZWxlZ2F0ZShjLCBuKTsgaWYgKHUpIHsgaWYgKHUgPT09IHkpIGNvbnRpbnVlOyByZXR1cm4gdTsgfSB9IGlmICgibmV4dCIgPT09IG4ubWV0aG9kKSBuLnNlbnQgPSBuLl9zZW50ID0gbi5hcmc7ZWxzZSBpZiAoInRocm93IiA9PT0gbi5tZXRob2QpIHsgaWYgKG8gPT09IGgpIHRocm93IG8gPSBzLCBuLmFyZzsgbi5kaXNwYXRjaEV4Y2VwdGlvbihuLmFyZyk7IH0gZWxzZSAicmV0dXJuIiA9PT0gbi5tZXRob2QgJiYgbi5hYnJ1cHQoInJldHVybiIsIG4uYXJnKTsgbyA9IGY7IHZhciBwID0gdHJ5Q2F0Y2goZSwgciwgbik7IGlmICgibm9ybWFsIiA9PT0gcC50eXBlKSB7IGlmIChvID0gbi5kb25lID8gcyA6IGwsIHAuYXJnID09PSB5KSBjb250aW51ZTsgcmV0dXJuIHsgdmFsdWU6IHAuYXJnLCBkb25lOiBuLmRvbmUgfTsgfSAidGhyb3ciID09PSBwLnR5cGUgJiYgKG8gPSBzLCBuLm1ldGhvZCA9ICJ0aHJvdyIsIG4uYXJnID0gcC5hcmcpOyB9IH07IH0gZnVuY3Rpb24gbWF5YmVJbnZva2VEZWxlZ2F0ZShlLCByKSB7IHZhciBuID0gci5tZXRob2QsIG8gPSBlLml0ZXJhdG9yW25dOyBpZiAobyA9PT0gdCkgcmV0dXJuIHIuZGVsZWdhdGUgPSBudWxsLCAidGhyb3ciID09PSBuICYmIGUuaXRlcmF0b3JbInJldHVybiJdICYmIChyLm1ldGhvZCA9ICJyZXR1cm4iLCByLmFyZyA9IHQsIG1heWJlSW52b2tlRGVsZWdhdGUoZSwgciksICJ0aHJvdyIgPT09IHIubWV0aG9kKSB8fCAicmV0dXJuIiAhPT0gbiAmJiAoci5tZXRob2QgPSAidGhyb3ciLCByLmFyZyA9IG5ldyBUeXBlRXJyb3IoIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJyIgKyBuICsgIicgbWV0aG9kIikpLCB5OyB2YXIgaSA9IHRyeUNhdGNoKG8sIGUuaXRlcmF0b3IsIHIuYXJnKTsgaWYgKCJ0aHJvdyIgPT09IGkudHlwZSkgcmV0dXJuIHIubWV0aG9kID0gInRocm93Iiwgci5hcmcgPSBpLmFyZywgci5kZWxlZ2F0ZSA9IG51bGwsIHk7IHZhciBhID0gaS5hcmc7IHJldHVybiBhID8gYS5kb25lID8gKHJbZS5yZXN1bHROYW1lXSA9IGEudmFsdWUsIHIubmV4dCA9IGUubmV4dExvYywgInJldHVybiIgIT09IHIubWV0aG9kICYmIChyLm1ldGhvZCA9ICJuZXh0Iiwgci5hcmcgPSB0KSwgci5kZWxlZ2F0ZSA9IG51bGwsIHkpIDogYSA6IChyLm1ldGhvZCA9ICJ0aHJvdyIsIHIuYXJnID0gbmV3IFR5cGVFcnJvcigiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3QiKSwgci5kZWxlZ2F0ZSA9IG51bGwsIHkpOyB9IGZ1bmN0aW9uIHB1c2hUcnlFbnRyeSh0KSB7IHZhciBlID0geyB0cnlMb2M6IHRbMF0gfTsgMSBpbiB0ICYmIChlLmNhdGNoTG9jID0gdFsxXSksIDIgaW4gdCAmJiAoZS5maW5hbGx5TG9jID0gdFsyXSwgZS5hZnRlckxvYyA9IHRbM10pLCB0aGlzLnRyeUVudHJpZXMucHVzaChlKTsgfSBmdW5jdGlvbiByZXNldFRyeUVudHJ5KHQpIHsgdmFyIGUgPSB0LmNvbXBsZXRpb24gfHwge307IGUudHlwZSA9ICJub3JtYWwiLCBkZWxldGUgZS5hcmcsIHQuY29tcGxldGlvbiA9IGU7IH0gZnVuY3Rpb24gQ29udGV4dCh0KSB7IHRoaXMudHJ5RW50cmllcyA9IFt7IHRyeUxvYzogInJvb3QiIH1dLCB0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKSwgdGhpcy5yZXNldCghMCk7IH0gZnVuY3Rpb24gdmFsdWVzKGUpIHsgaWYgKGUgfHwgIiIgPT09IGUpIHsgdmFyIHIgPSBlW2FdOyBpZiAocikgcmV0dXJuIHIuY2FsbChlKTsgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGUubmV4dCkgcmV0dXJuIGU7IGlmICghaXNOYU4oZS5sZW5ndGgpKSB7IHZhciBvID0gLTEsIGkgPSBmdW5jdGlvbiBuZXh0KCkgeyBmb3IgKDsgKytvIDwgZS5sZW5ndGg7KSBpZiAobi5jYWxsKGUsIG8pKSByZXR1cm4gbmV4dC52YWx1ZSA9IGVbb10sIG5leHQuZG9uZSA9ICExLCBuZXh0OyByZXR1cm4gbmV4dC52YWx1ZSA9IHQsIG5leHQuZG9uZSA9ICEwLCBuZXh0OyB9OyByZXR1cm4gaS5uZXh0ID0gaTsgfSB9IHRocm93IG5ldyBUeXBlRXJyb3IoX3R5cGVvZiQxKGUpICsgIiBpcyBub3QgaXRlcmFibGUiKTsgfSByZXR1cm4gR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIG8oZywgImNvbnN0cnVjdG9yIiwgeyB2YWx1ZTogR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsIGNvbmZpZ3VyYWJsZTogITAgfSksIG8oR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsICJjb25zdHJ1Y3RvciIsIHsgdmFsdWU6IEdlbmVyYXRvckZ1bmN0aW9uLCBjb25maWd1cmFibGU6ICEwIH0pLCBHZW5lcmF0b3JGdW5jdGlvbi5kaXNwbGF5TmFtZSA9IGRlZmluZShHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgdSwgIkdlbmVyYXRvckZ1bmN0aW9uIiksIGUuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uICh0KSB7IHZhciBlID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCAmJiB0LmNvbnN0cnVjdG9yOyByZXR1cm4gISFlICYmIChlID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fCAiR2VuZXJhdG9yRnVuY3Rpb24iID09PSAoZS5kaXNwbGF5TmFtZSB8fCBlLm5hbWUpKTsgfSwgZS5tYXJrID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZih0LCBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSkgOiAodC5fX3Byb3RvX18gPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgZGVmaW5lKHQsIHUsICJHZW5lcmF0b3JGdW5jdGlvbiIpKSwgdC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKGcpLCB0OyB9LCBlLmF3cmFwID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHsgX19hd2FpdDogdCB9OyB9LCBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpLCBkZWZpbmUoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUsIGMsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pLCBlLkFzeW5jSXRlcmF0b3IgPSBBc3luY0l0ZXJhdG9yLCBlLmFzeW5jID0gZnVuY3Rpb24gKHQsIHIsIG4sIG8sIGkpIHsgdm9pZCAwID09PSBpICYmIChpID0gUHJvbWlzZSk7IHZhciBhID0gbmV3IEFzeW5jSXRlcmF0b3Iod3JhcCh0LCByLCBuLCBvKSwgaSk7IHJldHVybiBlLmlzR2VuZXJhdG9yRnVuY3Rpb24ocikgPyBhIDogYS5uZXh0KCkudGhlbihmdW5jdGlvbiAodCkgeyByZXR1cm4gdC5kb25lID8gdC52YWx1ZSA6IGEubmV4dCgpOyB9KTsgfSwgZGVmaW5lSXRlcmF0b3JNZXRob2RzKGcpLCBkZWZpbmUoZywgdSwgIkdlbmVyYXRvciIpLCBkZWZpbmUoZywgYSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSksIGRlZmluZShnLCAidG9TdHJpbmciLCBmdW5jdGlvbiAoKSB7IHJldHVybiAiW29iamVjdCBHZW5lcmF0b3JdIjsgfSksIGUua2V5cyA9IGZ1bmN0aW9uICh0KSB7IHZhciBlID0gT2JqZWN0KHQpLCByID0gW107IGZvciAodmFyIG4gaW4gZSkgci5wdXNoKG4pOyByZXR1cm4gci5yZXZlcnNlKCksIGZ1bmN0aW9uIG5leHQoKSB7IGZvciAoOyByLmxlbmd0aDspIHsgdmFyIHQgPSByLnBvcCgpOyBpZiAodCBpbiBlKSByZXR1cm4gbmV4dC52YWx1ZSA9IHQsIG5leHQuZG9uZSA9ICExLCBuZXh0OyB9IHJldHVybiBuZXh0LmRvbmUgPSAhMCwgbmV4dDsgfTsgfSwgZS52YWx1ZXMgPSB2YWx1ZXMsIENvbnRleHQucHJvdG90eXBlID0geyBjb25zdHJ1Y3RvcjogQ29udGV4dCwgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KGUpIHsgaWYgKHRoaXMucHJldiA9IDAsIHRoaXMubmV4dCA9IDAsIHRoaXMuc2VudCA9IHRoaXMuX3NlbnQgPSB0LCB0aGlzLmRvbmUgPSAhMSwgdGhpcy5kZWxlZ2F0ZSA9IG51bGwsIHRoaXMubWV0aG9kID0gIm5leHQiLCB0aGlzLmFyZyA9IHQsIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpLCAhZSkgZm9yICh2YXIgciBpbiB0aGlzKSAidCIgPT09IHIuY2hhckF0KDApICYmIG4uY2FsbCh0aGlzLCByKSAmJiAhaXNOYU4oK3Iuc2xpY2UoMSkpICYmICh0aGlzW3JdID0gdCk7IH0sIHN0b3A6IGZ1bmN0aW9uIHN0b3AoKSB7IHRoaXMuZG9uZSA9ICEwOyB2YXIgdCA9IHRoaXMudHJ5RW50cmllc1swXS5jb21wbGV0aW9uOyBpZiAoInRocm93IiA9PT0gdC50eXBlKSB0aHJvdyB0LmFyZzsgcmV0dXJuIHRoaXMucnZhbDsgfSwgZGlzcGF0Y2hFeGNlcHRpb246IGZ1bmN0aW9uIGRpc3BhdGNoRXhjZXB0aW9uKGUpIHsgaWYgKHRoaXMuZG9uZSkgdGhyb3cgZTsgdmFyIHIgPSB0aGlzOyBmdW5jdGlvbiBoYW5kbGUobiwgbykgeyByZXR1cm4gYS50eXBlID0gInRocm93IiwgYS5hcmcgPSBlLCByLm5leHQgPSBuLCBvICYmIChyLm1ldGhvZCA9ICJuZXh0Iiwgci5hcmcgPSB0KSwgISFvOyB9IGZvciAodmFyIG8gPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgbyA+PSAwOyAtLW8pIHsgdmFyIGkgPSB0aGlzLnRyeUVudHJpZXNbb10sIGEgPSBpLmNvbXBsZXRpb247IGlmICgicm9vdCIgPT09IGkudHJ5TG9jKSByZXR1cm4gaGFuZGxlKCJlbmQiKTsgaWYgKGkudHJ5TG9jIDw9IHRoaXMucHJldikgeyB2YXIgYyA9IG4uY2FsbChpLCAiY2F0Y2hMb2MiKSwgdSA9IG4uY2FsbChpLCAiZmluYWxseUxvYyIpOyBpZiAoYyAmJiB1KSB7IGlmICh0aGlzLnByZXYgPCBpLmNhdGNoTG9jKSByZXR1cm4gaGFuZGxlKGkuY2F0Y2hMb2MsICEwKTsgaWYgKHRoaXMucHJldiA8IGkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShpLmZpbmFsbHlMb2MpOyB9IGVsc2UgaWYgKGMpIHsgaWYgKHRoaXMucHJldiA8IGkuY2F0Y2hMb2MpIHJldHVybiBoYW5kbGUoaS5jYXRjaExvYywgITApOyB9IGVsc2UgeyBpZiAoIXUpIHRocm93IG5ldyBFcnJvcigidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHkiKTsgaWYgKHRoaXMucHJldiA8IGkuZmluYWxseUxvYykgcmV0dXJuIGhhbmRsZShpLmZpbmFsbHlMb2MpOyB9IH0gfSB9LCBhYnJ1cHQ6IGZ1bmN0aW9uIGFicnVwdCh0LCBlKSB7IGZvciAodmFyIHIgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgciA+PSAwOyAtLXIpIHsgdmFyIG8gPSB0aGlzLnRyeUVudHJpZXNbcl07IGlmIChvLnRyeUxvYyA8PSB0aGlzLnByZXYgJiYgbi5jYWxsKG8sICJmaW5hbGx5TG9jIikgJiYgdGhpcy5wcmV2IDwgby5maW5hbGx5TG9jKSB7IHZhciBpID0gbzsgYnJlYWs7IH0gfSBpICYmICgiYnJlYWsiID09PSB0IHx8ICJjb250aW51ZSIgPT09IHQpICYmIGkudHJ5TG9jIDw9IGUgJiYgZSA8PSBpLmZpbmFsbHlMb2MgJiYgKGkgPSBudWxsKTsgdmFyIGEgPSBpID8gaS5jb21wbGV0aW9uIDoge307IHJldHVybiBhLnR5cGUgPSB0LCBhLmFyZyA9IGUsIGkgPyAodGhpcy5tZXRob2QgPSAibmV4dCIsIHRoaXMubmV4dCA9IGkuZmluYWxseUxvYywgeSkgOiB0aGlzLmNvbXBsZXRlKGEpOyB9LCBjb21wbGV0ZTogZnVuY3Rpb24gY29tcGxldGUodCwgZSkgeyBpZiAoInRocm93IiA9PT0gdC50eXBlKSB0aHJvdyB0LmFyZzsgcmV0dXJuICJicmVhayIgPT09IHQudHlwZSB8fCAiY29udGludWUiID09PSB0LnR5cGUgPyB0aGlzLm5leHQgPSB0LmFyZyA6ICJyZXR1cm4iID09PSB0LnR5cGUgPyAodGhpcy5ydmFsID0gdGhpcy5hcmcgPSB0LmFyZywgdGhpcy5tZXRob2QgPSAicmV0dXJuIiwgdGhpcy5uZXh0ID0gImVuZCIpIDogIm5vcm1hbCIgPT09IHQudHlwZSAmJiBlICYmICh0aGlzLm5leHQgPSBlKSwgeTsgfSwgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2godCkgeyBmb3IgKHZhciBlID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGUgPj0gMDsgLS1lKSB7IHZhciByID0gdGhpcy50cnlFbnRyaWVzW2VdOyBpZiAoci5maW5hbGx5TG9jID09PSB0KSByZXR1cm4gdGhpcy5jb21wbGV0ZShyLmNvbXBsZXRpb24sIHIuYWZ0ZXJMb2MpLCByZXNldFRyeUVudHJ5KHIpLCB5OyB9IH0sICJjYXRjaCI6IGZ1bmN0aW9uIF9jYXRjaCh0KSB7IGZvciAodmFyIGUgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgZSA+PSAwOyAtLWUpIHsgdmFyIHIgPSB0aGlzLnRyeUVudHJpZXNbZV07IGlmIChyLnRyeUxvYyA9PT0gdCkgeyB2YXIgbiA9IHIuY29tcGxldGlvbjsgaWYgKCJ0aHJvdyIgPT09IG4udHlwZSkgeyB2YXIgbyA9IG4uYXJnOyByZXNldFRyeUVudHJ5KHIpOyB9IHJldHVybiBvOyB9IH0gdGhyb3cgbmV3IEVycm9yKCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHQiKTsgfSwgZGVsZWdhdGVZaWVsZDogZnVuY3Rpb24gZGVsZWdhdGVZaWVsZChlLCByLCBuKSB7IHJldHVybiB0aGlzLmRlbGVnYXRlID0geyBpdGVyYXRvcjogdmFsdWVzKGUpLCByZXN1bHROYW1lOiByLCBuZXh0TG9jOiBuIH0sICJuZXh0IiA9PT0gdGhpcy5tZXRob2QgJiYgKHRoaXMuYXJnID0gdCksIHk7IH0gfSwgZTsgfQoJZnVuY3Rpb24gYXN5bmNHZW5lcmF0b3JTdGVwJDEoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CglmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvciQxKGZuKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBzZWxmID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdmFyIGdlbiA9IGZuLmFwcGx5KHNlbGYsIGFyZ3MpOyBmdW5jdGlvbiBfbmV4dCh2YWx1ZSkgeyBhc3luY0dlbmVyYXRvclN0ZXAkMShnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgIm5leHQiLCB2YWx1ZSk7IH0gZnVuY3Rpb24gX3Rocm93KGVycikgeyBhc3luY0dlbmVyYXRvclN0ZXAkMShnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoJdmFyIHJlYWRNZXRob2RzID0gWydnZXQnLCAnZ2V0S2V5JywgJ2dldEFsbCcsICdnZXRBbGxLZXlzJywgJ2NvdW50J107Cgl2YXIgd3JpdGVNZXRob2RzID0gWydwdXQnLCAnYWRkJywgJ2RlbGV0ZScsICdjbGVhciddOwoJdmFyIGNhY2hlZE1ldGhvZHMgPSBuZXcgTWFwKCk7CglmdW5jdGlvbiBnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB7CgkgIGlmICghKHRhcmdldCBpbnN0YW5jZW9mIElEQkRhdGFiYXNlICYmICEocHJvcCBpbiB0YXJnZXQpICYmIHR5cGVvZiBwcm9wID09PSAnc3RyaW5nJykpIHsKCSAgICByZXR1cm47CgkgIH0KCSAgaWYgKGNhY2hlZE1ldGhvZHMuZ2V0KHByb3ApKSByZXR1cm4gY2FjaGVkTWV0aG9kcy5nZXQocHJvcCk7CgkgIHZhciB0YXJnZXRGdW5jTmFtZSA9IHByb3AucmVwbGFjZSgvRnJvbUluZGV4JC8sICcnKTsKCSAgdmFyIHVzZUluZGV4ID0gcHJvcCAhPT0gdGFyZ2V0RnVuY05hbWU7CgkgIHZhciBpc1dyaXRlID0gd3JpdGVNZXRob2RzLmluY2x1ZGVzKHRhcmdldEZ1bmNOYW1lKTsKCSAgaWYgKAoJICAvLyBCYWlsIGlmIHRoZSB0YXJnZXQgZG9lc24ndCBleGlzdCBvbiB0aGUgdGFyZ2V0LiBFZywgZ2V0QWxsIGlzbid0IGluIEVkZ2UuCgkgICEodGFyZ2V0RnVuY05hbWUgaW4gKHVzZUluZGV4ID8gSURCSW5kZXggOiBJREJPYmplY3RTdG9yZSkucHJvdG90eXBlKSB8fCAhKGlzV3JpdGUgfHwgcmVhZE1ldGhvZHMuaW5jbHVkZXModGFyZ2V0RnVuY05hbWUpKSkgewoJICAgIHJldHVybjsKCSAgfQoJICB2YXIgbWV0aG9kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKCSAgICB2YXIgX3JlZjMgPSBfYXN5bmNUb0dlbmVyYXRvciQxKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSQxKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKHN0b3JlTmFtZSkgewoJICAgICAgdmFyIF90YXJnZXQ7CgkgICAgICB2YXIgdHgsCgkgICAgICAgIHRhcmdldCwKCSAgICAgICAgX2xlbiwKCSAgICAgICAgYXJncywKCSAgICAgICAgX2tleSwKCSAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7CgkgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSQxKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewoJICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewoJICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgIC8vIGlzV3JpdGUgPyAncmVhZHdyaXRlJyA6IHVuZGVmaW5lZCBnemlwcHMgYmV0dGVyLCBidXQgZmFpbHMgaW4gRWRnZSA6KAoJICAgICAgICAgICAgdHggPSB0aGlzLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgaXNXcml0ZSA/ICdyZWFkd3JpdGUnIDogJ3JlYWRvbmx5Jyk7CgkgICAgICAgICAgICB0YXJnZXQgPSB0eC5zdG9yZTsKCSAgICAgICAgICAgIGZvciAoX2xlbiA9IF9hcmdzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CgkgICAgICAgICAgICAgIGFyZ3NbX2tleSAtIDFdID0gX2FyZ3NbX2tleV07CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodXNlSW5kZXgpIHRhcmdldCA9IHRhcmdldC5pbmRleChhcmdzLnNoaWZ0KCkpOwoJICAgICAgICAgICAgLy8gTXVzdCByZWplY3QgaWYgb3AgcmVqZWN0cy4KCSAgICAgICAgICAgIC8vIElmIGl0J3MgYSB3cml0ZSBvcGVyYXRpb24sIG11c3QgcmVqZWN0IGlmIHR4LmRvbmUgcmVqZWN0cy4KCSAgICAgICAgICAgIC8vIE11c3QgcmVqZWN0IHdpdGggb3AgcmVqZWN0aW9uIGZpcnN0LgoJICAgICAgICAgICAgLy8gTXVzdCByZXNvbHZlIHdpdGggb3AgdmFsdWUuCgkgICAgICAgICAgICAvLyBNdXN0IGhhbmRsZSBib3RoIHByb21pc2VzIChubyB1bmhhbmRsZWQgcmVqZWN0aW9ucykKCSAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwoJICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFsoX3RhcmdldCA9IHRhcmdldClbdGFyZ2V0RnVuY05hbWVdLmFwcGx5KF90YXJnZXQsIGFyZ3MpLCBpc1dyaXRlICYmIHR4LmRvbmVdKTsKCSAgICAgICAgICBjYXNlIDY6CgkgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dC5zZW50WzBdKTsKCSAgICAgICAgICBjYXNlIDc6CgkgICAgICAgICAgY2FzZSAiZW5kIjoKCSAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CgkgICAgICAgIH0KCSAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwoJICAgIH0pKTsKCSAgICByZXR1cm4gZnVuY3Rpb24gbWV0aG9kKF94KSB7CgkgICAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCSAgICB9OwoJICB9KCk7CgkgIGNhY2hlZE1ldGhvZHMuc2V0KHByb3AsIG1ldGhvZCk7CgkgIHJldHVybiBtZXRob2Q7Cgl9CglyZXBsYWNlVHJhcHMoZnVuY3Rpb24gKG9sZFRyYXBzKSB7CgkgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG9sZFRyYXBzKSwge30sIHsKCSAgICBnZXQ6IGZ1bmN0aW9uIGdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7CgkgICAgICByZXR1cm4gZ2V0TWV0aG9kKHRhcmdldCwgcHJvcCkgfHwgb2xkVHJhcHMuZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpOwoJICAgIH0sCgkgICAgaGFzOiBmdW5jdGlvbiBoYXModGFyZ2V0LCBwcm9wKSB7CgkgICAgICByZXR1cm4gISFnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB8fCBvbGRUcmFwcy5oYXModGFyZ2V0LCBwcm9wKTsKCSAgICB9CgkgIH0pOwoJfSk7CgoJLy8gaW5kZXhlZERCIHN0b3JlTmFtZQoJdmFyIExPR19JTkZPX1NUT1JFX05BTUUgPSAnbG9nLWluZm8nOwoJLy8gaW5kZXhlZERCIOeJiOacrAoJdmFyIERCX1ZFUlNJT04gPSAxOwoJLy8g5pWw5o2u5bqT5ZCN56ewCgl2YXIgTE9HX0RBVEFCQVNFX05BTUUgPSAicW5jLW9mZmxpbmUtbG9nLSIuY29uY2F0KERCX1ZFUlNJT04pOwoKCXZhciBtZDUgPSBmdW5jdGlvbiAoKSB7CgkgIHZhciBhZGQzMjsKCSAgZnVuY3Rpb24gbWQ1Y3ljbGUoeCwgaykgewoJICAgIHZhciBhID0geFswXTsKCSAgICB2YXIgYiA9IHhbMV07CgkgICAgdmFyIGMgPSB4WzJdOwoJICAgIHZhciBkID0geFszXTsKCSAgICBhID0gZmYoYSwgYiwgYywgZCwga1swXSwgNywgLTY4MDg3NjkzNik7CgkgICAgZCA9IGZmKGQsIGEsIGIsIGMsIGtbMV0sIDEyLCAtMzg5NTY0NTg2KTsKCSAgICBjID0gZmYoYywgZCwgYSwgYiwga1syXSwgMTcsIDYwNjEwNTgxOSk7CgkgICAgYiA9IGZmKGIsIGMsIGQsIGEsIGtbM10sIDIyLCAtMTA0NDUyNTMzMCk7CgkgICAgYSA9IGZmKGEsIGIsIGMsIGQsIGtbNF0sIDcsIC0xNzY0MTg4OTcpOwoJICAgIGQgPSBmZihkLCBhLCBiLCBjLCBrWzVdLCAxMiwgMTIwMDA4MDQyNik7CgkgICAgYyA9IGZmKGMsIGQsIGEsIGIsIGtbNl0sIDE3LCAtMTQ3MzIzMTM0MSk7CgkgICAgYiA9IGZmKGIsIGMsIGQsIGEsIGtbN10sIDIyLCAtNDU3MDU5ODMpOwoJICAgIGEgPSBmZihhLCBiLCBjLCBkLCBrWzhdLCA3LCAxNzcwMDM1NDE2KTsKCSAgICBkID0gZmYoZCwgYSwgYiwgYywga1s5XSwgMTIsIC0xOTU4NDE0NDE3KTsKCSAgICBjID0gZmYoYywgZCwgYSwgYiwga1sxMF0sIDE3LCAtNDIwNjMpOwoJICAgIGIgPSBmZihiLCBjLCBkLCBhLCBrWzExXSwgMjIsIC0xOTkwNDA0MTYyKTsKCSAgICBhID0gZmYoYSwgYiwgYywgZCwga1sxMl0sIDcsIDE4MDQ2MDM2ODIpOwoJICAgIGQgPSBmZihkLCBhLCBiLCBjLCBrWzEzXSwgMTIsIC00MDM0MTEwMSk7CgkgICAgYyA9IGZmKGMsIGQsIGEsIGIsIGtbMTRdLCAxNywgLTE1MDIwMDIyOTApOwoJICAgIGIgPSBmZihiLCBjLCBkLCBhLCBrWzE1XSwgMjIsIDEyMzY1MzUzMjkpOwoJICAgIGEgPSBnZyhhLCBiLCBjLCBkLCBrWzFdLCA1LCAtMTY1Nzk2NTEwKTsKCSAgICBkID0gZ2coZCwgYSwgYiwgYywga1s2XSwgOSwgLTEwNjk1MDE2MzIpOwoJICAgIGMgPSBnZyhjLCBkLCBhLCBiLCBrWzExXSwgMTQsIDY0MzcxNzcxMyk7CgkgICAgYiA9IGdnKGIsIGMsIGQsIGEsIGtbMF0sIDIwLCAtMzczODk3MzAyKTsKCSAgICBhID0gZ2coYSwgYiwgYywgZCwga1s1XSwgNSwgLTcwMTU1ODY5MSk7CgkgICAgZCA9IGdnKGQsIGEsIGIsIGMsIGtbMTBdLCA5LCAzODAxNjA4Myk7CgkgICAgYyA9IGdnKGMsIGQsIGEsIGIsIGtbMTVdLCAxNCwgLTY2MDQ3ODMzNSk7CgkgICAgYiA9IGdnKGIsIGMsIGQsIGEsIGtbNF0sIDIwLCAtNDA1NTM3ODQ4KTsKCSAgICBhID0gZ2coYSwgYiwgYywgZCwga1s5XSwgNSwgNTY4NDQ2NDM4KTsKCSAgICBkID0gZ2coZCwgYSwgYiwgYywga1sxNF0sIDksIC0xMDE5ODAzNjkwKTsKCSAgICBjID0gZ2coYywgZCwgYSwgYiwga1szXSwgMTQsIC0xODczNjM5NjEpOwoJICAgIGIgPSBnZyhiLCBjLCBkLCBhLCBrWzhdLCAyMCwgMTE2MzUzMTUwMSk7CgkgICAgYSA9IGdnKGEsIGIsIGMsIGQsIGtbMTNdLCA1LCAtMTQ0NDY4MTQ2Nyk7CgkgICAgZCA9IGdnKGQsIGEsIGIsIGMsIGtbMl0sIDksIC01MTQwMzc4NCk7CgkgICAgYyA9IGdnKGMsIGQsIGEsIGIsIGtbN10sIDE0LCAxNzM1MzI4NDczKTsKCSAgICBiID0gZ2coYiwgYywgZCwgYSwga1sxMl0sIDIwLCAtMTkyNjYwNzczNCk7CgkgICAgYSA9IGhoKGEsIGIsIGMsIGQsIGtbNV0sIDQsIC0zNzg1NTgpOwoJICAgIGQgPSBoaChkLCBhLCBiLCBjLCBrWzhdLCAxMSwgLTIwMjI1NzQ0NjMpOwoJICAgIGMgPSBoaChjLCBkLCBhLCBiLCBrWzExXSwgMTYsIDE4MzkwMzA1NjIpOwoJICAgIGIgPSBoaChiLCBjLCBkLCBhLCBrWzE0XSwgMjMsIC0zNTMwOTU1Nik7CgkgICAgYSA9IGhoKGEsIGIsIGMsIGQsIGtbMV0sIDQsIC0xNTMwOTkyMDYwKTsKCSAgICBkID0gaGgoZCwgYSwgYiwgYywga1s0XSwgMTEsIDEyNzI4OTMzNTMpOwoJICAgIGMgPSBoaChjLCBkLCBhLCBiLCBrWzddLCAxNiwgLTE1NTQ5NzYzMik7CgkgICAgYiA9IGhoKGIsIGMsIGQsIGEsIGtbMTBdLCAyMywgLTEwOTQ3MzA2NDApOwoJICAgIGEgPSBoaChhLCBiLCBjLCBkLCBrWzEzXSwgNCwgNjgxMjc5MTc0KTsKCSAgICBkID0gaGgoZCwgYSwgYiwgYywga1swXSwgMTEsIC0zNTg1MzcyMjIpOwoJICAgIGMgPSBoaChjLCBkLCBhLCBiLCBrWzNdLCAxNiwgLTcyMjUyMTk3OSk7CgkgICAgYiA9IGhoKGIsIGMsIGQsIGEsIGtbNl0sIDIzLCA3NjAyOTE4OSk7CgkgICAgYSA9IGhoKGEsIGIsIGMsIGQsIGtbOV0sIDQsIC02NDAzNjQ0ODcpOwoJICAgIGQgPSBoaChkLCBhLCBiLCBjLCBrWzEyXSwgMTEsIC00MjE4MTU4MzUpOwoJICAgIGMgPSBoaChjLCBkLCBhLCBiLCBrWzE1XSwgMTYsIDUzMDc0MjUyMCk7CgkgICAgYiA9IGhoKGIsIGMsIGQsIGEsIGtbMl0sIDIzLCAtOTk1MzM4NjUxKTsKCSAgICBhID0gaWkoYSwgYiwgYywgZCwga1swXSwgNiwgLTE5ODYzMDg0NCk7CgkgICAgZCA9IGlpKGQsIGEsIGIsIGMsIGtbN10sIDEwLCAxMTI2ODkxNDE1KTsKCSAgICBjID0gaWkoYywgZCwgYSwgYiwga1sxNF0sIDE1LCAtMTQxNjM1NDkwNSk7CgkgICAgYiA9IGlpKGIsIGMsIGQsIGEsIGtbNV0sIDIxLCAtNTc0MzQwNTUpOwoJICAgIGEgPSBpaShhLCBiLCBjLCBkLCBrWzEyXSwgNiwgMTcwMDQ4NTU3MSk7CgkgICAgZCA9IGlpKGQsIGEsIGIsIGMsIGtbM10sIDEwLCAtMTg5NDk4NjYwNik7CgkgICAgYyA9IGlpKGMsIGQsIGEsIGIsIGtbMTBdLCAxNSwgLTEwNTE1MjMpOwoJICAgIGIgPSBpaShiLCBjLCBkLCBhLCBrWzFdLCAyMSwgLTIwNTQ5MjI3OTkpOwoJICAgIGEgPSBpaShhLCBiLCBjLCBkLCBrWzhdLCA2LCAxODczMzEzMzU5KTsKCSAgICBkID0gaWkoZCwgYSwgYiwgYywga1sxNV0sIDEwLCAtMzA2MTE3NDQpOwoJICAgIGMgPSBpaShjLCBkLCBhLCBiLCBrWzZdLCAxNSwgLTE1NjAxOTgzODApOwoJICAgIGIgPSBpaShiLCBjLCBkLCBhLCBrWzEzXSwgMjEsIDEzMDkxNTE2NDkpOwoJICAgIGEgPSBpaShhLCBiLCBjLCBkLCBrWzRdLCA2LCAtMTQ1NTIzMDcwKTsKCSAgICBkID0gaWkoZCwgYSwgYiwgYywga1sxMV0sIDEwLCAtMTEyMDIxMDM3OSk7CgkgICAgYyA9IGlpKGMsIGQsIGEsIGIsIGtbMl0sIDE1LCA3MTg3ODcyNTkpOwoJICAgIGIgPSBpaShiLCBjLCBkLCBhLCBrWzldLCAyMSwgLTM0MzQ4NTU1MSk7CgkgICAgeFswXSA9IGFkZDMyKGEsIHhbMF0pOwoJICAgIHhbMV0gPSBhZGQzMihiLCB4WzFdKTsKCSAgICB4WzJdID0gYWRkMzIoYywgeFsyXSk7CgkgICAgeFszXSA9IGFkZDMyKGQsIHhbM10pOwoJICB9CgkgIGZ1bmN0aW9uIGNtbihxLCBhLCBiLCB4LCBzLCB0KSB7CgkgICAgYSA9IGFkZDMyKGFkZDMyKGEsIHEpLCBhZGQzMih4LCB0KSk7CgkgICAgcmV0dXJuIGFkZDMyKGEgPDwgcyB8IGEgPj4+IDMyIC0gcywgYik7CgkgIH0KCSAgZnVuY3Rpb24gZmYoYSwgYiwgYywgZCwgeCwgcywgdCkgewoJICAgIHJldHVybiBjbW4oYiAmIGMgfCB+YiAmIGQsIGEsIGIsIHgsIHMsIHQpOwoJICB9CgkgIGZ1bmN0aW9uIGdnKGEsIGIsIGMsIGQsIHgsIHMsIHQpIHsKCSAgICByZXR1cm4gY21uKGIgJiBkIHwgYyAmIH5kLCBhLCBiLCB4LCBzLCB0KTsKCSAgfQoJICBmdW5jdGlvbiBoaChhLCBiLCBjLCBkLCB4LCBzLCB0KSB7CgkgICAgcmV0dXJuIGNtbihiIF4gYyBeIGQsIGEsIGIsIHgsIHMsIHQpOwoJICB9CgkgIGZ1bmN0aW9uIGlpKGEsIGIsIGMsIGQsIHgsIHMsIHQpIHsKCSAgICByZXR1cm4gY21uKGMgXiAoYiB8IH5kKSwgYSwgYiwgeCwgcywgdCk7CgkgIH0KCSAgZnVuY3Rpb24gbWQ1MShzKSB7CgkgICAgdmFyIG4gPSBzLmxlbmd0aDsKCSAgICB2YXIgc3RhdGUgPSBbMTczMjU4NDE5MywgLTI3MTczMzg3OSwgLTE3MzI1ODQxOTQsIDI3MTczMzg3OF07CgkgICAgdmFyIGk7CgkgICAgZm9yIChpID0gNjQ7IGkgPD0gcy5sZW5ndGg7IGkgKz0gNjQpIHsKCSAgICAgIG1kNWN5Y2xlKHN0YXRlLCBtZDVibGsocy5zdWJzdHJpbmcoaSAtIDY0LCBpKSkpOwoJICAgIH0KCSAgICBzID0gcy5zdWJzdHJpbmcoaSAtIDY0KTsKCSAgICB2YXIgdGFpbCA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCSAgICBmb3IgKGkgPSAwOyBpIDwgcy5sZW5ndGg7IGkrKykgdGFpbFtpID4+IDJdIHw9IHMuY2hhckNvZGVBdChpKSA8PCAoaSAlIDQgPDwgMyk7CgkgICAgdGFpbFtpID4+IDJdIHw9IDB4ODAgPDwgKGkgJSA0IDw8IDMpOwoJICAgIGlmIChpID4gNTUpIHsKCSAgICAgIG1kNWN5Y2xlKHN0YXRlLCB0YWlsKTsKCSAgICAgIGZvciAoaSA9IDA7IGkgPCAxNjsgaSsrKSB0YWlsW2ldID0gMDsKCSAgICB9CgkgICAgdGFpbFsxNF0gPSBuICogODsKCSAgICBtZDVjeWNsZShzdGF0ZSwgdGFpbCk7CgkgICAgcmV0dXJuIHN0YXRlOwoJICB9CgkgIHZhciBiaW5hcnlCYXNlNjQgPSBmdW5jdGlvbiBiaW5hcnlCYXNlNjQoc3RyKSB7CgkgICAgdmFyIGk7CgkgICAgdmFyIGxlbjsKCSAgICB2YXIgX2NoYXI7CgkgICAgdmFyIHJlcyA9ICcnOwoJICAgIGZvciAoaSA9IDAsIGxlbiA9IHN0ci5sZW5ndGggLyAyOyBpIDwgbGVuOyBpKyspIHsKCSAgICAgIF9jaGFyID0gcGFyc2VJbnQoc3RyW2kgKiAyXSArIHN0cltpICogMiArIDFdLCAxNik7CgkgICAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShfY2hhcik7CgkgICAgfQoJICAgIHJldHVybiBidG9hKHJlcyk7CgkgIH07CgkgIGZ1bmN0aW9uIGdldEN0eCgpIHsKCSAgICB2YXIgY3R4ID0gewoJICAgICAgc3RhdGU6IFtdLAoJICAgICAgdGFpbDogJycsCgkgICAgICBzaXplOiAwLAoJICAgICAgdXBkYXRlOiBudWxsLAoJICAgICAgZGlnZXN0OiBudWxsCgkgICAgfTsKCSAgICBjdHguc3RhdGUgPSBbMTczMjU4NDE5MywgLTI3MTczMzg3OSwgLTE3MzI1ODQxOTQsIDI3MTczMzg3OF07CgkgICAgY3R4LnRhaWwgPSAnJzsKCSAgICBjdHguc2l6ZSA9IDA7CgkgICAgY3R4LnVwZGF0ZSA9IGZ1bmN0aW9uIChzLCBpc0JpbmFyeVN0cmluZykgewoJICAgICAgaWYgKCFpc0JpbmFyeVN0cmluZykgcyA9IFV0ZjhFbmNvZGUocyk7CgkgICAgICBjdHguc2l6ZSArPSBzLmxlbmd0aDsKCSAgICAgIHMgPSBjdHgudGFpbCArIHM7CgkgICAgICB2YXIgaTsKCSAgICAgIHZhciBzdGF0ZSA9IGN0eC5zdGF0ZTsKCSAgICAgIGZvciAoaSA9IDY0OyBpIDw9IHMubGVuZ3RoOyBpICs9IDY0KSB7CgkgICAgICAgIG1kNWN5Y2xlKHN0YXRlLCBtZDVibGsocy5zdWJzdHJpbmcoaSAtIDY0LCBpKSkpOwoJICAgICAgfQoJICAgICAgY3R4LnRhaWwgPSBzLnN1YnN0cmluZyhpIC0gNjQpOwoJICAgICAgcmV0dXJuIGN0eDsKCSAgICB9OwoJICAgIGN0eC5kaWdlc3QgPSBmdW5jdGlvbiAoZW5jb2RlKSB7CgkgICAgICB2YXIgaTsKCSAgICAgIHZhciBuID0gY3R4LnNpemU7CgkgICAgICB2YXIgc3RhdGUgPSBjdHguc3RhdGU7CgkgICAgICB2YXIgcyA9IGN0eC50YWlsOwoJICAgICAgdmFyIHRhaWwgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF07CgkgICAgICBmb3IgKGkgPSAwOyBpIDwgcy5sZW5ndGg7IGkrKykgdGFpbFtpID4+IDJdIHw9IHMuY2hhckNvZGVBdChpKSA8PCAoaSAlIDQgPDwgMyk7CgkgICAgICB0YWlsW2kgPj4gMl0gfD0gMHg4MCA8PCAoaSAlIDQgPDwgMyk7CgkgICAgICBpZiAoaSA+IDU1KSB7CgkgICAgICAgIG1kNWN5Y2xlKHN0YXRlLCB0YWlsKTsKCSAgICAgICAgZm9yIChpID0gMDsgaSA8IDE2OyBpKyspIHRhaWxbaV0gPSAwOwoJICAgICAgfQoJICAgICAgdGFpbFsxNF0gPSBuICogODsKCSAgICAgIG1kNWN5Y2xlKHN0YXRlLCB0YWlsKTsKCSAgICAgIHJldHVybiBlbmNvZGUgPT09ICdoZXgnID8gaGV4KHN0YXRlKSA6IGVuY29kZSA9PT0gJ2Jhc2U2NCcgPyBiaW5hcnlCYXNlNjQoaGV4KHN0YXRlKSkgOiBzdGF0ZTsKCSAgICB9OwoJICAgIHJldHVybiBjdHg7CgkgIH0KCgkgIC8qIHRoZXJlIG5lZWRzIHRvIGJlIHN1cHBvcnQgZm9yIFVuaWNvZGUgaGVyZSwKCSAgKiB1bmxlc3Mgd2UgcHJldGVuZCB0aGF0IHdlIGNhbiByZWRlZmluZSB0aGUgTUQtNQoJICAqIGFsZ29yaXRobSBmb3IgbXVsdGktYnl0ZSBjaGFyYWN0ZXJzIChwZXJoYXBzCgkgICogYnkgYWRkaW5nIGV2ZXJ5IGZvdXIgMTYtYml0IGNoYXJhY3RlcnMgYW5kCgkgICogc2hvcnRlbmluZyB0aGUgc3VtIHRvIDMyIGJpdHMpLiBPdGhlcndpc2UKCSAgKiBJIHN1Z2dlc3QgcGVyZm9ybWluZyBNRC01IGFzIGlmIGV2ZXJ5IGNoYXJhY3RlcgoJICAqIHdhcyB0d28gYnl0ZXMtLWUuZy4sIDAwNDAgMDAyNSA9IEAlLS1idXQgdGhlbgoJICAqIGhvdyB3aWxsIGFuIG9yZGluYXJ5IE1ELTUgc3VtIGJlIG1hdGNoZWQ/CgkgICogVGhlcmUgaXMgbm8gd2F5IHRvIHN0YW5kYXJkaXplIHRleHQgdG8gc29tZXRoaW5nCgkgICogbGlrZSBVVEYtOCBiZWZvcmUgdHJhbnNmb3JtYXRpb247IHNwZWVkIGNvc3QgaXMKCSAgKiB1dHRlcmx5IHByb2hpYml0aXZlLiBUaGUgSmF2YVNjcmlwdCBzdGFuZGFyZAoJICAqIGl0c2VsZiBuZWVkcyB0byBsb29rIGF0IHRoaXM6IGl0IHNob3VsZCBzdGFydAoJICAqIHByb3ZpZGluZyBhY2Nlc3MgdG8gc3RyaW5ncyBhcyBwcmVmb3JtZWQgVVRGLTgKCSAgKiA4LWJpdCB1bnNpZ25lZCB2YWx1ZSBhcnJheXMuCgkgICovCgkgIGZ1bmN0aW9uIG1kNWJsayhzKSB7CgkgICAgLyogSSBmaWd1cmVkIGdsb2JhbCB3YXMgZmFzdGVyLiAgICovCgkgICAgdmFyIG1kNWJsa3MgPSBbXTsKCSAgICB2YXIgaTsgLyogQW5keSBLaW5nIHNhaWQgZG8gaXQgdGhpcyB3YXkuICovCgkgICAgZm9yIChpID0gMDsgaSA8IDY0OyBpICs9IDQpIHsKCSAgICAgIG1kNWJsa3NbaSA+PiAyXSA9IHMuY2hhckNvZGVBdChpKSArIChzLmNoYXJDb2RlQXQoaSArIDEpIDw8IDgpICsgKHMuY2hhckNvZGVBdChpICsgMikgPDwgMTYpICsgKHMuY2hhckNvZGVBdChpICsgMykgPDwgMjQpOwoJICAgIH0KCSAgICByZXR1cm4gbWQ1YmxrczsKCSAgfQoJICB2YXIgaGV4X2NociA9ICcwMTIzNDU2Nzg5YWJjZGVmJy5zcGxpdCgnJyk7CgkgIGZ1bmN0aW9uIHJoZXgobikgewoJICAgIHZhciBzID0gJyc7CgkgICAgdmFyIGogPSAwOwoJICAgIGZvciAoOyBqIDwgNDsgaisrKSBzICs9IGhleF9jaHJbbiA+PiBqICogOCArIDQgJiAweDBGXSArIGhleF9jaHJbbiA+PiBqICogOCAmIDB4MEZdOwoJICAgIHJldHVybiBzOwoJICB9CgkgIGZ1bmN0aW9uIGhleCh4KSB7CgkgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB4W2ldID0gcmhleCh4W2ldKTsKCSAgICByZXR1cm4geC5qb2luKCcnKTsKCSAgfQoJICBmdW5jdGlvbiBVdGY4RW5jb2RlKHN0cmluZykgewoJICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cclxuL2csICdcbicpOwoJICAgIHZhciB1dGZ0ZXh0ID0gJyc7CgkgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBzdHJpbmcubGVuZ3RoOyBuKyspIHsKCSAgICAgIHZhciBjID0gc3RyaW5nLmNoYXJDb2RlQXQobik7CgkgICAgICBpZiAoYyA8IDEyOCkgewoJICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyk7CgkgICAgICB9IGVsc2UgaWYgKGMgPiAxMjcgJiYgYyA8IDIwNDgpIHsKCSAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMgPj4gNiB8IDE5Mik7CgkgICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjICYgNjMgfCAxMjgpOwoJICAgICAgfSBlbHNlIHsKCSAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMgPj4gMTIgfCAyMjQpOwoJICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyA+PiA2ICYgNjMgfCAxMjgpOwoJICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyAmIDYzIHwgMTI4KTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIHV0ZnRleHQ7CgkgIH0KCSAgZnVuY3Rpb24gbWQ1KHMpIHsKCSAgICB2YXIgaXNCaW5hcnlTdHJpbmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwoJICAgIGlmICghaXNCaW5hcnlTdHJpbmcpIHsKCSAgICAgIHMgPSBVdGY4RW5jb2RlKHMpOwoJICAgIH0KCSAgICByZXR1cm4gaGV4KG1kNTEocykpOwoJICB9CgkgIGFkZDMyID0gZnVuY3Rpb24gYWRkMzIoYSwgYikgewoJICAgIHJldHVybiBhICsgYiAmIDB4RkZGRkZGRkY7CgkgIH07CgkgIGlmIChtZDUoJ2hlbGxvJykgIT09ICc1ZDQxNDAyYWJjNGIyYTc2Yjk3MTlkOTExMDE3YzU5MicpIHsKCSAgICBhZGQzMiA9IGZ1bmN0aW9uIGFkZDMyKHgsIHkpIHsKCSAgICAgIHZhciBsc3cgPSAoeCAmIDB4RkZGRikgKyAoeSAmIDB4RkZGRik7CgkgICAgICB2YXIgbXN3ID0gKHggPj4gMTYpICsgKHkgPj4gMTYpICsgKGxzdyA+PiAxNik7CgkgICAgICByZXR1cm4gbXN3IDw8IDE2IHwgbHN3ICYgMHhGRkZGOwoJICAgIH07CgkgIH0KCSAgbWQ1LmdldEN0eCA9IGdldEN0eDsKCSAgcmV0dXJuIG1kNTsKCX0oKTsKCgkvKioKCSAqIOiOt+WPluaWh+S7tueahG1kNQoJICogQHBhcmFtIGZpbGUgRmlsZeWvueixoQoJICovCgl2YXIgZ2V0RmlsZU1kNSA9IGZ1bmN0aW9uIGdldEZpbGVNZDUoZmlsZSkgewoJICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJICAgIHZhciBtZDVDaHVua1NpemUgPSAxMDI0ICogMTAyNDsKCSAgICB2YXIgc2l6ZSA9IGZpbGUuc2l6ZTsKCSAgICB2YXIgbWQ1Y3R4ID0gbWQ1LmdldEN0eCgpOwoJICAgIHZhciBuZXh0ID0gZnVuY3Rpb24gbmV4dChzdGFydCkgewoJICAgICAgaWYgKHN0YXJ0ID49IHNpemUpIHsKCSAgICAgICAgdmFyIGhhc2ggPSBtZDVjdHguZGlnZXN0KCdoZXgnKTsKCSAgICAgICAgcmVzb2x2ZShoYXNoKTsKCSAgICAgICAgcmV0dXJuOwoJICAgICAgfQoJICAgICAgdmFyIGVuZCA9IE1hdGgubWluKHNpemUsIHN0YXJ0ICsgbWQ1Q2h1bmtTaXplKTsKCSAgICAgIHZhciBibG9iID0gZmlsZS5zbGljZShzdGFydCwgZW5kKTsKCSAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoJICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGNvbnRlbnQgPSByZWFkZXIucmVzdWx0OwoJICAgICAgICBtZDVjdHggPSBtZDVjdHgudXBkYXRlKGNvbnRlbnQsIHRydWUpOwoJICAgICAgICBjb250ZW50ID0gbnVsbDsKCSAgICAgICAgbmV4dChzdGFydCArIG1kNUNodW5rU2l6ZSk7CgkgICAgICB9OwoJICAgICAgcmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJlamVjdCgncW4tbG9nZ2Vy6I635Y+W5paH5Lu25aSx6LSlJyk7CgkgICAgICB9OwoJICAgICAgcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyhibG9iKTsKCSAgICB9OwoJICAgIG5leHQoMCk7CgkgIH0pOwoJfTsKCgkvKioKCSAqIOaXpeW/l+aWh+S7tuWQjQoJICovCgl2YXIgTE9HX05BTUUgPSAnZmUubG9nJzsKCglmdW5jdGlvbiBfdHlwZW9mKG8pIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvKSB7IHJldHVybiB0eXBlb2YgbzsgfSA6IGZ1bmN0aW9uIChvKSB7IHJldHVybiBvICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiBvLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgbyAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG87IH0sIF90eXBlb2Yobyk7IH0KCWZ1bmN0aW9uIF9yZWdlbmVyYXRvclJ1bnRpbWUoKSB7IC8qISByZWdlbmVyYXRvci1ydW50aW1lIC0tIENvcHlyaWdodCAoYykgMjAxNC1wcmVzZW50LCBGYWNlYm9vaywgSW5jLiAtLSBsaWNlbnNlIChNSVQpOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVnZW5lcmF0b3IvYmxvYi9tYWluL0xJQ0VOU0UgKi8gX3JlZ2VuZXJhdG9yUnVudGltZSA9IGZ1bmN0aW9uIF9yZWdlbmVyYXRvclJ1bnRpbWUoKSB7IHJldHVybiBlOyB9OyB2YXIgdCwgZSA9IHt9LCByID0gT2JqZWN0LnByb3RvdHlwZSwgbiA9IHIuaGFzT3duUHJvcGVydHksIG8gPSBPYmplY3QuZGVmaW5lUHJvcGVydHkgfHwgZnVuY3Rpb24gKHQsIGUsIHIpIHsgdFtlXSA9IHIudmFsdWU7IH0sIGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgPyBTeW1ib2wgOiB7fSwgYSA9IGkuaXRlcmF0b3IgfHwgIkBAaXRlcmF0b3IiLCBjID0gaS5hc3luY0l0ZXJhdG9yIHx8ICJAQGFzeW5jSXRlcmF0b3IiLCB1ID0gaS50b1N0cmluZ1RhZyB8fCAiQEB0b1N0cmluZ1RhZyI7IGZ1bmN0aW9uIGRlZmluZSh0LCBlLCByKSB7IHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgZSwgeyB2YWx1ZTogciwgZW51bWVyYWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAsIHdyaXRhYmxlOiAhMCB9KSwgdFtlXTsgfSB0cnkgeyBkZWZpbmUoe30sICIiKTsgfSBjYXRjaCAodCkgeyBkZWZpbmUgPSBmdW5jdGlvbiBkZWZpbmUodCwgZSwgcikgeyByZXR1cm4gdFtlXSA9IHI7IH07IH0gZnVuY3Rpb24gd3JhcCh0LCBlLCByLCBuKSB7IHZhciBpID0gZSAmJiBlLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvciA/IGUgOiBHZW5lcmF0b3IsIGEgPSBPYmplY3QuY3JlYXRlKGkucHJvdG90eXBlKSwgYyA9IG5ldyBDb250ZXh0KG4gfHwgW10pOyByZXR1cm4gbyhhLCAiX2ludm9rZSIsIHsgdmFsdWU6IG1ha2VJbnZva2VNZXRob2QodCwgciwgYykgfSksIGE7IH0gZnVuY3Rpb24gdHJ5Q2F0Y2godCwgZSwgcikgeyB0cnkgeyByZXR1cm4geyB0eXBlOiAibm9ybWFsIiwgYXJnOiB0LmNhbGwoZSwgcikgfTsgfSBjYXRjaCAodCkgeyByZXR1cm4geyB0eXBlOiAidGhyb3ciLCBhcmc6IHQgfTsgfSB9IGUud3JhcCA9IHdyYXA7IHZhciBoID0gInN1c3BlbmRlZFN0YXJ0IiwgbCA9ICJzdXNwZW5kZWRZaWVsZCIsIGYgPSAiZXhlY3V0aW5nIiwgcyA9ICJjb21wbGV0ZWQiLCB5ID0ge307IGZ1bmN0aW9uIEdlbmVyYXRvcigpIHt9IGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uKCkge30gZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUoKSB7fSB2YXIgcCA9IHt9OyBkZWZpbmUocCwgYSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSk7IHZhciBkID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLCB2ID0gZCAmJiBkKGQodmFsdWVzKFtdKSkpOyB2ICYmIHYgIT09IHIgJiYgbi5jYWxsKHYsIGEpICYmIChwID0gdik7IHZhciBnID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID0gR2VuZXJhdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocCk7IGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyh0KSB7IFsibmV4dCIsICJ0aHJvdyIsICJyZXR1cm4iXS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7IGRlZmluZSh0LCBlLCBmdW5jdGlvbiAodCkgeyByZXR1cm4gdGhpcy5faW52b2tlKGUsIHQpOyB9KTsgfSk7IH0gZnVuY3Rpb24gQXN5bmNJdGVyYXRvcih0LCBlKSB7IGZ1bmN0aW9uIGludm9rZShyLCBvLCBpLCBhKSB7IHZhciBjID0gdHJ5Q2F0Y2godFtyXSwgdCwgbyk7IGlmICgidGhyb3ciICE9PSBjLnR5cGUpIHsgdmFyIHUgPSBjLmFyZywgaCA9IHUudmFsdWU7IHJldHVybiBoICYmICJvYmplY3QiID09IF90eXBlb2YoaCkgJiYgbi5jYWxsKGgsICJfX2F3YWl0IikgPyBlLnJlc29sdmUoaC5fX2F3YWl0KS50aGVuKGZ1bmN0aW9uICh0KSB7IGludm9rZSgibmV4dCIsIHQsIGksIGEpOyB9LCBmdW5jdGlvbiAodCkgeyBpbnZva2UoInRocm93IiwgdCwgaSwgYSk7IH0pIDogZS5yZXNvbHZlKGgpLnRoZW4oZnVuY3Rpb24gKHQpIHsgdS52YWx1ZSA9IHQsIGkodSk7IH0sIGZ1bmN0aW9uICh0KSB7IHJldHVybiBpbnZva2UoInRocm93IiwgdCwgaSwgYSk7IH0pOyB9IGEoYy5hcmcpOyB9IHZhciByOyBvKHRoaXMsICJfaW52b2tlIiwgeyB2YWx1ZTogZnVuY3Rpb24gdmFsdWUodCwgbikgeyBmdW5jdGlvbiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpIHsgcmV0dXJuIG5ldyBlKGZ1bmN0aW9uIChlLCByKSB7IGludm9rZSh0LCBuLCBlLCByKTsgfSk7IH0gcmV0dXJuIHIgPSByID8gci50aGVuKGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnLCBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZykgOiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpOyB9IH0pOyB9IGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoZSwgciwgbikgeyB2YXIgbyA9IGg7IHJldHVybiBmdW5jdGlvbiAoaSwgYSkgeyBpZiAobyA9PT0gZikgdGhyb3cgbmV3IEVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBydW5uaW5nIik7IGlmIChvID09PSBzKSB7IGlmICgidGhyb3ciID09PSBpKSB0aHJvdyBhOyByZXR1cm4geyB2YWx1ZTogdCwgZG9uZTogITAgfTsgfSBmb3IgKG4ubWV0aG9kID0gaSwgbi5hcmcgPSBhOzspIHsgdmFyIGMgPSBuLmRlbGVnYXRlOyBpZiAoYykgeyB2YXIgdSA9IG1heWJlSW52b2tlRGVsZWdhdGUoYywgbik7IGlmICh1KSB7IGlmICh1ID09PSB5KSBjb250aW51ZTsgcmV0dXJuIHU7IH0gfSBpZiAoIm5leHQiID09PSBuLm1ldGhvZCkgbi5zZW50ID0gbi5fc2VudCA9IG4uYXJnO2Vsc2UgaWYgKCJ0aHJvdyIgPT09IG4ubWV0aG9kKSB7IGlmIChvID09PSBoKSB0aHJvdyBvID0gcywgbi5hcmc7IG4uZGlzcGF0Y2hFeGNlcHRpb24obi5hcmcpOyB9IGVsc2UgInJldHVybiIgPT09IG4ubWV0aG9kICYmIG4uYWJydXB0KCJyZXR1cm4iLCBuLmFyZyk7IG8gPSBmOyB2YXIgcCA9IHRyeUNhdGNoKGUsIHIsIG4pOyBpZiAoIm5vcm1hbCIgPT09IHAudHlwZSkgeyBpZiAobyA9IG4uZG9uZSA/IHMgOiBsLCBwLmFyZyA9PT0geSkgY29udGludWU7IHJldHVybiB7IHZhbHVlOiBwLmFyZywgZG9uZTogbi5kb25lIH07IH0gInRocm93IiA9PT0gcC50eXBlICYmIChvID0gcywgbi5tZXRob2QgPSAidGhyb3ciLCBuLmFyZyA9IHAuYXJnKTsgfSB9OyB9IGZ1bmN0aW9uIG1heWJlSW52b2tlRGVsZWdhdGUoZSwgcikgeyB2YXIgbiA9IHIubWV0aG9kLCBvID0gZS5pdGVyYXRvcltuXTsgaWYgKG8gPT09IHQpIHJldHVybiByLmRlbGVnYXRlID0gbnVsbCwgInRocm93IiA9PT0gbiAmJiBlLml0ZXJhdG9yWyJyZXR1cm4iXSAmJiAoci5tZXRob2QgPSAicmV0dXJuIiwgci5hcmcgPSB0LCBtYXliZUludm9rZURlbGVnYXRlKGUsIHIpLCAidGhyb3ciID09PSByLm1ldGhvZCkgfHwgInJldHVybiIgIT09IG4gJiYgKHIubWV0aG9kID0gInRocm93Iiwgci5hcmcgPSBuZXcgVHlwZUVycm9yKCJUaGUgaXRlcmF0b3IgZG9lcyBub3QgcHJvdmlkZSBhICciICsgbiArICInIG1ldGhvZCIpKSwgeTsgdmFyIGkgPSB0cnlDYXRjaChvLCBlLml0ZXJhdG9yLCByLmFyZyk7IGlmICgidGhyb3ciID09PSBpLnR5cGUpIHJldHVybiByLm1ldGhvZCA9ICJ0aHJvdyIsIHIuYXJnID0gaS5hcmcsIHIuZGVsZWdhdGUgPSBudWxsLCB5OyB2YXIgYSA9IGkuYXJnOyByZXR1cm4gYSA/IGEuZG9uZSA/IChyW2UucmVzdWx0TmFtZV0gPSBhLnZhbHVlLCByLm5leHQgPSBlLm5leHRMb2MsICJyZXR1cm4iICE9PSByLm1ldGhvZCAmJiAoci5tZXRob2QgPSAibmV4dCIsIHIuYXJnID0gdCksIHIuZGVsZWdhdGUgPSBudWxsLCB5KSA6IGEgOiAoci5tZXRob2QgPSAidGhyb3ciLCByLmFyZyA9IG5ldyBUeXBlRXJyb3IoIml0ZXJhdG9yIHJlc3VsdCBpcyBub3QgYW4gb2JqZWN0IiksIHIuZGVsZWdhdGUgPSBudWxsLCB5KTsgfSBmdW5jdGlvbiBwdXNoVHJ5RW50cnkodCkgeyB2YXIgZSA9IHsgdHJ5TG9jOiB0WzBdIH07IDEgaW4gdCAmJiAoZS5jYXRjaExvYyA9IHRbMV0pLCAyIGluIHQgJiYgKGUuZmluYWxseUxvYyA9IHRbMl0sIGUuYWZ0ZXJMb2MgPSB0WzNdKSwgdGhpcy50cnlFbnRyaWVzLnB1c2goZSk7IH0gZnVuY3Rpb24gcmVzZXRUcnlFbnRyeSh0KSB7IHZhciBlID0gdC5jb21wbGV0aW9uIHx8IHt9OyBlLnR5cGUgPSAibm9ybWFsIiwgZGVsZXRlIGUuYXJnLCB0LmNvbXBsZXRpb24gPSBlOyB9IGZ1bmN0aW9uIENvbnRleHQodCkgeyB0aGlzLnRyeUVudHJpZXMgPSBbeyB0cnlMb2M6ICJyb290IiB9XSwgdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyksIHRoaXMucmVzZXQoITApOyB9IGZ1bmN0aW9uIHZhbHVlcyhlKSB7IGlmIChlIHx8ICIiID09PSBlKSB7IHZhciByID0gZVthXTsgaWYgKHIpIHJldHVybiByLmNhbGwoZSk7IGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBlLm5leHQpIHJldHVybiBlOyBpZiAoIWlzTmFOKGUubGVuZ3RoKSkgeyB2YXIgbyA9IC0xLCBpID0gZnVuY3Rpb24gbmV4dCgpIHsgZm9yICg7ICsrbyA8IGUubGVuZ3RoOykgaWYgKG4uY2FsbChlLCBvKSkgcmV0dXJuIG5leHQudmFsdWUgPSBlW29dLCBuZXh0LmRvbmUgPSAhMSwgbmV4dDsgcmV0dXJuIG5leHQudmFsdWUgPSB0LCBuZXh0LmRvbmUgPSAhMCwgbmV4dDsgfTsgcmV0dXJuIGkubmV4dCA9IGk7IH0gfSB0aHJvdyBuZXcgVHlwZUVycm9yKF90eXBlb2YoZSkgKyAiIGlzIG5vdCBpdGVyYWJsZSIpOyB9IHJldHVybiBHZW5lcmF0b3JGdW5jdGlvbi5wcm90b3R5cGUgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgbyhnLCAiY29uc3RydWN0b3IiLCB7IHZhbHVlOiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgY29uZmlndXJhYmxlOiAhMCB9KSwgbyhHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSwgImNvbnN0cnVjdG9yIiwgeyB2YWx1ZTogR2VuZXJhdG9yRnVuY3Rpb24sIGNvbmZpZ3VyYWJsZTogITAgfSksIEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gZGVmaW5lKEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCB1LCAiR2VuZXJhdG9yRnVuY3Rpb24iKSwgZS5pc0dlbmVyYXRvckZ1bmN0aW9uID0gZnVuY3Rpb24gKHQpIHsgdmFyIGUgPSAiZnVuY3Rpb24iID09IHR5cGVvZiB0ICYmIHQuY29uc3RydWN0b3I7IHJldHVybiAhIWUgJiYgKGUgPT09IEdlbmVyYXRvckZ1bmN0aW9uIHx8ICJHZW5lcmF0b3JGdW5jdGlvbiIgPT09IChlLmRpc3BsYXlOYW1lIHx8IGUubmFtZSkpOyB9LCBlLm1hcmsgPSBmdW5jdGlvbiAodCkgeyByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHQsIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKSA6ICh0Ll9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLCBkZWZpbmUodCwgdSwgIkdlbmVyYXRvckZ1bmN0aW9uIikpLCB0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoZyksIHQ7IH0sIGUuYXdyYXAgPSBmdW5jdGlvbiAodCkgeyByZXR1cm4geyBfX2F3YWl0OiB0IH07IH0sIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhBc3luY0l0ZXJhdG9yLnByb3RvdHlwZSksIGRlZmluZShBc3luY0l0ZXJhdG9yLnByb3RvdHlwZSwgYywgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSksIGUuQXN5bmNJdGVyYXRvciA9IEFzeW5jSXRlcmF0b3IsIGUuYXN5bmMgPSBmdW5jdGlvbiAodCwgciwgbiwgbywgaSkgeyB2b2lkIDAgPT09IGkgJiYgKGkgPSBQcm9taXNlKTsgdmFyIGEgPSBuZXcgQXN5bmNJdGVyYXRvcih3cmFwKHQsIHIsIG4sIG8pLCBpKTsgcmV0dXJuIGUuaXNHZW5lcmF0b3JGdW5jdGlvbihyKSA/IGEgOiBhLm5leHQoKS50aGVuKGZ1bmN0aW9uICh0KSB7IHJldHVybiB0LmRvbmUgPyB0LnZhbHVlIDogYS5uZXh0KCk7IH0pOyB9LCBkZWZpbmVJdGVyYXRvck1ldGhvZHMoZyksIGRlZmluZShnLCB1LCAiR2VuZXJhdG9yIiksIGRlZmluZShnLCBhLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9KSwgZGVmaW5lKGcsICJ0b1N0cmluZyIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuICJbb2JqZWN0IEdlbmVyYXRvcl0iOyB9KSwgZS5rZXlzID0gZnVuY3Rpb24gKHQpIHsgdmFyIGUgPSBPYmplY3QodCksIHIgPSBbXTsgZm9yICh2YXIgbiBpbiBlKSByLnB1c2gobik7IHJldHVybiByLnJldmVyc2UoKSwgZnVuY3Rpb24gbmV4dCgpIHsgZm9yICg7IHIubGVuZ3RoOykgeyB2YXIgdCA9IHIucG9wKCk7IGlmICh0IGluIGUpIHJldHVybiBuZXh0LnZhbHVlID0gdCwgbmV4dC5kb25lID0gITEsIG5leHQ7IH0gcmV0dXJuIG5leHQuZG9uZSA9ICEwLCBuZXh0OyB9OyB9LCBlLnZhbHVlcyA9IHZhbHVlcywgQ29udGV4dC5wcm90b3R5cGUgPSB7IGNvbnN0cnVjdG9yOiBDb250ZXh0LCByZXNldDogZnVuY3Rpb24gcmVzZXQoZSkgeyBpZiAodGhpcy5wcmV2ID0gMCwgdGhpcy5uZXh0ID0gMCwgdGhpcy5zZW50ID0gdGhpcy5fc2VudCA9IHQsIHRoaXMuZG9uZSA9ICExLCB0aGlzLmRlbGVnYXRlID0gbnVsbCwgdGhpcy5tZXRob2QgPSAibmV4dCIsIHRoaXMuYXJnID0gdCwgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSksICFlKSBmb3IgKHZhciByIGluIHRoaXMpICJ0IiA9PT0gci5jaGFyQXQoMCkgJiYgbi5jYWxsKHRoaXMsIHIpICYmICFpc05hTigrci5zbGljZSgxKSkgJiYgKHRoaXNbcl0gPSB0KTsgfSwgc3RvcDogZnVuY3Rpb24gc3RvcCgpIHsgdGhpcy5kb25lID0gITA7IHZhciB0ID0gdGhpcy50cnlFbnRyaWVzWzBdLmNvbXBsZXRpb247IGlmICgidGhyb3ciID09PSB0LnR5cGUpIHRocm93IHQuYXJnOyByZXR1cm4gdGhpcy5ydmFsOyB9LCBkaXNwYXRjaEV4Y2VwdGlvbjogZnVuY3Rpb24gZGlzcGF0Y2hFeGNlcHRpb24oZSkgeyBpZiAodGhpcy5kb25lKSB0aHJvdyBlOyB2YXIgciA9IHRoaXM7IGZ1bmN0aW9uIGhhbmRsZShuLCBvKSB7IHJldHVybiBhLnR5cGUgPSAidGhyb3ciLCBhLmFyZyA9IGUsIHIubmV4dCA9IG4sIG8gJiYgKHIubWV0aG9kID0gIm5leHQiLCByLmFyZyA9IHQpLCAhIW87IH0gZm9yICh2YXIgbyA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBvID49IDA7IC0tbykgeyB2YXIgaSA9IHRoaXMudHJ5RW50cmllc1tvXSwgYSA9IGkuY29tcGxldGlvbjsgaWYgKCJyb290IiA9PT0gaS50cnlMb2MpIHJldHVybiBoYW5kbGUoImVuZCIpOyBpZiAoaS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7IHZhciBjID0gbi5jYWxsKGksICJjYXRjaExvYyIpLCB1ID0gbi5jYWxsKGksICJmaW5hbGx5TG9jIik7IGlmIChjICYmIHUpIHsgaWYgKHRoaXMucHJldiA8IGkuY2F0Y2hMb2MpIHJldHVybiBoYW5kbGUoaS5jYXRjaExvYywgITApOyBpZiAodGhpcy5wcmV2IDwgaS5maW5hbGx5TG9jKSByZXR1cm4gaGFuZGxlKGkuZmluYWxseUxvYyk7IH0gZWxzZSBpZiAoYykgeyBpZiAodGhpcy5wcmV2IDwgaS5jYXRjaExvYykgcmV0dXJuIGhhbmRsZShpLmNhdGNoTG9jLCAhMCk7IH0gZWxzZSB7IGlmICghdSkgdGhyb3cgbmV3IEVycm9yKCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseSIpOyBpZiAodGhpcy5wcmV2IDwgaS5maW5hbGx5TG9jKSByZXR1cm4gaGFuZGxlKGkuZmluYWxseUxvYyk7IH0gfSB9IH0sIGFicnVwdDogZnVuY3Rpb24gYWJydXB0KHQsIGUpIHsgZm9yICh2YXIgciA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyByID49IDA7IC0tcikgeyB2YXIgbyA9IHRoaXMudHJ5RW50cmllc1tyXTsgaWYgKG8udHJ5TG9jIDw9IHRoaXMucHJldiAmJiBuLmNhbGwobywgImZpbmFsbHlMb2MiKSAmJiB0aGlzLnByZXYgPCBvLmZpbmFsbHlMb2MpIHsgdmFyIGkgPSBvOyBicmVhazsgfSB9IGkgJiYgKCJicmVhayIgPT09IHQgfHwgImNvbnRpbnVlIiA9PT0gdCkgJiYgaS50cnlMb2MgPD0gZSAmJiBlIDw9IGkuZmluYWxseUxvYyAmJiAoaSA9IG51bGwpOyB2YXIgYSA9IGkgPyBpLmNvbXBsZXRpb24gOiB7fTsgcmV0dXJuIGEudHlwZSA9IHQsIGEuYXJnID0gZSwgaSA/ICh0aGlzLm1ldGhvZCA9ICJuZXh0IiwgdGhpcy5uZXh0ID0gaS5maW5hbGx5TG9jLCB5KSA6IHRoaXMuY29tcGxldGUoYSk7IH0sIGNvbXBsZXRlOiBmdW5jdGlvbiBjb21wbGV0ZSh0LCBlKSB7IGlmICgidGhyb3ciID09PSB0LnR5cGUpIHRocm93IHQuYXJnOyByZXR1cm4gImJyZWFrIiA9PT0gdC50eXBlIHx8ICJjb250aW51ZSIgPT09IHQudHlwZSA/IHRoaXMubmV4dCA9IHQuYXJnIDogInJldHVybiIgPT09IHQudHlwZSA/ICh0aGlzLnJ2YWwgPSB0aGlzLmFyZyA9IHQuYXJnLCB0aGlzLm1ldGhvZCA9ICJyZXR1cm4iLCB0aGlzLm5leHQgPSAiZW5kIikgOiAibm9ybWFsIiA9PT0gdC50eXBlICYmIGUgJiYgKHRoaXMubmV4dCA9IGUpLCB5OyB9LCBmaW5pc2g6IGZ1bmN0aW9uIGZpbmlzaCh0KSB7IGZvciAodmFyIGUgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgZSA+PSAwOyAtLWUpIHsgdmFyIHIgPSB0aGlzLnRyeUVudHJpZXNbZV07IGlmIChyLmZpbmFsbHlMb2MgPT09IHQpIHJldHVybiB0aGlzLmNvbXBsZXRlKHIuY29tcGxldGlvbiwgci5hZnRlckxvYyksIHJlc2V0VHJ5RW50cnkociksIHk7IH0gfSwgImNhdGNoIjogZnVuY3Rpb24gX2NhdGNoKHQpIHsgZm9yICh2YXIgZSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBlID49IDA7IC0tZSkgeyB2YXIgciA9IHRoaXMudHJ5RW50cmllc1tlXTsgaWYgKHIudHJ5TG9jID09PSB0KSB7IHZhciBuID0gci5jb21wbGV0aW9uOyBpZiAoInRocm93IiA9PT0gbi50eXBlKSB7IHZhciBvID0gbi5hcmc7IHJlc2V0VHJ5RW50cnkocik7IH0gcmV0dXJuIG87IH0gfSB0aHJvdyBuZXcgRXJyb3IoImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdCIpOyB9LCBkZWxlZ2F0ZVlpZWxkOiBmdW5jdGlvbiBkZWxlZ2F0ZVlpZWxkKGUsIHIsIG4pIHsgcmV0dXJuIHRoaXMuZGVsZWdhdGUgPSB7IGl0ZXJhdG9yOiB2YWx1ZXMoZSksIHJlc3VsdE5hbWU6IHIsIG5leHRMb2M6IG4gfSwgIm5leHQiID09PSB0aGlzLm1ldGhvZCAmJiAodGhpcy5hcmcgPSB0KSwgeTsgfSB9LCBlOyB9CglmdW5jdGlvbiBhc3luY0dlbmVyYXRvclN0ZXAoZ2VuLCByZXNvbHZlLCByZWplY3QsIF9uZXh0LCBfdGhyb3csIGtleSwgYXJnKSB7IHRyeSB7IHZhciBpbmZvID0gZ2VuW2tleV0oYXJnKTsgdmFyIHZhbHVlID0gaW5mby52YWx1ZTsgfSBjYXRjaCAoZXJyb3IpIHsgcmVqZWN0KGVycm9yKTsgcmV0dXJuOyB9IGlmIChpbmZvLmRvbmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0gZWxzZSB7IFByb21pc2UucmVzb2x2ZSh2YWx1ZSkudGhlbihfbmV4dCwgX3Rocm93KTsgfSB9CglmdW5jdGlvbiBfYXN5bmNUb0dlbmVyYXRvcihmbikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTsgZnVuY3Rpb24gX25leHQodmFsdWUpIHsgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCAibmV4dCIsIHZhbHVlKTsgfSBmdW5jdGlvbiBfdGhyb3coZXJyKSB7IGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgInRocm93IiwgZXJyKTsgfSBfbmV4dCh1bmRlZmluZWQpOyB9KTsgfTsgfQoJb25tZXNzYWdlID0gZnVuY3Rpb24gb25tZXNzYWdlKCkgewoJICB0cnkgewoJICAgIHZhciB6aXAgPSBuZXcgSlNaaXAoKTsKCSAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKExPR19EQVRBQkFTRV9OQU1FLCBEQl9WRVJTSU9OKTsKCSAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CgkgICAgICBwb3N0TWVzc2FnZSgnJyk7CgkgICAgfTsKCSAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkgewoJICAgICAgdmFyIF9ldmVudCR0YXJnZXQ7CgkgICAgICB2YXIgZGIgPSAoX2V2ZW50JHRhcmdldCA9IGV2ZW50LnRhcmdldCkgPT09IG51bGwgfHwgX2V2ZW50JHRhcmdldCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2V2ZW50JHRhcmdldC5yZXN1bHQ7CgkgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbihbTE9HX0lORk9fU1RPUkVfTkFNRV0sICdyZWFkd3JpdGUnKTsKCSAgICAgIHZhciBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKExPR19JTkZPX1NUT1JFX05BTUUpOwoJICAgICAgb2JqZWN0U3RvcmUuZ2V0QWxsKCkub25zdWNjZXNzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodGFibGVFdmVudCkgewoJICAgICAgICAgIHZhciBpbm5lclN0cmluZywgaW5uZXJTdHJpbmdBZGRCciwgemlwQ29udGVudCwgZmlsZU1kNSwgemlwRmlsZTsKCSAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKCSAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CgkgICAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBpbm5lclN0cmluZyA9IE9iamVjdC52YWx1ZXModGFibGVFdmVudC50YXJnZXQucmVzdWx0KS5tYXAoZnVuY3Rpb24gKHYpIHsKCSAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh2KTsKCSAgICAgICAgICAgICAgICB9KTsgLy8g5pel5b+X5re75Yqg5o2i6KGM77yM5pa55L6/6ZiF6K+7CgkgICAgICAgICAgICAgICAgaW5uZXJTdHJpbmdBZGRCciA9IGlubmVyU3RyaW5nLmpvaW4oJ1xuJyk7CgkgICAgICAgICAgICAgICAgemlwLmZpbGUoTE9HX05BTUUsIGlubmVyU3RyaW5nQWRkQnIpOwoJICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwoJICAgICAgICAgICAgICAgIHJldHVybiB6aXAuZ2VuZXJhdGVBc3luYyh7CgkgICAgICAgICAgICAgICAgICB0eXBlOiAnYmxvYicKCSAgICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgICAgY2FzZSA1OgoJICAgICAgICAgICAgICAgIHppcENvbnRlbnQgPSBfY29udGV4dC5zZW50OwoJICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwoJICAgICAgICAgICAgICAgIHJldHVybiBnZXRGaWxlTWQ1KHppcENvbnRlbnQpOwoJICAgICAgICAgICAgICBjYXNlIDg6CgkgICAgICAgICAgICAgICAgZmlsZU1kNSA9IF9jb250ZXh0LnNlbnQ7CgkgICAgICAgICAgICAgICAgemlwRmlsZSA9IG5ldyBGaWxlKFt6aXBDb250ZW50XSwgIiIuY29uY2F0KGZpbGVNZDUsICIuemlwIiksIHsKCSAgICAgICAgICAgICAgICAgIHR5cGU6ICdhcHBsaWNhdGlvbi96aXAnCgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgcG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgICAgICAgZmlsZU1kNTogZmlsZU1kNSwKCSAgICAgICAgICAgICAgICAgIHppcEZpbGU6IHppcEZpbGUKCSAgICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgICAgY2FzZSAxMToKCSAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKCSAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgIH0sIF9jYWxsZWUpOwoJICAgICAgICB9KSk7CgkgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKCSAgICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJICAgICAgICB9OwoJICAgICAgfSgpOwoJICAgIH07CgkgIH0gY2F0Y2ggKGUpIHsKCSAgICBwb3N0TWVzc2FnZSh7CgkgICAgICBmaWxlTWQ1OiAnJywKCSAgICAgIHppcEZpbGU6ICcnCgkgICAgfSk7CgkgIH0KCX07Cgp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD13b3JrZXIuanMubWFwCgo=",q=null,$=!1,function(g){return gg=gg||Q(_,q,$),new Worker(gg,g)}),Cg=C("../../node_modules/.pnpm/@tencent+qn-logger@1.0.0/node_modules/@tencent/qn-logger/es/dcl-upload/call.js"),tg=function(){var g;function I(I,C){var n=I[0],o=I[1],r=I[2],s=I[3];n=t(n,o,r,s,C[0],7,-680876936),s=t(s,n,o,r,C[1],12,-389564586),r=t(r,s,n,o,C[2],17,606105819),o=t(o,r,s,n,C[3],22,-1044525330),n=t(n,o,r,s,C[4],7,-176418897),s=t(s,n,o,r,C[5],12,1200080426),r=t(r,s,n,o,C[6],17,-1473231341),o=t(o,r,s,n,C[7],22,-45705983),n=t(n,o,r,s,C[8],7,1770035416),s=t(s,n,o,r,C[9],12,-1958414417),r=t(r,s,n,o,C[10],17,-42063),o=t(o,r,s,n,C[11],22,-1990404162),n=t(n,o,r,s,C[12],7,1804603682),s=t(s,n,o,r,C[13],12,-40341101),r=t(r,s,n,o,C[14],17,-1502002290),n=A(n,o=t(o,r,s,n,C[15],22,1236535329),r,s,C[1],5,-165796510),s=A(s,n,o,r,C[6],9,-1069501632),r=A(r,s,n,o,C[11],14,643717713),o=A(o,r,s,n,C[0],20,-373897302),n=A(n,o,r,s,C[5],5,-701558691),s=A(s,n,o,r,C[10],9,38016083),r=A(r,s,n,o,C[15],14,-660478335),o=A(o,r,s,n,C[4],20,-405537848),n=A(n,o,r,s,C[9],5,568446438),s=A(s,n,o,r,C[14],9,-1019803690),r=A(r,s,n,o,C[3],14,-187363961),o=A(o,r,s,n,C[8],20,1163531501),n=A(n,o,r,s,C[13],5,-1444681467),s=A(s,n,o,r,C[2],9,-51403784),r=A(r,s,n,o,C[7],14,1735328473),n=e(n,o=A(o,r,s,n,C[12],20,-1926607734),r,s,C[5],4,-378558),s=e(s,n,o,r,C[8],11,-2022574463),r=e(r,s,n,o,C[11],16,1839030562),o=e(o,r,s,n,C[14],23,-35309556),n=e(n,o,r,s,C[1],4,-1530992060),s=e(s,n,o,r,C[4],11,1272893353),r=e(r,s,n,o,C[7],16,-155497632),o=e(o,r,s,n,C[10],23,-1094730640),n=e(n,o,r,s,C[13],4,681279174),s=e(s,n,o,r,C[0],11,-358537222),r=e(r,s,n,o,C[3],16,-722521979),o=e(o,r,s,n,C[6],23,76029189),n=e(n,o,r,s,C[9],4,-640364487),s=e(s,n,o,r,C[12],11,-421815835),r=e(r,s,n,o,C[15],16,530742520),n=i(n,o=e(o,r,s,n,C[2],23,-995338651),r,s,C[0],6,-198630844),s=i(s,n,o,r,C[7],10,1126891415),r=i(r,s,n,o,C[14],15,-1416354905),o=i(o,r,s,n,C[5],21,-57434055),n=i(n,o,r,s,C[12],6,1700485571),s=i(s,n,o,r,C[3],10,-1894986606),r=i(r,s,n,o,C[10],15,-1051523),o=i(o,r,s,n,C[1],21,-2054922799),n=i(n,o,r,s,C[8],6,1873313359),s=i(s,n,o,r,C[15],10,-30611744),r=i(r,s,n,o,C[6],15,-1560198380),o=i(o,r,s,n,C[13],21,1309151649),n=i(n,o,r,s,C[4],6,-145523070),s=i(s,n,o,r,C[11],10,-1120210379),r=i(r,s,n,o,C[2],15,718787259),o=i(o,r,s,n,C[9],21,-343485551),I[0]=g(n,I[0]),I[1]=g(o,I[1]),I[2]=g(r,I[2]),I[3]=g(s,I[3])}function C(I,C,t,A,e,i){return C=g(g(C,I),g(A,i)),g(C<<e|C>>>32-e,t)}function t(g,I,t,A,e,i,n){return C(I&t|~I&A,g,I,e,i,n)}function A(g,I,t,A,e,i,n){return C(I&A|t&~A,g,I,e,i,n)}function e(g,I,t,A,e,i,n){return C(I^t^A,g,I,e,i,n)}function i(g,I,t,A,e,i,n){return C(t^(I|~A),g,I,e,i,n)}function n(g){var I,C=[];for(I=0;I<64;I+=4)C[I>>2]=g.charCodeAt(I)+(g.charCodeAt(I+1)<<8)+(g.charCodeAt(I+2)<<16)+(g.charCodeAt(I+3)<<24);return C}var o="0123456789abcdef".split("");function r(g){for(var I="",C=0;C<4;C++)I+=o[g>>8*C+4&15]+o[g>>8*C&15];return I}function s(g){for(var I=0;I<g.length;I++)g[I]=r(g[I]);return g.join("")}function a(g){g=g.replace(/\r\n/g,"\n");for(var I="",C=0;C<g.length;C++){var t=g.charCodeAt(C);t<128?I+=String.fromCharCode(t):t>127&&t<2048?(I+=String.fromCharCode(t>>6|192),I+=String.fromCharCode(63&t|128)):(I+=String.fromCharCode(t>>12|224),I+=String.fromCharCode(t>>6&63|128),I+=String.fromCharCode(63&t|128))}return I}function c(g){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(g=a(g)),s(function(g){var C,t=g.length,A=[1732584193,-271733879,-1732584194,271733878];for(C=64;C<=g.length;C+=64)I(A,n(g.substring(C-64,C)));g=g.substring(C-64);var e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(C=0;C<g.length;C++)e[C>>2]|=g.charCodeAt(C)<<(C%4<<3);if(e[C>>2]|=128<<(C%4<<3),C>55)for(I(A,e),C=0;C<16;C++)e[C]=0;return e[14]=8*t,I(A,e),A}(g))}return g=function(g,I){return g+I&4294967295},"5d41402abc4b2a76b9719d911017c592"!==c("hello")&&(g=function(g,I){var C=(65535&g)+(65535&I);return(g>>16)+(I>>16)+(C>>16)<<16|65535&C}),c.getCtx=function(){var g={state:[],tail:"",size:0,update:null,digest:null};return g.state=[1732584193,-271733879,-1732584194,271733878],g.tail="",g.size=0,g.update=function(C,t){var A;t||(C=a(C)),g.size+=C.length,C=g.tail+C;var e=g.state;for(A=64;A<=C.length;A+=64)I(e,n(C.substring(A-64,A)));return g.tail=C.substring(A-64),g},g.digest=function(C){var t,A=g.size,e=g.state,i=g.tail,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i.length;t++)n[t>>2]|=i.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(I(e,n),t=0;t<16;t++)n[t]=0;return n[14]=8*A,I(e,n),"hex"===C?s(e):"base64"===C?function(g){var I,C,t,A="";for(I=0,C=g.length/2;I<C;I++)t=parseInt(g[2*I]+g[2*I+1],16),A+=String.fromCharCode(t);return btoa(A)}(s(e)):e},g},c}(),Ag=function(g){return new Promise((function(I,C){var t=1048576,A=g.size,e=tg.getCtx();!function i(n){if(n>=A){var o=e.digest("hex");I(o)}else{var r=Math.min(A,n+t),s=g.slice(n,r),a=new FileReader;a.onload=function(){var g=a.result;e=e.update(g,!0),g=null,i(n+t)},a.onerror=function(){C("qn-logger获取文件失败")},a.readAsBinaryString(s)}}(0)}))},eg=function(g){var I,C,t,A="";for(I=0,C=g.length/2;I<C;I++)t=parseInt(g[2*I]+g[2*I+1],16),A+=String.fromCharCode(t);return btoa(A)};function ig(g){return ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},ig(g)}function ng(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ng=function(){return I};var g,I={},C=Object.prototype,t=C.hasOwnProperty,A=Object.defineProperty||function(g,I,C){g[I]=C.value},e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function r(g,I,C){return Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}),g[I]}try{r({},"")}catch(g){r=function(g,I,C){return g[I]=C}}function s(g,I,C,t){var e=I&&I.prototype instanceof m?I:m,i=Object.create(e.prototype),n=new K(t||[]);return A(i,"_invoke",{value:f(g,C,n)}),i}function a(g,I,C){try{return{type:"normal",arg:g.call(I,C)}}catch(g){return{type:"throw",arg:g}}}I.wrap=s;var c="suspendedStart",l="suspendedYield",u="executing",d="completed",h={};function m(){}function S(){}function y(){}var b={};r(b,i,(function(){return this}));var Z=Object.getPrototypeOf,B=Z&&Z(Z(W([])));B&&B!==C&&t.call(B,i)&&(b=B);var G=y.prototype=m.prototype=Object.create(b);function p(g){["next","throw","return"].forEach((function(I){r(g,I,(function(g){return this._invoke(I,g)}))}))}function w(g,I){function C(A,e,i,n){var o=a(g[A],g,e);if("throw"!==o.type){var r=o.arg,s=r.value;return s&&"object"==ig(s)&&t.call(s,"__await")?I.resolve(s.__await).then((function(g){C("next",g,i,n)}),(function(g){C("throw",g,i,n)})):I.resolve(s).then((function(g){r.value=g,i(r)}),(function(g){return C("throw",g,i,n)}))}n(o.arg)}var e;A(this,"_invoke",{value:function(g,t){function A(){return new I((function(I,A){C(g,t,I,A)}))}return e=e?e.then(A,A):A()}})}function f(I,C,t){var A=c;return function(e,i){if(A===u)throw new Error("Generator is already running");if(A===d){if("throw"===e)throw i;return{value:g,done:!0}}for(t.method=e,t.arg=i;;){var n=t.delegate;if(n){var o=k(n,t);if(o){if(o===h)continue;return o}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(A===c)throw A=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);A=u;var r=a(I,C,t);if("normal"===r.type){if(A=t.done?d:l,r.arg===h)continue;return{value:r.arg,done:t.done}}"throw"===r.type&&(A=d,t.method="throw",t.arg=r.arg)}}}function k(I,C){var t=C.method,A=I.iterator[t];if(A===g)return C.delegate=null,"throw"===t&&I.iterator.return&&(C.method="return",C.arg=g,k(I,C),"throw"===C.method)||"return"!==t&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+t+"' method")),h;var e=a(A,I.iterator,C.arg);if("throw"===e.type)return C.method="throw",C.arg=e.arg,C.delegate=null,h;var i=e.arg;return i?i.done?(C[I.resultName]=i.value,C.next=I.nextLoc,"return"!==C.method&&(C.method="next",C.arg=g),C.delegate=null,h):i:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,h)}function H(g){var I={tryLoc:g[0]};1 in g&&(I.catchLoc=g[1]),2 in g&&(I.finallyLoc=g[2],I.afterLoc=g[3]),this.tryEntries.push(I)}function J(g){var I=g.completion||{};I.type="normal",delete I.arg,g.completion=I}function K(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(H,this),this.reset(!0)}function W(I){if(I||""===I){var C=I[i];if(C)return C.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var A=-1,e=function C(){for(;++A<I.length;)if(t.call(I,A))return C.value=I[A],C.done=!1,C;return C.value=g,C.done=!0,C};return e.next=e}}throw new TypeError(ig(I)+" is not iterable")}return S.prototype=y,A(G,"constructor",{value:y,configurable:!0}),A(y,"constructor",{value:S,configurable:!0}),S.displayName=r(y,o,"GeneratorFunction"),I.isGeneratorFunction=function(g){var I="function"==typeof g&&g.constructor;return!!I&&(I===S||"GeneratorFunction"===(I.displayName||I.name))},I.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,r(g,o,"GeneratorFunction")),g.prototype=Object.create(G),g},I.awrap=function(g){return{__await:g}},p(w.prototype),r(w.prototype,n,(function(){return this})),I.AsyncIterator=w,I.async=function(g,C,t,A,e){void 0===e&&(e=Promise);var i=new w(s(g,C,t,A),e);return I.isGeneratorFunction(C)?i:i.next().then((function(g){return g.done?g.value:i.next()}))},p(G),r(G,o,"Generator"),r(G,i,(function(){return this})),r(G,"toString",(function(){return"[object Generator]"})),I.keys=function(g){var I=Object(g),C=[];for(var t in I)C.push(t);return C.reverse(),function g(){for(;C.length;){var t=C.pop();if(t in I)return g.value=t,g.done=!1,g}return g.done=!0,g}},I.values=W,K.prototype={constructor:K,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(J),!I)for(var C in this)"t"===C.charAt(0)&&t.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=g)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var C=this;function A(t,A){return n.type="throw",n.arg=I,C.next=t,A&&(C.method="next",C.arg=g),!!A}for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],n=i.completion;if("root"===i.tryLoc)return A("end");if(i.tryLoc<=this.prev){var o=t.call(i,"catchLoc"),r=t.call(i,"finallyLoc");if(o&&r){if(this.prev<i.catchLoc)return A(i.catchLoc,!0);if(this.prev<i.finallyLoc)return A(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return A(i.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return A(i.finallyLoc)}}}},abrupt:function(g,I){for(var C=this.tryEntries.length-1;C>=0;--C){var A=this.tryEntries[C];if(A.tryLoc<=this.prev&&t.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var e=A;break}}e&&("break"===g||"continue"===g)&&e.tryLoc<=I&&I<=e.finallyLoc&&(e=null);var i=e?e.completion:{};return i.type=g,i.arg=I,e?(this.method="next",this.next=e.finallyLoc,h):this.complete(i)},complete:function(g,I){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&I&&(this.next=I),h},finish:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.finallyLoc===g)return this.complete(C.completion,C.afterLoc),J(C),h}},catch:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.tryLoc===g){var t=C.completion;if("throw"===t.type){var A=t.arg;J(C)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(I,C,t){return this.delegate={iterator:W(I),resultName:C,nextLoc:t},"next"===this.method&&(this.arg=g),h}},I}function og(g,I){var C=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);I&&(t=t.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),C.push.apply(C,t)}return C}function rg(g){for(var I=1;I<arguments.length;I++){var C=null!=arguments[I]?arguments[I]:{};I%2?og(Object(C),!0).forEach((function(I){sg(g,I,C[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(C)):og(Object(C)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(C,I))}))}return g}function sg(g,I,C){return(I=function(g){var I=function(g,I){if("object"!==ig(g)||null===g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var t=C.call(g,I||"default");if("object"!==ig(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"===ig(I)?I:String(I)}(I))in g?Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):g[I]=C,g}function ag(g,I,C,t,A,e,i){try{var n=g[e](i),o=n.value}catch(g){return void C(g)}n.done?I(o):Promise.resolve(o).then(t,A)}function cg(g){return function(){var I=this,C=arguments;return new Promise((function(t,A){var e=g.apply(I,C);function i(g){ag(e,t,A,i,n,"next",g)}function n(g){ag(e,t,A,i,n,"throw",g)}i(void 0)}))}}var lg=864e5,ug=function(){var g=cg(ng().mark((function g(I){var C,t,A,e,i,n,o,r,s,a,c,l,u;return ng().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(C=I.user,t=void 0===C?"":C,A=I.errorCallback,e=I.offlineRecorder,i=void 0===e?null:e,n=function(g){return g},"function"==typeof A&&(n=A),t){g.next=5;break}return g.abrupt("return");case 5:if(o=Date.parse((new Date).toString()),!((r=window.localStorage.getItem("qn-logger-flag-".concat(t)))&&Number(r)&&o-Number(r)<lg)){g.next=9;break}return g.abrupt("return");case 9:if(!((s=yg(o))&&s>=3)){g.next=12;break}return g.abrupt("return");case 12:return g.next=14,(0,Cg.ML)(t);case 14:if(g.sent){g.next=17;break}return g.abrupt("return");case 17:return a=rg(rg({},I),{},{nowTimestamp:o,errorNum:s,errorCallback:n}),g.prev=18,g.next=21,Sg(i);case 21:c=g.sent,l=c.fileMd5,u=c.zipFile,l&&u&&dg(rg(rg({},a),{},{fileMd5:l,zipFile:u})),g.next=30;break;case 27:g.prev=27,g.t0=g.catch(18),n("worker执行失败");case 30:case"end":return g.stop()}}),g,null,[[18,27]])})));return function(I){return g.apply(this,arguments)}}(),dg=function(){var g=cg(ng().mark((function g(I){var C,t,A,e,i,n,o,r,s,a,c,l,u;return ng().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(C=I.user,t=void 0===C?"":C,A=I.errorCallback,e=I.dclConfig,i=I.customField,n=I.nowTimestamp,o=I.errorNum,r=I.fileMd5,s=I.zipFile,!r||!s){g.next=22;break}return g.next=4,hg({user:t,dclConfig:e,customField:i});case 4:if(a=g.sent,c=a.isSuccess,l=a.feedbackId,c){g.next=9;break}return g.abrupt("return");case 9:return g.next=11,mg({feedbackId:l,fileMd5:r,zipFile:s,dclConfig:e});case 11:if(u=g.sent){g.next=14;break}return g.abrupt("return");case 14:if(u.isUploadSuccess){g.next=18;break}return window.localStorage.setItem("qn-logger-error","".concat(o+1,";").concat(n)),A("qn-logger上传失败".concat(u.info)),g.abrupt("return");case 18:u.isAttachSuccess&&window.localStorage.setItem("qn-logger-flag-".concat(t),"".concat(n)),window.localStorage.setItem("qn-logger-error","0;".concat(n)),g.next=23;break;case 22:A("worker执行失败");case 23:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),hg=function(){var g=cg(ng().mark((function g(I){var C,t,A,e,i,n,o;return ng().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:t=I.user,A=void 0===t?"":t,e=I.dclConfig,i=I.customField,n=void 0;try{n=i?JSON.parse(i):{}}catch(g){console.log(g)}return g.next=5,(0,Cg.kc)({apiName:"feedbacks",user:A,dclConfig:e,method:"POST",data:{message:"".concat(A,"-反馈-").concat((new Date).toLocaleString()),levelId:"0",customField:n}});case 5:return o=g.sent,g.abrupt("return",{isSuccess:0===(null==o?void 0:o.errcode),feedbackId:null==o||null===(C=o.data)||void 0===C?void 0:C.id});case 7:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),mg=function(){var g=cg(ng().mark((function g(I){var C,t,A,e,i,n,o,r,s,a,c,l;return ng().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=I.feedbackId,i=I.fileMd5,n=I.zipFile,o=I.dclConfig,e){g.next=3;break}return g.abrupt("return");case 3:return r=eg(i),g.next=6,(0,Cg.kc)({apiName:"tmp-sign-url",method:"GET",dclConfig:o,params:{module:"client-feedback-attach",fileName:"".concat(i,".zip"),fileMd5:i}});case 6:if(0===(null==(s=g.sent)?void 0:s.errcode)){g.next=9;break}return g.abrupt("return");case 9:return a=s.data||{},c={contentMd5:r,url:null==a?void 0:a.tmpSignUrl,acl:null==a||null===(C=a.constraint)||void 0===C?void 0:C.acl,storageClass:null==a||null===(t=a.constraint)||void 0===t?void 0:t.storageClass,trafficLimit:null==a||null===(A=a.constraint)||void 0===A?void 0:A.trafficLimit},g.next=13,(0,Cg.xH)(n,c);case 13:if(200===g.sent){g.next=16;break}return g.abrupt("return",{isUploadSuccess:!1,isAttachSuccess:!1,info:JSON.stringify(c)});case 16:return g.next=18,(0,Cg.kc)({apiName:"update-attach",fid:e,dclConfig:o,method:"POST",data:{attach:[null==a?void 0:a.downloadUrl]}});case 18:if(0===(null==(l=g.sent)?void 0:l.errcode)){g.next=21;break}return g.abrupt("return",{isUploadSuccess:!0,isAttachSuccess:!1});case 21:return g.abrupt("return",{isUploadSuccess:!0,isAttachSuccess:!0});case 22:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),Sg=function(){var g=cg(ng().mark((function g(I){var C,t,A,e,i;return ng().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!window.Worker){g.next=2;break}return g.abrupt("return",new Promise((function(g,I){var C=new Ig;C.postMessage(null),C.onmessage=function(C){var t=C.data,A=t.fileMd5,e=t.zipFile;A&&e?g({fileMd5:A,zipFile:e}):I("worker执行失败")}})));case 2:if(I){g.next=4;break}return g.abrupt("return",{fileMd5:"",zipFile:null});case 4:return C=new(j()),g.next=7,I.getAllLogs();case 7:return"string"==typeof(t=g.sent)?C.file(s,t):C.file(s,JSON.stringify(t)),g.next=11,C.generateAsync({type:"blob"});case 11:return A=g.sent,g.next=14,Ag(A);case 14:return e=g.sent,i=new File([A],"".concat(e,".zip"),{type:"application/zip"}),g.abrupt("return",{fileMd5:e,zipFile:i});case 17:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),yg=function(g){var I=0,C=window.localStorage.getItem("qn-logger-error"),t=null==C?void 0:C.split(";");2===(null==t?void 0:t.length)&&(I=Number(t[0]),g-Number(t[1])>lg&&(I=0,window.localStorage.setItem("qn-logger-error","".concat(I,";").concat(g))));return I};function bg(g){return bg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},bg(g)}function Zg(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Zg=function(){return I};var g,I={},C=Object.prototype,t=C.hasOwnProperty,A=Object.defineProperty||function(g,I,C){g[I]=C.value},e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function r(g,I,C){return Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}),g[I]}try{r({},"")}catch(g){r=function(g,I,C){return g[I]=C}}function s(g,I,C,t){var e=I&&I.prototype instanceof m?I:m,i=Object.create(e.prototype),n=new K(t||[]);return A(i,"_invoke",{value:f(g,C,n)}),i}function a(g,I,C){try{return{type:"normal",arg:g.call(I,C)}}catch(g){return{type:"throw",arg:g}}}I.wrap=s;var c="suspendedStart",l="suspendedYield",u="executing",d="completed",h={};function m(){}function S(){}function y(){}var b={};r(b,i,(function(){return this}));var Z=Object.getPrototypeOf,B=Z&&Z(Z(W([])));B&&B!==C&&t.call(B,i)&&(b=B);var G=y.prototype=m.prototype=Object.create(b);function p(g){["next","throw","return"].forEach((function(I){r(g,I,(function(g){return this._invoke(I,g)}))}))}function w(g,I){function C(A,e,i,n){var o=a(g[A],g,e);if("throw"!==o.type){var r=o.arg,s=r.value;return s&&"object"==bg(s)&&t.call(s,"__await")?I.resolve(s.__await).then((function(g){C("next",g,i,n)}),(function(g){C("throw",g,i,n)})):I.resolve(s).then((function(g){r.value=g,i(r)}),(function(g){return C("throw",g,i,n)}))}n(o.arg)}var e;A(this,"_invoke",{value:function(g,t){function A(){return new I((function(I,A){C(g,t,I,A)}))}return e=e?e.then(A,A):A()}})}function f(I,C,t){var A=c;return function(e,i){if(A===u)throw new Error("Generator is already running");if(A===d){if("throw"===e)throw i;return{value:g,done:!0}}for(t.method=e,t.arg=i;;){var n=t.delegate;if(n){var o=k(n,t);if(o){if(o===h)continue;return o}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(A===c)throw A=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);A=u;var r=a(I,C,t);if("normal"===r.type){if(A=t.done?d:l,r.arg===h)continue;return{value:r.arg,done:t.done}}"throw"===r.type&&(A=d,t.method="throw",t.arg=r.arg)}}}function k(I,C){var t=C.method,A=I.iterator[t];if(A===g)return C.delegate=null,"throw"===t&&I.iterator.return&&(C.method="return",C.arg=g,k(I,C),"throw"===C.method)||"return"!==t&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+t+"' method")),h;var e=a(A,I.iterator,C.arg);if("throw"===e.type)return C.method="throw",C.arg=e.arg,C.delegate=null,h;var i=e.arg;return i?i.done?(C[I.resultName]=i.value,C.next=I.nextLoc,"return"!==C.method&&(C.method="next",C.arg=g),C.delegate=null,h):i:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,h)}function H(g){var I={tryLoc:g[0]};1 in g&&(I.catchLoc=g[1]),2 in g&&(I.finallyLoc=g[2],I.afterLoc=g[3]),this.tryEntries.push(I)}function J(g){var I=g.completion||{};I.type="normal",delete I.arg,g.completion=I}function K(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(H,this),this.reset(!0)}function W(I){if(I||""===I){var C=I[i];if(C)return C.call(I);if("function"==typeof I.next)return I;if(!isNaN(I.length)){var A=-1,e=function C(){for(;++A<I.length;)if(t.call(I,A))return C.value=I[A],C.done=!1,C;return C.value=g,C.done=!0,C};return e.next=e}}throw new TypeError(bg(I)+" is not iterable")}return S.prototype=y,A(G,"constructor",{value:y,configurable:!0}),A(y,"constructor",{value:S,configurable:!0}),S.displayName=r(y,o,"GeneratorFunction"),I.isGeneratorFunction=function(g){var I="function"==typeof g&&g.constructor;return!!I&&(I===S||"GeneratorFunction"===(I.displayName||I.name))},I.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,r(g,o,"GeneratorFunction")),g.prototype=Object.create(G),g},I.awrap=function(g){return{__await:g}},p(w.prototype),r(w.prototype,n,(function(){return this})),I.AsyncIterator=w,I.async=function(g,C,t,A,e){void 0===e&&(e=Promise);var i=new w(s(g,C,t,A),e);return I.isGeneratorFunction(C)?i:i.next().then((function(g){return g.done?g.value:i.next()}))},p(G),r(G,o,"Generator"),r(G,i,(function(){return this})),r(G,"toString",(function(){return"[object Generator]"})),I.keys=function(g){var I=Object(g),C=[];for(var t in I)C.push(t);return C.reverse(),function g(){for(;C.length;){var t=C.pop();if(t in I)return g.value=t,g.done=!1,g}return g.done=!0,g}},I.values=W,K.prototype={constructor:K,reset:function(I){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(J),!I)for(var C in this)"t"===C.charAt(0)&&t.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=g)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(I){if(this.done)throw I;var C=this;function A(t,A){return n.type="throw",n.arg=I,C.next=t,A&&(C.method="next",C.arg=g),!!A}for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],n=i.completion;if("root"===i.tryLoc)return A("end");if(i.tryLoc<=this.prev){var o=t.call(i,"catchLoc"),r=t.call(i,"finallyLoc");if(o&&r){if(this.prev<i.catchLoc)return A(i.catchLoc,!0);if(this.prev<i.finallyLoc)return A(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return A(i.catchLoc,!0)}else{if(!r)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return A(i.finallyLoc)}}}},abrupt:function(g,I){for(var C=this.tryEntries.length-1;C>=0;--C){var A=this.tryEntries[C];if(A.tryLoc<=this.prev&&t.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var e=A;break}}e&&("break"===g||"continue"===g)&&e.tryLoc<=I&&I<=e.finallyLoc&&(e=null);var i=e?e.completion:{};return i.type=g,i.arg=I,e?(this.method="next",this.next=e.finallyLoc,h):this.complete(i)},complete:function(g,I){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&I&&(this.next=I),h},finish:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.finallyLoc===g)return this.complete(C.completion,C.afterLoc),J(C),h}},catch:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var C=this.tryEntries[I];if(C.tryLoc===g){var t=C.completion;if("throw"===t.type){var A=t.arg;J(C)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(I,C,t){return this.delegate={iterator:W(I),resultName:C,nextLoc:t},"next"===this.method&&(this.arg=g),h}},I}function Bg(g,I){var C=Object.keys(g);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(g);I&&(t=t.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),C.push.apply(C,t)}return C}function Gg(g){for(var I=1;I<arguments.length;I++){var C=null!=arguments[I]?arguments[I]:{};I%2?Bg(Object(C),!0).forEach((function(I){pg(g,I,C[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(C)):Bg(Object(C)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(C,I))}))}return g}function pg(g,I,C){return(I=Hg(I))in g?Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):g[I]=C,g}function wg(g,I,C,t,A,e,i){try{var n=g[e](i),o=n.value}catch(g){return void C(g)}n.done?I(o):Promise.resolve(o).then(t,A)}function fg(g){return function(){var I=this,C=arguments;return new Promise((function(t,A){var e=g.apply(I,C);function i(g){wg(e,t,A,i,n,"next",g)}function n(g){wg(e,t,A,i,n,"throw",g)}i(void 0)}))}}function kg(g,I){for(var C=0;C<I.length;C++){var t=I[C];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(g,Hg(t.key),t)}}function Hg(g){var I=function(g,I){if("object"!==bg(g)||null===g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var t=C.call(g,I||"default");if("object"!==bg(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"===bg(I)?I:String(I)}var Jg=function(g){return g.log="__log",g}(Jg||{}),Kg=function(){function g(I){var C,t=this;!function(g,I){if(!(g instanceof I))throw new TypeError("Cannot call a class as a function")}(this,g),this.logQueueBeforeLoad=[],this.offlineRecorder=new E,this.options=I,"complete"===(null===(C=document)||void 0===C?void 0:C.readyState)?this.onPageLoad():"undefined"!=typeof window&&window.addEventListener("load",(function(){return t.onPageLoad()}))}var I,C,A,e,i,o,r;return I=g,C=[{key:"setNamespace",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.scopeName=g,this}},{key:"trace",value:function(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];this.logWrap.apply(this,["trace"].concat(I))}},{key:"debug",value:function(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];this.logWrap.apply(this,["debug"].concat(I))}},{key:"info",value:function(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];this.logWrap.apply(this,["info"].concat(I))}},{key:"log",value:function(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];this.logWrap.apply(this,["log"].concat(I))}},{key:"warn",value:function(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];this.logWrap.apply(this,["warn"].concat(I))}},{key:"error",value:function(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];this.logWrap.apply(this,["error"].concat(I))}},{key:"createDCL",value:(r=fg(Zg().mark((function g(I){var C,A,e;return Zg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,C=this.options,A=C.user,e=C.dclConfig,g.next=4,hg(Gg({user:A,dclConfig:e},I));case 4:return g.abrupt("return",g.sent);case 7:g.prev=7,g.t0=g.catch(0),t(this.options.errorHandler)&&this.options.errorHandler(g.t0);case 10:case"end":return g.stop()}}),g,this,[[0,7]])}))),function(g){return r.apply(this,arguments)})},{key:"uploadLogToDCL",value:(o=fg(Zg().mark((function g(I){var C,A,e,i;return Zg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,Sg(this.offlineRecorder);case 3:return C=g.sent,A=C.fileMd5,e=C.zipFile,i=this.options.dclConfig,g.next=9,mg({feedbackId:I,fileMd5:A,zipFile:e,dclConfig:i});case 9:return g.abrupt("return",g.sent);case 12:g.prev=12,g.t0=g.catch(0),t(this.options.errorHandler)&&this.options.errorHandler(g.t0);case 15:case"end":return g.stop()}}),g,this,[[0,12]])}))),function(g){return o.apply(this,arguments)})},{key:"report",value:(i=fg(Zg().mark((function g(I){var C,A,e,i;return Zg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:try{C=this.options,A=C.user,e=C.dclConfig,i=C.errorHandler,ug(Gg(Gg({user:A,dclConfig:e},I),{},{offlineRecorder:this.offlineRecorder,errorCallback:i}))}catch(g){t(this.options.errorHandler)&&this.options.errorHandler(g)}case 1:case"end":return g.stop()}}),g,this)}))),function(g){return i.apply(this,arguments)})},{key:"logWrap",value:function(g){for(var I,C=this.scopeName,t="[".concat(g,"][").concat((I=new Date,"".concat(I.getFullYear(),"-").concat(I.getMonth()+1,"-").concat(I.getDate()," ").concat(I.getHours(),":").concat(I.getMinutes(),":").concat(I.getSeconds(),".").concat(I.getMilliseconds())),"]").concat(C?"[".concat(C,"]"):""),A=arguments.length,e=new Array(A>1?A-1:0),i=1;i<A;i++)e[i-1]=arguments[i];var n=e.map((function(g){return JSON.stringify(g)})).join(","),o="".concat(t," ").concat(n);this.enableConsoleOutput()&&console[g](o),this.logIfLoaded(o)}},{key:"enableConsoleOutput",value:function(){return!!n(Jg.log)}},{key:"logAsync",value:(e=fg(Zg().mark((function g(I){return Zg().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:try{this.offlineRecorder.storeOfflineLog(I)}catch(g){t(this.options.errorHandler)&&this.options.errorHandler(g)}case 1:case"end":return g.stop()}}),g,this)}))),function(g){return e.apply(this,arguments)})},{key:"logIfLoaded",value:function(g){!document.readyState||document.readyState&&"complete"===document.readyState?this.logAsync(g):this.logQueueBeforeLoad.push(g)}},{key:"onPageLoad",value:function(){var g=this,I=this.options.autoReport;(void 0===I||I)&&this.report(),this.logQueueBeforeLoad.forEach((function(I){g.logAsync(I)})),this.logQueueBeforeLoad=[],window.removeEventListener("load",(function(){return g.onPageLoad()}))}}],C&&kg(I.prototype,C),A&&kg(I,A),Object.defineProperty(I,"prototype",{writable:!1}),g}()},"../../node_modules/.pnpm/@tencent+qn-utils@1.1.31/node_modules/@tencent/qn-utils/es/device/index.js":
/*!***********************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@tencent+qn-utils@1.1.31/node_modules/@tencent/qn-utils/es/device/index.js ***!
  \***********************************************************************************************************/function(g,I,C){"use strict";function t(g){var I,C=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")||"undefined"!=typeof window&&(null===(I=window)||void 0===I||null===(I=I.navigator)||void 0===I?void 0:I.userAgent);return g?C.toLowerCase():C}C.d(I,{tq:function(){return A}});var A=function(g){return/android|webos|iphone|ipad|ipod|blackberry|opera mini|harmony|mobile/i.test(t("l",g))}},"../../node_modules/.pnpm/jszip@3.10.1/node_modules/jszip/dist/jszip.min.js":
/*!**********************************************************************************!*\
  !*** ../../node_modules/.pnpm/jszip@3.10.1/node_modules/jszip/dist/jszip.min.js ***!
  \**********************************************************************************/function(g,I,C){var t,A,e,i;function n(g){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},n(g)
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/}i=function(){return function g(I,C,t){function A(i,n){if(!C[i]){if(!I[i]){if(e)return e(i,!0);var o=new Error("Cannot find module '"+i+"'");throw o.code="MODULE_NOT_FOUND",o}var r=C[i]={exports:{}};I[i][0].call(r.exports,(function(g){return A(I[i][1][g]||g)}),r,r.exports,g,I,C,t)}return C[i].exports}for(var e=void 0,i=0;i<t.length;i++)A(t[i]);return A}({1:[function(g,I,C){"use strict";var t=g("./utils"),A=g("./support"),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.encode=function(g){for(var I,C,A,i,n,o,r,s=[],a=0,c=g.length,l=c,u="string"!==t.getTypeOf(g);a<g.length;)l=c-a,A=u?(I=g[a++],C=a<c?g[a++]:0,a<c?g[a++]:0):(I=g.charCodeAt(a++),C=a<c?g.charCodeAt(a++):0,a<c?g.charCodeAt(a++):0),i=I>>2,n=(3&I)<<4|C>>4,o=1<l?(15&C)<<2|A>>6:64,r=2<l?63&A:64,s.push(e.charAt(i)+e.charAt(n)+e.charAt(o)+e.charAt(r));return s.join("")},C.decode=function(g){var I,C,t,i,n,o,r=0,s=0,a="data:";if(g.substr(0,5)===a)throw new Error("Invalid base64 input, it looks like a data url.");var c,l=3*(g=g.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(g.charAt(g.length-1)===e.charAt(64)&&l--,g.charAt(g.length-2)===e.charAt(64)&&l--,l%1!=0)throw new Error("Invalid base64 input, bad content length.");for(c=A.uint8array?new Uint8Array(0|l):new Array(0|l);r<g.length;)I=e.indexOf(g.charAt(r++))<<2|(i=e.indexOf(g.charAt(r++)))>>4,C=(15&i)<<4|(n=e.indexOf(g.charAt(r++)))>>2,t=(3&n)<<6|(o=e.indexOf(g.charAt(r++))),c[s++]=I,64!==n&&(c[s++]=C),64!==o&&(c[s++]=t);return c}},{"./support":30,"./utils":32}],2:[function(g,I,C){"use strict";var t=g("./external"),A=g("./stream/DataWorker"),e=g("./stream/Crc32Probe"),i=g("./stream/DataLengthProbe");function n(g,I,C,t,A){this.compressedSize=g,this.uncompressedSize=I,this.crc32=C,this.compression=t,this.compressedContent=A}n.prototype={getContentWorker:function(){var g=new A(t.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),I=this;return g.on("end",(function(){if(this.streamInfo.data_length!==I.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),g},getCompressedWorker:function(){return new A(t.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},n.createWorkerFrom=function(g,I,C){return g.pipe(new e).pipe(new i("uncompressedSize")).pipe(I.compressWorker(C)).pipe(new i("compressedSize")).withStreamInfo("compression",I)},I.exports=n},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(g,I,C){"use strict";var t=g("./stream/GenericWorker");C.STORE={magic:"\0\0",compressWorker:function(){return new t("STORE compression")},uncompressWorker:function(){return new t("STORE decompression")}},C.DEFLATE=g("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(g,I,C){"use strict";var t=g("./utils"),A=function(){for(var g,I=[],C=0;C<256;C++){g=C;for(var t=0;t<8;t++)g=1&g?3988292384^g>>>1:g>>>1;I[C]=g}return I}();I.exports=function(g,I){return void 0!==g&&g.length?"string"!==t.getTypeOf(g)?function(g,I,C,t){var e=A,i=0+C;g^=-1;for(var n=0;n<i;n++)g=g>>>8^e[255&(g^I[n])];return-1^g}(0|I,g,g.length):function(g,I,C,t){var e=A,i=0+C;g^=-1;for(var n=0;n<i;n++)g=g>>>8^e[255&(g^I.charCodeAt(n))];return-1^g}(0|I,g,g.length):0}},{"./utils":32}],5:[function(g,I,C){"use strict";C.base64=!1,C.binary=!1,C.dir=!1,C.createFolders=!0,C.date=null,C.compression=null,C.compressionOptions=null,C.comment=null,C.unixPermissions=null,C.dosPermissions=null},{}],6:[function(g,I,C){"use strict";var t;t="undefined"!=typeof Promise?Promise:g("lie"),I.exports={Promise:t}},{lie:37}],7:[function(g,I,C){"use strict";var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,A=g("pako"),e=g("./utils"),i=g("./stream/GenericWorker"),n=t?"uint8array":"array";function o(g,I){i.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=I,this.meta={}}C.magic="\b\0",e.inherits(o,i),o.prototype.processChunk=function(g){this.meta=g.meta,null===this._pako&&this._createPako(),this._pako.push(e.transformTo(n,g.data),!1)},o.prototype.flush=function(){i.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this._pako=null},o.prototype._createPako=function(){this._pako=new A[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(I){g.push({data:I,meta:g.meta})}},C.compressWorker=function(g){return new o("Deflate",g)},C.uncompressWorker=function(){return new o("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(g,I,C){"use strict";function t(g,I){var C,t="";for(C=0;C<I;C++)t+=String.fromCharCode(255&g),g>>>=8;return t}function A(g,I,C,A,i,s){var a,c,l=g.file,u=g.compression,d=s!==n.utf8encode,h=e.transformTo("string",s(l.name)),m=e.transformTo("string",n.utf8encode(l.name)),S=l.comment,y=e.transformTo("string",s(S)),b=e.transformTo("string",n.utf8encode(S)),Z=m.length!==l.name.length,B=b.length!==S.length,G="",p="",w="",f=l.dir,k=l.date,H={crc32:0,compressedSize:0,uncompressedSize:0};I&&!C||(H.crc32=g.crc32,H.compressedSize=g.compressedSize,H.uncompressedSize=g.uncompressedSize);var J=0;I&&(J|=8),d||!Z&&!B||(J|=2048);var K=0,W=0;f&&(K|=16),"UNIX"===i?(W=798,K|=function(g,I){var C=g;return g||(C=I?16893:33204),(65535&C)<<16}(l.unixPermissions,f)):(W=20,K|=function(g){return 63&(g||0)}(l.dosPermissions)),a=k.getUTCHours(),a<<=6,a|=k.getUTCMinutes(),a<<=5,a|=k.getUTCSeconds()/2,c=k.getUTCFullYear()-1980,c<<=4,c|=k.getUTCMonth()+1,c<<=5,c|=k.getUTCDate(),Z&&(p=t(1,1)+t(o(h),4)+m,G+="up"+t(p.length,2)+p),B&&(w=t(1,1)+t(o(y),4)+b,G+="uc"+t(w.length,2)+w);var V="";return V+="\n\0",V+=t(J,2),V+=u.magic,V+=t(a,2),V+=t(c,2),V+=t(H.crc32,4),V+=t(H.compressedSize,4),V+=t(H.uncompressedSize,4),V+=t(h.length,2),V+=t(G.length,2),{fileRecord:r.LOCAL_FILE_HEADER+V+h+G,dirRecord:r.CENTRAL_FILE_HEADER+t(W,2)+V+t(y.length,2)+"\0\0\0\0"+t(K,4)+t(A,4)+h+G+y}}var e=g("../utils"),i=g("../stream/GenericWorker"),n=g("../utf8"),o=g("../crc32"),r=g("../signature");function s(g,I,C,t){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=C,this.encodeFileName=t,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}e.inherits(s,i),s.prototype.push=function(g){var I=g.meta.percent||0,C=this.entriesCount,t=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,i.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:C?(I+100*(C-t-1))/C:100}}))},s.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var I=this.streamFiles&&!g.file.dir;if(I){var C=A(g,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:C.fileRecord,meta:{percent:0}})}else this.accumulate=!0},s.prototype.closedSource=function(g){this.accumulate=!1;var I=this.streamFiles&&!g.file.dir,C=A(g,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(C.dirRecord),I)this.push({data:function(g){return r.DATA_DESCRIPTOR+t(g.crc32,4)+t(g.compressedSize,4)+t(g.uncompressedSize,4)}(g),meta:{percent:100}});else for(this.push({data:C.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},s.prototype.flush=function(){for(var g=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var C=this.bytesWritten-g,A=function(g,I,C,A,i){var n=e.transformTo("string",i(A));return r.CENTRAL_DIRECTORY_END+"\0\0\0\0"+t(g,2)+t(g,2)+t(I,4)+t(C,4)+t(n.length,2)+n}(this.dirRecords.length,C,g,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},s.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},s.prototype.registerPrevious=function(g){this._sources.push(g);var I=this;return g.on("data",(function(g){I.processChunk(g)})),g.on("end",(function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()})),g.on("error",(function(g){I.error(g)})),this},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},s.prototype.error=function(g){var I=this._sources;if(!i.prototype.error.call(this,g))return!1;for(var C=0;C<I.length;C++)try{I[C].error(g)}catch(g){}return!0},s.prototype.lock=function(){i.prototype.lock.call(this);for(var g=this._sources,I=0;I<g.length;I++)g[I].lock()},I.exports=s},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(g,I,C){"use strict";var t=g("../compressions"),A=g("./ZipFileWorker");C.generateWorker=function(g,I,C){var e=new A(I.streamFiles,C,I.platform,I.encodeFileName),i=0;try{g.forEach((function(g,C){i++;var A=function(g,I){var C=g||I,A=t[C];if(!A)throw new Error(C+" is not a valid compression method !");return A}(C.options.compression,I.compression),n=C.options.compressionOptions||I.compressionOptions||{},o=C.dir,r=C.date;C._compressWorker(A,n).withStreamInfo("file",{name:g,dir:o,date:r,comment:C.comment||"",unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions}).pipe(e)})),e.entriesCount=i}catch(g){e.error(g)}return e}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(g,I,C){"use strict";function t(){if(!(this instanceof t))return new t;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var g=new t;for(var I in this)"function"!=typeof this[I]&&(g[I]=this[I]);return g}}(t.prototype=g("./object")).loadAsync=g("./load"),t.support=g("./support"),t.defaults=g("./defaults"),t.version="3.10.1",t.loadAsync=function(g,I){return(new t).loadAsync(g,I)},t.external=g("./external"),I.exports=t},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(g,I,C){"use strict";var t=g("./utils"),A=g("./external"),e=g("./utf8"),i=g("./zipEntries"),n=g("./stream/Crc32Probe"),o=g("./nodejsUtils");function r(g){return new A.Promise((function(I,C){var t=g.decompressed.getContentWorker().pipe(new n);t.on("error",(function(g){C(g)})).on("end",(function(){t.streamInfo.crc32!==g.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):I()})).resume()}))}I.exports=function(g,I){var C=this;return I=t.extend(I||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:e.utf8decode}),o.isNode&&o.isStream(g)?A.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):t.prepareContent("the loaded zip file",g,!0,I.optimizedBinaryString,I.base64).then((function(g){var C=new i(I);return C.load(g),C})).then((function(g){var C=[A.Promise.resolve(g)],t=g.files;if(I.checkCRC32)for(var e=0;e<t.length;e++)C.push(r(t[e]));return A.Promise.all(C)})).then((function(g){for(var A=g.shift(),e=A.files,i=0;i<e.length;i++){var n=e[i],o=n.fileNameStr,r=t.resolve(n.fileNameStr);C.file(r,n.decompressed,{binary:!0,optimizedBinaryString:!0,date:n.date,dir:n.dir,comment:n.fileCommentStr.length?n.fileCommentStr:null,unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions,createFolders:I.createFolders}),n.dir||(C.file(r).unsafeOriginalName=o)}return A.zipComment.length&&(C.comment=A.zipComment),C}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(g,I,C){"use strict";var t=g("../utils"),A=g("../stream/GenericWorker");function e(g,I){A.call(this,"Nodejs stream input adapter for "+g),this._upstreamEnded=!1,this._bindStream(I)}t.inherits(e,A),e.prototype._bindStream=function(g){var I=this;(this._stream=g).pause(),g.on("data",(function(g){I.push({data:g,meta:{percent:0}})})).on("error",(function(g){I.isPaused?this.generatedError=g:I.error(g)})).on("end",(function(){I.isPaused?I._upstreamEnded=!0:I.end()}))},e.prototype.pause=function(){return!!A.prototype.pause.call(this)&&(this._stream.pause(),!0)},e.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},I.exports=e},{"../stream/GenericWorker":28,"../utils":32}],13:[function(g,I,C){"use strict";var t=g("readable-stream").Readable;function A(g,I,C){t.call(this,I),this._helper=g;var A=this;g.on("data",(function(g,I){A.push(g)||A._helper.pause(),C&&C(I)})).on("error",(function(g){A.emit("error",g)})).on("end",(function(){A.push(null)}))}g("../utils").inherits(A,t),A.prototype._read=function(){this._helper.resume()},I.exports=A},{"../utils":32,"readable-stream":16}],14:[function(g,I,C){"use strict";I.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(g,I){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(g,I);if("number"==typeof g)throw new Error('The "data" argument must not be a number');return new Buffer(g,I)},allocBuffer:function(g){if(Buffer.alloc)return Buffer.alloc(g);var I=new Buffer(g);return I.fill(0),I},isBuffer:function(g){return Buffer.isBuffer(g)},isStream:function(g){return g&&"function"==typeof g.on&&"function"==typeof g.pause&&"function"==typeof g.resume}}},{}],15:[function(g,I,C){"use strict";function t(g,I,C){var t,A=e.getTypeOf(I),n=e.extend(C||{},o);n.date=n.date||new Date,null!==n.compression&&(n.compression=n.compression.toUpperCase()),"string"==typeof n.unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(g=d(g)),n.createFolders&&(t=u(g))&&h.call(this,t,!0);var a,m="string"===A&&!1===n.binary&&!1===n.base64;C&&void 0!==C.binary||(n.binary=!m),(I instanceof r&&0===I.uncompressedSize||n.dir||!I||0===I.length)&&(n.base64=!1,n.binary=!0,I="",n.compression="STORE",A="string"),a=I instanceof r||I instanceof i?I:c.isNode&&c.isStream(I)?new l(g,I):e.prepareContent(g,I,n.binary,n.optimizedBinaryString,n.base64);var S=new s(g,a,n);this.files[g]=S}var A=g("./utf8"),e=g("./utils"),i=g("./stream/GenericWorker"),n=g("./stream/StreamHelper"),o=g("./defaults"),r=g("./compressedObject"),s=g("./zipObject"),a=g("./generate"),c=g("./nodejsUtils"),l=g("./nodejs/NodejsStreamInputAdapter"),u=function(g){"/"===g.slice(-1)&&(g=g.substring(0,g.length-1));var I=g.lastIndexOf("/");return 0<I?g.substring(0,I):""},d=function(g){return"/"!==g.slice(-1)&&(g+="/"),g},h=function(g,I){return I=void 0!==I?I:o.createFolders,g=d(g),this.files[g]||t.call(this,g,null,{dir:!0,createFolders:I}),this.files[g]};function m(g){return"[object RegExp]"===Object.prototype.toString.call(g)}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(g){var I,C,t;for(I in this.files)t=this.files[I],(C=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&g(C,t)},filter:function(g){var I=[];return this.forEach((function(C,t){g(C,t)&&I.push(t)})),I},file:function(g,I,C){if(1!==arguments.length)return g=this.root+g,t.call(this,g,I,C),this;if(m(g)){var A=g;return this.filter((function(g,I){return!I.dir&&A.test(g)}))}var e=this.files[this.root+g];return e&&!e.dir?e:null},folder:function(g){if(!g)return this;if(m(g))return this.filter((function(I,C){return C.dir&&g.test(I)}));var I=this.root+g,C=h.call(this,I),t=this.clone();return t.root=C.name,t},remove:function(g){g=this.root+g;var I=this.files[g];if(I||("/"!==g.slice(-1)&&(g+="/"),I=this.files[g]),I&&!I.dir)delete this.files[g];else for(var C=this.filter((function(I,C){return C.name.slice(0,g.length)===g})),t=0;t<C.length;t++)delete this.files[C[t].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(g){var I,C={};try{if((C=e.extend(g||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:A.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),"binarystring"===C.type&&(C.type="string"),!C.type)throw new Error("No output type specified.");e.checkSupport(C.type),"darwin"!==C.platform&&"freebsd"!==C.platform&&"linux"!==C.platform&&"sunos"!==C.platform||(C.platform="UNIX"),"win32"===C.platform&&(C.platform="DOS");var t=C.comment||this.comment||"";I=a.generateWorker(this,C,t)}catch(g){(I=new i("error")).error(g)}return new n(I,C.type||"string",C.mimeType)},generateAsync:function(g,I){return this.generateInternalStream(g).accumulate(I)},generateNodeStream:function(g,I){return(g=g||{}).type||(g.type="nodebuffer"),this.generateInternalStream(g).toNodejsStream(I)}};I.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(g,I,C){"use strict";I.exports=g("stream")},{stream:void 0}],17:[function(g,I,C){"use strict";var t=g("./DataReader");function A(g){t.call(this,g);for(var I=0;I<this.data.length;I++)g[I]=255&g[I]}g("../utils").inherits(A,t),A.prototype.byteAt=function(g){return this.data[this.zero+g]},A.prototype.lastIndexOfSignature=function(g){for(var I=g.charCodeAt(0),C=g.charCodeAt(1),t=g.charCodeAt(2),A=g.charCodeAt(3),e=this.length-4;0<=e;--e)if(this.data[e]===I&&this.data[e+1]===C&&this.data[e+2]===t&&this.data[e+3]===A)return e-this.zero;return-1},A.prototype.readAndCheckSignature=function(g){var I=g.charCodeAt(0),C=g.charCodeAt(1),t=g.charCodeAt(2),A=g.charCodeAt(3),e=this.readData(4);return I===e[0]&&C===e[1]&&t===e[2]&&A===e[3]},A.prototype.readData=function(g){if(this.checkOffset(g),0===g)return[];var I=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,I},I.exports=A},{"../utils":32,"./DataReader":18}],18:[function(g,I,C){"use strict";var t=g("../utils");function A(g){this.data=g,this.length=g.length,this.index=0,this.zero=0}A.prototype={checkOffset:function(g){this.checkIndex(this.index+g)},checkIndex:function(g){if(this.length<this.zero+g||g<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+g+"). Corrupted zip ?")},setIndex:function(g){this.checkIndex(g),this.index=g},skip:function(g){this.setIndex(this.index+g)},byteAt:function(){},readInt:function(g){var I,C=0;for(this.checkOffset(g),I=this.index+g-1;I>=this.index;I--)C=(C<<8)+this.byteAt(I);return this.index+=g,C},readString:function(g){return t.transformTo("string",this.readData(g))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var g=this.readInt(4);return new Date(Date.UTC(1980+(g>>25&127),(g>>21&15)-1,g>>16&31,g>>11&31,g>>5&63,(31&g)<<1))}},I.exports=A},{"../utils":32}],19:[function(g,I,C){"use strict";var t=g("./Uint8ArrayReader");function A(g){t.call(this,g)}g("../utils").inherits(A,t),A.prototype.readData=function(g){this.checkOffset(g);var I=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,I},I.exports=A},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(g,I,C){"use strict";var t=g("./DataReader");function A(g){t.call(this,g)}g("../utils").inherits(A,t),A.prototype.byteAt=function(g){return this.data.charCodeAt(this.zero+g)},A.prototype.lastIndexOfSignature=function(g){return this.data.lastIndexOf(g)-this.zero},A.prototype.readAndCheckSignature=function(g){return g===this.readData(4)},A.prototype.readData=function(g){this.checkOffset(g);var I=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,I},I.exports=A},{"../utils":32,"./DataReader":18}],21:[function(g,I,C){"use strict";var t=g("./ArrayReader");function A(g){t.call(this,g)}g("../utils").inherits(A,t),A.prototype.readData=function(g){if(this.checkOffset(g),0===g)return new Uint8Array(0);var I=this.data.subarray(this.zero+this.index,this.zero+this.index+g);return this.index+=g,I},I.exports=A},{"../utils":32,"./ArrayReader":17}],22:[function(g,I,C){"use strict";var t=g("../utils"),A=g("../support"),e=g("./ArrayReader"),i=g("./StringReader"),n=g("./NodeBufferReader"),o=g("./Uint8ArrayReader");I.exports=function(g){var I=t.getTypeOf(g);return t.checkSupport(I),"string"!==I||A.uint8array?"nodebuffer"===I?new n(g):A.uint8array?new o(t.transformTo("uint8array",g)):new e(t.transformTo("array",g)):new i(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(g,I,C){"use strict";C.LOCAL_FILE_HEADER="PK",C.CENTRAL_FILE_HEADER="PK",C.CENTRAL_DIRECTORY_END="PK",C.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",C.ZIP64_CENTRAL_DIRECTORY_END="PK",C.DATA_DESCRIPTOR="PK\b"},{}],24:[function(g,I,C){"use strict";var t=g("./GenericWorker"),A=g("../utils");function e(g){t.call(this,"ConvertWorker to "+g),this.destType=g}A.inherits(e,t),e.prototype.processChunk=function(g){this.push({data:A.transformTo(this.destType,g.data),meta:g.meta})},I.exports=e},{"../utils":32,"./GenericWorker":28}],25:[function(g,I,C){"use strict";var t=g("./GenericWorker"),A=g("../crc32");function e(){t.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}g("../utils").inherits(e,t),e.prototype.processChunk=function(g){this.streamInfo.crc32=A(g.data,this.streamInfo.crc32||0),this.push(g)},I.exports=e},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(g,I,C){"use strict";var t=g("../utils"),A=g("./GenericWorker");function e(g){A.call(this,"DataLengthProbe for "+g),this.propName=g,this.withStreamInfo(g,0)}t.inherits(e,A),e.prototype.processChunk=function(g){if(g){var I=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=I+g.data.length}A.prototype.processChunk.call(this,g)},I.exports=e},{"../utils":32,"./GenericWorker":28}],27:[function(g,I,C){"use strict";var t=g("../utils"),A=g("./GenericWorker");function e(g){A.call(this,"DataWorker");var I=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,g.then((function(g){I.dataIsReady=!0,I.data=g,I.max=g&&g.length||0,I.type=t.getTypeOf(g),I.isPaused||I._tickAndRepeat()}),(function(g){I.error(g)}))}t.inherits(e,A),e.prototype.cleanUp=function(){A.prototype.cleanUp.call(this),this.data=null},e.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,t.delay(this._tickAndRepeat,[],this)),!0)},e.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(t.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},e.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var g=null,I=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":g=this.data.substring(this.index,I);break;case"uint8array":g=this.data.subarray(this.index,I);break;case"array":case"nodebuffer":g=this.data.slice(this.index,I)}return this.index=I,this.push({data:g,meta:{percent:this.max?this.index/this.max*100:0}})},I.exports=e},{"../utils":32,"./GenericWorker":28}],28:[function(g,I,C){"use strict";function t(g){this.name=g||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}t.prototype={push:function(g){this.emit("data",g)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(g){this.emit("error",g)}return!0},error:function(g){return!this.isFinished&&(this.isPaused?this.generatedError=g:(this.isFinished=!0,this.emit("error",g),this.previous&&this.previous.error(g),this.cleanUp()),!0)},on:function(g,I){return this._listeners[g].push(I),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(g,I){if(this._listeners[g])for(var C=0;C<this._listeners[g].length;C++)this._listeners[g][C].call(this,I)},pipe:function(g){return g.registerPrevious(this)},registerPrevious:function(g){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=g.streamInfo,this.mergeStreamInfo(),this.previous=g;var I=this;return g.on("data",(function(g){I.processChunk(g)})),g.on("end",(function(){I.end()})),g.on("error",(function(g){I.error(g)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var g=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),g=!0),this.previous&&this.previous.resume(),!g},flush:function(){},processChunk:function(g){this.push(g)},withStreamInfo:function(g,I){return this.extraStreamInfo[g]=I,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var g in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,g)&&(this.streamInfo[g]=this.extraStreamInfo[g])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var g="Worker "+this.name;return this.previous?this.previous+" -> "+g:g}},I.exports=t},{}],29:[function(g,I,C){"use strict";var t=g("../utils"),A=g("./ConvertWorker"),e=g("./GenericWorker"),i=g("../base64"),n=g("../support"),o=g("../external"),r=null;if(n.nodestream)try{r=g("../nodejs/NodejsStreamOutputAdapter")}catch(g){}function s(g,I,C){var i=I;switch(I){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=I,this._mimeType=C,t.checkSupport(i),this._worker=g.pipe(new A(i)),g.lock()}catch(g){this._worker=new e("error"),this._worker.error(g)}}s.prototype={accumulate:function(g){return function(g,I){return new o.Promise((function(C,A){var e=[],n=g._internalType,o=g._outputType,r=g._mimeType;g.on("data",(function(g,C){e.push(g),I&&I(C)})).on("error",(function(g){e=[],A(g)})).on("end",(function(){try{var g=function(g,I,C){switch(g){case"blob":return t.newBlob(t.transformTo("arraybuffer",I),C);case"base64":return i.encode(I);default:return t.transformTo(g,I)}}(o,function(g,I){var C,t=0,A=null,e=0;for(C=0;C<I.length;C++)e+=I[C].length;switch(g){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(A=new Uint8Array(e),C=0;C<I.length;C++)A.set(I[C],t),t+=I[C].length;return A;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+g+"'")}}(n,e),r);C(g)}catch(g){A(g)}e=[]})).resume()}))}(this,g)},on:function(g,I){var C=this;return"data"===g?this._worker.on(g,(function(g){I.call(C,g.data,g.meta)})):this._worker.on(g,(function(){t.delay(I,arguments,C)})),this},resume:function(){return t.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(t.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new r(this,{objectMode:"nodebuffer"!==this._outputType},g)}},I.exports=s},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(g,I,C){"use strict";if(C.base64=!0,C.array=!0,C.string=!0,C.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,C.nodebuffer="undefined"!=typeof Buffer,C.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)C.blob=!1;else{var t=new ArrayBuffer(0);try{C.blob=0===new Blob([t],{type:"application/zip"}).size}catch(g){try{var A=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);A.append(t),C.blob=0===A.getBlob("application/zip").size}catch(g){C.blob=!1}}}try{C.nodestream=!!g("readable-stream").Readable}catch(g){C.nodestream=!1}},{"readable-stream":16}],31:[function(g,I,C){"use strict";for(var t=g("./utils"),A=g("./support"),e=g("./nodejsUtils"),i=g("./stream/GenericWorker"),n=new Array(256),o=0;o<256;o++)n[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function r(){i.call(this,"utf-8 decode"),this.leftOver=null}function s(){i.call(this,"utf-8 encode")}n[254]=n[254]=1,C.utf8encode=function(g){return A.nodebuffer?e.newBufferFrom(g,"utf-8"):function(g){var I,C,t,e,i,n=g.length,o=0;for(e=0;e<n;e++)55296==(64512&(C=g.charCodeAt(e)))&&e+1<n&&56320==(64512&(t=g.charCodeAt(e+1)))&&(C=65536+(C-55296<<10)+(t-56320),e++),o+=C<128?1:C<2048?2:C<65536?3:4;for(I=A.uint8array?new Uint8Array(o):new Array(o),e=i=0;i<o;e++)55296==(64512&(C=g.charCodeAt(e)))&&e+1<n&&56320==(64512&(t=g.charCodeAt(e+1)))&&(C=65536+(C-55296<<10)+(t-56320),e++),C<128?I[i++]=C:(C<2048?I[i++]=192|C>>>6:(C<65536?I[i++]=224|C>>>12:(I[i++]=240|C>>>18,I[i++]=128|C>>>12&63),I[i++]=128|C>>>6&63),I[i++]=128|63&C);return I}(g)},C.utf8decode=function(g){return A.nodebuffer?t.transformTo("nodebuffer",g).toString("utf-8"):function(g){var I,C,A,e,i=g.length,o=new Array(2*i);for(I=C=0;I<i;)if((A=g[I++])<128)o[C++]=A;else if(4<(e=n[A]))o[C++]=65533,I+=e-1;else{for(A&=2===e?31:3===e?15:7;1<e&&I<i;)A=A<<6|63&g[I++],e--;1<e?o[C++]=65533:A<65536?o[C++]=A:(A-=65536,o[C++]=55296|A>>10&1023,o[C++]=56320|1023&A)}return o.length!==C&&(o.subarray?o=o.subarray(0,C):o.length=C),t.applyFromCharCode(o)}(g=t.transformTo(A.uint8array?"uint8array":"array",g))},t.inherits(r,i),r.prototype.processChunk=function(g){var I=t.transformTo(A.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(A.uint8array){var e=I;(I=new Uint8Array(e.length+this.leftOver.length)).set(this.leftOver,0),I.set(e,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var i=function(g,I){var C;for((I=I||g.length)>g.length&&(I=g.length),C=I-1;0<=C&&128==(192&g[C]);)C--;return C<0||0===C?I:C+n[g[C]]>I?C:I}(I),o=I;i!==I.length&&(A.uint8array?(o=I.subarray(0,i),this.leftOver=I.subarray(i,I.length)):(o=I.slice(0,i),this.leftOver=I.slice(i,I.length))),this.push({data:C.utf8decode(o),meta:g.meta})},r.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:C.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},C.Utf8DecodeWorker=r,t.inherits(s,i),s.prototype.processChunk=function(g){this.push({data:C.utf8encode(g.data),meta:g.meta})},C.Utf8EncodeWorker=s},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(g,I,C){"use strict";var t=g("./support"),A=g("./base64"),e=g("./nodejsUtils"),i=g("./external");function n(g){return g}function o(g,I){for(var C=0;C<g.length;++C)I[C]=255&g.charCodeAt(C);return I}g("setimmediate"),C.newBlob=function(g,I){C.checkSupport("blob");try{return new Blob([g],{type:I})}catch(C){try{var t=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return t.append(g),t.getBlob(I)}catch(g){throw new Error("Bug : can't construct the Blob.")}}};var r={stringifyByChunk:function(g,I,C){var t=[],A=0,e=g.length;if(e<=C)return String.fromCharCode.apply(null,g);for(;A<e;)"array"===I||"nodebuffer"===I?t.push(String.fromCharCode.apply(null,g.slice(A,Math.min(A+C,e)))):t.push(String.fromCharCode.apply(null,g.subarray(A,Math.min(A+C,e)))),A+=C;return t.join("")},stringifyByChar:function(g){for(var I="",C=0;C<g.length;C++)I+=String.fromCharCode(g[C]);return I},applyCanBeUsed:{uint8array:function(){try{return t.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(g){return!1}}(),nodebuffer:function(){try{return t.nodebuffer&&1===String.fromCharCode.apply(null,e.allocBuffer(1)).length}catch(g){return!1}}()}};function s(g){var I=65536,t=C.getTypeOf(g),A=!0;if("uint8array"===t?A=r.applyCanBeUsed.uint8array:"nodebuffer"===t&&(A=r.applyCanBeUsed.nodebuffer),A)for(;1<I;)try{return r.stringifyByChunk(g,t,I)}catch(g){I=Math.floor(I/2)}return r.stringifyByChar(g)}function a(g,I){for(var C=0;C<g.length;C++)I[C]=g[C];return I}C.applyFromCharCode=s;var c={};c.string={string:n,array:function(g){return o(g,new Array(g.length))},arraybuffer:function(g){return c.string.uint8array(g).buffer},uint8array:function(g){return o(g,new Uint8Array(g.length))},nodebuffer:function(g){return o(g,e.allocBuffer(g.length))}},c.array={string:s,array:n,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return e.newBufferFrom(g)}},c.arraybuffer={string:function(g){return s(new Uint8Array(g))},array:function(g){return a(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:n,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return e.newBufferFrom(new Uint8Array(g))}},c.uint8array={string:s,array:function(g){return a(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:n,nodebuffer:function(g){return e.newBufferFrom(g)}},c.nodebuffer={string:s,array:function(g){return a(g,new Array(g.length))},arraybuffer:function(g){return c.nodebuffer.uint8array(g).buffer},uint8array:function(g){return a(g,new Uint8Array(g.length))},nodebuffer:n},C.transformTo=function(g,I){if(I=I||"",!g)return I;C.checkSupport(g);var t=C.getTypeOf(I);return c[t][g](I)},C.resolve=function(g){for(var I=g.split("/"),C=[],t=0;t<I.length;t++){var A=I[t];"."===A||""===A&&0!==t&&t!==I.length-1||(".."===A?C.pop():C.push(A))}return C.join("/")},C.getTypeOf=function(g){return"string"==typeof g?"string":"[object Array]"===Object.prototype.toString.call(g)?"array":t.nodebuffer&&e.isBuffer(g)?"nodebuffer":t.uint8array&&g instanceof Uint8Array?"uint8array":t.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},C.checkSupport=function(g){if(!t[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},C.MAX_VALUE_16BITS=65535,C.MAX_VALUE_32BITS=-1,C.pretty=function(g){var I,C,t="";for(C=0;C<(g||"").length;C++)t+="\\x"+((I=g.charCodeAt(C))<16?"0":"")+I.toString(16).toUpperCase();return t},C.delay=function(g,I,C){setImmediate((function(){g.apply(C||null,I||[])}))},C.inherits=function(g,I){function C(){}C.prototype=I.prototype,g.prototype=new C},C.extend=function(){var g,I,C={};for(g=0;g<arguments.length;g++)for(I in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],I)&&void 0===C[I]&&(C[I]=arguments[g][I]);return C},C.prepareContent=function(g,I,e,n,r){return i.Promise.resolve(I).then((function(g){return t.blob&&(g instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(g)))&&"undefined"!=typeof FileReader?new i.Promise((function(I,C){var t=new FileReader;t.onload=function(g){I(g.target.result)},t.onerror=function(g){C(g.target.error)},t.readAsArrayBuffer(g)})):g})).then((function(I){var s=C.getTypeOf(I);return s?("arraybuffer"===s?I=C.transformTo("uint8array",I):"string"===s&&(r?I=A.decode(I):e&&!0!==n&&(I=function(g){return o(g,t.uint8array?new Uint8Array(g.length):new Array(g.length))}(I))),I):i.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(g,I,C){"use strict";var t=g("./reader/readerFor"),A=g("./utils"),e=g("./signature"),i=g("./zipEntry"),n=g("./support");function o(g){this.files=[],this.loadOptions=g}o.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var I=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+A.pretty(I)+", expected "+A.pretty(g)+")")}},isSignature:function(g,I){var C=this.reader.index;this.reader.setIndex(g);var t=this.reader.readString(4)===I;return this.reader.setIndex(C),t},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),I=n.uint8array?"uint8array":"array",C=A.transformTo(I,g);this.zipComment=this.loadOptions.decodeFileName(C)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,I,C,t=this.zip64EndOfCentralSize-44;0<t;)g=this.reader.readInt(2),I=this.reader.readInt(4),C=this.reader.readData(I),this.zip64ExtensibleData[g]={id:g,length:I,value:C}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,I;for(g=0;g<this.files.length;g++)I=this.files[g],this.reader.setIndex(I.localHeaderOffset),this.checkSignature(e.LOCAL_FILE_HEADER),I.readLocalPart(this.reader),I.handleUTF8(),I.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(g=new i({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var I=g;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===A.MAX_VALUE_16BITS||this.diskWithCentralDirStart===A.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===A.MAX_VALUE_16BITS||this.centralDirRecords===A.MAX_VALUE_16BITS||this.centralDirSize===A.MAX_VALUE_32BITS||this.centralDirOffset===A.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var C=this.centralDirOffset+this.centralDirSize;this.zip64&&(C+=20,C+=12+this.zip64EndOfCentralSize);var t=I-C;if(0<t)this.isSignature(I,e.CENTRAL_FILE_HEADER)||(this.reader.zero=t);else if(t<0)throw new Error("Corrupted zip: missing "+Math.abs(t)+" bytes.")},prepareReader:function(g){this.reader=t(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},I.exports=o},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(g,I,C){"use strict";var t=g("./reader/readerFor"),A=g("./utils"),e=g("./compressedObject"),i=g("./crc32"),n=g("./utf8"),o=g("./compressions"),r=g("./support");function s(g,I){this.options=g,this.loadOptions=I}s.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(g){var I,C;if(g.skip(22),this.fileNameLength=g.readInt(2),C=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(C),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(I=function(g){for(var I in o)if(Object.prototype.hasOwnProperty.call(o,I)&&o[I].magic===g)return o[I];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+A.pretty(this.compressionMethod)+" unknown (inner file : "+A.transformTo("string",this.fileName)+")");this.decompressed=new e(this.compressedSize,this.uncompressedSize,this.crc32,I,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var I=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(I),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==g&&(this.dosPermissions=63&this.externalFileAttributes),3==g&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=t(this.extraFields[1].value);this.uncompressedSize===A.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===A.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===A.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===A.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var I,C,t,A=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<A;)I=g.readInt(2),C=g.readInt(2),t=g.readData(C),this.extraFields[I]={id:I,length:C,value:t};g.setIndex(A)},handleUTF8:function(){var g=r.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=n.utf8decode(this.fileName),this.fileCommentStr=n.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(null!==I)this.fileNameStr=I;else{var C=A.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(C)}var t=this.findExtraFieldUnicodeComment();if(null!==t)this.fileCommentStr=t;else{var e=A.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(e)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var I=t(g.value);return 1!==I.readInt(1)||i(this.fileName)!==I.readInt(4)?null:n.utf8decode(I.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var I=t(g.value);return 1!==I.readInt(1)||i(this.fileComment)!==I.readInt(4)?null:n.utf8decode(I.readData(g.length-5))}return null}},I.exports=s},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(g,I,C){"use strict";function t(g,I,C){this.name=g,this.dir=C.dir,this.date=C.date,this.comment=C.comment,this.unixPermissions=C.unixPermissions,this.dosPermissions=C.dosPermissions,this._data=I,this._dataBinary=C.binary,this.options={compression:C.compression,compressionOptions:C.compressionOptions}}var A=g("./stream/StreamHelper"),e=g("./stream/DataWorker"),i=g("./utf8"),n=g("./compressedObject"),o=g("./stream/GenericWorker");t.prototype={internalStream:function(g){var I=null,C="string";try{if(!g)throw new Error("No output type specified.");var t="string"===(C=g.toLowerCase())||"text"===C;"binarystring"!==C&&"text"!==C||(C="string"),I=this._decompressWorker();var e=!this._dataBinary;e&&!t&&(I=I.pipe(new i.Utf8EncodeWorker)),!e&&t&&(I=I.pipe(new i.Utf8DecodeWorker))}catch(g){(I=new o("error")).error(g)}return new A(I,C,"")},async:function(g,I){return this.internalStream(g).accumulate(I)},nodeStream:function(g,I){return this.internalStream(g||"nodebuffer").toNodejsStream(I)},_compressWorker:function(g,I){if(this._data instanceof n&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var C=this._decompressWorker();return this._dataBinary||(C=C.pipe(new i.Utf8EncodeWorker)),n.createWorkerFrom(C,g,I)},_decompressWorker:function(){return this._data instanceof n?this._data.getContentWorker():this._data instanceof o?this._data:new e(this._data)}};for(var r=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],s=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},a=0;a<r.length;a++)t.prototype[r[a]]=s;I.exports=t},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(g,I,t){(function(g){"use strict";var C,t,A=g.MutationObserver||g.WebKitMutationObserver;if(A){var e=0,i=new A(s),n=g.document.createTextNode("");i.observe(n,{characterData:!0}),C=function(){n.data=e=++e%2}}else if(g.setImmediate||void 0===g.MessageChannel)C="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var I=g.document.createElement("script");I.onreadystatechange=function(){s(),I.onreadystatechange=null,I.parentNode.removeChild(I),I=null},g.document.documentElement.appendChild(I)}:function(){setTimeout(s,0)};else{var o=new g.MessageChannel;o.port1.onmessage=s,C=function(){o.port2.postMessage(0)}}var r=[];function s(){var g,I;t=!0;for(var C=r.length;C;){for(I=r,r=[],g=-1;++g<C;)I[g]();C=r.length}t=!1}I.exports=function(g){1!==r.push(g)||t||C()}}).call(this,void 0!==C.g?C.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(g,I,C){"use strict";var t=g("immediate");function A(){}var e={},i=["REJECTED"],o=["FULFILLED"],r=["PENDING"];function s(g){if("function"!=typeof g)throw new TypeError("resolver must be a function");this.state=r,this.queue=[],this.outcome=void 0,g!==A&&u(this,g)}function a(g,I,C){this.promise=g,"function"==typeof I&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),"function"==typeof C&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function c(g,I,C){t((function(){var t;try{t=I(C)}catch(t){return e.reject(g,t)}t===g?e.reject(g,new TypeError("Cannot resolve promise with itself")):e.resolve(g,t)}))}function l(g){var I=g&&g.then;if(g&&("object"==n(g)||"function"==typeof g)&&"function"==typeof I)return function(){I.apply(g,arguments)}}function u(g,I){var C=!1;function t(I){C||(C=!0,e.reject(g,I))}function A(I){C||(C=!0,e.resolve(g,I))}var i=d((function(){I(A,t)}));"error"===i.status&&t(i.value)}function d(g,I){var C={};try{C.value=g(I),C.status="success"}catch(g){C.status="error",C.value=g}return C}(I.exports=s).prototype.finally=function(g){if("function"!=typeof g)return this;var I=this.constructor;return this.then((function(C){return I.resolve(g()).then((function(){return C}))}),(function(C){return I.resolve(g()).then((function(){throw C}))}))},s.prototype.catch=function(g){return this.then(null,g)},s.prototype.then=function(g,I){if("function"!=typeof g&&this.state===o||"function"!=typeof I&&this.state===i)return this;var C=new this.constructor(A);return this.state!==r?c(C,this.state===o?g:I,this.outcome):this.queue.push(new a(C,g,I)),C},a.prototype.callFulfilled=function(g){e.resolve(this.promise,g)},a.prototype.otherCallFulfilled=function(g){c(this.promise,this.onFulfilled,g)},a.prototype.callRejected=function(g){e.reject(this.promise,g)},a.prototype.otherCallRejected=function(g){c(this.promise,this.onRejected,g)},e.resolve=function(g,I){var C=d(l,I);if("error"===C.status)return e.reject(g,C.value);var t=C.value;if(t)u(g,t);else{g.state=o,g.outcome=I;for(var A=-1,i=g.queue.length;++A<i;)g.queue[A].callFulfilled(I)}return g},e.reject=function(g,I){g.state=i,g.outcome=I;for(var C=-1,t=g.queue.length;++C<t;)g.queue[C].callRejected(I);return g},s.resolve=function(g){return g instanceof this?g:e.resolve(new this(A),g)},s.reject=function(g){var I=new this(A);return e.reject(I,g)},s.all=function(g){var I=this;if("[object Array]"!==Object.prototype.toString.call(g))return this.reject(new TypeError("must be an array"));var C=g.length,t=!1;if(!C)return this.resolve([]);for(var i=new Array(C),n=0,o=-1,r=new this(A);++o<C;)s(g[o],o);return r;function s(g,A){I.resolve(g).then((function(g){i[A]=g,++n!==C||t||(t=!0,e.resolve(r,i))}),(function(g){t||(t=!0,e.reject(r,g))}))}},s.race=function(g){if("[object Array]"!==Object.prototype.toString.call(g))return this.reject(new TypeError("must be an array"));var I=g.length,C=!1;if(!I)return this.resolve([]);for(var t,i=-1,n=new this(A);++i<I;)t=g[i],this.resolve(t).then((function(g){C||(C=!0,e.resolve(n,g))}),(function(g){C||(C=!0,e.reject(n,g))}));return n}},{immediate:36}],38:[function(g,I,C){"use strict";var t={};(0,g("./lib/utils/common").assign)(t,g("./lib/deflate"),g("./lib/inflate"),g("./lib/zlib/constants")),I.exports=t},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(g,I,C){"use strict";var t=g("./zlib/deflate"),A=g("./utils/common"),e=g("./utils/strings"),i=g("./zlib/messages"),n=g("./zlib/zstream"),o=Object.prototype.toString,r=0,s=-1,a=0,c=8;function l(g){if(!(this instanceof l))return new l(g);this.options=A.assign({level:s,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:a,to:""},g||{});var I=this.options;I.raw&&0<I.windowBits?I.windowBits=-I.windowBits:I.gzip&&0<I.windowBits&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;var C=t.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(C!==r)throw new Error(i[C]);if(I.header&&t.deflateSetHeader(this.strm,I.header),I.dictionary){var u;if(u="string"==typeof I.dictionary?e.string2buf(I.dictionary):"[object ArrayBuffer]"===o.call(I.dictionary)?new Uint8Array(I.dictionary):I.dictionary,(C=t.deflateSetDictionary(this.strm,u))!==r)throw new Error(i[C]);this._dict_set=!0}}function u(g,I){var C=new l(I);if(C.push(g,!0),C.err)throw C.msg||i[C.err];return C.result}l.prototype.push=function(g,I){var C,i,n=this.strm,s=this.options.chunkSize;if(this.ended)return!1;i=I===~~I?I:!0===I?4:0,"string"==typeof g?n.input=e.string2buf(g):"[object ArrayBuffer]"===o.call(g)?n.input=new Uint8Array(g):n.input=g,n.next_in=0,n.avail_in=n.input.length;do{if(0===n.avail_out&&(n.output=new A.Buf8(s),n.next_out=0,n.avail_out=s),1!==(C=t.deflate(n,i))&&C!==r)return this.onEnd(C),!(this.ended=!0);0!==n.avail_out&&(0!==n.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(e.buf2binstring(A.shrinkBuf(n.output,n.next_out))):this.onData(A.shrinkBuf(n.output,n.next_out)))}while((0<n.avail_in||0===n.avail_out)&&1!==C);return 4===i?(C=t.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===r):2!==i||(this.onEnd(r),!(n.avail_out=0))},l.prototype.onData=function(g){this.chunks.push(g)},l.prototype.onEnd=function(g){g===r&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=A.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},C.Deflate=l,C.deflate=u,C.deflateRaw=function(g,I){return(I=I||{}).raw=!0,u(g,I)},C.gzip=function(g,I){return(I=I||{}).gzip=!0,u(g,I)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(g,I,C){"use strict";var t=g("./zlib/inflate"),A=g("./utils/common"),e=g("./utils/strings"),i=g("./zlib/constants"),n=g("./zlib/messages"),o=g("./zlib/zstream"),r=g("./zlib/gzheader"),s=Object.prototype.toString;function a(g){if(!(this instanceof a))return new a(g);this.options=A.assign({chunkSize:16384,windowBits:0,to:""},g||{});var I=this.options;I.raw&&0<=I.windowBits&&I.windowBits<16&&(I.windowBits=-I.windowBits,0===I.windowBits&&(I.windowBits=-15)),!(0<=I.windowBits&&I.windowBits<16)||g&&g.windowBits||(I.windowBits+=32),15<I.windowBits&&I.windowBits<48&&0==(15&I.windowBits)&&(I.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var C=t.inflateInit2(this.strm,I.windowBits);if(C!==i.Z_OK)throw new Error(n[C]);this.header=new r,t.inflateGetHeader(this.strm,this.header)}function c(g,I){var C=new a(I);if(C.push(g,!0),C.err)throw C.msg||n[C.err];return C.result}a.prototype.push=function(g,I){var C,n,o,r,a,c,l=this.strm,u=this.options.chunkSize,d=this.options.dictionary,h=!1;if(this.ended)return!1;n=I===~~I?I:!0===I?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof g?l.input=e.binstring2buf(g):"[object ArrayBuffer]"===s.call(g)?l.input=new Uint8Array(g):l.input=g,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new A.Buf8(u),l.next_out=0,l.avail_out=u),(C=t.inflate(l,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&d&&(c="string"==typeof d?e.string2buf(d):"[object ArrayBuffer]"===s.call(d)?new Uint8Array(d):d,C=t.inflateSetDictionary(this.strm,c)),C===i.Z_BUF_ERROR&&!0===h&&(C=i.Z_OK,h=!1),C!==i.Z_STREAM_END&&C!==i.Z_OK)return this.onEnd(C),!(this.ended=!0);l.next_out&&(0!==l.avail_out&&C!==i.Z_STREAM_END&&(0!==l.avail_in||n!==i.Z_FINISH&&n!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(o=e.utf8border(l.output,l.next_out),r=l.next_out-o,a=e.buf2string(l.output,o),l.next_out=r,l.avail_out=u-r,r&&A.arraySet(l.output,l.output,o,r,0),this.onData(a)):this.onData(A.shrinkBuf(l.output,l.next_out)))),0===l.avail_in&&0===l.avail_out&&(h=!0)}while((0<l.avail_in||0===l.avail_out)&&C!==i.Z_STREAM_END);return C===i.Z_STREAM_END&&(n=i.Z_FINISH),n===i.Z_FINISH?(C=t.inflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===i.Z_OK):n!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),!(l.avail_out=0))},a.prototype.onData=function(g){this.chunks.push(g)},a.prototype.onEnd=function(g){g===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=A.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},C.Inflate=a,C.inflate=c,C.inflateRaw=function(g,I){return(I=I||{}).raw=!0,c(g,I)},C.ungzip=c},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(g,I,C){"use strict";var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;C.assign=function(g){for(var I=Array.prototype.slice.call(arguments,1);I.length;){var C=I.shift();if(C){if("object"!=n(C))throw new TypeError(C+"must be non-object");for(var t in C)C.hasOwnProperty(t)&&(g[t]=C[t])}}return g},C.shrinkBuf=function(g,I){return g.length===I?g:g.subarray?g.subarray(0,I):(g.length=I,g)};var A={arraySet:function(g,I,C,t,A){if(I.subarray&&g.subarray)g.set(I.subarray(C,C+t),A);else for(var e=0;e<t;e++)g[A+e]=I[C+e]},flattenChunks:function(g){var I,C,t,A,e,i;for(I=t=0,C=g.length;I<C;I++)t+=g[I].length;for(i=new Uint8Array(t),I=A=0,C=g.length;I<C;I++)e=g[I],i.set(e,A),A+=e.length;return i}},e={arraySet:function(g,I,C,t,A){for(var e=0;e<t;e++)g[A+e]=I[C+e]},flattenChunks:function(g){return[].concat.apply([],g)}};C.setTyped=function(g){g?(C.Buf8=Uint8Array,C.Buf16=Uint16Array,C.Buf32=Int32Array,C.assign(C,A)):(C.Buf8=Array,C.Buf16=Array,C.Buf32=Array,C.assign(C,e))},C.setTyped(t)},{}],42:[function(g,I,C){"use strict";var t=g("./common"),A=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch(g){A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(g){e=!1}for(var i=new t.Buf8(256),n=0;n<256;n++)i[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;function o(g,I){if(I<65537&&(g.subarray&&e||!g.subarray&&A))return String.fromCharCode.apply(null,t.shrinkBuf(g,I));for(var C="",i=0;i<I;i++)C+=String.fromCharCode(g[i]);return C}i[254]=i[254]=1,C.string2buf=function(g){var I,C,A,e,i,n=g.length,o=0;for(e=0;e<n;e++)55296==(64512&(C=g.charCodeAt(e)))&&e+1<n&&56320==(64512&(A=g.charCodeAt(e+1)))&&(C=65536+(C-55296<<10)+(A-56320),e++),o+=C<128?1:C<2048?2:C<65536?3:4;for(I=new t.Buf8(o),e=i=0;i<o;e++)55296==(64512&(C=g.charCodeAt(e)))&&e+1<n&&56320==(64512&(A=g.charCodeAt(e+1)))&&(C=65536+(C-55296<<10)+(A-56320),e++),C<128?I[i++]=C:(C<2048?I[i++]=192|C>>>6:(C<65536?I[i++]=224|C>>>12:(I[i++]=240|C>>>18,I[i++]=128|C>>>12&63),I[i++]=128|C>>>6&63),I[i++]=128|63&C);return I},C.buf2binstring=function(g){return o(g,g.length)},C.binstring2buf=function(g){for(var I=new t.Buf8(g.length),C=0,A=I.length;C<A;C++)I[C]=g.charCodeAt(C);return I},C.buf2string=function(g,I){var C,t,A,e,n=I||g.length,r=new Array(2*n);for(C=t=0;C<n;)if((A=g[C++])<128)r[t++]=A;else if(4<(e=i[A]))r[t++]=65533,C+=e-1;else{for(A&=2===e?31:3===e?15:7;1<e&&C<n;)A=A<<6|63&g[C++],e--;1<e?r[t++]=65533:A<65536?r[t++]=A:(A-=65536,r[t++]=55296|A>>10&1023,r[t++]=56320|1023&A)}return o(r,t)},C.utf8border=function(g,I){var C;for((I=I||g.length)>g.length&&(I=g.length),C=I-1;0<=C&&128==(192&g[C]);)C--;return C<0||0===C?I:C+i[g[C]]>I?C:I}},{"./common":41}],43:[function(g,I,C){"use strict";I.exports=function(g,I,C,t){for(var A=65535&g|0,e=g>>>16&65535|0,i=0;0!==C;){for(C-=i=2e3<C?2e3:C;e=e+(A=A+I[t++]|0)|0,--i;);A%=65521,e%=65521}return A|e<<16|0}},{}],44:[function(g,I,C){"use strict";I.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(g,I,C){"use strict";var t=function(){for(var g,I=[],C=0;C<256;C++){g=C;for(var t=0;t<8;t++)g=1&g?3988292384^g>>>1:g>>>1;I[C]=g}return I}();I.exports=function(g,I,C,A){var e=t,i=A+C;g^=-1;for(var n=A;n<i;n++)g=g>>>8^e[255&(g^I[n])];return-1^g}},{}],46:[function(g,I,C){"use strict";var t,A=g("../utils/common"),e=g("./trees"),i=g("./adler32"),n=g("./crc32"),o=g("./messages"),r=0,s=0,a=-2,c=2,l=8,u=286,d=30,h=19,m=2*u+1,S=15,y=3,b=258,Z=b+y+1,B=42,G=113;function p(g,I){return g.msg=o[I],I}function w(g){return(g<<1)-(4<g?9:0)}function f(g){for(var I=g.length;0<=--I;)g[I]=0}function k(g){var I=g.state,C=I.pending;C>g.avail_out&&(C=g.avail_out),0!==C&&(A.arraySet(g.output,I.pending_buf,I.pending_out,C,g.next_out),g.next_out+=C,I.pending_out+=C,g.total_out+=C,g.avail_out-=C,I.pending-=C,0===I.pending&&(I.pending_out=0))}function H(g,I){e._tr_flush_block(g,0<=g.block_start?g.block_start:-1,g.strstart-g.block_start,I),g.block_start=g.strstart,k(g.strm)}function J(g,I){g.pending_buf[g.pending++]=I}function K(g,I){g.pending_buf[g.pending++]=I>>>8&255,g.pending_buf[g.pending++]=255&I}function W(g,I){var C,t,A=g.max_chain_length,e=g.strstart,i=g.prev_length,n=g.nice_match,o=g.strstart>g.w_size-Z?g.strstart-(g.w_size-Z):0,r=g.window,s=g.w_mask,a=g.prev,c=g.strstart+b,l=r[e+i-1],u=r[e+i];g.prev_length>=g.good_match&&(A>>=2),n>g.lookahead&&(n=g.lookahead);do{if(r[(C=I)+i]===u&&r[C+i-1]===l&&r[C]===r[e]&&r[++C]===r[e+1]){e+=2,C++;do{}while(r[++e]===r[++C]&&r[++e]===r[++C]&&r[++e]===r[++C]&&r[++e]===r[++C]&&r[++e]===r[++C]&&r[++e]===r[++C]&&r[++e]===r[++C]&&r[++e]===r[++C]&&e<c);if(t=b-(c-e),e=c-b,i<t){if(g.match_start=I,n<=(i=t))break;l=r[e+i-1],u=r[e+i]}}}while((I=a[I&s])>o&&0!=--A);return i<=g.lookahead?i:g.lookahead}function V(g){var I,C,t,e,o,r,s,a,c,l,u=g.w_size;do{if(e=g.window_size-g.lookahead-g.strstart,g.strstart>=u+(u-Z)){for(A.arraySet(g.window,g.window,u,u,0),g.match_start-=u,g.strstart-=u,g.block_start-=u,I=C=g.hash_size;t=g.head[--I],g.head[I]=u<=t?t-u:0,--C;);for(I=C=u;t=g.prev[--I],g.prev[I]=u<=t?t-u:0,--C;);e+=u}if(0===g.strm.avail_in)break;if(r=g.strm,s=g.window,a=g.strstart+g.lookahead,l=void 0,(c=e)<(l=r.avail_in)&&(l=c),C=0===l?0:(r.avail_in-=l,A.arraySet(s,r.input,r.next_in,l,a),1===r.state.wrap?r.adler=i(r.adler,s,l,a):2===r.state.wrap&&(r.adler=n(r.adler,s,l,a)),r.next_in+=l,r.total_in+=l,l),g.lookahead+=C,g.lookahead+g.insert>=y)for(o=g.strstart-g.insert,g.ins_h=g.window[o],g.ins_h=(g.ins_h<<g.hash_shift^g.window[o+1])&g.hash_mask;g.insert&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[o+y-1])&g.hash_mask,g.prev[o&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=o,o++,g.insert--,!(g.lookahead+g.insert<y)););}while(g.lookahead<Z&&0!==g.strm.avail_in)}function X(g,I){for(var C,t;;){if(g.lookahead<Z){if(V(g),g.lookahead<Z&&I===r)return 1;if(0===g.lookahead)break}if(C=0,g.lookahead>=y&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+y-1])&g.hash_mask,C=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),0!==C&&g.strstart-C<=g.w_size-Z&&(g.match_length=W(g,C)),g.match_length>=y)if(t=e._tr_tally(g,g.strstart-g.match_start,g.match_length-y),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=y){for(g.match_length--;g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+y-1])&g.hash_mask,C=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart,0!=--g.match_length;);g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else t=e._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(t&&(H(g,!1),0===g.strm.avail_out))return 1}return g.insert=g.strstart<y-1?g.strstart:y-1,4===I?(H(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(H(g,!1),0===g.strm.avail_out)?1:2}function L(g,I){for(var C,t,A;;){if(g.lookahead<Z){if(V(g),g.lookahead<Z&&I===r)return 1;if(0===g.lookahead)break}if(C=0,g.lookahead>=y&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+y-1])&g.hash_mask,C=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=y-1,0!==C&&g.prev_length<g.max_lazy_match&&g.strstart-C<=g.w_size-Z&&(g.match_length=W(g,C),g.match_length<=5&&(1===g.strategy||g.match_length===y&&4096<g.strstart-g.match_start)&&(g.match_length=y-1)),g.prev_length>=y&&g.match_length<=g.prev_length){for(A=g.strstart+g.lookahead-y,t=e._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-y),g.lookahead-=g.prev_length-1,g.prev_length-=2;++g.strstart<=A&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+y-1])&g.hash_mask,C=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),0!=--g.prev_length;);if(g.match_available=0,g.match_length=y-1,g.strstart++,t&&(H(g,!1),0===g.strm.avail_out))return 1}else if(g.match_available){if((t=e._tr_tally(g,0,g.window[g.strstart-1]))&&H(g,!1),g.strstart++,g.lookahead--,0===g.strm.avail_out)return 1}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(t=e._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<y-1?g.strstart:y-1,4===I?(H(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(H(g,!1),0===g.strm.avail_out)?1:2}function Y(g,I,C,t,A){this.good_length=g,this.max_lazy=I,this.nice_length=C,this.max_chain=t,this.func=A}function v(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=l,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new A.Buf16(2*m),this.dyn_dtree=new A.Buf16(2*(2*d+1)),this.bl_tree=new A.Buf16(2*(2*h+1)),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new A.Buf16(S+1),this.heap=new A.Buf16(2*u+1),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new A.Buf16(2*u+1),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function R(g){var I;return g&&g.state?(g.total_in=g.total_out=0,g.data_type=c,(I=g.state).pending=0,I.pending_out=0,I.wrap<0&&(I.wrap=-I.wrap),I.status=I.wrap?B:G,g.adler=2===I.wrap?0:1,I.last_flush=r,e._tr_init(I),s):p(g,a)}function D(g){var I=R(g);return I===s&&function(g){g.window_size=2*g.w_size,f(g.head),g.max_lazy_match=t[g.level].max_lazy,g.good_match=t[g.level].good_length,g.nice_match=t[g.level].nice_length,g.max_chain_length=t[g.level].max_chain,g.strstart=0,g.block_start=0,g.lookahead=0,g.insert=0,g.match_length=g.prev_length=y-1,g.match_available=0,g.ins_h=0}(g.state),I}function N(g,I,C,t,e,i){if(!g)return a;var n=1;if(-1===I&&(I=6),t<0?(n=0,t=-t):15<t&&(n=2,t-=16),e<1||9<e||C!==l||t<8||15<t||I<0||9<I||i<0||4<i)return p(g,a);8===t&&(t=9);var o=new v;return(g.state=o).strm=g,o.wrap=n,o.gzhead=null,o.w_bits=t,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=e+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+y-1)/y),o.window=new A.Buf8(2*o.w_size),o.head=new A.Buf16(o.hash_size),o.prev=new A.Buf16(o.w_size),o.lit_bufsize=1<<e+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new A.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=I,o.strategy=i,o.method=C,D(g)}t=[new Y(0,0,0,0,(function(g,I){var C=65535;for(C>g.pending_buf_size-5&&(C=g.pending_buf_size-5);;){if(g.lookahead<=1){if(V(g),0===g.lookahead&&I===r)return 1;if(0===g.lookahead)break}g.strstart+=g.lookahead,g.lookahead=0;var t=g.block_start+C;if((0===g.strstart||g.strstart>=t)&&(g.lookahead=g.strstart-t,g.strstart=t,H(g,!1),0===g.strm.avail_out))return 1;if(g.strstart-g.block_start>=g.w_size-Z&&(H(g,!1),0===g.strm.avail_out))return 1}return g.insert=0,4===I?(H(g,!0),0===g.strm.avail_out?3:4):(g.strstart>g.block_start&&(H(g,!1),g.strm.avail_out),1)})),new Y(4,4,8,4,X),new Y(4,5,16,8,X),new Y(4,6,32,32,X),new Y(4,4,16,16,L),new Y(8,16,32,32,L),new Y(8,16,128,128,L),new Y(8,32,128,256,L),new Y(32,128,258,1024,L),new Y(32,258,258,4096,L)],C.deflateInit=function(g,I){return N(g,I,l,15,8,0)},C.deflateInit2=N,C.deflateReset=D,C.deflateResetKeep=R,C.deflateSetHeader=function(g,I){return g&&g.state?2!==g.state.wrap?a:(g.state.gzhead=I,s):a},C.deflate=function(g,I){var C,A,i,o;if(!g||!g.state||5<I||I<0)return g?p(g,a):a;if(A=g.state,!g.output||!g.input&&0!==g.avail_in||666===A.status&&4!==I)return p(g,0===g.avail_out?-5:a);if(A.strm=g,C=A.last_flush,A.last_flush=I,A.status===B)if(2===A.wrap)g.adler=0,J(A,31),J(A,139),J(A,8),A.gzhead?(J(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),J(A,255&A.gzhead.time),J(A,A.gzhead.time>>8&255),J(A,A.gzhead.time>>16&255),J(A,A.gzhead.time>>24&255),J(A,9===A.level?2:2<=A.strategy||A.level<2?4:0),J(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(J(A,255&A.gzhead.extra.length),J(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(g.adler=n(g.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(J(A,0),J(A,0),J(A,0),J(A,0),J(A,0),J(A,9===A.level?2:2<=A.strategy||A.level<2?4:0),J(A,3),A.status=G);else{var c=l+(A.w_bits-8<<4)<<8;c|=(2<=A.strategy||A.level<2?0:A.level<6?1:6===A.level?2:3)<<6,0!==A.strstart&&(c|=32),c+=31-c%31,A.status=G,K(A,c),0!==A.strstart&&(K(A,g.adler>>>16),K(A,65535&g.adler)),g.adler=1}if(69===A.status)if(A.gzhead.extra){for(i=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>i&&(g.adler=n(g.adler,A.pending_buf,A.pending-i,i)),k(g),i=A.pending,A.pending!==A.pending_buf_size));)J(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>i&&(g.adler=n(g.adler,A.pending_buf,A.pending-i,i)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(73===A.status)if(A.gzhead.name){i=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>i&&(g.adler=n(g.adler,A.pending_buf,A.pending-i,i)),k(g),i=A.pending,A.pending===A.pending_buf_size)){o=1;break}o=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,J(A,o)}while(0!==o);A.gzhead.hcrc&&A.pending>i&&(g.adler=n(g.adler,A.pending_buf,A.pending-i,i)),0===o&&(A.gzindex=0,A.status=91)}else A.status=91;if(91===A.status)if(A.gzhead.comment){i=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>i&&(g.adler=n(g.adler,A.pending_buf,A.pending-i,i)),k(g),i=A.pending,A.pending===A.pending_buf_size)){o=1;break}o=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,J(A,o)}while(0!==o);A.gzhead.hcrc&&A.pending>i&&(g.adler=n(g.adler,A.pending_buf,A.pending-i,i)),0===o&&(A.status=103)}else A.status=103;if(103===A.status&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&k(g),A.pending+2<=A.pending_buf_size&&(J(A,255&g.adler),J(A,g.adler>>8&255),g.adler=0,A.status=G)):A.status=G),0!==A.pending){if(k(g),0===g.avail_out)return A.last_flush=-1,s}else if(0===g.avail_in&&w(I)<=w(C)&&4!==I)return p(g,-5);if(666===A.status&&0!==g.avail_in)return p(g,-5);if(0!==g.avail_in||0!==A.lookahead||I!==r&&666!==A.status){var u=2===A.strategy?function(g,I){for(var C;;){if(0===g.lookahead&&(V(g),0===g.lookahead)){if(I===r)return 1;break}if(g.match_length=0,C=e._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++,C&&(H(g,!1),0===g.strm.avail_out))return 1}return g.insert=0,4===I?(H(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(H(g,!1),0===g.strm.avail_out)?1:2}(A,I):3===A.strategy?function(g,I){for(var C,t,A,i,n=g.window;;){if(g.lookahead<=b){if(V(g),g.lookahead<=b&&I===r)return 1;if(0===g.lookahead)break}if(g.match_length=0,g.lookahead>=y&&0<g.strstart&&(t=n[A=g.strstart-1])===n[++A]&&t===n[++A]&&t===n[++A]){i=g.strstart+b;do{}while(t===n[++A]&&t===n[++A]&&t===n[++A]&&t===n[++A]&&t===n[++A]&&t===n[++A]&&t===n[++A]&&t===n[++A]&&A<i);g.match_length=b-(i-A),g.match_length>g.lookahead&&(g.match_length=g.lookahead)}if(g.match_length>=y?(C=e._tr_tally(g,1,g.match_length-y),g.lookahead-=g.match_length,g.strstart+=g.match_length,g.match_length=0):(C=e._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++),C&&(H(g,!1),0===g.strm.avail_out))return 1}return g.insert=0,4===I?(H(g,!0),0===g.strm.avail_out?3:4):g.last_lit&&(H(g,!1),0===g.strm.avail_out)?1:2}(A,I):t[A.level].func(A,I);if(3!==u&&4!==u||(A.status=666),1===u||3===u)return 0===g.avail_out&&(A.last_flush=-1),s;if(2===u&&(1===I?e._tr_align(A):5!==I&&(e._tr_stored_block(A,0,0,!1),3===I&&(f(A.head),0===A.lookahead&&(A.strstart=0,A.block_start=0,A.insert=0))),k(g),0===g.avail_out))return A.last_flush=-1,s}return 4!==I?s:A.wrap<=0?1:(2===A.wrap?(J(A,255&g.adler),J(A,g.adler>>8&255),J(A,g.adler>>16&255),J(A,g.adler>>24&255),J(A,255&g.total_in),J(A,g.total_in>>8&255),J(A,g.total_in>>16&255),J(A,g.total_in>>24&255)):(K(A,g.adler>>>16),K(A,65535&g.adler)),k(g),0<A.wrap&&(A.wrap=-A.wrap),0!==A.pending?s:1)},C.deflateEnd=function(g){var I;return g&&g.state?(I=g.state.status)!==B&&69!==I&&73!==I&&91!==I&&103!==I&&I!==G&&666!==I?p(g,a):(g.state=null,I===G?p(g,-3):s):a},C.deflateSetDictionary=function(g,I){var C,t,e,n,o,r,c,l,u=I.length;if(!g||!g.state)return a;if(2===(n=(C=g.state).wrap)||1===n&&C.status!==B||C.lookahead)return a;for(1===n&&(g.adler=i(g.adler,I,u,0)),C.wrap=0,u>=C.w_size&&(0===n&&(f(C.head),C.strstart=0,C.block_start=0,C.insert=0),l=new A.Buf8(C.w_size),A.arraySet(l,I,u-C.w_size,C.w_size,0),I=l,u=C.w_size),o=g.avail_in,r=g.next_in,c=g.input,g.avail_in=u,g.next_in=0,g.input=I,V(C);C.lookahead>=y;){for(t=C.strstart,e=C.lookahead-(y-1);C.ins_h=(C.ins_h<<C.hash_shift^C.window[t+y-1])&C.hash_mask,C.prev[t&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=t,t++,--e;);C.strstart=t,C.lookahead=y-1,V(C)}return C.strstart+=C.lookahead,C.block_start=C.strstart,C.insert=C.lookahead,C.lookahead=0,C.match_length=C.prev_length=y-1,C.match_available=0,g.next_in=r,g.input=c,g.avail_in=o,C.wrap=n,s},C.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(g,I,C){"use strict";I.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(g,I,C){"use strict";I.exports=function(g,I){var C,t,A,e,i,n,o,r,s,a,c,l,u,d,h,m,S,y,b,Z,B,G,p,w,f;C=g.state,t=g.next_in,w=g.input,A=t+(g.avail_in-5),e=g.next_out,f=g.output,i=e-(I-g.avail_out),n=e+(g.avail_out-257),o=C.dmax,r=C.wsize,s=C.whave,a=C.wnext,c=C.window,l=C.hold,u=C.bits,d=C.lencode,h=C.distcode,m=(1<<C.lenbits)-1,S=(1<<C.distbits)-1;g:do{u<15&&(l+=w[t++]<<u,u+=8,l+=w[t++]<<u,u+=8),y=d[l&m];I:for(;;){if(l>>>=b=y>>>24,u-=b,0==(b=y>>>16&255))f[e++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=d[(65535&y)+(l&(1<<b)-1)];continue I}if(32&b){C.mode=12;break g}g.msg="invalid literal/length code",C.mode=30;break g}Z=65535&y,(b&=15)&&(u<b&&(l+=w[t++]<<u,u+=8),Z+=l&(1<<b)-1,l>>>=b,u-=b),u<15&&(l+=w[t++]<<u,u+=8,l+=w[t++]<<u,u+=8),y=h[l&S];C:for(;;){if(l>>>=b=y>>>24,u-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=h[(65535&y)+(l&(1<<b)-1)];continue C}g.msg="invalid distance code",C.mode=30;break g}if(B=65535&y,u<(b&=15)&&(l+=w[t++]<<u,(u+=8)<b&&(l+=w[t++]<<u,u+=8)),o<(B+=l&(1<<b)-1)){g.msg="invalid distance too far back",C.mode=30;break g}if(l>>>=b,u-=b,(b=e-i)<B){if(s<(b=B-b)&&C.sane){g.msg="invalid distance too far back",C.mode=30;break g}if(p=c,(G=0)===a){if(G+=r-b,b<Z){for(Z-=b;f[e++]=c[G++],--b;);G=e-B,p=f}}else if(a<b){if(G+=r+a-b,(b-=a)<Z){for(Z-=b;f[e++]=c[G++],--b;);if(G=0,a<Z){for(Z-=b=a;f[e++]=c[G++],--b;);G=e-B,p=f}}}else if(G+=a-b,b<Z){for(Z-=b;f[e++]=c[G++],--b;);G=e-B,p=f}for(;2<Z;)f[e++]=p[G++],f[e++]=p[G++],f[e++]=p[G++],Z-=3;Z&&(f[e++]=p[G++],1<Z&&(f[e++]=p[G++]))}else{for(G=e-B;f[e++]=f[G++],f[e++]=f[G++],f[e++]=f[G++],2<(Z-=3););Z&&(f[e++]=f[G++],1<Z&&(f[e++]=f[G++]))}break}}break}}while(t<A&&e<n);t-=Z=u>>3,l&=(1<<(u-=Z<<3))-1,g.next_in=t,g.next_out=e,g.avail_in=t<A?A-t+5:5-(t-A),g.avail_out=e<n?n-e+257:257-(e-n),C.hold=l,C.bits=u}},{}],49:[function(g,I,C){"use strict";var t=g("../utils/common"),A=g("./adler32"),e=g("./crc32"),i=g("./inffast"),n=g("./inftrees"),o=0,r=-2,s=1,a=852,c=592;function l(g){return(g>>>24&255)+(g>>>8&65280)+((65280&g)<<8)+((255&g)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new t.Buf16(320),this.work=new t.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(g){var I;return g&&g.state?(I=g.state,g.total_in=g.total_out=I.total=0,g.msg="",I.wrap&&(g.adler=1&I.wrap),I.mode=s,I.last=0,I.havedict=0,I.dmax=32768,I.head=null,I.hold=0,I.bits=0,I.lencode=I.lendyn=new t.Buf32(a),I.distcode=I.distdyn=new t.Buf32(c),I.sane=1,I.back=-1,o):r}function h(g){var I;return g&&g.state?((I=g.state).wsize=0,I.whave=0,I.wnext=0,d(g)):r}function m(g,I){var C,t;return g&&g.state?(t=g.state,I<0?(C=0,I=-I):(C=1+(I>>4),I<48&&(I&=15)),I&&(I<8||15<I)?r:(null!==t.window&&t.wbits!==I&&(t.window=null),t.wrap=C,t.wbits=I,h(g))):r}function S(g,I){var C,t;return g?(t=new u,(g.state=t).window=null,(C=m(g,I))!==o&&(g.state=null),C):r}var y,b,Z=!0;function B(g){if(Z){var I;for(y=new t.Buf32(512),b=new t.Buf32(32),I=0;I<144;)g.lens[I++]=8;for(;I<256;)g.lens[I++]=9;for(;I<280;)g.lens[I++]=7;for(;I<288;)g.lens[I++]=8;for(n(1,g.lens,0,288,y,0,g.work,{bits:9}),I=0;I<32;)g.lens[I++]=5;n(2,g.lens,0,32,b,0,g.work,{bits:5}),Z=!1}g.lencode=y,g.lenbits=9,g.distcode=b,g.distbits=5}function G(g,I,C,A){var e,i=g.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new t.Buf8(i.wsize)),A>=i.wsize?(t.arraySet(i.window,I,C-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(A<(e=i.wsize-i.wnext)&&(e=A),t.arraySet(i.window,I,C-A,e,i.wnext),(A-=e)?(t.arraySet(i.window,I,C-A,A,0),i.wnext=A,i.whave=i.wsize):(i.wnext+=e,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=e))),0}C.inflateReset=h,C.inflateReset2=m,C.inflateResetKeep=d,C.inflateInit=function(g){return S(g,15)},C.inflateInit2=S,C.inflate=function(g,I){var C,a,c,u,d,h,m,S,y,b,Z,p,w,f,k,H,J,K,W,V,X,L,Y,v,R=0,D=new t.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!g||!g.state||!g.output||!g.input&&0!==g.avail_in)return r;12===(C=g.state).mode&&(C.mode=13),d=g.next_out,c=g.output,m=g.avail_out,u=g.next_in,a=g.input,h=g.avail_in,S=C.hold,y=C.bits,b=h,Z=m,L=o;g:for(;;)switch(C.mode){case s:if(0===C.wrap){C.mode=13;break}for(;y<16;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(2&C.wrap&&35615===S){D[C.check=0]=255&S,D[1]=S>>>8&255,C.check=e(C.check,D,2,0),y=S=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&S)<<8)+(S>>8))%31){g.msg="incorrect header check",C.mode=30;break}if(8!=(15&S)){g.msg="unknown compression method",C.mode=30;break}if(y-=4,X=8+(15&(S>>>=4)),0===C.wbits)C.wbits=X;else if(X>C.wbits){g.msg="invalid window size",C.mode=30;break}C.dmax=1<<X,g.adler=C.check=1,C.mode=512&S?10:12,y=S=0;break;case 2:for(;y<16;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(C.flags=S,8!=(255&C.flags)){g.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){g.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=S>>8&1),512&C.flags&&(D[0]=255&S,D[1]=S>>>8&255,C.check=e(C.check,D,2,0)),y=S=0,C.mode=3;case 3:for(;y<32;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}C.head&&(C.head.time=S),512&C.flags&&(D[0]=255&S,D[1]=S>>>8&255,D[2]=S>>>16&255,D[3]=S>>>24&255,C.check=e(C.check,D,4,0)),y=S=0,C.mode=4;case 4:for(;y<16;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}C.head&&(C.head.xflags=255&S,C.head.os=S>>8),512&C.flags&&(D[0]=255&S,D[1]=S>>>8&255,C.check=e(C.check,D,2,0)),y=S=0,C.mode=5;case 5:if(1024&C.flags){for(;y<16;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}C.length=S,C.head&&(C.head.extra_len=S),512&C.flags&&(D[0]=255&S,D[1]=S>>>8&255,C.check=e(C.check,D,2,0)),y=S=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(h<(p=C.length)&&(p=h),p&&(C.head&&(X=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),t.arraySet(C.head.extra,a,u,p,X)),512&C.flags&&(C.check=e(C.check,a,p,u)),h-=p,u+=p,C.length-=p),C.length))break g;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(0===h)break g;for(p=0;X=a[u+p++],C.head&&X&&C.length<65536&&(C.head.name+=String.fromCharCode(X)),X&&p<h;);if(512&C.flags&&(C.check=e(C.check,a,p,u)),h-=p,u+=p,X)break g}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(0===h)break g;for(p=0;X=a[u+p++],C.head&&X&&C.length<65536&&(C.head.comment+=String.fromCharCode(X)),X&&p<h;);if(512&C.flags&&(C.check=e(C.check,a,p,u)),h-=p,u+=p,X)break g}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;y<16;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(S!==(65535&C.check)){g.msg="header crc mismatch",C.mode=30;break}y=S=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),g.adler=C.check=0,C.mode=12;break;case 10:for(;y<32;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}g.adler=C.check=l(S),y=S=0,C.mode=11;case 11:if(0===C.havedict)return g.next_out=d,g.avail_out=m,g.next_in=u,g.avail_in=h,C.hold=S,C.bits=y,2;g.adler=C.check=1,C.mode=12;case 12:if(5===I||6===I)break g;case 13:if(C.last){S>>>=7&y,y-=7&y,C.mode=27;break}for(;y<3;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}switch(C.last=1&S,y-=1,3&(S>>>=1)){case 0:C.mode=14;break;case 1:if(B(C),C.mode=20,6!==I)break;S>>>=2,y-=2;break g;case 2:C.mode=17;break;case 3:g.msg="invalid block type",C.mode=30}S>>>=2,y-=2;break;case 14:for(S>>>=7&y,y-=7&y;y<32;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if((65535&S)!=(S>>>16^65535)){g.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&S,y=S=0,C.mode=15,6===I)break g;case 15:C.mode=16;case 16:if(p=C.length){if(h<p&&(p=h),m<p&&(p=m),0===p)break g;t.arraySet(c,a,u,p,d),h-=p,u+=p,m-=p,d+=p,C.length-=p;break}C.mode=12;break;case 17:for(;y<14;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(C.nlen=257+(31&S),S>>>=5,y-=5,C.ndist=1+(31&S),S>>>=5,y-=5,C.ncode=4+(15&S),S>>>=4,y-=4,286<C.nlen||30<C.ndist){g.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;y<3;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}C.lens[N[C.have++]]=7&S,S>>>=3,y-=3}for(;C.have<19;)C.lens[N[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,Y={bits:C.lenbits},L=n(0,C.lens,0,19,C.lencode,0,C.work,Y),C.lenbits=Y.bits,L){g.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;H=(R=C.lencode[S&(1<<C.lenbits)-1])>>>16&255,J=65535&R,!((k=R>>>24)<=y);){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(J<16)S>>>=k,y-=k,C.lens[C.have++]=J;else{if(16===J){for(v=k+2;y<v;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(S>>>=k,y-=k,0===C.have){g.msg="invalid bit length repeat",C.mode=30;break}X=C.lens[C.have-1],p=3+(3&S),S>>>=2,y-=2}else if(17===J){for(v=k+3;y<v;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}y-=k,X=0,p=3+(7&(S>>>=k)),S>>>=3,y-=3}else{for(v=k+7;y<v;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}y-=k,X=0,p=11+(127&(S>>>=k)),S>>>=7,y-=7}if(C.have+p>C.nlen+C.ndist){g.msg="invalid bit length repeat",C.mode=30;break}for(;p--;)C.lens[C.have++]=X}}if(30===C.mode)break;if(0===C.lens[256]){g.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,Y={bits:C.lenbits},L=n(1,C.lens,0,C.nlen,C.lencode,0,C.work,Y),C.lenbits=Y.bits,L){g.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,Y={bits:C.distbits},L=n(2,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,Y),C.distbits=Y.bits,L){g.msg="invalid distances set",C.mode=30;break}if(C.mode=20,6===I)break g;case 20:C.mode=21;case 21:if(6<=h&&258<=m){g.next_out=d,g.avail_out=m,g.next_in=u,g.avail_in=h,C.hold=S,C.bits=y,i(g,Z),d=g.next_out,c=g.output,m=g.avail_out,u=g.next_in,a=g.input,h=g.avail_in,S=C.hold,y=C.bits,12===C.mode&&(C.back=-1);break}for(C.back=0;H=(R=C.lencode[S&(1<<C.lenbits)-1])>>>16&255,J=65535&R,!((k=R>>>24)<=y);){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(H&&0==(240&H)){for(K=k,W=H,V=J;H=(R=C.lencode[V+((S&(1<<K+W)-1)>>K)])>>>16&255,J=65535&R,!(K+(k=R>>>24)<=y);){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}S>>>=K,y-=K,C.back+=K}if(S>>>=k,y-=k,C.back+=k,C.length=J,0===H){C.mode=26;break}if(32&H){C.back=-1,C.mode=12;break}if(64&H){g.msg="invalid literal/length code",C.mode=30;break}C.extra=15&H,C.mode=22;case 22:if(C.extra){for(v=C.extra;y<v;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}C.length+=S&(1<<C.extra)-1,S>>>=C.extra,y-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;H=(R=C.distcode[S&(1<<C.distbits)-1])>>>16&255,J=65535&R,!((k=R>>>24)<=y);){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(0==(240&H)){for(K=k,W=H,V=J;H=(R=C.distcode[V+((S&(1<<K+W)-1)>>K)])>>>16&255,J=65535&R,!(K+(k=R>>>24)<=y);){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}S>>>=K,y-=K,C.back+=K}if(S>>>=k,y-=k,C.back+=k,64&H){g.msg="invalid distance code",C.mode=30;break}C.offset=J,C.extra=15&H,C.mode=24;case 24:if(C.extra){for(v=C.extra;y<v;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}C.offset+=S&(1<<C.extra)-1,S>>>=C.extra,y-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){g.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(0===m)break g;if(p=Z-m,C.offset>p){if((p=C.offset-p)>C.whave&&C.sane){g.msg="invalid distance too far back",C.mode=30;break}w=p>C.wnext?(p-=C.wnext,C.wsize-p):C.wnext-p,p>C.length&&(p=C.length),f=C.window}else f=c,w=d-C.offset,p=C.length;for(m<p&&(p=m),m-=p,C.length-=p;c[d++]=f[w++],--p;);0===C.length&&(C.mode=21);break;case 26:if(0===m)break g;c[d++]=C.length,m--,C.mode=21;break;case 27:if(C.wrap){for(;y<32;){if(0===h)break g;h--,S|=a[u++]<<y,y+=8}if(Z-=m,g.total_out+=Z,C.total+=Z,Z&&(g.adler=C.check=C.flags?e(C.check,c,Z,d-Z):A(C.check,c,Z,d-Z)),Z=m,(C.flags?S:l(S))!==C.check){g.msg="incorrect data check",C.mode=30;break}y=S=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;y<32;){if(0===h)break g;h--,S+=a[u++]<<y,y+=8}if(S!==(4294967295&C.total)){g.msg="incorrect length check",C.mode=30;break}y=S=0}C.mode=29;case 29:L=1;break g;case 30:L=-3;break g;case 31:return-4;default:return r}return g.next_out=d,g.avail_out=m,g.next_in=u,g.avail_in=h,C.hold=S,C.bits=y,(C.wsize||Z!==g.avail_out&&C.mode<30&&(C.mode<27||4!==I))&&G(g,g.output,g.next_out,Z-g.avail_out)?(C.mode=31,-4):(b-=g.avail_in,Z-=g.avail_out,g.total_in+=b,g.total_out+=Z,C.total+=Z,C.wrap&&Z&&(g.adler=C.check=C.flags?e(C.check,c,Z,g.next_out-Z):A(C.check,c,Z,g.next_out-Z)),g.data_type=C.bits+(C.last?64:0)+(12===C.mode?128:0)+(20===C.mode||15===C.mode?256:0),(0==b&&0===Z||4===I)&&L===o&&(L=-5),L)},C.inflateEnd=function(g){if(!g||!g.state)return r;var I=g.state;return I.window&&(I.window=null),g.state=null,o},C.inflateGetHeader=function(g,I){var C;return g&&g.state?0==(2&(C=g.state).wrap)?r:((C.head=I).done=!1,o):r},C.inflateSetDictionary=function(g,I){var C,t=I.length;return g&&g.state?0!==(C=g.state).wrap&&11!==C.mode?r:11===C.mode&&A(1,I,t,0)!==C.check?-3:G(g,I,t,t)?(C.mode=31,-4):(C.havedict=1,o):r},C.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(g,I,C){"use strict";var t=g("../utils/common"),A=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],n=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];I.exports=function(g,I,C,o,r,s,a,c){var l,u,d,h,m,S,y,b,Z,B=c.bits,G=0,p=0,w=0,f=0,k=0,H=0,J=0,K=0,W=0,V=0,X=null,L=0,Y=new t.Buf16(16),v=new t.Buf16(16),R=null,D=0;for(G=0;G<=15;G++)Y[G]=0;for(p=0;p<o;p++)Y[I[C+p]]++;for(k=B,f=15;1<=f&&0===Y[f];f--);if(f<k&&(k=f),0===f)return r[s++]=20971520,r[s++]=20971520,c.bits=1,0;for(w=1;w<f&&0===Y[w];w++);for(k<w&&(k=w),G=K=1;G<=15;G++)if(K<<=1,(K-=Y[G])<0)return-1;if(0<K&&(0===g||1!==f))return-1;for(v[1]=0,G=1;G<15;G++)v[G+1]=v[G]+Y[G];for(p=0;p<o;p++)0!==I[C+p]&&(a[v[I[C+p]]++]=p);if(S=0===g?(X=R=a,19):1===g?(X=A,L-=257,R=e,D-=257,256):(X=i,R=n,-1),G=w,m=s,J=p=V=0,d=-1,h=(W=1<<(H=k))-1,1===g&&852<W||2===g&&592<W)return 1;for(;;){for(y=G-J,Z=a[p]<S?(b=0,a[p]):a[p]>S?(b=R[D+a[p]],X[L+a[p]]):(b=96,0),l=1<<G-J,w=u=1<<H;r[m+(V>>J)+(u-=l)]=y<<24|b<<16|Z|0,0!==u;);for(l=1<<G-1;V&l;)l>>=1;if(0!==l?(V&=l-1,V+=l):V=0,p++,0==--Y[G]){if(G===f)break;G=I[C+a[p]]}if(k<G&&(V&h)!==d){for(0===J&&(J=k),m+=w,K=1<<(H=G-J);H+J<f&&!((K-=Y[H+J])<=0);)H++,K<<=1;if(W+=1<<H,1===g&&852<W||2===g&&592<W)return 1;r[d=V&h]=k<<24|H<<16|m-s|0}}return 0!==V&&(r[m+V]=G-J<<24|64<<16|0),c.bits=k,0}},{"../utils/common":41}],51:[function(g,I,C){"use strict";I.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(g,I,C){"use strict";var t=g("../utils/common");function A(g){for(var I=g.length;0<=--I;)g[I]=0}var e=256,i=286,n=30,o=15,r=16,s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);A(u);var d=new Array(60);A(d);var h=new Array(512);A(h);var m=new Array(256);A(m);var S=new Array(29);A(S);var y,b,Z,B=new Array(n);function G(g,I,C,t,A){this.static_tree=g,this.extra_bits=I,this.extra_base=C,this.elems=t,this.max_length=A,this.has_stree=g&&g.length}function p(g,I){this.dyn_tree=g,this.max_code=0,this.stat_desc=I}function w(g){return g<256?h[g]:h[256+(g>>>7)]}function f(g,I){g.pending_buf[g.pending++]=255&I,g.pending_buf[g.pending++]=I>>>8&255}function k(g,I,C){g.bi_valid>r-C?(g.bi_buf|=I<<g.bi_valid&65535,f(g,g.bi_buf),g.bi_buf=I>>r-g.bi_valid,g.bi_valid+=C-r):(g.bi_buf|=I<<g.bi_valid&65535,g.bi_valid+=C)}function H(g,I,C){k(g,C[2*I],C[2*I+1])}function J(g,I){for(var C=0;C|=1&g,g>>>=1,C<<=1,0<--I;);return C>>>1}function K(g,I,C){var t,A,e=new Array(o+1),i=0;for(t=1;t<=o;t++)e[t]=i=i+C[t-1]<<1;for(A=0;A<=I;A++){var n=g[2*A+1];0!==n&&(g[2*A]=J(e[n]++,n))}}function W(g){var I;for(I=0;I<i;I++)g.dyn_ltree[2*I]=0;for(I=0;I<n;I++)g.dyn_dtree[2*I]=0;for(I=0;I<19;I++)g.bl_tree[2*I]=0;g.dyn_ltree[512]=1,g.opt_len=g.static_len=0,g.last_lit=g.matches=0}function V(g){8<g.bi_valid?f(g,g.bi_buf):0<g.bi_valid&&(g.pending_buf[g.pending++]=g.bi_buf),g.bi_buf=0,g.bi_valid=0}function X(g,I,C,t){var A=2*I,e=2*C;return g[A]<g[e]||g[A]===g[e]&&t[I]<=t[C]}function L(g,I,C){for(var t=g.heap[C],A=C<<1;A<=g.heap_len&&(A<g.heap_len&&X(I,g.heap[A+1],g.heap[A],g.depth)&&A++,!X(I,t,g.heap[A],g.depth));)g.heap[C]=g.heap[A],C=A,A<<=1;g.heap[C]=t}function Y(g,I,C){var t,A,i,n,o=0;if(0!==g.last_lit)for(;t=g.pending_buf[g.d_buf+2*o]<<8|g.pending_buf[g.d_buf+2*o+1],A=g.pending_buf[g.l_buf+o],o++,0===t?H(g,A,I):(H(g,(i=m[A])+e+1,I),0!==(n=s[i])&&k(g,A-=S[i],n),H(g,i=w(--t),C),0!==(n=a[i])&&k(g,t-=B[i],n)),o<g.last_lit;);H(g,256,I)}function v(g,I){var C,t,A,e=I.dyn_tree,i=I.stat_desc.static_tree,n=I.stat_desc.has_stree,r=I.stat_desc.elems,s=-1;for(g.heap_len=0,g.heap_max=573,C=0;C<r;C++)0!==e[2*C]?(g.heap[++g.heap_len]=s=C,g.depth[C]=0):e[2*C+1]=0;for(;g.heap_len<2;)e[2*(A=g.heap[++g.heap_len]=s<2?++s:0)]=1,g.depth[A]=0,g.opt_len--,n&&(g.static_len-=i[2*A+1]);for(I.max_code=s,C=g.heap_len>>1;1<=C;C--)L(g,e,C);for(A=r;C=g.heap[1],g.heap[1]=g.heap[g.heap_len--],L(g,e,1),t=g.heap[1],g.heap[--g.heap_max]=C,g.heap[--g.heap_max]=t,e[2*A]=e[2*C]+e[2*t],g.depth[A]=(g.depth[C]>=g.depth[t]?g.depth[C]:g.depth[t])+1,e[2*C+1]=e[2*t+1]=A,g.heap[1]=A++,L(g,e,1),2<=g.heap_len;);g.heap[--g.heap_max]=g.heap[1],function(g,I){var C,t,A,e,i,n,r=I.dyn_tree,s=I.max_code,a=I.stat_desc.static_tree,c=I.stat_desc.has_stree,l=I.stat_desc.extra_bits,u=I.stat_desc.extra_base,d=I.stat_desc.max_length,h=0;for(e=0;e<=o;e++)g.bl_count[e]=0;for(r[2*g.heap[g.heap_max]+1]=0,C=g.heap_max+1;C<573;C++)d<(e=r[2*r[2*(t=g.heap[C])+1]+1]+1)&&(e=d,h++),r[2*t+1]=e,s<t||(g.bl_count[e]++,i=0,u<=t&&(i=l[t-u]),n=r[2*t],g.opt_len+=n*(e+i),c&&(g.static_len+=n*(a[2*t+1]+i)));if(0!==h){do{for(e=d-1;0===g.bl_count[e];)e--;g.bl_count[e]--,g.bl_count[e+1]+=2,g.bl_count[d]--,h-=2}while(0<h);for(e=d;0!==e;e--)for(t=g.bl_count[e];0!==t;)s<(A=g.heap[--C])||(r[2*A+1]!==e&&(g.opt_len+=(e-r[2*A+1])*r[2*A],r[2*A+1]=e),t--)}}(g,I),K(e,s,g.bl_count)}function R(g,I,C){var t,A,e=-1,i=I[1],n=0,o=7,r=4;for(0===i&&(o=138,r=3),I[2*(C+1)+1]=65535,t=0;t<=C;t++)A=i,i=I[2*(t+1)+1],++n<o&&A===i||(n<r?g.bl_tree[2*A]+=n:0!==A?(A!==e&&g.bl_tree[2*A]++,g.bl_tree[32]++):n<=10?g.bl_tree[34]++:g.bl_tree[36]++,e=A,r=(n=0)===i?(o=138,3):A===i?(o=6,3):(o=7,4))}function D(g,I,C){var t,A,e=-1,i=I[1],n=0,o=7,r=4;for(0===i&&(o=138,r=3),t=0;t<=C;t++)if(A=i,i=I[2*(t+1)+1],!(++n<o&&A===i)){if(n<r)for(;H(g,A,g.bl_tree),0!=--n;);else 0!==A?(A!==e&&(H(g,A,g.bl_tree),n--),H(g,16,g.bl_tree),k(g,n-3,2)):n<=10?(H(g,17,g.bl_tree),k(g,n-3,3)):(H(g,18,g.bl_tree),k(g,n-11,7));e=A,r=(n=0)===i?(o=138,3):A===i?(o=6,3):(o=7,4)}}A(B);var N=!1;function F(g,I,C,A){k(g,0+(A?1:0),3),function(g,I,C,A){V(g),f(g,C),f(g,~C),t.arraySet(g.pending_buf,g.window,I,C,g.pending),g.pending+=C}(g,I,C)}C._tr_init=function(g){N||(function(){var g,I,C,t,A,e=new Array(o+1);for(t=C=0;t<28;t++)for(S[t]=C,g=0;g<1<<s[t];g++)m[C++]=t;for(m[C-1]=t,t=A=0;t<16;t++)for(B[t]=A,g=0;g<1<<a[t];g++)h[A++]=t;for(A>>=7;t<n;t++)for(B[t]=A<<7,g=0;g<1<<a[t]-7;g++)h[256+A++]=t;for(I=0;I<=o;I++)e[I]=0;for(g=0;g<=143;)u[2*g+1]=8,g++,e[8]++;for(;g<=255;)u[2*g+1]=9,g++,e[9]++;for(;g<=279;)u[2*g+1]=7,g++,e[7]++;for(;g<=287;)u[2*g+1]=8,g++,e[8]++;for(K(u,287,e),g=0;g<n;g++)d[2*g+1]=5,d[2*g]=J(g,5);y=new G(u,s,257,i,o),b=new G(d,a,0,n,o),Z=new G(new Array(0),c,0,19,7)}(),N=!0),g.l_desc=new p(g.dyn_ltree,y),g.d_desc=new p(g.dyn_dtree,b),g.bl_desc=new p(g.bl_tree,Z),g.bi_buf=0,g.bi_valid=0,W(g)},C._tr_stored_block=F,C._tr_flush_block=function(g,I,C,t){var A,i,n=0;0<g.level?(2===g.strm.data_type&&(g.strm.data_type=function(g){var I,C=4093624447;for(I=0;I<=31;I++,C>>>=1)if(1&C&&0!==g.dyn_ltree[2*I])return 0;if(0!==g.dyn_ltree[18]||0!==g.dyn_ltree[20]||0!==g.dyn_ltree[26])return 1;for(I=32;I<e;I++)if(0!==g.dyn_ltree[2*I])return 1;return 0}(g)),v(g,g.l_desc),v(g,g.d_desc),n=function(g){var I;for(R(g,g.dyn_ltree,g.l_desc.max_code),R(g,g.dyn_dtree,g.d_desc.max_code),v(g,g.bl_desc),I=18;3<=I&&0===g.bl_tree[2*l[I]+1];I--);return g.opt_len+=3*(I+1)+5+5+4,I}(g),A=g.opt_len+3+7>>>3,(i=g.static_len+3+7>>>3)<=A&&(A=i)):A=i=C+5,C+4<=A&&-1!==I?F(g,I,C,t):4===g.strategy||i===A?(k(g,2+(t?1:0),3),Y(g,u,d)):(k(g,4+(t?1:0),3),function(g,I,C,t){var A;for(k(g,I-257,5),k(g,C-1,5),k(g,t-4,4),A=0;A<t;A++)k(g,g.bl_tree[2*l[A]+1],3);D(g,g.dyn_ltree,I-1),D(g,g.dyn_dtree,C-1)}(g,g.l_desc.max_code+1,g.d_desc.max_code+1,n+1),Y(g,g.dyn_ltree,g.dyn_dtree)),W(g),t&&V(g)},C._tr_tally=function(g,I,C){return g.pending_buf[g.d_buf+2*g.last_lit]=I>>>8&255,g.pending_buf[g.d_buf+2*g.last_lit+1]=255&I,g.pending_buf[g.l_buf+g.last_lit]=255&C,g.last_lit++,0===I?g.dyn_ltree[2*C]++:(g.matches++,I--,g.dyn_ltree[2*(m[C]+e+1)]++,g.dyn_dtree[2*w(I)]++),g.last_lit===g.lit_bufsize-1},C._tr_align=function(g){k(g,2,3),H(g,256,u),function(g){16===g.bi_valid?(f(g,g.bi_buf),g.bi_buf=0,g.bi_valid=0):8<=g.bi_valid&&(g.pending_buf[g.pending++]=255&g.bi_buf,g.bi_buf>>=8,g.bi_valid-=8)}(g)}},{"../utils/common":41}],53:[function(g,I,C){"use strict";I.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(g,I,t){(function(g){!function(g,I){"use strict";if(!g.setImmediate){var C,t,A,e,i=1,n={},o=!1,r=g.document,s=Object.getPrototypeOf&&Object.getPrototypeOf(g);s=s&&s.setTimeout?s:g,C="[object process]"==={}.toString.call(g.process)?function(g){process.nextTick((function(){c(g)}))}:function(){if(g.postMessage&&!g.importScripts){var I=!0,C=g.onmessage;return g.onmessage=function(){I=!1},g.postMessage("","*"),g.onmessage=C,I}}()?(e="setImmediate$"+Math.random()+"$",g.addEventListener?g.addEventListener("message",l,!1):g.attachEvent("onmessage",l),function(I){g.postMessage(e+I,"*")}):g.MessageChannel?((A=new MessageChannel).port1.onmessage=function(g){c(g.data)},function(g){A.port2.postMessage(g)}):r&&"onreadystatechange"in r.createElement("script")?(t=r.documentElement,function(g){var I=r.createElement("script");I.onreadystatechange=function(){c(g),I.onreadystatechange=null,t.removeChild(I),I=null},t.appendChild(I)}):function(g){setTimeout(c,0,g)},s.setImmediate=function(g){"function"!=typeof g&&(g=new Function(""+g));for(var I=new Array(arguments.length-1),t=0;t<I.length;t++)I[t]=arguments[t+1];var A={callback:g,args:I};return n[i]=A,C(i),i++},s.clearImmediate=a}function a(g){delete n[g]}function c(g){if(o)setTimeout(c,0,g);else{var C=n[g];if(C){o=!0;try{!function(g){var C=g.callback,t=g.args;switch(t.length){case 0:C();break;case 1:C(t[0]);break;case 2:C(t[0],t[1]);break;case 3:C(t[0],t[1],t[2]);break;default:C.apply(I,t)}}(C)}finally{a(g),o=!1}}}}function l(I){I.source===g&&"string"==typeof I.data&&0===I.data.indexOf(e)&&c(+I.data.slice(e.length))}}("undefined"==typeof self?void 0===g?this:g:self)}).call(this,void 0!==C.g?C.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},"object"==n(I)?g.exports=i():(A=[],void 0===(e="function"==typeof(t=i)?t.apply(I,A):t)||(g.exports=e))}}]);
//# sourceMappingURL=877.js.map